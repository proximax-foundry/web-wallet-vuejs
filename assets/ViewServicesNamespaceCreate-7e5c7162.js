import{_ as ae,a5 as $e,M as ie,o as u,b as c,e as s,x as ue,t as r,O as ce,f as C,j as q,d as de,r as l,u as ve,c as y,z,F as Te,g as Ce,h as me,l as Pe,n as h,b3 as Ie,b4 as Se,H as f,B as d,S as Z,a as L,i as re,m as k,v as Ee,W as Fe,w as ne,G as Ve}from"./index-4140311c.js";import{_ as Re}from"./PasswordInput.vue_vue_type_script_setup_true_lang-91834de9.js";import{_ as Ae}from"./icon-info-8b4f1351.js";import{N as V}from"./namespaceUtils-099bed42.js";import{_ as De}from"./delete-8b454e7f.js";import{D as Me}from"./DurationInputClean-e095878e.js";import{_ as Le,a as Ue,b as Be,c as We}from"./TxnSummary.vue_vue_type_script_setup_true_lang-25f66628.js";import{T as ee}from"./transactionState-60e095e5.js";import"./jdenticon-module-230f7496.js";import"./proximax-logo-ecfc3767.js";const ze={directives:{tooltip:$e},props:{placeholder:String,errorMessage:String,showError:Boolean,disabled:Boolean,modelValue:String,toolTip:String},emits:["update:modelValue"],name:"TextInputTooltip",data(){return{textErr:!1}}},Oe={class:"border border-gray-200 px-2 py-1 h-14 rounded-md"},He={class:"uppercase text-gray-500 text-txs text-left mb-2"},je={key:0,src:Ae,class:"inline-block ml-1 relative cursor-pointer",style:{top:"-1px"}},Ge=["disabled","value"],qe={class:"h-3 mb-2"},Qe={key:0,class:"error error-text text-left"};function Ye(t,_,n,R,U,x){const i=ie("tooltip");return u(),c("div",{class:q(n.disabled?"opacity-50":"")},[s("div",Oe,[s("div",He,[ue(r(n.placeholder)+" ",1),n.toolTip?ce((u(),c("img",je,null,512)),[[i,{value:"<tiptext>"+n.toolTip+"</tiptext>",escape:!0},void 0,{bottom:!0}]]):C("",!0)]),s("input",{disabled:n.disabled,value:n.modelValue,onInput:_[0]||(_[0]=g=>t.$emit("update:modelValue",g.target.value)),type:"text",class:"text_input"},null,40,Ge)]),s("div",qe,[U.textErr||n.showError?(u(),c("div",Qe,r(n.errorMessage),1)):C("",!0)])],2)}const Je=ae(ze,[["render",Ye]]),Ke=de({emits:["select-namespace","update:modelValue","clear-namespace"],name:"SelectInputParentNamespace",props:["modelValue","action","address","disabled"],setup(t,{emit:_}){const n=l(!1);me().appContext.config.globalProperties.emitter;const{t:U}=ve(),x=l(""),i=l(""),g=v=>{x.value=v.value,i.value=v.label,n.value=!n.value},o=()=>{x.value="",i.value=""},O=y(()=>{let v=[];v.push({value:"1",label:U("namespace.newRootNamespace"),level:0,disabled:!1});const A=V.listNamespaces(z.Address.createFromRawAddress(t.address).plain());return A.length>0&&v.push.apply(v,A),v});return{selectNamespace:g,namespaces:O,toggleSelection:n,selectedNamespace:x,selectedNamespaceLabel:i,selectNs:v=>{v.disabled||(g(v),_("update:modelValue",x.value),_("select-namespace",x.value))},clearLabel:o}}}),Xe={class:"flex"},Ze={class:"flex flex-col ml-2 text-left"},ea={class:"text-blue-primary font-semibold text-xxs mb-1 uppercase",style:{"line-height":"9px"}},aa={key:0,class:"mt-1 text-tsm font-bold"},ta={key:1,class:"text-tsm font-bold"},sa={key:0,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},la={key:1,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},oa={class:"relative"},ra={key:0,class:"absolute border border-t-0 w-full z-50 bg-white max-h-40 overflow-auto px-3 filter drop-shodow-xl"},na={key:0,class:"uppercase pl-2 pt-4 text-xxs text-gray-400"},ia={key:1,class:"text-xxs pt-2 pl-2 pb-2"},ua=["onClick"],ca={key:0,class:"cursor-pointer text-blue-primary text-xxs mt-0.5 ml-auto font-semibold uppercase"},da={key:1,class:"text-gray-300 text-xxs mt-0.5 ml-auto uppercase"},va={key:2,class:"text-gray-500 text-xxs mt-0.5 ml-auto uppercase"};function ma(t,_,n,R,U,x){return u(),c("div",{class:q(["relative",t.disabled?"opacity-50":"cursor-pointer"])},[s("div",{onClick:_[1]||(_[1]=i=>t.disabled?"":t.toggleSelection=!t.toggleSelection),class:"border ml-auto mr-auto py-3 px-2 rounded-md w-full h-14"},[s("div",Xe,[s("div",Ze,[s("div",ea,r(t.$t("general.namespace")),1),t.selectedNamespace!=""?(u(),c("div",aa,r(t.selectedNamespaceLabel),1)):(u(),c("div",ta,r(t.$t("namespace.selectNamespace")),1))]),!t.toggleSelection&&t.selectedNamespace==""?(u(),c("div",sa,r(t.$t("general.select")),1)):C("",!0),!t.toggleSelection&&t.selectedNamespace!=""?(u(),c("div",la,r(t.$t("general.change")),1)):C("",!0),t.toggleSelection?(u(),c("img",{key:2,onClick:_[0]||(_[0]=i=>{t.selectedNamespace="",t.$emit("clear-namespace")}),src:De,class:"h-5 w-5 ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"})):C("",!0)])]),s("div",oa,[t.toggleSelection?(u(),c("div",ra,[t.namespaces.length>0?(u(),c("div",na,r(t.$t("namespace.selectNamespace")),1)):(u(),c("div",ia,r(t.$t("general.listEmpty")),1)),(u(!0),c(Te,null,Ce(t.namespaces,(i,g)=>(u(),c("div",{key:g,class:q(["px-2 py-3 flex items-center",[g!=t.namespaces.length-1?"border-b border-gray-200":"",i.disabled?"cursor-text":"cursor-pointer"]]),onClick:o=>t.selectNs(i)},[s("div",{class:q(["text-xs truncate",i.disabled?"text-gray-300":"text-black font-semibold"])},r(i.label),3),i.label!=t.selectedNamespace&&!i.disabled?(u(),c("div",ca,r(t.$t("general.select")),1)):i.disabled?(u(),c("div",da,r(t.$t("general.disabled")),1)):(u(),c("div",va,r(t.$t("general.current")),1))],10,ua))),128))])):C("",!0)])],2)}const pa=ae(Ke,[["render",ma]]),fa={class:"w-10/12 ml-auto mr-auto"},ba={class:"border filter shadow-lg xl:grid xl:grid-cols-3 mt-8"},ga={class:"xl:col-span-2 p-12"},ha={class:"font-semibold mb-4"},_a={key:0,class:"rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},ya={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},xa={class:"inline-block text-xs"},Na={key:1,class:"error error_box"},wa={class:"mt-4"},ka={class:"flex gap-1 mt-3"},$a={key:0,class:"mt-3"},Ta={class:"lg:grid lg:grid-cols-2 mt-5"},Ca={class:"mb-5 lg:mb-0 lg:mr-2"},Pa={class:"mb-5 lg:mb-0 lg:ml-2"},Ia={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},Sa={class:"text-xs text-white my-5"},Ea=["disabled"],Fa={class:"text-center"},Va={class:"sm:grid sm:grid-cols-2 mt-10 lg:mt-16"},Ra={class:"mb-8 sm:pr-1"},Aa={href:"https://bcdocs.xpxsirius.io/docs/built-in-features/namespace/",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Da={class:"text-gray-400 text-tsm my-3 sm:pr-2"},Ma={class:"mb-8"},La={href:"https://t.me/proximaxhelpdesk",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Ua={class:"text-gray-400 text-tsm my-3"},Ba="^[^ ]{8,}$",Wa=de({__name:"ViewServicesNamespaceCreate",setup(t){const _=Pe(),{t:n}=ve(),R=l(null),x=me().appContext.config.globalProperties.emitter,i=l(!1),g=l(!1),o=l(""),O=l(!1),N=l("1"),v=l(""),A=l(""),P=l(n("namespace.validName"));l("");const I=l(!1),S=l(!1),te=l(!1),pe=l(!1),se=`^[0-9a-z]{2,${y(()=>h.currentNetworkProfileConfig?h.currentNetworkProfileConfig.maxNameSize:0).value}}$`,b=l(!1),D=y(()=>h.currentNetworkProfileConfig?Math.floor(Ie.configReturn(h.currentNetworkProfileConfig.maxNamespaceDuration,Se.DAY)):0),m=l(""),B=y(()=>m.value?m.value=="1"?Number(N.value)>0?f.convertToExact(h.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock*V.calculateDuration(Number(N.value)),d.nativeToken.divisibility):f.convertToExact(h.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock,d.nativeToken.divisibility):f.convertToExact(h.currentNetworkProfileConfig.childNamespaceRentalFee,d.nativeToken.divisibility):0),fe=y(()=>f.toCurrencyFormat(B.value,d.nativeToken.divisibility)),Q=y(()=>h.currentNetworkProfileConfig?f.convertToExact(h.currentNetworkProfileConfig.lockedFundsPerAggregate,d.nativeToken.divisibility):0),Y=y(()=>h.currentNetworkProfile?f.convertToExact(Z.getLockFundFee(),d.nativeToken.divisibility):0),be=y(()=>Q.value+Y.value),ge=y(()=>!(v.value.match(Ba)&&o.value.match(se)&&!O.value&&!le.value&&!b.value&&m.value)),p=l(null),H=l(null),w=l(null),$=l(0),j=l(0),J=async e=>{if(d.chainAPI&&e)try{const a=await d.chainAPI.accountAPI.getAccountInfo(z.Address.createFromRawAddress(e)),E=a.mosaics.findIndex(M=>M.id.toHex()==d.nativeToken.assetId);return E!=-1?a.mosaics[E].amount.compact()/Math.pow(10,d.nativeToken.divisibility):0}catch{return 0}},le=y(()=>{if(w.value)return p.value?j.value<B.value?!0:$.value<T.value+be.value:$.value<B.value+T.value});$.value<B.value?(I.value=!0,te.value=!0,S.value=!0,i.value=!0,g.value=!0):(I.value=!1,te.value=!1,S.value=!1,i.value=!1,g.value=!1);const G=l(0),T=l(0),he=()=>{m.value=""},_e=e=>{let a=0;e=="1"?(N.value="1",S.value=!1,o.value.trim().length>0&&!b.value&&(a=V.getRootNamespaceTransactionFee(o.value),G.value=Number(f.convertToCurrency(a,d.nativeToken.divisibility)),T.value=f.convertToExact(a,d.nativeToken.divisibility))):(N.value="0",S.value=!0,o.value.trim().length>0&&!b.value&&(a=V.getSubNamespaceTransactionFee(e,o.value),G.value=Number(f.convertToCurrency(a,d.nativeToken.divisibility)),T.value=f.convertToExact(a,d.nativeToken.divisibility)))};L(m,e=>{e?(i.value=!1,S.value=!1,I.value=!1):(i.value=!0,S.value=!0,I.value=!0)},{immediate:!0});const ye=async()=>{if(!Fe.verifyWalletPassword(ne.currentLoggedInWallet.name,h.chainNetworkName,v.value)){A.value=n("general.walletPasswordInvalid",{name:ne.currentLoggedInWallet.name});return}let a,E=d.buildTxn;const M=await d.chainAPI.nodeAPI.getNodeTime();if(m.value==="1"){let W=E.registerRootNamespace(o.value,z.UInt64.fromUint(V.calculateDuration(Number(N.value))));a=await Z.signTxnWithPassword(w.value,p.value,v.value,W,void 0,new z.UInt64(M.sendTimeStamp))}else{let W=E.registersubNamespace(m.value,o.value);a=await Z.signTxnWithPassword(w.value,p.value,v.value,W,void 0,new z.UInt64(M.sendTimeStamp))}ee.lockHashPayload=a.hashLockTxnPayload,ee.transactionPayload=a.txnPayload,ee.selectedAddress=w.value,_.push({name:"ViewConfirmTransaction"})};L(N,e=>{parseInt(e)>D.value&&(N.value=`${D.value}`)});const K=()=>{N.value="1"},oe=y(()=>{if(p.value){let e=[Q.value,Y.value,T.value];return f.safeSum(e)}else return B.value+T.value});L(oe,e=>{$.value<e?(I.value=!0,g.value=!0):(I.value=!1,g.value=!1)});const xe=y(()=>h.currentNetworkProfileConfig?h.currentNetworkProfileConfig.reservedRootNamespaceNames.split(",").map(e=>e.trim()):[]),Ne=()=>m.value==="1"&&xe.value.includes(o.value.trim())?(b.value=!0,P.value=n("namespace.reservedName"),!0):!1,we=async()=>{if(m.value==="1"&&o.value.trim())try{let e=await Ve.getNamespaceInfo(f.createNamespaceId(o.value));if(p.value){if(e.owner.address.plain()!==p.value)return b.value=!0,P.value=n("namespace.nameRegistered"),!0}else if(e.owner.address.plain()!==w.value)return b.value=!0,P.value=n("namespace.nameRegistered"),!0}catch{return!1}return!1},ke=async()=>{if(o.value.trim()){if(Ne())return;if(b.value=!o.value.match(se),b.value)P.value=n("namespace.validName");else{if(await we())return;let a=0;m.value=="1"?o.value.trim().length>0&&!b.value&&(a=V.getRootNamespaceTransactionFee(o.value),G.value=Number(f.convertToCurrency(a,d.nativeToken.divisibility)),T.value=f.convertToExact(a,d.nativeToken.divisibility)):o.value.trim().length>0&&!b.value&&(a=V.getSubNamespaceTransactionFee(o.value,m.value),G.value=Number(f.convertToCurrency(a,d.nativeToken.divisibility)),T.value=f.convertToExact(a,d.nativeToken.divisibility))}}},X=()=>{o.value="",m.value="",R.value.clearLabel(),b.value=!1,K(),H.value=null,p.value=null};return L(w,async(e,a)=>{e==null?($.value=0,X()):e!=a&&(X(),$.value=await J(e))}),L(p,async(e,a)=>{e==null?(j.value=0,X(),$.value=await J(w.value)):e!=a&&(m.value="",o.value="",R.value.clearLabel(),b.value=!1,K(),j.value=await J(e))}),L(o,e=>{m.value===""?(b.value=!1,P.value=""):e.length==0&&(b.value=!0,P.value=n("namespace.validName"))}),x.on("select-account",e=>{w.value=e}),x.on("select-multisig-account",e=>{H.value=e.label,p.value=e.value}),x.on("CLOSE_MULTISIG",()=>{H.value=null,p.value=null}),(e,a)=>{const E=re("font-awesome-icon"),M=re("router-link"),W=ie("debounce");return u(),c("div",null,[s("div",fa,[s("div",ba,[s("div",ga,[s("div",ha,r(e.$t("general.createNamespace")),1),le.value?(u(),c("div",_a,[s("div",ya,[k(E,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),s("div",xa,r(e.$t("general.insufficientBalance")),1)])):C("",!0),A.value!=""?(u(),c("div",Na,r(A.value),1)):C("",!0),s("div",wa,[s("div",ka,[k(Le,{type:"namespace"}),k(Ue,{"selected-address":w.value},null,8,["selected-address"])]),p.value?(u(),c("div",$a,[k(Be,{"select-default-address":p.value,"select-default-name":H.value,type:"namespace"},null,8,["select-default-address","select-default-name"])])):C("",!0),k(pa,{onSelectNamespace:_e,onClearNamespace:he,ref_key:"nsRef",ref:R,modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=F=>m.value=F),address:p.value?p.value:w.value,class:"mt-5",disabled:g.value},null,8,["modelValue","address","disabled"]),s("div",Ta,[s("div",Ca,[ce(k(Je,{disabled:i.value,placeholder:e.$t("general.name"),errorMessage:P.value,modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=F=>o.value=F),icon:"id-card-alt",showError:b.value,class:"w-full inline-block",toolTip:e.$t("namespace.namespaceNameMsg1")+"<br><br>"+e.$t("namespace.namespaceNameMsg2")+"<br><br>"+e.$t("namespace.namespaceNameMsg3"),tabindex:"0"},null,8,["disabled","placeholder","errorMessage","modelValue","showError","toolTip"]),[[W,ke,"1000"]])]),s("div",Pa,[k(Me,{disabled:S.value,modelValue:N.value,"onUpdate:modelValue":a[2]||(a[2]=F=>N.value=F),max:D.value,placeholder:e.$t("namespace.duration"),onSetDefaultDuration:K,showError:O.value,toolTip:e.$t("namespace.durationMsg")+`<br>${D.value===365?"1 "+e.$t("general.year"):""} (${D.value}`+e.$t("general.day",D.value)+")."},null,8,["disabled","modelValue","max","placeholder","showError","toolTip"])])])])]),s("div",Ia,[k(We,{"signer-native-token-balance":$.value,"namespace-rental-fee-currency":fe.value,"native-token-balance":p.value?j.value:$.value,"lock-fund":Q.value,"lock-fund-tx-fee":Y.value,"selected-multisig-address":p.value,"txn-fee":T.value,"total-fee":oe.value},null,8,["signer-native-token-balance","namespace-rental-fee-currency","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee"]),s("div",Sa,r(e.$t("general.enterPasswordContinue")),1),k(Re,{placeholder:e.$t("general.password"),errorMessage:e.$t("general.passwordRequired"),showError:pe.value,modelValue:v.value,"onUpdate:modelValue":a[3]||(a[3]=F=>v.value=F),disabled:I.value},null,8,["placeholder","errorMessage","showError","modelValue","disabled"]),s("button",{type:"submit",class:"mt-3 w-full blue-btn py-4 disabled:opacity-50 disabled:cursor-auto text-white",disabled:ge.value,onClick:ye},r(e.$t("namespace.registerNamespace")),9,Ea),s("div",Fa,[k(M,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white border-b-2 border-white"},{default:Ee(()=>[ue(r(e.$t("general.cancel")),1)]),_:1})])])]),s("div",Va,[s("div",Ra,[s("a",Aa,r(e.$t("general.namespaceQues")),1),s("div",Da,r(e.$t("namespace.namespaceAns")),1)]),s("div",Ma,[s("a",La,r(e.$t("general.feedback")),1),s("div",Ua,r(e.$t("general.feedbackDescription")),1)])])])])}}});const Za=ae(Wa,[["__scopeId","data-v-e102fe65"]]);export{Za as default};
