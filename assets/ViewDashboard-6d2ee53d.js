import{d as ue,o as f,f as _,l as y,b as x,s as E,t as o,v as R,e as t,H as d,_ as O,g as l,i as A,T as Le,F as $e,j as Fe,y as Qe,c,A as m,x as M,n as D,w as v,z as Ee,B as Ke,D as We,r as Be,a as Oe,h as ie,E as je,W as Q,G as B,I as Ve,J as Ue}from"./index-ac085045.js";import{_ as ze}from"./icon-xpx-072deeab.js";import{_ as Ge}from"./PendingDataTable.vue_vue_type_script_setup_true_lang-994958da.js";import{M as He,T as qe}from"./MixedTxnDataTable-c4afbcc3.js";import{s as ce,a as Je}from"./column.esm-a17d958d.js";import{c as Xe}from"./functions-c0137ee2.js";import{D as de}from"./dashboardService-c86c9cb4.js";import{q as Ye}from"./qrcode-b33e9ab2.js";import"./icon-message-e27d55b6.js";import"./icon-proximax-logo-gray-c2486ce1.js";import"./PasswordInput.vue_vue_type_script_setup_true_lang-354fad8f.js";const Ze="/web-wallet-vuejs/assets/icon-blue-chevron-right-cc98de93.svg",et="/web-wallet-vuejs/assets/icon-copy-82348b96.svg",tt="/web-wallet-vuejs/assets/icon-balance-white-7304021e.svg",st="/web-wallet-vuejs/assets/icon-transfer-white-341a4c30.svg",at="/web-wallet-vuejs/assets/icon-swap-white-2516ece4.svg",nt={class:"uppercase font-semibold text-xs"},rt={class:"uppercase font-semibold text-xs"},lt=ue({__name:"DashboardAssetDataTable",props:{assets:Array},setup(g){return(u,P)=>(f(),_("div",null,[y(R(Je),{value:g.assets,paginator:!0,rows:10,dataKey:"id",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink  RowsPerPageDropdown",rowsPerPageOptions:[10,20,30,40,50],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",responsiveLayout:"scroll"},{empty:x(()=>[E(o(u.$t("general.noRecord")),1)]),loading:x(()=>[E(o(u.$t("dashboard.fetchingTx")),1)]),default:x(()=>[y(R(ce),{field:"assetId",header:u.$t("general.assetId"),style:{"`wideScreen?'min-width":"200px'?'width: 200px'  `"}},{body:x(({data:i})=>[t("span",nt,o(i.namespaceNames[0]?i.namespaceNames[0]:i.idHex),1)]),_:1},8,["header"]),y(R(ce),{field:"amount",header:u.$t("general.amount"),style:{"`wideScreen?'min-width":"180px'?'width: 180px'`"}},{body:x(({data:i})=>[t("span",rt,o(R(d).toCurrencyFormat(i.amount,i.divisibility)),1)]),_:1},8,["header"])]),_:1},8,["value"])]))}});const ot=O(lt,[["__scopeId","data-v-2bb36a97"]]),it="/web-wallet-vuejs/assets/icon-qr_code-9cdfb652.svg",ct={name:"AddressQRModal",props:{accountAddressQR:String,notIncludeWord:Boolean},setup(g){return{toggleModal:l(!1)}}},dt=t("img",{src:it,class:"w-4 h-4 cursor-pointer mr-1 inline-block"},null,-1),ut={key:0,class:"text-xs font-bold",style:{"margin-top":"1px"}},pt={key:0,class:"popup-outer-lang fixed flex z-50"},vt={class:"modal-popup-box"},ft={class:"flex justify-center"},gt=["src"];function mt(g,u,P,i,K,h){return f(),_($e,null,[t("div",{class:"my-2 flex items-center cursor-pointer",onClick:u[0]||(u[0]=L=>i.toggleModal=!i.toggleModal)},[dt,P.notIncludeWord!=!0?(f(),_("span",ut,o(g.$t("dashboard.scanQR")),1)):A("",!0)]),y(Le,{"enter-active-class":"animate__animated animate__fadeInDown","leave-active-class":"animate__animated animate__fadeOutUp"},{default:x(()=>[i.toggleModal?(f(),_("div",pt,[t("div",vt,[t("div",ft,[t("img",{src:P.accountAddressQR,class:"inline-block"},null,8,gt)]),t("div",{class:"text-center cursor-pointer text-xs font-semibold text-blue-link mt-2",onClick:u[1]||(u[1]=L=>{i.toggleModal=!i.toggleModal})},o(g.$t("general.close")),1)])])):A("",!0)]),_:1}),i.toggleModal?(f(),_("div",{key:0,onClick:u[2]||(u[2]=L=>i.toggleModal=!i.toggleModal),class:"fixed inset-0 bg-opacity-60 bg-gray-100 z-20"})):A("",!0)],64)}const yt=O(ct,[["render",mt]]),b=g=>(Ve("data-v-0d4c720a"),g=g(),Ue(),g),_t={class:"px-2 sm:px-10 bg-gray-200 pb-4 pt-5"},bt={class:"max-w-screen-sm m-auto"},xt={class:"shadow-md w-full overflow-x-hidden address_div px-7 py-3 rounded flex flex-col bg-white text-black"},ht={class:"text-center py-3"},Tt={class:"text-center my-2"},wt={class:"inline-block"},kt={class:"font-bold text-xl"},At={class:"text-md"},Pt={class:"font-bold text-xl"},Ct=b(()=>t("img",{src:ze,class:"inline-block w-6 h-6 ml-3 mb-2"},null,-1)),It=b(()=>t("img",{src:Ze,class:"inline-block w-5 h-5 ml-1 mb-0.5"},null,-1)),St={class:"mb-8"},Nt={class:"flex items-center justify-center"},Mt=["copyValue","copySubject"],Dt=["href"],Rt=b(()=>t("div",{class:"inline-block rounded-full bg-blue-primary w-8 h-8"},[t("div",{class:"h-full w-full flex items-center justify-center"},[t("img",{src:tt,class:"w-5 h-5"})])],-1)),Lt=b(()=>t("br",null,null,-1)),$t={class:"text-xxs text-gray-400 inline-block uppercase"},Ft=b(()=>t("div",{class:"inline-block rounded-full bg-blue-primary w-8 h-8"},[t("div",{class:"h-full w-full flex items-center justify-center"},[t("img",{src:st,class:"w-5 h-5"})])],-1)),Qt=b(()=>t("br",null,null,-1)),Et={class:"text-xxs text-gray-400 inline-block uppercase"},Kt=b(()=>t("div",{class:"inline-block rounded-full bg-blue-primary w-8 h-8"},[t("div",{class:"h-full w-full flex items-center justify-center"},[t("img",{src:at,class:"w-5 h-5"})])],-1)),Wt=b(()=>t("br",null,null,-1)),Bt={class:"text-xxs text-gray-400 inline-block uppercase"},Ot={class:"text-left px-2 sm:px-10 bg-gray-200"},jt={class:"transition-all flex items-end"},Vt={key:0,class:"bg-white px-2 sm:px-10"},Ut=b(()=>t("div",{class:"text-txs text-gray-400 mt-10 mb-2"},[t("b",{class:"text-gray-700 uppercase"},"Pending Transactions")],-1)),zt={class:"text-txs text-gray-400 mt-10 mb-2"},Gt={class:"text-gray-700 uppercase"},Ht=["href"],qt=b(()=>t("div",{class:"text-right text-xs text-blue-primary mt-3"}," View more... ",-1)),Jt=[qt],Xt={key:1,class:"bg-white px-2 sm:px-10 pt-12"},Yt=ue({__name:"ViewDashboard",setup(g){const{t:u}=Fe(),P=Qe(),K=je().appContext.config.globalProperties.emitter,h=l("asset"),L=l(!1),pe=l(!1),j=l(!1),ve=l(!1),fe=l(""),C=l(""),I=l(!1),V=l(""),W=l(!1),ge=l(0),me=c(()=>m.networkType==M.NetworkType.TEST_NET||m.networkType==M.NetworkType.MAIN_NET),ye=async e=>{let s=e.txType,a=e.recipient,r=e.recipientType,p=!1;W.value=!1;let Re=e.sender;if(V.value=e.initialSigner,fe.value=e.message,C.value="",I.value=!1,s==="Transfer"||s==="Aggregate Complete"?(p=!0,Q.findWalletAccountByPublicKey(v.currentLoggedInWallet,Re)&&(W.value=!0)):Q.findWalletAccountByPublicKey(v.currentLoggedInWallet,V.value)&&(W.value=!0),r==="address"){let k=Q.findAccountPublicKeyByAddress(v.currentLoggedInWallet,a);if(k)C.value=k;else{let N=await B.getAccountInfo(d.createAddress(a));N.publicKey==="0".repeat(64)?I.value=!0:C.value=N.publicKey}}else{let k=await B.getNamespaceLinkedAddress(a);if(k){let N=Q.findAccountPublicKeyByAddress(v.currentLoggedInWallet,a);if(N)C.value=N;else{let oe=await B.getAccountInfo(k);oe.publicKey==="0".repeat(64)?I.value=!0:C.value=oe.publicKey}}else I.value=!0}p||(I.value=!0),ge.value++,j.value=!0},_e=c(()=>m.nativeToken.label),be=c(()=>m.nativeToken.divisibility),xe=c(()=>m.networkType==M.NetworkType.TEST_NET),U=c(()=>xe.value?D.chainNetworkName=="Sirius Testnet 1"?"https://bctestnetfaucet.xpxsirius.io/#/":D.chainNetworkName=="Sirius Testnet 2"?"https://bctestnet2faucet.xpxsirius.io/#/":!1:m.networkType==M.NetworkType.MAIN_NET?"https://www.proximax.io/en/xpx":!1);let n=c(()=>{if(v.currentLoggedInWallet){if(!v.currentLoggedInWallet.selectDefaultAccount())return v.currentLoggedInWallet.accounts[0]}else return null;return v.currentLoggedInWallet.selectDefaultAccount()});const he=c(()=>v.currentLoggedInWallet?n.value.assets.filter(a=>a.rawAmount!=0):[]),z=c(()=>n.value?d.createAddress(n.value.address).pretty():null),T=c(()=>n.value?n.value.address:null),Te=c(()=>{if(n.value){let e=d.createAddress(n.value.address).pretty(),s=e.substring(0,11),a=e.substring(e.length-11);return s+"..."+a}else return null}),$=c(()=>n.value?d.toCurrencyFormat(n.value?n.value.balance:0,be.value):null),we=c(()=>$.value?$.value.split(".")[0]:null),G=c(()=>$.value?$.value.split(".")[1]:null),ke=c(()=>n.value?n.value.name:null),Ae=c(()=>{if(z.value){let e=Ye(15,"H");return e.addData(z.value),e.make(),e.createDataURL()}else return null});let w=new de(v.currentLoggedInWallet,n.value),Pe=l(0),H=async()=>{let e=await w.getAccountTransactionsCount(n.value);Pe.value=e.confirmed};const Ce=e=>{let s=document.getElementById(e).getAttribute("copyValue"),a=document.getElementById(e).getAttribute("copySubject");Xe(s),P.add({severity:"info",detail:a+" "+u("general.copied"),group:"br-custom",life:3e3})},q=l([]),J=l([]),Ie=l([]);let X=d.createTransactionQueryParams(),S=d.getTransactionGroupType(),F=d.createTransactionFieldOrder(d.getQueryParamOrder_v2().DESC,d.getTransactionSortField().BLOCK);X.updateFieldOrder(F),X.embedded=!0;let Y=async()=>{let e=d.createTransactionQueryParams();e.pageSize=1,e.publicKey=n.value.publicKey,e.embedded=!0,e.updateFieldOrder(F);let s=await w.searchTxns(S.CONFIRMED,e),a=await w.formatConfirmedMixedTxns(s.transactions);q.value=a.slice(0,5),J.value=a},Z=async()=>{let e=d.createTransactionQueryParams();e.pageSize=20,e.type=qe.getTransferTypes(),e.publicKey=n.value.publicKey,e.embedded=!0,e.updateFieldOrder(F);let s=await w.searchTxns(S.CONFIRMED,e);if(s.transactions.length){let a=await w.formatConfirmedMixedTxns(s.transactions);Ie.value=a,Se.value=Ne(a).slice(0,3)}};const Se=l([]),Ne=e=>{let s=[],a=e.filter(r=>r.amountTransfer>0);for(const r of a){let p;T.value==r.sender&&T.value==r.recipient||(T.value==r.sender?(p.transferContact=v.currentLoggedInWallet.convertAddressToNamePretty(r.recipient,!0),p.transferContactAddress=r.recipient,p.amount="-"+d.toCurrencyFormat(r.amountTransfer,m.nativeToken.divisibility)):(p.transferContact=v.currentLoggedInWallet.convertAddressToNamePretty(r.sender,!0).substring(0,30),p.transferContactAddress=r.sender,p.amount=d.toCurrencyFormat(r.amountTransfer,m.nativeToken.divisibility)),p.transferContact.length>20,p.hash=r.hash,s.push(p))}return s};K.on("CLOSE_MODAL",()=>{L.value=!1,pe.value=!1,ve.value=!1,j.value=!1}),K.on("DEFAULT_ACCOUNT_SWITCHED",async e=>{H(),Y(),Z(),await ae(),await ne(),re()});const ee=l([]),te=l([]),se=l([]),Me=c(()=>ee.value.concat(se.value).concat(te.value));let ae=async()=>{if(!n.value)return;let e=d.createTransactionQueryParams();e.pageSize=1,e.address=T.value,e.embedded=!0,e.updateFieldOrder(F);let s=await w.searchTxns(S.UNCONFIRMED,e),a=await w.formatUnconfirmedMixedTxns(s.transactions);ee.value=a},ne=async()=>{if(!n.value)return;let e=new de(v.currentLoggedInWallet,n.value),s=d.createTransactionQueryParams();s.pageSize=100,s.address=T.value;let a=await e.searchTxns(S.PARTIAL,s),r=await e.formatPartialMixedTxns(a.transactions);te.value=r},re=()=>{if(!n.value)return;let e=[];Ee.autoAnnounceSignedTransaction.forEach(s=>{let a=M.TransactionMapping.createFromPayload(s.signedTransaction.payload);(Ke.castToAggregate(a).innerTransactions.find(p=>p.signer.address.plain()==n.value.address)!=null||s.signedTransaction.signer==n.value.publicKey)&&e.push({type:"Aggregate Bonded",hash:s.signedTransaction.hash,deadline:a.deadline.value,groupType:"In Queue",recipient:"",sender:"",amount:"",message:"",sda:""})}),se.value=e};const le=async()=>{H(),Y(),Z(),await ae(),await ne(),re()};if(m.isReady)le();else{let e=We(m,s=>{s.isReady&&(le(),e())})}const De=()=>D.currentNetworkProfile?D.currentNetworkProfile.chainExplorer.url+"/"+D.currentNetworkProfile.chainExplorer.addressRoute+"/"+n.value.address:"";return(e,s)=>{const a=Be("router-link");return f(),_("div",null,[t("div",_t,[t("div",bt,[t("div",xt,[t("div",ht,[t("div",Tt,[t("div",wt,[t("span",kt,o(we.value),1),E(o(G.value?".":""),1),t("span",At,o(G.value),1),t("span",Pt,o(_e.value),1)]),Ct]),y(a,{to:"/details-account/"+T.value,class:"inline-block text-xs font-bold text-blue-primary cursor-pointer"},{default:x(()=>[E(o(ke.value),1),It]),_:1},8,["to"]),t("div",St,[t("div",Nt,[t("div",{id:"address",class:"inline-block font-bold outline-none break-all text-xs lg:text-tsm",copyValue:T.value,copySubject:e.$t("general.address")},o(Te.value),9,Mt),t("img",{src:et,class:"w-4 cursor-pointer ml-4 inline-block",onClick:s[0]||(s[0]=r=>Ce("address"))}),y(yt,{accountAddressQR:Ae.value,notIncludeWord:!0},null,8,["accountAddressQR"])])]),t("div",null,[U.value?(f(),_("a",{key:0,href:U.value,target:"_new",class:"inline-block text-center mr-2"},[Rt,Lt,t("div",$t,o(e.$t("general.topUp")),1)],8,Dt)):A("",!0),y(a,{to:{name:"ViewTransferCreate"},class:"inline-block text-center mx-2"},{default:x(()=>[Ft,Qt,t("div",Et,o(e.$t("general.transfer")),1)]),_:1}),me.value?(f(),Oe(a,{key:1,to:{name:"ViewServicesMainnetSwap"},class:"inline-block text-center mx-3"},{default:x(()=>[Kt,Wt,t("div",Bt,o(e.$t("general.swap")),1)]),_:1})):A("",!0)])])])])]),t("div",Ot,[t("div",jt,[t("div",{class:ie(["text-xs inline-block px-3 rounded-t-sm py-3",`${h.value=="asset"?"bg-white text-gray-primary":"cursor-pointer"}`]),onClick:s[1]||(s[1]=r=>h.value="asset")},o(e.$t("general.asset",2)),3),t("div",{class:ie(["text-xs inline-block px-3 rounded-t-sm py-3",`${h.value=="overview"?"bg-white text-gray-primary":"cursor-pointer"}`]),onClick:s[2]||(s[2]=r=>h.value="overview")}," Activities ",2)])]),h.value=="overview"?(f(),_("div",Vt,[Ut,y(Ge,{transaction:Me.value},null,8,["transaction"]),t("div",zt,[t("b",Gt,o(e.$t("dashboard.recentTransactions")),1)]),y(He,{selectedGroupType:R(S).CONFIRMED,transactions:q.value,onOpenDecryptMsg:ye},null,8,["selectedGroupType","transactions"]),J.value.length==10?(f(),_("a",{key:0,href:De(),target:"_blank"},Jt,8,Ht)):A("",!0)])):h.value=="asset"?(f(),_("div",Xt,[y(ot,{assets:he.value},null,8,["assets"])])):A("",!0)])}}});const ds=O(Yt,[["__scopeId","data-v-0d4c720a"]]);export{ds as default};
