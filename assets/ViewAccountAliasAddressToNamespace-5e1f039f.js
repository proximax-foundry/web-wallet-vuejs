import{S as Ae}from"./SelectInputPluginClean-aae4ab18.js";import{P as _e}from"./PasswordInput-5f97cbbf.js";import{_ as Ne,u as Ce,c as l,w as m,r as d,n as C,H as M,E as b,P as Te,D as xe,a as V,B as K,q as Le,k as N,o,b as r,e as g,s as y,A as ae,t as u,S as Ie,af as Pe,F as se,i as le,f as p,z as Se,W as Fe}from"./index-47d422d4.js";import{a as h}from"./accountUtils-7f2f8316.js";import{A as Me,a as We}from"./AccountTabs-0ac62344.js";import{M as X}from"./multisigUtils-bc8d203b.js";import{A as Ue}from"./AddressInputClean-f9d79fe5.js";import{T as Ve}from"./TransactionFeeDisplay-b80cbe45.js";import"./multiselect-f063a86d.js";import"./jdenticon-module-4c899338.js";import"./functions-4879562c.js";import"./TextInput-585f2c09.js";import"./TextInputClean-5836e25c.js";import"./icon-key-5b3f7dda.js";import"./icon-red-x-a5511f99.js";import"./icon-green-tick-1b766454.js";import"./proximax-logo-ecfc3767.js";import"./icon-new-page-link-270844f6.js";const Ke={name:"ViewAccountAliasAddressToNamespace",components:{PasswordInput:_e,SelectInputPluginClean:Ae,AccountComponent:Me,AddressInputClean:Ue,AccountTabs:We,TransactionFeeDisplay:Ve},props:{address:String},setup(s){const{t:i}=Ce(),T=l(()=>{if(!m.currentLoggedInWallet)return[];let t=m.currentLoggedInWallet.accounts.map(n=>({name:n.name,balance:n.balance,address:n.address,publicKey:n.publicKey,isMultisig:!!n.getDirectParentMultisig().length,multisigInfo:n.multisigInfo})),c=m.currentLoggedInWallet.others.filter(n=>n.type==="MULTISIG").map(n=>({name:n.name,balance:n.balance,address:n.address,publicKey:n.publicKey,isMultisig:!0,multisigInfo:n.multisigInfo}));return t.concat(c)}),e=l(()=>{if(!m.currentLoggedInWallet)return null;let t=m.currentLoggedInWallet.accounts.find(c=>c.address==s.address)||m.currentLoggedInWallet.others.find(c=>c.address==s.address);return t||null}),w=t=>T.value.find(c=>c.publicKey==t),F=d(!1);(()=>{e.value&&X.onPartial(K.PublicAccount.createFromPublicKey(e.value.publicKey,b.networkType)).then(t=>F.value=t).catch(t=>{F.value=!1})})();const B=l(()=>f.value==""),x=d(null),D=d(null),A=d(s.address),L=d(""),E=d(null),R=d(null),a=d(""),v=d(""),f=d(""),_=l(()=>{let t=!1;return m.currentLoggedInWallet&&(t=h.getMultisig(A.value)),t}),k=d(""),I=d(!0),j=d(!1),W=d(""),ne="^[^ ]{8,}$",oe="^[0-9A-Za-z]{40}$",re="^[0-9A-Za-z-]{46}$",O=l(()=>C.currentNetworkProfileConfig?M.convertToExact(C.currentNetworkProfileConfig.lockedFundsPerAggregate,b.nativeToken.divisibility):0),z=l(()=>C.currentNetworkProfile?M.convertToExact(Te.getLockFundFee(),b.nativeToken.divisibility):0);xe();const q=m.currentLoggedInWallet?m.currentLoggedInWallet.name:"";let ie=d("");const P=d(0),H=l(()=>{let t=b.nativeToken.divisibility;return _.value?t==0?Math.trunc(parseFloat(P.value)+O.value+z.value):Math.round((parseFloat(P.value)+O.value+z.value)*Math.pow(10,b.nativeToken.divisibility))/Math.pow(10,b.nativeToken.divisibility):P.value}),$=l(()=>e.value?e.value.balance:0),ce=l(()=>b.nativeToken.label),de=l(()=>b.nativeToken.divisibility),ue=l(()=>m.currentLoggedInWallet?M.toCurrencyFormat($.value,de.value):"0"),ee=l(()=>{var t=!1;return _.value?w(S.value)&&(w(S.value).balance<H.value?t=!0:t=!1):$.value<H.value&&(t=!0),t}),me=l(()=>!(F.value==!1&&ee.value==!1&&v.value.match(ne)&&f.value!=null&&k.value!=""&&a.value!=null&&I.value==!1)),ve=l(()=>{let t=[];return t.push({value:"Link",label:i("general.link")},{value:"Unlink",label:i("general.unlink")}),t}),fe=l(()=>{let t=[];return f.value!=null&&(t=h.namespaceOption(A.value,f.value)),t}),Z=l(()=>m.currentLoggedInWallet?h.getNamespaceListByAddress(A.value).length==0:null),U=l(()=>{if(C.currentNetworkProfileConfig){let t=X.getCosignerInWallet(e.value.publicKey?e.value.publicKey:""),c=[];return t.cosignerList.forEach(n=>{c.push({publicKey:n,name:w(n).name,balance:w(n).balance,address:w(n).address})}),t.cosignerList=c,t}else return{hasCosigner:!1,cosignerList:[]}}),S=d(U.value.cosignerList[0]?U.value.cosignerList[0].publicKey:"");V(U,t=>{t.cosignerList.length&&(S.value=t.cosignerList[0]?t.cosignerList[0].publicKey:"")},{deep:!0});const G=l(()=>e.value?X.getCosignerInWallet(e.value.publicKey).cosignerList.length>0:!1),ge=l(()=>G.value==!1&&_.value==!0||Z.value==!0||f.value=="Unlink"),pe=l(()=>G.value==!1&&_.value==!0||Z.value==!0);V(f,(t,c)=>{t!=c&&(k.value="",x.value.clear(),a.value=null,j.value=!1)}),V(a,t=>{const n=h.getNamespaceListByAddress(A.value).find(Q=>Q.name===a.value);if(f.value=="Unlink"&&t!=null)k.value=K.Address.createFromRawAddress(n.linkedId).pretty();else if(f.value=="Link"&&k.value!=""&&t!=null){let Q=K.Address.createFromRawAddress(k.value).plain();P.value=M.amountFormatterSimple(h.getLinkNamespaceToAddressTransactionFee(_.value,Q,a.value,f.value),b.nativeToken.divisibility)}});const be=l(()=>h.getContact());V(k,t=>{if(t.length==46&&t.match(re)||t.length==40&&t.match(oe))if(h.verifyAddress(A.value,k.value).isPassed==!1)W.value="Invalid Address",I.value=!0;else{let n=K.Address.createFromRawAddress(t).plain();P.value=M.amountFormatterSimple(h.getLinkNamespaceToAddressTransactionFee(_.value,n,a.value,f.value),b.nativeToken.divisibility),W.value="",I.value=!1}else I.value=!0});const ke=Le(),ye=()=>{if(!Fe.verifyWalletPassword(q,C.chainNetworkName,v.value))L.value=i("general.walletPasswordInvalid",{name:q}),v.value="";else{let t=m.currentLoggedInWallet.accounts.find(c=>c.address==s.address)?m.currentLoggedInWallet.accounts.find(c=>c.address==s.address):m.currentLoggedInWallet.others.find(c=>c.address==s.address);L.value="",ie.value=f.value,h.linkNamespaceToAddress(S.value,_.value,t,v.value,a.value,f.value,k.value),te(),ke.push({name:"ViewAccountPendingTransactions",params:{address:s.address}})}},te=()=>{j.value=!1,x.value.clear(),I.value=!1,v.value="",W.value="",L.value="",k.value=""},J=l(()=>b.networkType),he=l(()=>J.value==168&&C.chainNetworkName=="Sirius Testnet 1"?"https://bctestnetfaucet.xpxsirius.io/#/":J.value==168&&C.chainNetworkName=="Sirius Testnet 2"?"https://bctestnet2faucet.xpxsirius.io/#/":""),we=l(()=>{let t=w(S.value);return t?t.balance:0});return{currentNativeTokenName:ce,acc:e,walletState:m,clearInput:te,actionsOptions:ve,disableNamespace:pe,selectAction:f,walletPassword:v,disableCreate:me,noNamespace:Z,namespaceOptions:fe,selectNamespace:a,showContactSelection:j,isMultiSig:_,selectContactRef:E,selectContact:R,disableContactSelection:ge,namespaceAddress:k,lockFundTxFee:z,showAddressError:I,err:L,addressErrorMsg:W,trxFee:P,contact:be,walletName:q,selectNamespaceRef:x,selectActionRef:D,aliasAddressToNamespace:ye,isCosigner:G,lockFund:O,totalFee:H,onPartial:F,walletCosignerList:U,selectedCosignPublicKey:S,findAcc:w,fundStatus:ee,topUpUrl:he,networkType:J,disableSelectNamespace:B,checkCosignBalance:we,accountDisplayBalance:ue}}},Be={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},De={class:"border-2 border-t-0 filter shadow-lg lg:grid lg:grid-cols-3"},Ee={class:"lg:col-span-2 py-6 px-6"},Re={key:0,class:"text-left mt-2 mb-5"},je={key:0},Oe={class:"text-tsm"},ze={key:0,class:"font-bold"},qe={key:1,class:"font-bold"},He=["value"],Ze={key:1,class:"font-semibold"},Ge={key:2,class:"font-semibold"},Je={key:3,class:"error error_box mb-5"},Qe={class:"flex mt-3 gap-1"},Xe={class:"text-xxs text-blue-primary font-semibold uppercase"},Ye={key:1,class:"border rounded-md cursor-pointer flex flex-col justify-around p-2"},$e={class:"text-xxs text-gray-400 font-semibold uppercase"},et={key:4,class:"border"},tt={class:"text-xxs text-gray-300 font-semibold py-2 px-2 uppercase"},at=["onClick"],st={key:0,class:"text-xs py-2 bg-gray-100 pl-2 w-full"},lt={key:1,class:"text-xs py-2 pl-2 w-full"},nt={key:2,class:"ml-auto pr-2 text-xxs py-2 font-semibold text-blue-primary bg-gray-100 uppercase"},ot={key:3,class:"ml-auto mr-2 text-xxs py-2 font-semibold text-blue-primary uppercase"},rt={class:"bg-navy-primary p-6 lg:col-span-1"},it={class:"font-semibold text-xs text-white mb-1.5"},ct=g("div",{class:"mt-3"},null,-1),dt=["disabled"],ut=["disabled"],mt={class:"text-center"};function vt(s,i,T,e,w,F){const Y=N("AccountComponent"),B=N("AccountTabs"),x=N("SelectInputPluginClean"),D=N("AddressInputClean"),A=N("font-awesome-icon"),L=N("TransactionFeeDisplay"),E=N("PasswordInput"),R=N("router-link");return o(),r("div",null,[g("div",Be,[y(Y,{address:T.address,class:"mb-6"},null,8,["address"]),y(B,{address:T.address,selected:"details"},null,8,["address"]),g("div",De,[g("div",Ee,[e.isMultiSig?(o(),r("div",Re,[e.walletCosignerList.cosignerList.length>0?(o(),r("div",je,[g("div",Oe,[ae(u(s.$t("general.initiateBy"))+": ",1),e.walletCosignerList.length==1?(o(),r("span",ze,u(e.walletCosignerList.cosignerList[0].name),1)):(o(),r("span",qe,[Ie(g("select",{class:"","onUpdate:modelValue":i[0]||(i[0]=a=>e.selectedCosignPublicKey=a)},[(o(!0),r(se,null,le(e.walletCosignerList.cosignerList,(a,v)=>(o(),r("option",{value:e.findAcc(a.publicKey).publicKey,key:v},u(a.name),9,He))),128))],512),[[Pe,e.selectedCosignPublicKey]])]))])])):p("v-if",!0)])):p("v-if",!0),e.selectAction=="Link"?(o(),r("div",Ze,u(s.$t("general.linkToNamespace")),1)):p("v-if",!0),e.selectAction=="Unlink"?(o(),r("div",Ge,u(s.$t("namespace.manageNamespace")),1)):p("v-if",!0),e.err!=""?(o(),r("div",Je,u(e.err),1)):p("v-if",!0),y(x,{class:"my-3",placeholder:s.$t("namespace.selectAction"),modelValue:e.selectAction,"onUpdate:modelValue":i[1]||(i[1]=a=>e.selectAction=a),options:e.actionsOptions,ref:"selectActionRef",disabled:e.disableNamespace},null,8,["placeholder","modelValue","options","disabled"]),y(x,{placeholder:s.$t("namespace.selectNamespace"),ref:"selectNamespaceRef",modelValue:e.selectNamespace,"onUpdate:modelValue":i[2]||(i[2]=a=>e.selectNamespace=a),options:e.namespaceOptions,disabled:e.disableNamespace||e.disableSelectNamespace},null,8,["placeholder","modelValue","options","disabled"]),g("div",Qe,[y(D,{placeholder:s.$t("general.addAccAddress"),modelValue:e.namespaceAddress,"onUpdate:modelValue":i[3]||(i[3]=a=>e.namespaceAddress=a),errorMessage:e.addressErrorMsg,showError:e.showAddressError,disabled:e.disableNamespace||e.selectAction=="Unlink"||e.selectNamespace==null},null,8,["placeholder","modelValue","errorMessage","showError","disabled"]),e.selectNamespace!=null&&e.selectAction=="Link"?(o(),r("div",{key:0,onClick:i[4]||(i[4]=a=>e.showContactSelection=!e.showContactSelection),class:"border rounded-md cursor-pointer flex flex-col justify-around p-2"},[y(A,{icon:"id-card-alt",class:"text-blue-primary ml-auto mr-auto"}),g("div",Xe,u(s.$t("general.select")),1)])):(o(),r("div",Ye,[y(A,{icon:"id-card-alt",class:"text-gray-400 ml-auto mr-auto"}),g("div",$e,u(s.$t("general.select")),1)]))]),e.showContactSelection?(o(),r("div",et,[g("div",tt,u(s.$t("general.importFromAB")),1),(o(!0),r(se,null,le(e.contact,(a,v)=>(o(),r("div",{key:v,class:"cursor-pointer"},[g("div",{onClick:f=>{e.namespaceAddress=a.value,e.showContactSelection=!1},class:"flex justify-center"},[v%2==0?(o(),r("div",st,u(a.label),1)):p("v-if",!0),v%2==1?(o(),r("div",lt,u(a.label),1)):p("v-if",!0),v%2==0?(o(),r("div",nt,u(s.$t("general.select")),1)):p("v-if",!0),v%2==1?(o(),r("div",ot,u(s.$t("general.select")),1)):p("v-if",!0)],8,at)]))),128))])):p("v-if",!0)]),g("div",rt,[y(L,{"transaction-fee":Number(e.trxFee),"total-fee-formatted":String(e.totalFee),"get-multi-sig-cosigner":e.walletCosignerList,"check-cosign-balance":String(e.checkCosignBalance),"lock-fund-currency":e.lockFund,"lock-fund-tx-fee":e.lockFundTxFee,balance:e.accountDisplayBalance,"selected-acc-add":T.address,"no-namespace":e.noNamespace,"on-partial":e.onPartial,"is-cosigner":e.isCosigner,"fund-status":e.fundStatus},null,8,["transaction-fee","total-fee-formatted","get-multi-sig-cosigner","check-cosign-balance","lock-fund-currency","lock-fund-tx-fee","balance","selected-acc-add","no-namespace","on-partial","is-cosigner","fund-status"]),g("div",it,u(s.$t("general.enterPasswordContinue")),1),y(E,{placeholder:s.$t("general.enterPassword"),errorMessage:s.$t("general.passwordRequired"),modelValue:e.walletPassword,"onUpdate:modelValue":i[5]||(i[5]=a=>e.walletPassword=a),icon:"lock",disabled:e.disableNamespace},null,8,["placeholder","errorMessage","modelValue","disabled"]),ct,e.selectAction=="Link"?(o(),r("button",{key:0,class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:i[6]||(i[6]=(...a)=>e.aliasAddressToNamespace&&e.aliasAddressToNamespace(...a)),disabled:e.disableCreate},u(s.$t("general.linkToNamespace")),9,dt)):p("v-if",!0),e.selectAction=="Unlink"?(o(),r("button",{key:1,class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:i[7]||(i[7]=(...a)=>e.aliasAddressToNamespace&&e.aliasAddressToNamespace(...a)),disabled:e.disableCreate},u(s.$t("namespace.unlinkNamespace")),9,ut)):p("v-if",!0),g("div",mt,[y(R,{to:{name:"ViewAccountDetails",params:{address:T.address}},class:"content-center text-xs text-white underline"},{default:Se(()=>[ae(u(s.$t("general.cancel")),1)]),_:1},8,["to"])])])])])])}const Ft=Ne(Ke,[["render",vt],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/account/submodule/linkToNamespace/views/ViewAccountAliasAddressToNamespace.vue"]]);export{Ft as default};
