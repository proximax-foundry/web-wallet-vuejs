import{_ as X,a5 as xe,M as le,o as i,b as c,e as s,x as ne,t as o,O as oe,f as C,j,d as re,r as l,u as ie,c as y,z as W,F as Ne,g as ke,h as ce,l as $e,n as h,b3 as we,b4 as Te,H as m,B as d,S as Ce,a as V,i as se,m as T,v as Ie,G as Se}from"./index-3c3de18f.js";import{_ as Pe}from"./icon-info-8b4f1351.js";import{N as P}from"./namespaceUtils-4b7b444d.js";import{_ as Fe}from"./delete-8b454e7f.js";import{D as Ee}from"./DurationInputClean-3ce5b959.js";import{_ as Re,a as Ve,b as De,c as Ae}from"./TxnSummary.vue_vue_type_script_setup_true_lang-5a8ea51c.js";import{T as H}from"./transactionState-dba65b25.js";import"./jdenticon-module-05002873.js";import"./proximax-logo-ecfc3767.js";const Me={directives:{tooltip:xe},props:{placeholder:String,errorMessage:String,showError:Boolean,disabled:Boolean,modelValue:String,toolTip:String},emits:["update:modelValue"],name:"TextInputTooltip",data(){return{textErr:!1}}},Be={class:"border border-gray-200 px-2 py-1 h-14 rounded-md"},Le={class:"uppercase text-gray-500 text-txs text-left mb-2"},Ue={key:0,src:Pe,class:"inline-block ml-1 relative cursor-pointer",style:{top:"-1px"}},ze=["disabled","value"],Oe={class:"h-3 mb-2"},He={key:0,class:"error error-text text-left"};function je(a,_,u,F,D,x){const r=le("tooltip");return i(),c("div",{class:j(u.disabled?"opacity-50":"")},[s("div",Be,[s("div",Le,[ne(o(u.placeholder)+" ",1),u.toolTip?oe((i(),c("img",Ue,null,512)),[[r,{value:"<tiptext>"+u.toolTip+"</tiptext>",escape:!0},void 0,{bottom:!0}]]):C("",!0)]),s("input",{disabled:u.disabled,value:u.modelValue,onInput:_[0]||(_[0]=b=>a.$emit("update:modelValue",b.target.value)),type:"text",class:"text_input"},null,40,ze)]),s("div",Oe,[D.textErr||u.showError?(i(),c("div",He,o(u.errorMessage),1)):C("",!0)])],2)}const Ge=X(Me,[["render",je]]),Qe=re({emits:["select-namespace","update:modelValue","clear-namespace"],name:"SelectInputParentNamespace",props:["modelValue","action","address","disabled"],setup(a,{emit:_}){const u=l(!1);ce().appContext.config.globalProperties.emitter;const{t:D}=ie(),x=l(""),r=l(""),b=g=>{x.value=g.value,r.value=g.label,u.value=!u.value},n=()=>{x.value="",r.value=""},B=y(()=>{let g=[];g.push({value:"1",label:D("namespace.newRootNamespace"),level:0,disabled:!1});const k=P.listNamespaces(W.Address.createFromRawAddress(a.address).plain());return k.length>0&&g.push.apply(g,k),g});return{selectNamespace:b,namespaces:B,toggleSelection:u,selectedNamespace:x,selectedNamespaceLabel:r,selectNs:g=>{g.disabled||(b(g),_("update:modelValue",x.value),_("select-namespace",x.value))},clearLabel:n}}}),Ye={class:"flex"},qe={class:"flex flex-col ml-2 text-left"},Je={class:"text-blue-primary font-semibold text-xxs mb-1 uppercase",style:{"line-height":"9px"}},Ke={key:0,class:"mt-1 text-tsm font-bold"},We={key:1,class:"text-tsm font-bold"},Xe={key:0,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},Ze={key:1,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},ea={class:"relative"},aa={key:0,class:"absolute border border-t-0 w-full z-50 bg-white max-h-40 overflow-auto px-3 filter drop-shodow-xl"},ta={key:0,class:"uppercase pl-2 pt-4 text-xxs text-gray-400"},sa={key:1,class:"text-xxs pt-2 pl-2 pb-2"},la=["onClick"],na={key:0,class:"cursor-pointer text-blue-primary text-xxs mt-0.5 ml-auto font-semibold uppercase"},oa={key:1,class:"text-gray-300 text-xxs mt-0.5 ml-auto uppercase"},ra={key:2,class:"text-gray-500 text-xxs mt-0.5 ml-auto uppercase"};function ia(a,_,u,F,D,x){return i(),c("div",{class:j(["relative",a.disabled?"opacity-50":"cursor-pointer"])},[s("div",{onClick:_[1]||(_[1]=r=>a.disabled?"":a.toggleSelection=!a.toggleSelection),class:"border ml-auto mr-auto py-3 px-2 rounded-md w-full h-14"},[s("div",Ye,[s("div",qe,[s("div",Je,o(a.$t("general.namespace")),1),a.selectedNamespace!=""?(i(),c("div",Ke,o(a.selectedNamespaceLabel),1)):(i(),c("div",We,o(a.$t("namespace.selectNamespace")),1))]),!a.toggleSelection&&a.selectedNamespace==""?(i(),c("div",Xe,o(a.$t("general.select")),1)):C("",!0),!a.toggleSelection&&a.selectedNamespace!=""?(i(),c("div",Ze,o(a.$t("general.change")),1)):C("",!0),a.toggleSelection?(i(),c("img",{key:2,onClick:_[0]||(_[0]=r=>{a.selectedNamespace="",a.$emit("clear-namespace")}),src:Fe,class:"h-5 w-5 ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"})):C("",!0)])]),s("div",ea,[a.toggleSelection?(i(),c("div",aa,[a.namespaces.length>0?(i(),c("div",ta,o(a.$t("namespace.selectNamespace")),1)):(i(),c("div",sa,o(a.$t("general.listEmpty")),1)),(i(!0),c(Ne,null,ke(a.namespaces,(r,b)=>(i(),c("div",{key:b,class:j(["px-2 py-3 flex items-center",[b!=a.namespaces.length-1?"border-b border-gray-200":"",r.disabled?"cursor-text":"cursor-pointer"]]),onClick:n=>a.selectNs(r)},[s("div",{class:j(["text-xs truncate",r.disabled?"text-gray-300":"text-black font-semibold"])},o(r.label),3),r.label!=a.selectedNamespace&&!r.disabled?(i(),c("div",na,o(a.$t("general.select")),1)):r.disabled?(i(),c("div",oa,o(a.$t("general.disabled")),1)):(i(),c("div",ra,o(a.$t("general.current")),1))],10,la))),128))])):C("",!0)])],2)}const ca=X(Qe,[["render",ia]]),ua={class:"w-10/12 ml-auto mr-auto"},da={class:"border filter shadow-lg xl:grid xl:grid-cols-3 mt-8"},va={class:"xl:col-span-2 p-12"},ma={class:"font-semibold mb-4"},pa={key:0,class:"rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},fa={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},ba={class:"inline-block text-xs"},ga={key:1,class:"error error_box"},_a={class:"mt-4"},ha={class:"flex gap-1 mt-3"},ya={key:0,class:"mt-3"},xa={class:"lg:grid lg:grid-cols-2 mt-5"},Na={class:"mb-5 lg:mb-0 lg:mr-2"},ka={class:"mb-5 lg:mb-0 lg:ml-2"},$a={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},wa=["disabled"],Ta={class:"text-center"},Ca={class:"sm:grid sm:grid-cols-2 mt-10 lg:mt-16"},Ia={class:"mb-8 sm:pr-1"},Sa={href:"https://bcdocs.xpxsirius.io/docs/built-in-features/namespace/",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Pa={class:"text-gray-400 text-tsm my-3 sm:pr-2"},Fa={class:"mb-8"},Ea={href:"https://t.me/proximaxhelpdesk",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Ra={class:"text-gray-400 text-tsm my-3"},Va=re({__name:"ViewServicesNamespaceCreate",setup(a){const _=$e(),{t:u}=ie(),F=l(null),x=ce().appContext.config.globalProperties.emitter,r=l(!1),b=l(!1),n=l(""),B=l(!1),N=l("1"),g=l(""),k=l(u("namespace.validName"));l("");const E=l(!1),S=l(!1),Z=l(!1);l(!1);const ee=`^[0-9a-z]{2,${y(()=>h.currentNetworkProfileConfig?h.currentNetworkProfileConfig.maxNameSize:0).value}}$`,p=l(!1),R=y(()=>h.currentNetworkProfileConfig?Math.floor(we.configReturn(h.currentNetworkProfileConfig.maxNamespaceDuration,Te.DAY)):0),v=l(""),A=y(()=>v.value?v.value=="1"?Number(N.value)>0?m.convertToExact(h.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock*P.calculateDuration(Number(N.value)),d.nativeToken.divisibility):m.convertToExact(h.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock,d.nativeToken.divisibility):m.convertToExact(h.currentNetworkProfileConfig.childNamespaceRentalFee,d.nativeToken.divisibility):0),ue=y(()=>m.toCurrencyFormat(A.value,d.nativeToken.divisibility)),G=y(()=>h.currentNetworkProfileConfig?m.convertToExact(h.currentNetworkProfileConfig.lockedFundsPerAggregate,d.nativeToken.divisibility):0),Q=y(()=>h.currentNetworkProfile?m.convertToExact(Ce.getLockFundFee(),d.nativeToken.divisibility):0),de=y(()=>G.value+Q.value),ve=y(()=>!(n.value.match(ee)&&!B.value&&!ae.value&&!p.value&&v.value)),f=l(null),L=l(null),I=l(null),$=l(0),U=l(0),Y=async e=>{if(d.chainAPI&&e)try{const t=await d.chainAPI.accountAPI.getAccountInfo(W.Address.createFromRawAddress(e)),O=t.mosaics.findIndex(K=>K.id.toHex()==d.nativeToken.assetId);return O!=-1?t.mosaics[O].amount.compact()/Math.pow(10,d.nativeToken.divisibility):0}catch{return 0}},ae=y(()=>{if(I.value)return f.value?U.value<A.value?!0:$.value<w.value+de.value:$.value<A.value+w.value});$.value<A.value?(E.value=!0,Z.value=!0,S.value=!0,r.value=!0,b.value=!0):(E.value=!1,Z.value=!1,S.value=!1,r.value=!1,b.value=!1);const z=l(0),w=l(0),me=()=>{v.value=""},pe=e=>{let t=0;e=="1"?(N.value="1",S.value=!1,n.value.trim().length>0&&!p.value&&(t=P.getRootNamespaceTransactionFee(n.value),z.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),w.value=m.convertToExact(t,d.nativeToken.divisibility))):(N.value="0",S.value=!0,n.value.trim().length>0&&!p.value&&(t=P.getSubNamespaceTransactionFee(e,n.value),z.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),w.value=m.convertToExact(t,d.nativeToken.divisibility)))};V(v,e=>{e?(r.value=!1,S.value=!1,E.value=!1):(r.value=!0,S.value=!0,E.value=!0)},{immediate:!0});const fe=()=>{let e=d.buildTxn;if(v.value==="1"){let t=e.registerRootNamespace(n.value,W.UInt64.fromUint(P.calculateDuration(Number(N.value)))).serialize();H.unsignedTransactionPayload=t}else{let t=e.registersubNamespace(v.value,n.value).serialize();H.unsignedTransactionPayload=t}H.selectedAddress=I.value,H.selectedMultisigAddress=f.value,_.push({name:"ViewConfirmTransaction"})};V(N,e=>{parseInt(e)>R.value&&(N.value=`${R.value}`)});const q=()=>{N.value="1"},te=y(()=>{if(f.value){let e=[G.value,Q.value,w.value];return m.safeSum(e)}else return A.value+w.value});V(te,e=>{$.value<e?(E.value=!0,b.value=!0):(E.value=!1,b.value=!1)});const be=y(()=>h.currentNetworkProfileConfig?h.currentNetworkProfileConfig.reservedRootNamespaceNames.split(",").map(e=>e.trim()):[]),ge=()=>v.value==="1"&&be.value.includes(n.value.trim())?(p.value=!0,k.value=u("namespace.reservedName"),!0):!1,_e=async()=>{if(v.value==="1"&&n.value.trim())try{let e=await Se.getNamespaceInfo(m.createNamespaceId(n.value));if(f.value){if(e.owner.address.plain()!==f.value)return p.value=!0,k.value=u("namespace.nameRegistered"),!0}else if(e.owner.address.plain()!==I.value)return p.value=!0,k.value=u("namespace.nameRegistered"),!0}catch{return!1}return!1},he=async()=>{if(n.value.trim()){if(ge())return;if(p.value=!n.value.match(ee),p.value)k.value=u("namespace.validName");else{if(await _e())return;let t=0;v.value=="1"?n.value.trim().length>0&&!p.value&&(t=P.getRootNamespaceTransactionFee(n.value),z.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),w.value=m.convertToExact(t,d.nativeToken.divisibility)):n.value.trim().length>0&&!p.value&&(t=P.getSubNamespaceTransactionFee(n.value,v.value),z.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),w.value=m.convertToExact(t,d.nativeToken.divisibility))}}},J=()=>{n.value="",v.value="",F.value.clearLabel(),p.value=!1,q(),L.value=null,f.value=null};return V(I,async(e,t)=>{e==null?($.value=0,J()):e!=t&&(J(),$.value=await Y(e))}),V(f,async(e,t)=>{e==null?(U.value=0,J(),$.value=await Y(I.value)):e!=t&&(v.value="",n.value="",F.value.clearLabel(),p.value=!1,q(),U.value=await Y(e))}),V(n,e=>{v.value===""?(p.value=!1,k.value=""):e.length==0&&(p.value=!0,k.value=u("namespace.validName"))}),x.on("select-account",e=>{I.value=e}),x.on("select-multisig-account",e=>{L.value=e.label,f.value=e.value}),x.on("CLOSE_MULTISIG",()=>{L.value=null,f.value=null}),(e,t)=>{const O=se("font-awesome-icon"),K=se("router-link"),ye=le("debounce");return i(),c("div",null,[s("div",ua,[s("div",da,[s("div",va,[s("div",ma,o(e.$t("general.createNamespace")),1),ae.value?(i(),c("div",pa,[s("div",fa,[T(O,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),s("div",ba,o(e.$t("general.insufficientBalance")),1)])):C("",!0),g.value!=""?(i(),c("div",ga,o(g.value),1)):C("",!0),s("div",_a,[s("div",ha,[T(Re,{type:"namespace"}),T(Ve,{"selected-address":I.value},null,8,["selected-address"])]),f.value?(i(),c("div",ya,[T(De,{"select-default-address":f.value,"select-default-name":L.value,type:"namespace"},null,8,["select-default-address","select-default-name"])])):C("",!0),T(ca,{onSelectNamespace:pe,onClearNamespace:me,ref_key:"nsRef",ref:F,modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=M=>v.value=M),address:f.value?f.value:I.value,class:"mt-5",disabled:b.value},null,8,["modelValue","address","disabled"]),s("div",xa,[s("div",Na,[oe(T(Ge,{disabled:r.value,placeholder:e.$t("general.name"),errorMessage:k.value,modelValue:n.value,"onUpdate:modelValue":t[1]||(t[1]=M=>n.value=M),icon:"id-card-alt",showError:p.value,class:"w-full inline-block",toolTip:e.$t("namespace.namespaceNameMsg1")+"<br><br>"+e.$t("namespace.namespaceNameMsg2")+"<br><br>"+e.$t("namespace.namespaceNameMsg3"),tabindex:"0"},null,8,["disabled","placeholder","errorMessage","modelValue","showError","toolTip"]),[[ye,he,"1000"]])]),s("div",ka,[T(Ee,{disabled:S.value,modelValue:N.value,"onUpdate:modelValue":t[2]||(t[2]=M=>N.value=M),max:R.value,placeholder:e.$t("namespace.duration"),onSetDefaultDuration:q,showError:B.value,toolTip:e.$t("namespace.durationMsg")+`<br>${R.value===365?"1 "+e.$t("general.year"):""} (${R.value}`+e.$t("general.day",R.value)+")."},null,8,["disabled","modelValue","max","placeholder","showError","toolTip"])])])])]),s("div",$a,[T(Ae,{"signer-native-token-balance":$.value,"namespace-rental-fee-currency":ue.value,"native-token-balance":f.value?U.value:$.value,"lock-fund":G.value,"lock-fund-tx-fee":Q.value,"selected-multisig-address":f.value,"txn-fee":w.value,"total-fee":te.value},null,8,["signer-native-token-balance","namespace-rental-fee-currency","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee"]),s("button",{type:"submit",class:"mt-3 w-full blue-btn py-4 disabled:opacity-50 disabled:cursor-auto text-white",disabled:ve.value,onClick:fe},o(e.$t("namespace.registerNamespace")),9,wa),s("div",Ta,[T(K,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white border-b-2 border-white"},{default:Ie(()=>[ne(o(e.$t("general.cancel")),1)]),_:1})])])]),s("div",Ca,[s("div",Ia,[s("a",Sa,o(e.$t("general.namespaceQues")),1),s("div",Pa,o(e.$t("namespace.namespaceAns")),1)]),s("div",Fa,[s("a",Ea,o(e.$t("general.feedback")),1),s("div",Ra,o(e.$t("general.feedbackDescription")),1)])])])])}}});const Ga=X(Va,[["__scopeId","data-v-d3d23bb1"]]);export{Ga as default};
