import{d as S}from"./tsjs-xpx-chain-sdk-84426b6a.js";import"./vue-86063517.js";import{T as te}from"./TextInputClean-e28e968a.js";import{u as oe}from"./vue-router-21fffbbf.js";import{u as re}from"./primevue-35724b2c.js";import{A as ae}from"./addressBookUtils-0d3294bf.js";import{w as n,H as U,W as se,A as E,_ as le}from"./index-71c561bd.js";import{u as ie}from"./vue-i18n-728f748b.js";import{S as ne}from"./SelectInputPluginClean-49282494.js";import{A as de,_ as ce}from"./icon-save-3ec0aac9.js";import{r,c as k,x as me,w as N,u as ue,B as P,o as _,z as I,A as b,a as g,m as W,l as V,g as u,e as F}from"./@vue-a9ecc9f1.js";import"./@js-joda-d98eb16f.js";import"./rxjs-1250b26d.js";import"./tslib-8dbab242.js";import"./@noble-f8eff84a.js";import"./js-sha3-d7d4f583.js";import"./node-stdlib-browser-23a8bc7f.js";import"./buffer-6d367910.js";import"./base64-js-50a5cdf9.js";import"./ieee754-44f7831e.js";import"./process-2209b2b3.js";import"./utf8-c941a4a0.js";import"./bip39-936aefa9.js";import"./axios-b48d2c29.js";import"./flatbuffers-edc4f8d7.js";import"./ws-0a714537.js";import"./crypto-js-e64ac54c.js";import"./crypto-browserify-4fd8cccd.js";import"./randombytes-685e9383.js";import"./safe-buffer-c463177b.js";import"./create-hash-92c04a28.js";import"./inherits-804453d8.js";import"./md5.js-8d474739.js";import"./hash-base-bb85fc42.js";import"./readable-stream-2241ee9e.js";import"./events-86ccc6d8.js";import"./util-06f7ff32.js";import"./is-arguments-86164331.js";import"./has-tostringtag-7c6352d6.js";import"./has-symbols-cd7870b9.js";import"./call-bind-9e7f09da.js";import"./get-intrinsic-f35014ba.js";import"./has-proto-8ede3a55.js";import"./function-bind-68631a08.js";import"./has-ab8e2922.js";import"./is-generator-function-06dfaf9d.js";import"./which-typed-array-cf6b6a29.js";import"./for-each-f57c5052.js";import"./is-callable-7492318c.js";import"./available-typed-arrays-61974ec7.js";import"./gopd-bab4d6bd.js";import"./is-typed-array-037eef20.js";import"./util-deprecate-c3aabb3c.js";import"./string_decoder-ef7b01fe.js";import"./ripemd160-58dcfa02.js";import"./sha.js-cea3da2e.js";import"./cipher-base-aee0e03d.js";import"./stream-browserify-7496a08f.js";import"./create-hmac-e8b5ea4a.js";import"./browserify-sign-a708a95f.js";import"./browserify-rsa-bfbdcbb6.js";import"./bn.js-1ae23332.js";import"./elliptic-75e883ee.js";import"./minimalistic-assert-4cc49674.js";import"./minimalistic-crypto-utils-6f869a51.js";import"./brorand-03f0f79d.js";import"./hash.js-4f5dfe73.js";import"./hmac-drbg-87799258.js";import"./parse-asn1-465c125b.js";import"./asn1.js-405e93e4.js";import"./safer-buffer-2ac6237e.js";import"./evp_bytestokey-e91543fa.js";import"./browserify-aes-ce20a0e6.js";import"./buffer-xor-87a7236a.js";import"./pbkdf2-e2ae8643.js";import"./browserify-cipher-c4c37ca3.js";import"./browserify-des-3f7e64d9.js";import"./des.js-d262604a.js";import"./diffie-hellman-c8260aab.js";import"./miller-rabin-de27bf02.js";import"./create-ecdh-ffe720e9.js";import"./public-encrypt-fc0568a2.js";import"./randomfill-2874e5f1.js";import"./mathjs-2a513dae.js";import"./@babel-484168fe.js";import"./typed-function-4896e4f1.js";import"./decimal.js-d133ee8e.js";import"./complex.js-cf2520e8.js";import"./fraction.js-39e7906a.js";import"./javascript-natural-sort-c4dd0c27.js";import"./escape-latex-c8a96e7a.js";import"./seedrandom-c8f991ad.js";import"./tiny-emitter-56d49cfd.js";import"./crypto-random-string-d158262e.js";import"./jose-92e5544c.js";import"./vue-loading-overlay-b89251b1.js";import"./jspdf-30014160.js";import"./fflate-8981c52c.js";import"./vue-debounce-3bbbf8c6.js";import"./mitt-f7ef348c.js";/* empty css                   */import"./maska-6f10db43.js";import"./@fortawesome-014b81f2.js";import"./vue3-blocks-tree-e53499e3.js";import"./@intlify-16888cd3.js";import"./@vueform-4d3340af.js";const pe={name:"ViewServicesAddressBookEditContact",components:{TextInputClean:te,SelectInputPluginClean:ne,AddCustomGroupModal:de},props:{contactAddress:String,contactPublicKey:String},setup(o){const K=ue().appContext.config.globalProperties.emitter,t=r(null),{t:a}=ie(),D=re(),p=r(""),v=r(!0),C=r(""),M=oe(),d=r("");var w=null;n.currentLoggedInWallet&&(w=n.currentLoggedInWallet.contacts.find(e=>U.createAddress(e.address).pretty()==o.contactAddress));const f=r(w?w.name:""),s=r(o.contactAddress),l=r(""),A=r("");l.value=s.value;const T=r(!1),L=r(!1);o.contactPublicKey=="true"&&(T.value=!0);const q=k(()=>s.value.length==64),O=r([]);n.currentLoggedInWallet&&n.currentLoggedInWallet.contacts.forEach(e=>{O.value.push(e.group)}),me(()=>{t.value.select(w?w.group:[])});function j(e,i,y){return y.indexOf(e)===i}var B=[a("addressBook.work"),a("addressBook.friend"),a("addressBook.family"),a("addressBook.employee"),a("addressBook.director")].concat(O.value).filter(j);B=B.filter(e=>e!="-none-"),B.sort();const h=r([]);h.value.push({value:"-none-",label:" - "}),B.forEach(e=>{h.value.push({value:e,label:e})}),h.value.push({value:"Custom",label:a("addressBook.custom")});const H=k(()=>h.value),z=k(()=>!(v.value&&f.value!="")),J=k(()=>!v.value&&l.value!=""),Q=k(()=>l.value!=""&&f.value==""||s.value!=""&&f.value==""),X=k(()=>{let e=a("general.invalidInput");return C.value?C.value:e});N(s,()=>{if(n.currentLoggedInWallet)if(s.value.length<=63||s.value.length>=65){l.value=s.value;const e=n.currentLoggedInWallet.accounts.find(y=>y.default==!0),i=ae.verifyNetworkAddress(e.address,l.value);v.value=i.isPassed,C.value=i.errMessage,R()}else s.value.length==64&&(v.value=!0,l.value=se.createAddressFromPublicKey(s.value,E.networkType).plain())});const x=r(!1);N(d,e=>{e=="Custom"&&(x.value=!0)});const G=async e=>{try{let i=await E.chainAPI.accountAPI.getAccountInfo(S.Address.createFromRawAddress(e));i.publicKey=="0000000000000000000000000000000000000000000000000000000000000000"?(A.value=null,L.value=!0):(A.value=i.publicKey,L.value=!0)}catch{A.value=null,L.value=!0}},Y=async()=>{const e=n.currentLoggedInWallet;if(!e)return;s.value.length==64?A.value=s.value:await G(l.value);const i=n.currentLoggedInWallet.contacts.findIndex(m=>U.createAddress(m.address).pretty()==o.contactAddress);let y=e.contacts.filter(m=>m.name.toLowerCase()!=w.name.toLowerCase().trim()),Z=y.find(m=>m.name.toLowerCase()==f.value.toLowerCase().trim()),$=e.accounts.find(m=>m.name.toLowerCase()==f.value.toLowerCase().trim()),ee=y.find(m=>S.Address.createFromRawAddress(m.address).plain()==S.Address.createFromRawAddress(l.value).plain());Z!=null||$!=null?p.value=a("addressBook.nameExist"):ee!=null?p.value=a("addressBook.addressExist"):(n.currentLoggedInWallet.updateAddressBook(i,{name:f.value.trim(),address:S.Address.createFromRawAddress(l.value).plain(),group:d.value,publicKey:A.value}),n.wallets.saveMyWalletOnlytoLocalStorage(n.currentLoggedInWallet),D.add({severity:"info",summary:a("general.addressBook"),detail:a("addressBook.contactUpdated"),group:"br-custom",life:5e3}),M.push({name:"ViewServicesAddressBook"}))};K.on("CLOSE_ADDCUSTOMGROUP_PANEL",()=>{x.value=!1}),K.on("ADD_CUSTOM_GROUP",e=>{h.value.push({value:e,label:e}),t.value&&t.value.select(e),x.value=!1});const R=()=>{if(E.isReady)G(l.value);else{let e=N(E,i=>{i.isReady&&(G(l.value),e())})}};return R(),{err:p,addErr:X,contactName:f,address:l,addressOrPk:s,disableSave:z,showAddErr:J,showNameErr:Q,SaveContact:Y,selectContactGroups:d,contactGroups:H,isDisplayAddCustomPanel:x,selectGroupDropdown:t,existingPublicKey:T,publicKey:A,isLoaded:L,newPublicKey:q}}},ve={class:"w-9/12 ml-auto mr-auto mt-5"},fe={class:"flex text-xs font-semibold border-b-2 menu_title_div"},ge={class:"border border-gray-100 p-5 filter drop-shadow-xl mt-10 bg-white"},be={class:"text-md mb-5 font-semibold"},we={key:0,class:"error error_box mb-5"},Ae={class:"mt-2 py-3 text-center px-0 flex"},ye=["disabled"],ke=b("img",{src:ce,class:"inline-block mr-2"},null,-1),Ce={key:1},he={key:0,class:"px-3 py-2 mt-1 bg-red-300"},_e={key:1,class:"px-3 py-2 mt-1 bg-green-100"};function Ie(o,c,K,t,a,D){const p=P("router-link"),v=P("TextInputClean"),C=P("SelectInputPluginClean"),M=P("AddCustomGroupModal");return _(),I("div",null,[b("div",ve,[b("div",fe,[g(p,{to:{name:"ViewServicesAddressBook"},class:"w-18 text-center border-b pb-3"},{default:W(()=>[V(u(o.$t("general.list")),1)]),_:1}),g(p,{to:{name:"ViewServicesAddressBookImport"},class:"w-18 text-center border-b pb-3"},{default:W(()=>[V(u(o.$t("general.import")),1)]),_:1}),g(p,{to:{name:"ViewServicesAddressBookExport"},class:"w-18 text-center border-b pb-3"},{default:W(()=>[V(u(o.$t("general.export")),1)]),_:1})]),b("div",ge,[b("div",be,u(o.$t("addressBook.editContact")),1),t.err!=""?(_(),I("div",we,u(t.err),1)):F("v-if",!0),b("div",Ae,[g(v,{placeholder:o.$t("general.name"),errorMessage:o.$t("general.nameRequired"),modelValue:t.contactName,"onUpdate:modelValue":c[0]||(c[0]=d=>t.contactName=d),icon:"id-card-alt",showError:t.showNameErr,class:"w-52 inline-block mr-2"},null,8,["placeholder","errorMessage","modelValue","showError"]),g(v,{placeholder:o.$t("general.address"),errorMessage:t.addErr,modelValue:t.addressOrPk,"onUpdate:modelValue":c[1]||(c[1]=d=>t.addressOrPk=d),icon:"wallet",showError:t.showAddErr,class:"w-96 inline-block mr-2"},null,8,["placeholder","errorMessage","modelValue","showError"]),g(C,{modelValue:t.selectContactGroups,"onUpdate:modelValue":c[2]||(c[2]=d=>t.selectContactGroups=d),placeholder:"Group",options:t.contactGroups,selectDefault:"-none-",ref:"selectGroupDropdown",class:"w-60 inline-block mr-2"},null,8,["modelValue","options"]),b("button",{type:"submit",class:"default-btn py-1 disabled:opacity-50 h-12 flex items-center",disabled:t.disableSave,onClick:c[3]||(c[3]=d=>t.SaveContact())},[ke,V(u(o.$t("addressBook.saveAddress")),1)],8,ye)]),!t.existingPublicKey&&!t.showAddErr&&!t.newPublicKey?(_(),I("div",Ce,[!t.publicKey&&t.isLoaded?(_(),I("div",he,u(o.$t("general.publicKeyNotAvailable")),1)):(_(),I("div",_e,u(o.$t("general.publicKeyAvailable")),1))])):F("v-if",!0)])]),g(M,{toggleModal:t.isDisplayAddCustomPanel,groups:t.contactGroups},null,8,["toggleModal","groups"])])}const Bo=le(pe,[["render",Ie],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/services/submodule/addressbook/views/ViewServicesAddressBookEditContact.vue"]]);export{Bo as default};
