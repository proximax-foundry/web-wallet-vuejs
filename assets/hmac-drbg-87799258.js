import{r as l}from"./hash.js-4f5dfe73.js";import{r as f}from"./minimalistic-crypto-utils-6f869a51.js";import{r as y}from"./minimalistic-assert-4cc49674.js";var u,p;function V(){if(p)return u;p=1;var m=l(),n=f(),o=y();function h(i){if(!(this instanceof h))return new h(i);this.hash=i.hash,this.predResist=!!i.predResist,this.outLen=this.hash.outSize,this.minEntropy=i.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=n.toArray(i.entropy,i.entropyEnc||"hex"),e=n.toArray(i.nonce,i.nonceEnc||"hex"),r=n.toArray(i.pers,i.persEnc||"hex");o(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,e,r)}return u=h,h.prototype._init=function(t,e,r){var a=t.concat(e).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(a),this._reseed=1,this.reseedInterval=281474976710656},h.prototype._hmac=function(){return new m.hmac(this.hash,this.K)},h.prototype._update=function(t){var e=this._hmac().update(this.V).update([0]);t&&(e=e.update(t)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())},h.prototype.reseed=function(t,e,r,a){typeof e!="string"&&(a=r,r=e,e=null),t=n.toArray(t,e),r=n.toArray(r,a),o(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(r||[])),this._reseed=1},h.prototype.generate=function(t,e,r,a){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof e!="string"&&(a=r,r=e,e=null),r&&(r=n.toArray(r,a||"hex"),this._update(r));for(var s=[];s.length<t;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var c=s.slice(0,t);return this._update(r),this._reseed++,n.encode(c,e)},u}export{V as r};
