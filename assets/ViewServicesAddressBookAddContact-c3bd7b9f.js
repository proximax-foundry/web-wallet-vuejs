import{d as z,r as d,c as f,u as j,A as Z,l as H,a as I,i as V,o as L,b as $,e as l,m,v as A,x as h,t as u,f as G,O as J,R as Q,F as X,z as E,aW as Y,w as p,W as ee,B as N}from"./index-d5b7a9f4.js";import{_ as ae}from"./icon-save-307f50b1.js";import{T as W}from"./TextInputClean-d00e68ae.js";import{A as te}from"./addressBookUtils-0d3294bf.js";const oe={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},se={class:"flex text-xs font-semibold border-b-2 menu_title_div"},le={class:"border border-gray-100 p-5 filter drop-shadow-xl mt-10 bg-white"},re={class:"text-md mb-5 font-semibold"},de={key:0,class:"error error_box mb-5"},ne={class:"py-3 px-0 flex flex-wrap items-center gap-2 flex-grow"},ue=["disabled"],ie=l("img",{src:ae,class:"mr-2"},null,-1),ce={class:"flex flex-col justify-center items-center"},ve={class:"mt-2 text-xs font-semibold"},me={key:0,class:"error error_box mb-3"},pe=["placeholder"],fe=["disabled"],be="^[0-9A-Za-z]{1,}$",Ae=z({__name:"ViewServicesAddressBookAddContact",setup(ge){const i=d(""),M=f(()=>!i.value.match(be)),{t:o}=j(),P=Z(),n=d(""),v=d(""),r=d(""),b=d(""),c=d(""),y=d(!1),B=d(""),D=H(),g=d({value:"-none-",label:" - "}),w=d([o("addressBook.work"),o("addressBook.friend"),o("addressBook.family"),o("addressBook.employee"),o("addressBook.director")]),S=f(()=>[{value:"-none-",label:" - "},{value:"Custom",label:o("addressBook.custom")}].concat(w.value.map(e=>({value:e,label:e})))),R=f(()=>!(y.value&&n.value!="")),U=f(()=>!y.value&&v.value!=""),F=f(()=>v.value!=""&&n.value==""||r.value!=""&&n.value==""),T=f(()=>{let e=o("general.invalidInput");return B.value?B.value:e});I(r,()=>{if(p.currentLoggedInWallet)if(r.value.length<=63||r.value.length>=65){v.value=r.value;const e=p.currentLoggedInWallet.accounts.find(t=>t.default==!0),a=te.verifyNetworkAddress(e.address,v.value);y.value=a.isPassed,B.value=a.errMessage}else r.value.length==64&&(y.value=!0,v.value=ee.createAddressFromPublicKey(r.value,N.networkType).plain())});const k=d(!1);I(g,e=>{e.value=="Custom"&&(k.value=!0)});const K=async e=>{try{let a=await N.chainAPI.accountAPI.getAccountInfo(E.Address.createFromRawAddress(e));a.publicKey=="0000000000000000000000000000000000000000000000000000000000000000"?b.value=null:b.value=a.publicKey}catch{b.value=null}},O=async()=>{if(n.value==" "){c.value=o("general.nameRequired");return}r.value.length==64?b.value=r.value:await K(v.value);const e=E.Address.createFromRawAddress(v.value);let a=new Y(n.value.trim(),e.plain(),g.value.value,b.value);const t=p.currentLoggedInWallet,C=t.accounts.findIndex(x=>x.name.toLowerCase()==n.value.toLowerCase().trim()),_=t.contacts!=null?t.contacts.findIndex(x=>E.Address.createFromRawAddress(x.address).plain()==e.plain()):-1,s=t.contacts!=null?t.contacts.findIndex(x=>x.name.toLowerCase()==n.value.toLowerCase().trim()):-1;_>=0?c.value=o("addressBook.addressExist"):s>=0||C>=0?c.value=o("addressBook.nameExist"):(p.currentLoggedInWallet.addAddressBook(a),p.wallets.saveMyWalletOnlytoLocalStorage(p.currentLoggedInWallet),c.value="",n.value="",r.value="",P.add({severity:"info",summary:o("general.addressBook"),detail:o("addressBook.newContactAdded"),group:"br-custom",life:5e3}),D.push({name:"ViewServicesAddressBook"}))},q=()=>{S.value.find(({value:e})=>e.toLowerCase()===i.value.toLowerCase())||w.value.includes(i.value.toLowerCase())?c.value=o("addressBook.groupValidation"):(w.value.push(i.value),g.value={value:i.value,label:i.value},k.value=!1,i.value="")};return I(()=>p.currentLoggedInWallet,e=>{if(e){const a=[...new Set(e.contacts.map(t=>t.group))].filter(t=>t!="-none-");w.value=w.value.concat(a)}},{immediate:!0}),(e,a)=>{const t=V("router-link"),C=V("Dropdown"),_=V("Dialog");return L(),$(X,null,[l("div",null,[l("div",oe,[l("div",se,[m(t,{to:{name:"ViewServicesAddressBook"},class:"w-18 text-center border-b pb-3"},{default:A(()=>[h(u(e.$t("general.list")),1)]),_:1}),m(t,{to:{name:"ViewServicesAddressBookImport"},class:"w-18 text-center border-b pb-3"},{default:A(()=>[h(u(e.$t("general.import")),1)]),_:1}),m(t,{to:{name:"ViewServicesAddressBookExport"},class:"w-18 text-center border-b pb-3"},{default:A(()=>[h(u(e.$t("general.export")),1)]),_:1})]),l("div",le,[l("div",re,u(e.$t("addressBook.addNewContact")),1),c.value!=""?(L(),$("div",de,u(c.value),1)):G("",!0),l("div",ne,[m(W,{placeholder:e.$t("general.name"),errorMessage:e.$t("general.nameRequired"),modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=s=>n.value=s),icon:"id-card-alt",showError:F.value},null,8,["placeholder","errorMessage","modelValue","showError"]),m(W,{placeholder:e.$t("multisig.addressOrPk"),errorMessage:T.value,modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=s=>r.value=s),icon:"wallet",showError:U.value},null,8,["placeholder","errorMessage","modelValue","showError"]),m(C,{modelValue:g.value,"onUpdate:modelValue":a[2]||(a[2]=s=>g.value=s),options:S.value,"option-label":"label",placeholder:"Group "},null,8,["modelValue","options"]),l("button",{type:"submit",class:"bg-blue-primary text-white px-2 rounded-lg py-2 font-semibold disabled:opacity-50 flex items-center",disabled:R.value,onClick:a[3]||(a[3]=s=>O())},[ie,h(u(e.$t("addressBook.saveAddress")),1)],8,ue)])])])]),m(_,{visible:k.value,"onUpdate:visible":a[6]||(a[6]=s=>k.value=s),modal:"",draggable:!1,dismissableMask:!0,closable:!1,class:"w-96"},{default:A(()=>[l("div",ce,[l("div",ve,u(e.$t("addressBook.addCustomGroup")),1),c.value!=""?(L(),$("div",me,u(c.value),1)):G("",!0),J(l("input",{type:"text","onUpdate:modelValue":a[4]||(a[4]=s=>i.value=s),placeholder:e.$t("addressBook.customGroup"),class:"border border-gray-300 p-3 my-5 text-tsm text-center focus:outline-none"},null,8,pe),[[Q,i.value]]),l("button",{class:"rounded-md cursor-pointer text-xs text-white py-2 text-center ml-auto mr-auto btn-default bg-blue-primary w-14 mb-2 disabled:opacity-50",onClick:q,disabled:M.value},u(e.$t("general.add")),9,fe),l("div",{class:"text-center cursor-pointer font-semibold text-xs text-gray-500 mt-2",onClick:a[5]||(a[5]=s=>k.value=!1)},u(e.$t("general.cancel")),1)])]),_:1},8,["visible"])],64)}}});export{Ae as default};
