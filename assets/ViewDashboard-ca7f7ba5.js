import{d as ue,o as v,f as y,l as m,b,s as Q,t as o,v as D,e as s,H as d,_ as B,g as l,i as h,T as Re,F as Le,j as $e,y as Fe,c as u,A as g,x as N,n as M,w as f,z as Qe,B as Ee,D as Ke,r as We,a as Be,h as oe,E as Oe,W as F,G as W}from"./index-bab83e60.js";import{_ as je}from"./icon-xpx-072deeab.js";import{_ as Ve}from"./PendingDataTable.vue_vue_type_script_setup_true_lang-69ec750c.js";import{M as Ue,T as ze}from"./MixedTxnDataTable-0a3f5213.js";import{s as ie,a as Ge}from"./column.esm-8743909d.js";import{c as He}from"./functions-b0c67f6e.js";import{D as ce}from"./dashboardService-39c523f8.js";import{q as qe}from"./qrcode-b891d35a.js";import"./icon-message-e27d55b6.js";import"./icon-proximax-logo-gray-c2486ce1.js";import"./PasswordInput.vue_vue_type_script_setup_true_lang-4b78936e.js";const Je="/web-wallet-vuejs/assets/icon-blue-chevron-right-cc98de93.svg",Xe="/web-wallet-vuejs/assets/icon-copy-82348b96.svg",Ye="/web-wallet-vuejs/assets/icon-balance-white-7304021e.svg",Ze="/web-wallet-vuejs/assets/icon-transfer-white-341a4c30.svg",et="/web-wallet-vuejs/assets/icon-swap-white-2516ece4.svg",tt={class:"uppercase font-semibold text-xs"},st={class:"uppercase font-semibold text-xs"},at=ue({__name:"DashboardAssetDataTable",props:{assets:Array},setup(k){return(i,A)=>(v(),y("div",null,[m(D(Ge),{value:k.assets,paginator:!0,rows:10,dataKey:"id",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink  RowsPerPageDropdown",rowsPerPageOptions:[10,20,30,40,50],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",responsiveLayout:"scroll"},{empty:b(()=>[Q(o(i.$t("general.noRecord")),1)]),loading:b(()=>[Q(o(i.$t("dashboard.fetchingTx")),1)]),default:b(()=>[m(D(ie),{field:"assetId",header:i.$t("general.assetId"),style:{"`wideScreen?'min-width":"200px'?'width: 200px'  `"}},{body:b(({data:c})=>[s("span",tt,o(c.namespaceNames[0]?c.namespaceNames[0]:c.idHex),1)]),_:1},8,["header"]),m(D(ie),{field:"amount",header:i.$t("general.amount"),style:{"`wideScreen?'min-width":"180px'?'width: 180px'`"}},{body:b(({data:c})=>[s("span",st,o(D(d).toCurrencyFormat(c.amount,c.divisibility)),1)]),_:1},8,["header"])]),_:1},8,["value"])]))}});const nt=B(at,[["__scopeId","data-v-2bb36a97"]]),rt="/web-wallet-vuejs/assets/icon-qr_code-9cdfb652.svg",lt={name:"AddressQRModal",props:{accountAddressQR:String,notIncludeWord:Boolean},setup(k){return{toggleModal:l(!1)}}},ot={key:0,class:"text-xs font-bold",style:{"margin-top":"1px"}},it={key:0,class:"popup-outer-lang fixed flex z-50"},ct={class:"modal-popup-box"},ut={class:"flex justify-center"},dt=["src"];function pt(k,i,A,c,E,x){return v(),y(Le,null,[s("div",{class:"my-2 flex items-center cursor-pointer",onClick:i[0]||(i[0]=R=>c.toggleModal=!c.toggleModal)},[i[3]||(i[3]=s("img",{src:rt,class:"w-4 h-4 cursor-pointer mr-1 inline-block"},null,-1)),A.notIncludeWord!=!0?(v(),y("span",ot,o(k.$t("dashboard.scanQR")),1)):h("",!0)]),m(Re,{"enter-active-class":"animate__animated animate__fadeInDown","leave-active-class":"animate__animated animate__fadeOutUp"},{default:b(()=>[c.toggleModal?(v(),y("div",it,[s("div",ct,[s("div",ut,[s("img",{src:A.accountAddressQR,class:"inline-block"},null,8,dt)]),s("div",{class:"text-center cursor-pointer text-xs font-semibold text-blue-link mt-2",onClick:i[1]||(i[1]=R=>{c.toggleModal=!c.toggleModal})},o(k.$t("general.close")),1)])])):h("",!0)]),_:1}),c.toggleModal?(v(),y("div",{key:0,onClick:i[2]||(i[2]=R=>c.toggleModal=!c.toggleModal),class:"fixed inset-0 bg-opacity-60 bg-gray-100 z-20"})):h("",!0)],64)}const ft=B(lt,[["render",pt]]),vt={class:"px-2 sm:px-10 bg-gray-200 pb-4 pt-5"},gt={class:"max-w-screen-sm m-auto"},mt={class:"shadow-md w-full overflow-x-hidden address_div px-7 py-3 rounded flex flex-col bg-white text-black"},yt={class:"text-center py-3"},bt={class:"text-center my-2"},xt={class:"inline-block"},Tt={class:"font-bold text-xl"},wt={class:"text-md"},_t={class:"font-bold text-xl"},ht={class:"mb-8"},kt={class:"flex items-center justify-center"},At=["copyValue","copySubject"],Pt=["href"],Ct={class:"text-xxs text-gray-400 inline-block uppercase"},It={class:"text-xxs text-gray-400 inline-block uppercase"},St={class:"text-xxs text-gray-400 inline-block uppercase"},Nt={class:"text-left px-2 sm:px-10 bg-gray-200"},Mt={class:"transition-all flex items-end"},Dt={key:0,class:"bg-white px-2 sm:px-10"},Rt={class:"text-txs text-gray-400 mt-10 mb-2"},Lt={class:"text-gray-700 uppercase"},$t=["href"],Ft={key:1,class:"bg-white px-2 sm:px-10 pt-12"},Qt=ue({__name:"ViewDashboard",setup(k){const{t:i}=$e(),A=Fe(),E=Oe().appContext.config.globalProperties.emitter,x=l("asset"),R=l(!1),de=l(!1),O=l(!1),pe=l(!1),fe=l(""),P=l(""),C=l(!1),j=l(""),K=l(!1),ve=l(0),ge=u(()=>g.networkType==N.NetworkType.TEST_NET||g.networkType==N.NetworkType.MAIN_NET),me=async e=>{let t=e.txType,a=e.recipient,r=e.recipientType,p=!1;K.value=!1;let De=e.sender;if(j.value=e.initialSigner,fe.value=e.message,P.value="",C.value=!1,t==="Transfer"||t==="Aggregate Complete"?(p=!0,F.findWalletAccountByPublicKey(f.currentLoggedInWallet,De)&&(K.value=!0)):F.findWalletAccountByPublicKey(f.currentLoggedInWallet,j.value)&&(K.value=!0),r==="address"){let _=F.findAccountPublicKeyByAddress(f.currentLoggedInWallet,a);if(_)P.value=_;else{let S=await W.getAccountInfo(d.createAddress(a));S.publicKey==="0".repeat(64)?C.value=!0:P.value=S.publicKey}}else{let _=await W.getNamespaceLinkedAddress(a);if(_){let S=F.findAccountPublicKeyByAddress(f.currentLoggedInWallet,a);if(S)P.value=S;else{let le=await W.getAccountInfo(_);le.publicKey==="0".repeat(64)?C.value=!0:P.value=le.publicKey}}else C.value=!0}p||(C.value=!0),ve.value++,O.value=!0},ye=u(()=>g.nativeToken.label),be=u(()=>g.nativeToken.divisibility),xe=u(()=>g.networkType==N.NetworkType.TEST_NET),V=u(()=>xe.value?M.chainNetworkName=="Sirius Testnet 1"?"https://bctestnetfaucet.xpxsirius.io/#/":M.chainNetworkName=="Sirius Testnet 2"?"https://bctestnet2faucet.xpxsirius.io/#/":!1:g.networkType==N.NetworkType.MAIN_NET?"https://www.proximax.io/en/xpx":!1);let n=u(()=>{if(f.currentLoggedInWallet){if(!f.currentLoggedInWallet.selectDefaultAccount())return f.currentLoggedInWallet.accounts[0]}else return null;return f.currentLoggedInWallet.selectDefaultAccount()});const Te=u(()=>f.currentLoggedInWallet?n.value.assets.filter(a=>a.rawAmount!=0):[]),U=u(()=>n.value?d.createAddress(n.value.address).pretty():null),T=u(()=>n.value?n.value.address:null),we=u(()=>{if(n.value){let e=d.createAddress(n.value.address).pretty(),t=e.substring(0,11),a=e.substring(e.length-11);return t+"..."+a}else return null}),L=u(()=>n.value?d.toCurrencyFormat(n.value?n.value.balance:0,be.value):null),_e=u(()=>L.value?L.value.split(".")[0]:null),z=u(()=>L.value?L.value.split(".")[1]:null),he=u(()=>n.value?n.value.name:null),ke=u(()=>{if(U.value){let e=qe(15,"H");return e.addData(U.value),e.make(),e.createDataURL()}else return null});let w=new ce(f.currentLoggedInWallet,n.value),Ae=l(0),G=async()=>{let e=await w.getAccountTransactionsCount(n.value);Ae.value=e.confirmed};const Pe=e=>{let t=document.getElementById(e).getAttribute("copyValue"),a=document.getElementById(e).getAttribute("copySubject");He(t),A.add({severity:"info",detail:a+" "+i("general.copied"),group:"br-custom",life:3e3})},H=l([]),q=l([]),Ce=l([]);let J=d.createTransactionQueryParams(),I=d.getTransactionGroupType(),$=d.createTransactionFieldOrder(d.getQueryParamOrder_v2().DESC,d.getTransactionSortField().BLOCK);J.updateFieldOrder($),J.embedded=!0;let X=async()=>{let e=d.createTransactionQueryParams();e.pageSize=1,e.publicKey=n.value.publicKey,e.embedded=!0,e.updateFieldOrder($);let t=await w.searchTxns(I.CONFIRMED,e),a=await w.formatConfirmedMixedTxns(t.transactions);H.value=a.slice(0,5),q.value=a},Y=async()=>{let e=d.createTransactionQueryParams();e.pageSize=20,e.type=ze.getTransferTypes(),e.publicKey=n.value.publicKey,e.embedded=!0,e.updateFieldOrder($);let t=await w.searchTxns(I.CONFIRMED,e);if(t.transactions.length){let a=await w.formatConfirmedMixedTxns(t.transactions);Ce.value=a,Ie.value=Se(a).slice(0,3)}};const Ie=l([]),Se=e=>{let t=[],a=e.filter(r=>r.amountTransfer>0);for(const r of a){let p;T.value==r.sender&&T.value==r.recipient||(T.value==r.sender?(p.transferContact=f.currentLoggedInWallet.convertAddressToNamePretty(r.recipient,!0),p.transferContactAddress=r.recipient,p.amount="-"+d.toCurrencyFormat(r.amountTransfer,g.nativeToken.divisibility)):(p.transferContact=f.currentLoggedInWallet.convertAddressToNamePretty(r.sender,!0).substring(0,30),p.transferContactAddress=r.sender,p.amount=d.toCurrencyFormat(r.amountTransfer,g.nativeToken.divisibility)),p.transferContact.length>20,p.hash=r.hash,t.push(p))}return t};E.on("CLOSE_MODAL",()=>{R.value=!1,de.value=!1,pe.value=!1,O.value=!1}),E.on("DEFAULT_ACCOUNT_SWITCHED",async e=>{G(),X(),Y(),await se(),await ae(),ne()});const Z=l([]),ee=l([]),te=l([]),Ne=u(()=>Z.value.concat(te.value).concat(ee.value));let se=async()=>{if(!n.value)return;let e=d.createTransactionQueryParams();e.pageSize=1,e.address=T.value,e.embedded=!0,e.updateFieldOrder($);let t=await w.searchTxns(I.UNCONFIRMED,e),a=await w.formatUnconfirmedMixedTxns(t.transactions);Z.value=a},ae=async()=>{if(!n.value)return;let e=new ce(f.currentLoggedInWallet,n.value),t=d.createTransactionQueryParams();t.pageSize=100,t.address=T.value;let a=await e.searchTxns(I.PARTIAL,t),r=await e.formatPartialMixedTxns(a.transactions);ee.value=r},ne=()=>{if(!n.value)return;let e=[];Qe.autoAnnounceSignedTransaction.forEach(t=>{let a=N.TransactionMapping.createFromPayload(t.signedTransaction.payload);(Ee.castToAggregate(a).innerTransactions.find(p=>p.signer.address.plain()==n.value.address)!=null||t.signedTransaction.signer==n.value.publicKey)&&e.push({type:"Aggregate Bonded",hash:t.signedTransaction.hash,deadline:a.deadline.value,groupType:"In Queue",recipient:"",sender:"",amount:"",message:"",sda:""})}),te.value=e};const re=async()=>{G(),X(),Y(),await se(),await ae(),ne()};if(g.isReady)re();else{let e=Ke(g,t=>{t.isReady&&(re(),e())})}const Me=()=>M.currentNetworkProfile?M.currentNetworkProfile.chainExplorer.url+"/"+M.currentNetworkProfile.chainExplorer.addressRoute+"/"+n.value.address:"";return(e,t)=>{const a=We("router-link");return v(),y("div",null,[s("div",vt,[s("div",gt,[s("div",mt,[s("div",yt,[s("div",bt,[s("div",xt,[s("span",Tt,o(_e.value),1),Q(o(z.value?".":""),1),s("span",wt,o(z.value),1),s("span",_t,o(ye.value),1)]),t[3]||(t[3]=s("img",{src:je,class:"inline-block w-6 h-6 ml-3 mb-2"},null,-1))]),m(a,{to:"/details-account/"+T.value,class:"inline-block text-xs font-bold text-blue-primary cursor-pointer"},{default:b(()=>[Q(o(he.value),1),t[4]||(t[4]=s("img",{src:Je,class:"inline-block w-5 h-5 ml-1 mb-0.5"},null,-1))]),_:1},8,["to"]),s("div",ht,[s("div",kt,[s("div",{id:"address",class:"inline-block font-bold outline-none break-all text-xs lg:text-tsm",copyValue:T.value,copySubject:e.$t("general.address")},o(we.value),9,At),s("img",{src:Xe,class:"w-4 cursor-pointer ml-4 inline-block",onClick:t[0]||(t[0]=r=>Pe("address"))}),m(ft,{accountAddressQR:ke.value,notIncludeWord:!0},null,8,["accountAddressQR"])])]),s("div",null,[V.value?(v(),y("a",{key:0,href:V.value,target:"_new",class:"inline-block text-center mr-2"},[t[5]||(t[5]=s("div",{class:"inline-block rounded-full bg-blue-primary w-8 h-8"},[s("div",{class:"h-full w-full flex items-center justify-center"},[s("img",{src:Ye,class:"w-5 h-5"})])],-1)),t[6]||(t[6]=s("br",null,null,-1)),s("div",Ct,o(e.$t("general.topUp")),1)],8,Pt)):h("",!0),m(a,{to:{name:"ViewTransferCreate"},class:"inline-block text-center mx-2"},{default:b(()=>[t[7]||(t[7]=s("div",{class:"inline-block rounded-full bg-blue-primary w-8 h-8"},[s("div",{class:"h-full w-full flex items-center justify-center"},[s("img",{src:Ze,class:"w-5 h-5"})])],-1)),t[8]||(t[8]=s("br",null,null,-1)),s("div",It,o(e.$t("general.transfer")),1)]),_:1}),ge.value?(v(),Be(a,{key:1,to:{name:"ViewServicesMainnetSwap"},class:"inline-block text-center mx-3"},{default:b(()=>[t[9]||(t[9]=s("div",{class:"inline-block rounded-full bg-blue-primary w-8 h-8"},[s("div",{class:"h-full w-full flex items-center justify-center"},[s("img",{src:et,class:"w-5 h-5"})])],-1)),t[10]||(t[10]=s("br",null,null,-1)),s("div",St,o(e.$t("general.swap")),1)]),_:1})):h("",!0)])])])])]),s("div",Nt,[s("div",Mt,[s("div",{class:oe(["text-xs inline-block px-3 rounded-t-sm py-3",`${x.value=="asset"?"bg-white text-gray-primary":"cursor-pointer"}`]),onClick:t[1]||(t[1]=r=>x.value="asset")},o(e.$t("general.asset",2)),3),s("div",{class:oe(["text-xs inline-block px-3 rounded-t-sm py-3",`${x.value=="overview"?"bg-white text-gray-primary":"cursor-pointer"}`]),onClick:t[2]||(t[2]=r=>x.value="overview")}," Activities ",2)])]),x.value=="overview"?(v(),y("div",Dt,[t[12]||(t[12]=s("div",{class:"text-txs text-gray-400 mt-10 mb-2"},[s("b",{class:"text-gray-700 uppercase"},"Pending Transactions")],-1)),m(Ve,{transaction:Ne.value},null,8,["transaction"]),s("div",Rt,[s("b",Lt,o(e.$t("dashboard.recentTransactions")),1)]),m(Ue,{selectedGroupType:D(I).CONFIRMED,transactions:H.value,onOpenDecryptMsg:me},null,8,["selectedGroupType","transactions"]),q.value.length==10?(v(),y("a",{key:0,href:Me(),target:"_blank"},t[11]||(t[11]=[s("div",{class:"text-right text-xs text-blue-primary mt-3"}," View more... ",-1)]),8,$t)):h("",!0)])):x.value=="asset"?(v(),y("div",Ft,[m(nt,{assets:Te.value},null,8,["assets"])])):h("",!0)])}}});const qt=B(Qt,[["__scopeId","data-v-0d4c720a"]]);export{qt as default};
