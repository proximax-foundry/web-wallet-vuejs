import{D as se,u as oe,r as S,w as h,c as x,E as L,a as ne,q as re,B as p,H as ie,a0 as ae,n as M,_ as ce,k as A,o as m,b as v,e as s,s as _,z as W,A as P,t as c,aK as E,f,S as C,X as V}from"./index-b4bb6af4.js";import{A as de,a as ue}from"./AccountTabs-b9f79c7e.js";import{c as pe}from"./functions-7c132b7a.js";import{_ as me}from"./chevron_left-0423cb29.js";import{_ as ve}from"./proximax-logo-ecfc3767.js";import{_ as fe}from"./icon-multisig-2a7c5e5f.js";import{a as be}from"./icon-key-5b3f7dda.js";import"./jdenticon-module-6969b920.js";import"./TextInput-827c3ec7.js";import"./TextInputClean-3b09ae50.js";const ge={name:"ViewMultisigScheme",components:{AccountComponent:de,AccountTabs:ue},props:{address:String},setup(i){const d=se(),{t:b}=oe(),l=S(!1),u=h.currentLoggedInWallet,g=x(()=>{if(!u)return null;let e=u.accounts.find(t=>t.address==i.address)||u.others.filter(t=>t.type==="MULTISIG").find(t=>t.address==i.address);return e||null}),r=x(()=>g.value?g.value.multisigInfo.filter(e=>e.level>=0):[]),T=L.networkType,y=e=>{let t=p.Address.createFromPublicKey(e,T);try{return t}catch{}},B=e=>e>0?b("general.multisig").toUpperCase()+"-":b("general.cosigner")+"-",k=e=>u.accounts.find(t=>t.address==y(e).plain()),o=(e,t)=>{const n=p.PublicAccount.createFromPublicKey(e,T).address.plain(),a=h.currentLoggedInWallet.contacts.find(le=>le.address==n);return a?a.name:k(e)?k(e).name:B(t)+y(e).plain().substr(-4)},w=e=>r.value.find(t=>t.publicKey==e).cosignaturies.length,R=(e,t)=>{let n=p.Address.createFromRawAddress(e).plain();return t?u.accounts.find(a=>a.address==n)||u.others.find(a=>a.address==n):u.accounts.find(a=>a.address==n)},H=e=>{let t=p.Address.createFromRawAddress(e).plain();return!!h.currentLoggedInWallet.others.find(n=>n.address==t)},U=e=>r.value.find(t=>t.publicKey==e).cosignaturies,K=e=>r.value.find(t=>t.publicKey==e).minApproval,N=e=>r.value.find(t=>t.publicKey==e).minRemoval,I=e=>{let t=u.accounts.find(n=>n.publicKey==e)?u.accounts.find(n=>n.publicKey==e):u.others.find(n=>n.publicKey==e);return t?t.balance:-1},D=e=>{let t=[],n=[];for(let a=0;a<e.length;a++)n=U(e[a]),t.push({label:y(e[a]).pretty(),name:o(e[a],w(e[a])),balance:I(e[a]),numApproveTx:K(e[a]),numRemoval:N(e[a]),children:D(n)});return t};let F={label:"",name:"",balance:0,numApproveTx:0,numRemoval:0,children:[]};r.value[0]&&(F={label:y(r.value[0].publicKey).pretty(),name:o(r.value[0].publicKey,r.value[0].cosignaturies.length),balance:I(r.value[0].publicKey),numApproveTx:K(r.value[0].publicKey),numRemoval:N(r.value[0].publicKey),children:D(r.value[0].cosignaturies)}),ne(()=>g,e=>{r.value[0]&&(F={label:y(r.value[0].publicKey).pretty(),name:o(r.value[0].publicKey,r.value[0].cosignaturies.length),balance:I(r.value[0].publicKey),numApproveTx:K(r.value[0].publicKey),numRemoval:N(r.value[0].publicKey),children:D(r.value[0].cosignaturies)})},{deep:!0});let z=x(()=>g.value?g.value.getDirectParentMultisig().length>0:!1),O=e=>{let t=e.slice(0,13),n=e.slice(35,46);return t+"..."+n};const q=x(()=>L.nativeToken.label),G=x(()=>L.nativeToken.divisibility),X=e=>{let n=ie.toCurrencyFormat(e,G.value).split(".");return n[1]!=null?{left:n[0],right:n[1]}:{left:n[0],right:null}},Y=e=>{let t=document.getElementById(e).getAttribute("copyValue"),n=document.getElementById(e).getAttribute("copySubject");pe(t),d.add({severity:"info",detail:n+" "+b("general.copied"),group:"br-custom",life:3e3})},J=e=>{try{return p.Address.createFromRawAddress(e).pretty()}catch{}},Q=S(0),Z=S(1),$=S(!1),j=re(),ee=e=>{h.currentLoggedInWallet.accounts.find(t=>t.name==e)&&h.currentLoggedInWallet.setDefaultAccountByName(e)},te=e=>(h.currentLoggedInWallet.accounts.find(n=>n.address==e)||h.currentLoggedInWallet.others.find(n=>n.address==e)).name;return{isHover:l,navigate:e=>{if(R(e,!0)&&!l.value&&!H(e)?(ee(te(p.Address.createFromRawAddress(e).plain())),ae(p.Address.createFromRawAddress(e).plain()),j.push({name:"ViewAccountDetails",params:{address:p.Address.createFromRawAddress(e).plain()}})):R(e,!0)&&j.push({name:"ViewAccountDetails",params:{address:p.Address.createFromRawAddress(e).plain()}}),!M.currentNetworkProfile)return"";R(e,!0)||window.open(M.currentNetworkProfile.chainExplorer.url+"/"+M.currentNetworkProfile.chainExplorer.addressRoute+"/"+e)},viewType:Q,viewType2:Z,collapsable:$,findAccountWithAddress:R,splitBalance:X,currentNativeTokenName:q,displayAddress:O,isMultisig:z,currentAccount:g,graph:F,copy:Y,prettyAddress:J}}},ye={class:"flex cursor-pointer"},he=s("img",{src:me},null,-1),_e={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},we={class:"p-6 border-2 border-t-0 filter shadow-lg mb-6"},xe={class:"flex cursor-pointer"},Ae={class:"border-2 border-blue-primary p-1 mb-3 w-16 text-white bg-blue-primary text-xs text-center font-semibold"},Te=["onClick"],ke={class:"text-xs text-left text-blue-500 font-bold"},Re={class:"flex gap-1"},Se=["id","copyValue","copySubject"],Ce={key:0,class:"flex"},Ve={class:"text-xs font-bold"},Be={key:0,class:"text-xs font-bold"},Ke={class:"text-xxs mt-0.5"},Ne={class:"ml-1 text-xs font-bold"},Ie=s("img",{src:ve,class:"h-4 w-4"},null,-1),De={class:"flex gap-3"},Fe={class:"text-xxs text-gray-500"},Le={class:"text-xxs text-gray-500"},Me={class:"flex gap-1 ml-auto"},We=["title"],je=s("img",{src:fe,class:"h-4 w-5 mr-1",style:{transform:"rotateY(180deg)"}},null,-1),Pe=[je],Ee=["title"],He=s("img",{src:be,class:"h-3 w-3 mr-1"},null,-1),Ue=[He],ze={class:"font-semibold"},Oe={class:"text-left py-3 text-xs pl-4"},qe={class:"text-left py-3 text-xs pl-4"},Ge={key:0,class:"text-left py-3 text-xs pl-4"},Xe={key:1,class:"text-left py-3 text-xs pl-4"},Ye={key:0,class:"text-left py-3 text-xs pl-4"},Je={key:1,class:"text-left py-3 text-xs pl-4"},Qe={class:"text-left py-3 text-xs pl-4"};function Ze(i,d,b,l,u,g){const r=A("router-link"),T=A("AccountComponent"),y=A("AccountTabs"),B=A("font-awesome-icon"),k=A("blocks-tree");return m(),v("div",null,[s("div",ye,[he,_(r,{to:{name:"ViewDashboard"},class:"text-blue-primary text-xs mt-0.5"},{default:W(()=>[P(c(i.$t("general.back")),1)]),_:1})]),s("div",_e,[_(T,{address:b.address,class:"mb-6"},null,8,["address"]),_(y,{address:b.address,selected:"multisig"},null,8,["address"]),s("div",we,[s("div",xe,[_(r,{to:{name:"ViewMultisigHome",params:{address:b.address}},class:"border-2 border-blue-primary p-1 mb-3 w-16 text-blue-primary text-xs text-center font-semibold"},{default:W(()=>[P(c(i.$t("general.multisig")),1)]),_:1},8,["to"]),s("div",Ae,c(i.$t("general.scheme")),1)]),s("div",{class:"overflow-auto w-full border-2",style:E(`${l.viewType2==1?" transform: rotate(180deg);":""}`)},[_(k,{data:l.graph,horizontal:l.viewType==0,collapsable:l.collapsable,props:{label:"label",name:"name",balance:"balance",numApproveTx:"numApproveTx",numRemoval:"numRemoval",children:"children"}},{node:W(({data:o})=>[s("div",{class:"flex flex-col justify-center p-1.5 h-20 cursor-pointer",onClick:w=>l.navigate(l.prettyAddress(o.label)),style:E(`${l.viewType2==1?" transform: rotate(180deg);":""}width: 16.5rem`)},[s("div",ke,c(o.name),1),s("div",Re,[s("div",{id:o.label,copyValue:l.prettyAddress(o.label),copySubject:i.$t("general.address"),class:"font-bold text-left text-xs mt-0.5"},c(l.displayAddress(o.label)),9,Se),_(B,{icon:"copy",title:i.$t("general.copy"),onMouseover:d[0]||(d[0]=w=>l.isHover=!0),onMouseout:d[1]||(d[1]=w=>l.isHover=!1),onClick:w=>l.copy(o.label),class:"w-5 h-5 text-blue-primary cursor-pointer"},null,8,["title","onClick"])]),o.balance!=-1?(m(),v("div",Ce,[s("div",Ve,c(l.splitBalance(o.balance).left),1),l.splitBalance(o.balance).right!=null?(m(),v("div",Be,".")):f("v-if",!0),s("div",Ke,c(l.splitBalance(o.balance).right),1),s("div",Ne,c(l.currentNativeTokenName),1),Ie])):f("v-if",!0),s("div",De,[s("div",Fe,c(i.$t("multisig.approvalScheme",{approval:o.numApproveTx,maxApproval:o.children.length})),1),s("div",Le,c(i.$t("multisig.deletionScheme",{deletion:o.numRemoval,maxDeletion:o.children.length})),1),s("div",Me,[o.children.length>0?(m(),v("div",{key:0,class:"ml-auto bg-green-500 rounded-2xl",title:i.$t("general.multisigTitle")},Pe,8,We)):f("v-if",!0),o.children.length>0&&l.findAccountWithAddress(o.label)!=null?(m(),v("div",{key:1,class:"p-0.5 bg-purple-500 rounded-2xl",title:i.$t("general.ownerTitle")},Ue,8,Ee)):f("v-if",!0)])])],12,Te)]),_:1},8,["data","horizontal","collapsable"])],4)]),s("div",ze,c(i.$t("multisig.viewSettings")),1),s("div",null,[C(s("input",{name:"view-type",type:"radio",value:"0","onUpdate:modelValue":d[2]||(d[2]=o=>l.viewType=o),checked:!0},null,512),[[V,l.viewType]]),s("label",Oe,c(i.$t("multisig.horizontal")),1)]),C(s("input",{name:"view-type",type:"radio",value:"1","onUpdate:modelValue":d[3]||(d[3]=o=>l.viewType=o)},null,512),[[V,l.viewType]]),s("label",qe,c(i.$t("multisig.vertical")),1),s("div",null,[C(s("input",{name:"view-type-2",type:"radio",value:"0","onUpdate:modelValue":d[4]||(d[4]=o=>l.viewType2=o),checked:!0},null,512),[[V,l.viewType2]]),l.viewType==0?(m(),v("label",Ge,c(i.$t("multisig.rightToLeft")),1)):f("v-if",!0),l.viewType==1?(m(),v("label",Xe,c(i.$t("multisig.topToBottom")),1)):f("v-if",!0)]),C(s("input",{name:"view-type-2",type:"radio",value:"1","onUpdate:modelValue":d[5]||(d[5]=o=>l.viewType2=o)},null,512),[[V,l.viewType2]]),l.viewType==0?(m(),v("label",Ye,c(i.$t("multisig.leftToRight")),1)):f("v-if",!0),l.viewType==1?(m(),v("label",Je,c(i.$t("multisig.bottomToTop")),1)):f("v-if",!0),s("div",null,[s("input",{type:"checkbox",onClick:d[6]||(d[6]=o=>l.collapsable=!l.collapsable)}),s("label",Qe,c(i.$t("multisig.collapsible")),1)])])])}const dt=ce(ge,[["render",Ze],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/account/submodule/multisig/views/ViewMultisigScheme.vue"]]);export{dt as default};
