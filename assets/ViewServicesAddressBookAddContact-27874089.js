import{d as q,g as d,c as f,j as z,y as Z,k as H,D as I,r as E,o as V,f as _,e as l,l as m,b as A,s as B,t as u,i as S,O as J,P as Q,v as X,U as Y,F as ee,x as L,b3 as ae,w as p,W as te,A as G}from"./index-49f5eac9.js";import{_ as se}from"./icon-save-307f50b1.js";import{T as N}from"./TextInputClean-ae76feb7.js";import{A as oe}from"./addressBookUtils-0d3294bf.js";const le={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},re={class:"flex text-xs font-semibold border-b-2 menu_title_div"},de={class:"border border-gray-100 p-5 filter drop-shadow-xl mt-10 bg-white"},ne={class:"text-md mb-5 font-semibold"},ue={key:0,class:"error error_box mb-5"},ie={class:"py-3 px-0 flex flex-wrap items-center gap-2 flex-grow"},ce=["disabled"],ve={class:"flex flex-col justify-center items-center"},me={class:"mt-2 text-xs font-semibold"},pe={key:0,class:"error error_box mb-3"},be=["placeholder"],fe=["disabled"],ge="^[0-9A-Za-z]{1,}$",Be=q({__name:"ViewServicesAddressBookAddContact",setup(we){const i=d(""),P=f(()=>!i.value.match(ge)),{t:s}=z(),M=Z(),n=d(""),v=d(""),r=d(""),g=d(""),c=d(""),y=d(!1),h=d(""),W=H(),b=d({value:"-none-",label:" - "}),w=d([s("addressBook.work"),s("addressBook.friend"),s("addressBook.family"),s("addressBook.employee"),s("addressBook.director")]),$=f(()=>[{value:"-none-",label:" - "},{value:"Custom",label:s("addressBook.custom")}].concat(w.value.map(e=>({value:e,label:e})))),U=f(()=>!(y.value&&n.value!="")),D=f(()=>!y.value&&v.value!=""),F=f(()=>v.value!=""&&n.value==""||r.value!=""&&n.value==""),R=f(()=>{let e=s("general.invalidInput");return h.value?h.value:e});I(r,()=>{if(p.currentLoggedInWallet)if(r.value.length<=63||r.value.length>=65){v.value=r.value;const e=p.currentLoggedInWallet.accounts.find(t=>t.default==!0),a=oe.verifyNetworkAddress(e.address,v.value);y.value=a.isPassed,h.value=a.errMessage}else r.value.length==64&&(y.value=!0,v.value=te.createAddressFromPublicKey(r.value,G.networkType).plain())});const k=d(!1);I(b,e=>{e.value=="Custom"&&(k.value=!0)});const T=async e=>{try{let a=await G.chainAPI.accountAPI.getAccountInfo(L.Address.createFromRawAddress(e));a.publicKey=="0000000000000000000000000000000000000000000000000000000000000000"?g.value=null:g.value=a.publicKey}catch{g.value=null}},K=async()=>{if(n.value==" "){c.value=s("general.nameRequired");return}r.value.length==64?g.value=r.value:await T(v.value);const e=L.Address.createFromRawAddress(v.value);let a=new ae(n.value.trim(),e.plain(),b.value.value,g.value);const t=p.currentLoggedInWallet,C=t.accounts.findIndex(x=>x.name.toLowerCase()==n.value.toLowerCase().trim()),o=t.contacts!=null?t.contacts.findIndex(x=>L.Address.createFromRawAddress(x.address).plain()==e.plain()):-1,j=t.contacts!=null?t.contacts.findIndex(x=>x.name.toLowerCase()==n.value.toLowerCase().trim()):-1;o>=0?c.value=s("addressBook.addressExist"):j>=0||C>=0?c.value=s("addressBook.nameExist"):(p.currentLoggedInWallet.addAddressBook(a),p.wallets.saveMyWalletOnlytoLocalStorage(p.currentLoggedInWallet),c.value="",n.value="",r.value="",M.add({severity:"info",summary:s("general.addressBook"),detail:s("addressBook.newContactAdded"),group:"br-custom",life:5e3}),W.push({name:"ViewServicesAddressBook"}))},O=()=>{$.value.find(({value:e})=>e.toLowerCase()===i.value.toLowerCase())||w.value.includes(i.value.toLowerCase())?c.value=s("addressBook.groupValidation"):(w.value.push(i.value),b.value={value:i.value,label:i.value},k.value=!1,i.value="")};return I(()=>p.currentLoggedInWallet,e=>{if(e){const a=[...new Set(e.contacts.map(t=>t.group))].filter(t=>t!="-none-");w.value=w.value.concat(a)}},{immediate:!0}),(e,a)=>{const t=E("router-link"),C=E("Dropdown");return V(),_(ee,null,[l("div",null,[l("div",le,[l("div",re,[m(t,{to:{name:"ViewServicesAddressBook"},class:"w-18 text-center border-b pb-3"},{default:A(()=>[B(u(e.$t("general.list")),1)]),_:1}),m(t,{to:{name:"ViewServicesAddressBookImport"},class:"w-18 text-center border-b pb-3"},{default:A(()=>[B(u(e.$t("general.import")),1)]),_:1}),m(t,{to:{name:"ViewServicesAddressBookExport"},class:"w-18 text-center border-b pb-3"},{default:A(()=>[B(u(e.$t("general.export")),1)]),_:1})]),l("div",de,[l("div",ne,u(e.$t("addressBook.addNewContact")),1),c.value!=""?(V(),_("div",ue,u(c.value),1)):S("",!0),l("div",ie,[m(N,{placeholder:e.$t("general.name"),errorMessage:e.$t("general.nameRequired"),modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=o=>n.value=o),icon:"id-card-alt",showError:F.value},null,8,["placeholder","errorMessage","modelValue","showError"]),m(N,{placeholder:e.$t("multisig.addressOrPk"),errorMessage:R.value,modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=o=>r.value=o),icon:"wallet",showError:D.value},null,8,["placeholder","errorMessage","modelValue","showError"]),m(C,{modelValue:b.value,"onUpdate:modelValue":a[2]||(a[2]=o=>b.value=o),options:$.value,"option-label":"label",placeholder:"Group "},null,8,["modelValue","options"]),l("button",{type:"submit",class:"bg-blue-primary text-white px-2 rounded-lg py-2 font-semibold disabled:opacity-50 flex items-center",disabled:U.value,onClick:a[3]||(a[3]=o=>K())},[a[7]||(a[7]=l("img",{src:se,class:"mr-2"},null,-1)),B(u(e.$t("addressBook.saveAddress")),1)],8,ce)])])])]),m(X(Y),{visible:k.value,"onUpdate:visible":a[6]||(a[6]=o=>k.value=o),modal:"",draggable:!1,dismissableMask:!0,closable:!1,class:"w-96"},{default:A(()=>[l("div",ve,[l("div",me,u(e.$t("addressBook.addCustomGroup")),1),c.value!=""?(V(),_("div",pe,u(c.value),1)):S("",!0),J(l("input",{type:"text","onUpdate:modelValue":a[4]||(a[4]=o=>i.value=o),placeholder:e.$t("addressBook.customGroup"),class:"border border-gray-300 p-3 my-5 text-tsm text-center focus:outline-none"},null,8,be),[[Q,i.value]]),l("button",{class:"rounded-md cursor-pointer text-xs text-white py-2 text-center ml-auto mr-auto btn-default bg-blue-primary w-14 mb-2 disabled:opacity-50",onClick:O,disabled:P.value},u(e.$t("general.add")),9,fe),l("div",{class:"text-center cursor-pointer font-semibold text-xs text-gray-500 mt-2",onClick:a[5]||(a[5]=o=>(k.value=!1,b.value={value:"-none-",label:" - "}))},u(e.$t("general.cancel")),1)])]),_:1},8,["visible"])],64)}}});export{Be as default};
