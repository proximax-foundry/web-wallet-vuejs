import{d as J,g as k,O as me,K as Q,D as Y,r as Z,o as f,f as A,a as ee,b as E,e,t as l,i as I,v as w,E as te,w as u,x as i,A as s,c as y,y as ge,H as q,n as D,B as W,k as ve,l as K,s as pe,W as z,bk as fe}from"./index-f4fa05bb.js";import{_ as se}from"./proximax-logo-ecfc3767.js";import{M as he}from"./multisigUtils-5932eec1.js";import{t as O}from"./jdenticon-module-14cc3de9.js";import{T as _e}from"./TransactionLayout-4fe4075f.js";import{_ as xe}from"./PasswordInput.vue_vue_type_script_setup_true_lang-db2dfddb.js";const be={key:0,class:"account-item-value account-item"},ye={class:"flex"},we=["innerHTML"],Te={class:"flex flex-col ml-2 text-left"},Ae=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Multisig Account",-1),Ie={class:"mt-1 text-tsm font-bold"},ke={class:"account-item"},Le={class:"flex items-center"},Me=["innerHTML"],Fe={class:"text-xs ml-2 font-semibold"},Se=J({__name:"SelectInputCosignerAccount",props:{cosignerList:{type:Array,required:!1}},emits:["select-cosigner-account","update:modelValue"],setup(F){k(!1);const v=F,{cosignerList:N}=me(v),p=k([]),h=te().appContext.config.globalProperties.emitter;let S=new Q("ThemeStyleConfig");S.init();let H=S.jdenticonConfig;const T=k(null);Y(N,_=>{p.value=_.map(g=>{const r=[...u.currentLoggedInWallet.accounts,...u.currentLoggedInWallet.others].find(n=>n.publicKey==g);return{label:r?u.currentLoggedInWallet.convertAddressToName(r.address):i.PublicAccount.createFromPublicKey(g,s.networkType).address.plain(),value:i.PublicAccount.createFromPublicKey(g,s.networkType).address.plain()}})},{deep:!0,immediate:!0});const $=k(null),L=(_,g)=>{if(_==null&&g==null){T.value=null,h.emit("select-cosigner-account",null);return}h.emit("select-cosigner-account",g),T.value.label=_,T.value.value=g,$.value=O(g,25,H)};return(_,g)=>{const m=Z("Dropdown");return f(),A("div",null,[p.value.length?(f(),ee(m,{key:0,showClear:!0,modelValue:T.value,"onUpdate:modelValue":g[0]||(g[0]=r=>T.value=r),style:{width:"100%"},options:p.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:g[1]||(g[1]=r=>{var n,x,P,C;L((n=r.value)==null?void 0:n.label,(x=r.value)==null?void 0:x.value),_.$emit("update:modelValue",(P=r.value)==null?void 0:P.value),_.$emit("select-cosigner-account",(C=r.value)==null?void 0:C.value)})},{value:E(r=>[r.value?(f(),A("div",be,[e("div",ye,[e("div",{innerHTML:$.value},null,8,we),e("div",Te,[Ae,e("div",Ie,l(r.value.label),1)])])])):I("",!0)]),option:E(r=>[e("div",ke,[e("div",Le,[e("div",{innerHTML:w(O)(r.option.value,20,w(H))},null,8,Me),e("div",Fe,l(r.option.label),1)])])]),_:1},8,["modelValue","options"])):I("",!0)])}}}),He=e("div",null,"SDA-SDA Exchange - Remove Offer",-1),Pe={key:0,class:"text-blue-primary mt-3"},Ce={key:1,class:"text-red-500"},Ee={class:"border border-blue-300 rounded-md p-3 mt-3 bg-blue-50"},$e={class:"flex items-center gap-2"},Ge=["innerHTML"],Ve={class:"flex flex-col gap-0.5"},We=e("div",{class:"uppercase text-xxs text-blue-primary"}," Selected Account ",-1),Ne={class:"font-semibold"},Re=e("div",{class:"text-blue-primary mt-3"},"Amount to give",-1),Be=e("div",{class:"text-blue-primary mt-3"},"Amount to get",-1),De={key:0},Ke={class:"font-bold text-xs text-blue-primary uppercase"},Oe={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},je={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},Ue=["innerHTML"],Xe={class:"flex"},qe={class:"ml-1 text-blue-400 font-bold"},ze=e("img",{src:se,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),Je=e("div",{class:"border-b-2 border-gray-600 my-2"},null,-1),Qe={class:"font-bold text-xs text-blue-primary uppercase"},Ye={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},Ze={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},et=["innerHTML"],tt={class:"flex"},st={class:"ml-1 text-blue-400 font-bold"},nt=e("img",{src:se,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),at=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),ot={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},it={class:"font-semibold lg:col-span-2 col-span-3"},lt=["innerHTML"],rt={class:"ml-1 text-blue-400"},ct={key:1,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs"},dt={class:"font-semibold lg:col-span-2 col-span-3"},ut=["innerHTML"],mt={class:"ml-1 text-blue-400"},gt={key:2,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},vt={class:"font-semibold lg:col-span-2 col-span-3"},pt=["innerHTML"],ft={class:"ml-1 text-blue-400"},ht=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),_t={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},xt=e("div",{class:"font-semibold lg:col-span-2 col-span-3 uppercase"}," Total ",-1),bt=["innerHTML"],yt={class:"ml-1 text-blue-400"},wt={class:"font-semibold text-xs text-white mb-1.5"},Tt={class:"text-center"},St=J({__name:"ViewExchangeRemove",props:{owner:String,pair:String},setup(F){const v=F,N=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],p=k(""),R=t=>{if(!t)return"0";const a=i.Address.createFromRawAddress(t).plain(),o=u.currentLoggedInWallet.accounts.find(c=>c.address==a)||u.currentLoggedInWallet.others.find(c=>c.address==a);return o?h(o.balance):0},h=t=>{let a=t.toString().split(".");return a[1]!=null?'<span class="font-semibold text-sm">'+a[0]+'</span>.<span class="font-semibold text-xs">'+a[1]+"</span>":'<span class="font-semibold text-sm">'+a[0]+"</span>"},S=t=>{const a=N.find(o=>o.namespace==t);return a?a.name:t},H=new Q("ThemeStyleConfig");H.init();const T=y(()=>O(v.owner,40,H.jdenticonConfig)),$=y(()=>{const t=i.Address.createFromRawAddress(v.owner).plain();return u.currentLoggedInWallet.convertAddressToName(t,!0)}),L=k(null);te().appContext.config.globalProperties.emitter.on("select-cosigner-account",t=>{L.value=t});const m=y(()=>{const t=i.Address.createFromRawAddress(v.owner).plain();return(u.currentLoggedInWallet.accounts.find(o=>o.address==t)||u.currentLoggedInWallet.others.find(o=>o.address==t)).getDirectParentMultisig().length}),r=y(()=>{if(!m.value)return[];const t=i.Address.createFromRawAddress(v.owner).plain(),a=u.currentLoggedInWallet.accounts.find(o=>o.address==t)||u.currentLoggedInWallet.others.find(o=>o.address==t);return he.getCosignerInWallet(a.publicKey).cosignerList}),n=k(null),x=ge(),P=v.pair.split("/")[0],C=v.pair.split("/")[1],ne=async()=>{if(!P||!C){x.add({severity:"error",summary:"Error",detail:"Invalid",group:"br-custom",life:1e3});return}const t=new i.ExchangeSdaHttp(s.nodeFullURL),a=await fe(t.getAccountSdaExchangeOffers(i.Address.createFromRawAddress(v.owner)));if(n.value=a.sdaOfferBalances.find(d=>d.mosaicIdGive.toHex()==P&&d.mosaicIdGet.toHex()==C),!n.value){x.add({severity:"error",summary:"Error",detail:"Offer not found",group:"br-custom",life:1e3});return}const o=await s.chainAPI.assetAPI.getMosaicsNames([n.value.mosaicIdGet,n.value.mosaicIdGive]),c=await s.chainAPI.assetAPI.getMosaics([n.value.mosaicIdGet,n.value.mosaicIdGive]);n.value.mosaicGetName=o[0].names.length?o[0].names[0].name:n.value.mosaicIdGet.toHex(),n.value.mosaicGiveName=o[1].names.length?o[1].names[0].name:n.value.mosaicIdGive.toHex(),n.value.mosaicGetDivisibility=c.find(d=>d.mosaicId.toHex()==n.value.mosaicIdGet.toHex()).divisibility,n.value.mosaicGiveDivisibility=c.find(d=>d.mosaicId.toHex()==n.value.mosaicIdGive.toHex()).divisibility},ae=Y(s,async(t,a)=>{t.isReady&&(await ne(),ae())},{immediate:!0}),j=y(()=>q.convertToExact(D.currentNetworkProfileConfig.lockedFundsPerAggregate,s.nativeToken.divisibility)),U=y(()=>q.convertToExact(W.getLockFundFee(),s.nativeToken.divisibility)),B=y(()=>{var c;if(!s.isReady)return 0;const t=i.RemoveSdaExchangeOfferTransaction.create(i.Deadline.create(),[new i.RemoveSdaExchangeOffer(new i.MosaicId(s.nativeToken.assetId),new i.MosaicId(s.nativeToken.assetId))],s.networkType);if(!m.value)return((c=t.maxFee)==null?void 0:c.compact())/Math.pow(10,s.nativeToken.divisibility);const a=[...u.currentLoggedInWallet.accounts,...u.currentLoggedInWallet.others].find(d=>d.address==i.Address.createFromRawAddress(v.owner).plain()),o=[t.toAggregateV1(i.PublicAccount.createFromPublicKey(a.publicKey,s.networkType))];return s.buildTxn.aggregateBonded(o).maxFee.compact()/Math.pow(10,s.nativeToken.divisibility)}),oe=y(()=>m.value?Math.round((j.value+U.value+B.value)*Math.pow(10,s.nativeToken.divisibility))/Math.pow(10,s.nativeToken.divisibility):B.value),ie=ve(),le=async()=>{if(m.value&&!L.value){x.add({severity:"error",summary:"Error",detail:"Initiator not selected",group:"br-custom",life:1e3});return}if(p.value.length<8){x.add({severity:"error",summary:"Error",detail:"password must be at least 8 characters",group:"br-custom",life:1e3});return}if(!z.verifyWalletPassword(u.currentLoggedInWallet.name,D.chainNetworkName,p.value)){x.add({severity:"error",summary:"Error",detail:"Incorrect password",group:"br-custom",life:1e3});return}const t=i.Address.createFromRawAddress(v.owner).plain(),a=u.currentLoggedInWallet.accounts.find(b=>b.address==(m.value?L.value:t)),o=z.decryptPrivateKey(new i.Password(p.value),a.encrypted,a.iv);p.value="";const c=i.RemoveSdaExchangeOfferTransaction.create(i.Deadline.create(),[new i.RemoveSdaExchangeOffer(n.value.mosaicIdGive,n.value.mosaicIdGet)],s.networkType),d=i.Account.createFromPrivateKeyV1(o,s.networkType),M=D.currentNetworkProfile.generationHash;if(m.value){const b=[...u.currentLoggedInWallet.accounts,...u.currentLoggedInWallet.others].find(ue=>ue.address==t),G=[c.toAggregateV1(i.PublicAccount.createFromPublicKey(b.publicKey,s.networkType))],V=await s.chainAPI.nodeAPI.getNodeTime(),re=s.buildTxn.aggregateBonded(G,new i.UInt64(V.sendTimeStamp)),X=d.preV2Sign(re,M),ce=W.lockFundTx(X),de=d.preV2Sign(ce,M);W.announceLF_AND_addAutoAnnounceABT(de,X)}else{const b=d.preV2Sign(c,M);await W.announceTransaction(b)}ie.push({name:"ViewAccountPendingTransactions",params:{address:d.address.plain()}})};return(t,a)=>{const o=Z("router-link");return f(),ee(_e,{class:"mt-8"},{white:E(()=>{var c,d,M,b,G,V;return[He,r.value.length?(f(),A("div",Pe," Select Initiator ")):I("",!0),K(Se,{"cosigner-list":r.value},null,8,["cosigner-list"]),m.value&&!r.value.length?(f(),A("div",Ce," Cosigner not found ")):I("",!0),e("div",Ee,[e("div",$e,[e("div",{innerHTML:T.value},null,8,Ge),e("div",Ve,[We,e("div",Ne,l($.value),1)])])]),Re,e("div",null,l(((c=n.value)==null?void 0:c.currentMosaicGiveAmount.compact())/Math.pow(10,(d=n.value)==null?void 0:d.mosaicGiveDivisibility))+" "+l(S((M=n.value)==null?void 0:M.mosaicGiveName)),1),Be,e("div",null,l(((b=n.value)==null?void 0:b.currentMosaicGetAmount.compact())/Math.pow(10,(G=n.value)==null?void 0:G.mosaicGetDivisibility))+" "+l(S((V=n.value)==null?void 0:V.mosaicGetName)),1)]}),navy:E(()=>[m.value?(f(),A("div",De,[e("div",Ke,l(t.$t("general.multisigAcc")),1),e("div",Oe,[e("div",je,l(t.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:R(F.owner)},null,8,Ue),e("div",Xe,[e("div",qe,l(w(s).nativeToken.label),1),ze])]),Je])):I("",!0),e("div",Qe,l(t.$t("general.signerAcc")),1),e("div",Ye,[e("div",Ze,l(t.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:R(m.value?L.value:F.owner)},null,8,et),e("div",tt,[e("div",st,l(w(s).nativeToken.label),1),nt])]),at,e("div",ot,[e("div",it,l(m.value?t.$t("general.aggregateFee"):t.$t("general.transactionFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:h(B.value)},null,8,lt),e("div",rt,l(w(s).nativeToken.label),1)]),m.value?(f(),A("div",ct,[e("div",dt,l(t.$t("general.lockFund")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:h(j.value??0)},null,8,ut),e("div",mt,l(w(s).nativeToken.label),1)])):I("",!0),m.value?(f(),A("div",gt,[e("div",vt,l(t.$t("general.lockFundTxFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:h(U.value??0)},null,8,pt),e("div",ft,l(w(s).nativeToken.label),1)])):I("",!0),ht,e("div",_t,[xt,e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:h(oe.value)},null,8,bt),e("div",yt,l(w(s).nativeToken.label),1)]),e("div",wt,l(t.$t("general.enterPasswordContinue")),1),K(xe,{placeholder:t.$t("general.enterPassword"),modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=c=>p.value=c),icon:"lock",class:"mt-5 mb-3"},null,8,["placeholder","modelValue"]),e("button",{class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:a[1]||(a[1]=c=>le())}," Sell "),e("div",Tt,[K(o,{to:{name:"ViewExchangeListing"},class:"content-center text-xs text-white underline"},{default:E(()=>[pe(l(t.$t("general.cancel")),1)]),_:1})])]),_:1})}}});export{St as default};
