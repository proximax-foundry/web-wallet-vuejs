import{d as oe,u as ie,r as g,c as t,w as i,n as T,H as B,B as p,S as de,a as x,l as ue,z as w,i as F,o as O,b as Z,m as c,v as j,e as r,t as A,f as ce,j as H,x as ve,W as me}from"./index-ba257803.js";import{_ as ge}from"./PasswordInput.vue_vue_type_script_setup_true_lang-3f8540d8.js";import{a as L}from"./accountUtils-782f9836.js";import{A as pe,_ as fe}from"./AccountTabs.vue_vue_type_script_setup_true_lang-51d82901.js";import{M as q}from"./multisigUtils-dd6c3d9c.js";import{_ as be}from"./AddressInputClean.vue_vue_type_style_index_0_lang-f90300a5.js";import{_ as ke}from"./TransactionFeeDisplay.vue_vue_type_script_setup_true_lang-7a8cab72.js";import{_ as he}from"./SelectAccountAndContact.vue_vue_type_style_index_0_lang-79a44969.js";import"./jdenticon-module-f5566d14.js";import"./functions-076c2d3c.js";import"./TextInput-a19ddb40.js";import"./TextInputClean-030c322a.js";import"./icon-key-5b3f7dda.js";import"./icon-red-x-a5511f99.js";import"./icon-green-tick-1b766454.js";import"./proximax-logo-ecfc3767.js";const ye={class:"w-10/12 mx-auto mt-5"},we={class:"border-2 border-t-0 filter shadow-lg xl:grid xl:grid-cols-3"},Ae={class:"lg:col-span-2 py-6 px-6"},Le={key:0,class:"text-tsm flex gap-2 items-center"},Ce={class:"font-semibold mt-3"},Ne={class:"flex flex-col"},Ie={class:"flex mt-3 gap-1"},Te={class:"bg-navy-primary p-6 lg:col-span-1"},xe={class:"font-semibold text-xs text-white mb-1.5"},$e=r("div",{class:"mt-3"},null,-1),Se=["disabled"],We={class:"text-center"},Fe="^[^ ]{8,}$",Me="^[0-9A-Za-z]{40}$",Pe="^[0-9A-Za-z-]{46}$",Qe=oe({__name:"ViewAccountAliasAddressToNamespace",props:{address:{}},setup(v){const{t:f}=ie(),M=g({name:"",value:""}),G=[{value:"Link",label:f("general.link")},{value:"Unlink",label:f("general.unlink")}],n=g({value:"Link",label:f("general.link")}),d=g(null),b=e=>{let l=i.currentLoggedInWallet.accounts.map(a=>({name:a.name,balance:a.balance,address:a.address,publicKey:a.publicKey,isMultisig:!!a.getDirectParentMultisig().length,multisigInfo:a.multisigInfo})),s=i.currentLoggedInWallet.others.filter(a=>a.type==="MULTISIG").map(a=>({name:a.name,balance:a.balance,address:a.address,publicKey:a.publicKey,isMultisig:!0,multisigInfo:a.multisigInfo}));return l.concat(s).find(a=>a.publicKey==e)},k=t(()=>{var e;return((e=i.currentLoggedInWallet)==null?void 0:e.accounts.find(l=>l.address==v.address))||i.currentLoggedInWallet.others.find(l=>l.address==v.address)}),D=g(""),h=g(""),m=g(""),C=g(!0),P=g(""),V=t(()=>T.currentNetworkProfileConfig?B.convertToExact(T.currentNetworkProfileConfig.lockedFundsPerAggregate,p.nativeToken.divisibility):0),U=t(()=>T.currentNetworkProfile?B.convertToExact(de.getLockFundFee(),p.nativeToken.divisibility):0),R=i.currentLoggedInWallet?i.currentLoggedInWallet.name:"",y=g(0),K=t(()=>{let e=p.nativeToken.divisibility;return o.value.hasCosigner?e==0?Math.trunc(y.value+V.value+U.value):Math.round((y.value+V.value+U.value)*Math.pow(10,p.nativeToken.divisibility))/Math.pow(10,p.nativeToken.divisibility):y.value}),E=t(()=>k.value?k.value.balance:0),J=t(()=>p.nativeToken.divisibility),Q=t(()=>i.currentLoggedInWallet?B.toCurrencyFormat(E.value,J.value):"0"),_=t(()=>{var e=!1;return o.value.hasCosigner?b(N.value)&&(b(N.value).balance<K.value?e=!0:e=!1):E.value<K.value&&(e=!0),e}),X=t(()=>!(_.value==!1&&h.value.match(Fe)&&m.value!=""&&d.value.value!=null&&C.value==!1)),Y=t(()=>L.namespaceOption(v.address,n.value.value)),ee=t(()=>{var l,s;return(((l=i.currentLoggedInWallet)==null?void 0:l.accounts.find(a=>a.address==v.address))||((s=i.currentLoggedInWallet)==null?void 0:s.others.find(a=>a.address==v.address))).namespaces.filter(a=>a.active==!0)}),o=t(()=>T.currentNetworkProfileConfig?{hasCosigner:!1,cosignerList:q.getCosignerInWallet(k.value.publicKey?k.value.publicKey:"").cosignerList.map(s=>({publicKey:s,name:b(s).name,balance:b(s).balance,address:b(s).address}))}:{hasCosigner:!1,cosignerList:[]}),ae=t(()=>o.value.cosignerList.map(e=>({name:e.name,value:e.publicKey}))),N=g(o.value.cosignerList[0]?o.value.cosignerList[0].publicKey:"");x(o,e=>{e.cosignerList.length&&(N.value=e.cosignerList[0]?e.cosignerList[0].publicKey:"")},{deep:!0});const z=t(()=>k.value?q.getCosignerInWallet(k.value.publicKey).cosignerList.length>0:!1),$=t(()=>!!(!z.value&&o.value.hasCosigner||!ee.value.length));x(n,()=>{m.value="",d.value=null},{immediate:!0}),x(d,e=>{var a;const s=L.getNamespaceListByAddress(v.address).find(I=>{var W;return I.name===((W=d.value)==null?void 0:W.value)});if(n.value.value=="Unlink"&&e!=null)m.value=w.Address.createFromRawAddress(s.linkedId).pretty();else if(n.value.value=="Link"&&m.value!=""&&e.value!=null){let I=w.Address.createFromRawAddress(m.value).plain();y.value=L.getLinkNamespaceToAddressTransactionFee(o.value.hasCosigner,I,(a=d.value)==null?void 0:a.value,n.value.value)/Math.pow(10,p.nativeToken.divisibility)}}),x(m,e=>{var l;if(e.length==46&&e.match(Pe)||e.length==40&&e.match(Me))if(L.verifyAddress(v.address,m.value).isPassed==!1)P.value="Invalid Address",C.value=!0;else{let a=w.Address.createFromRawAddress(e).plain();y.value=L.getLinkNamespaceToAddressTransactionFee(o.value.hasCosigner,a,(l=d.value)==null?void 0:l.value,n.value.value)/Math.pow(10,p.nativeToken.divisibility),P.value="",C.value=!1}else C.value=!0});const le=ue(),se=()=>{var e;if(!me.verifyWalletPassword(R,T.chainNetworkName,h.value))D.value=f("general.walletPasswordInvalid",{name:R}),h.value="";else{let l=i.currentLoggedInWallet.accounts.find(s=>s.address==v.address)?i.currentLoggedInWallet.accounts.find(s=>s.address==v.address):i.currentLoggedInWallet.others.find(s=>s.address==v.address);D.value="",L.linkNamespaceToAddress(N.value,o.value.hasCosigner,l,h.value,(e=d.value)==null?void 0:e.value,n.value.value,m.value),le.push({name:"ViewAccountPendingTransactions",params:{address:v.address}})}},te=t(()=>{let e=b(N.value);return e?e.balance:0});x(o,e=>{e.cosignerList.length&&(M.value={name:e.cosignerList[0].name,value:e.cosignerList[0].publicKey})},{immediate:!0});const S=g(!1),ne=e=>{S.value=!1,m.value=e.data},re=t(()=>{const e=i.currentLoggedInWallet;if(!e)return[];const l=[...e.accounts,...e.others];return e.contacts.length?[{key:"0",label:f("general.ownerAcc"),selectable:!1,children:l.map((s,a)=>({key:"0-"+a.toString(),label:s.name,data:w.Address.createFromRawAddress(s.address).pretty(),selectable:!0}))},{key:"1",label:f("general.contact"),selectable:!1,children:e.contacts.map((s,a)=>({key:"1-"+a.toString(),label:s.name,data:w.Address.createFromRawAddress(s.address).pretty(),selectable:!0}))}]:[{key:"0",label:f("general.ownerAcc"),selectable:!1,children:l.map((s,a)=>({key:"0-"+a.toString(),label:s.name,data:w.Address.createFromRawAddress(s.address).pretty(),selectable:!0}))}]});return(e,l)=>{const s=F("Sidebar"),a=F("Dropdown"),I=F("font-awesome-icon"),W=F("router-link");return O(),Z("div",null,[c(s,{visible:S.value,"onUpdate:visible":l[0]||(l[0]=u=>S.value=u),baseZIndex:1e4,position:"full"},{default:j(()=>[c(he,{contacts:re.value,onNodeSelect:ne},null,8,["contacts"])]),_:1},8,["visible"]),r("div",ye,[c(pe,{address:e.address,class:"mb-6"},null,8,["address"]),c(fe,{address:e.address,selected:"details"},null,8,["address"]),r("div",we,[r("div",Ae,[o.value.cosignerList.length?(O(),Z("div",Le,[r("div",null,A(e.$t("general.initiateBy"))+":",1),c(a,{modelValue:M.value,"onUpdate:modelValue":l[1]||(l[1]=u=>M.value=u),options:ae.value,class:"text-tsm","option-label":"name"},null,8,["modelValue","options"])])):ce("",!0),r("div",Ce,A(n.value.value=="Link"?e.$t("general.linkToNamespace"):e.$t("namespace.manageNamespace")),1),r("div",Ne,[c(a,{class:"my-3",placeholder:e.$t("namespace.selectAction"),modelValue:n.value,"onUpdate:modelValue":l[2]||(l[2]=u=>n.value=u),options:G,"option-label":"label",disabled:$.value},null,8,["placeholder","modelValue","disabled"]),c(a,{placeholder:e.$t("namespace.selectNamespace"),modelValue:d.value,"onUpdate:modelValue":l[3]||(l[3]=u=>d.value=u),"option-label":"label",options:Y.value,"option-disabled":"disabled",disabled:$.value},null,8,["placeholder","modelValue","options","disabled"])]),r("div",Ie,[c(be,{placeholder:e.$t("general.addAccAddress"),modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=u=>m.value=u),errorMessage:P.value,showError:C.value,disabled:$.value||n.value.value=="Unlink"||d.value==null},null,8,["placeholder","modelValue","errorMessage","showError","disabled"]),r("div",{class:"border rounded-md cursor-pointer flex flex-col justify-around p-2",onClick:l[5]||(l[5]=u=>S.value=!0)},[c(I,{icon:"id-card-alt",class:H([d.value!=null&&n.value.value=="Link"?"text-blue-primary":"text-gray-400","ml-auto mr-auto"])},null,8,["class"]),r("div",{class:H([d.value!=null&&n.value.value=="Link"?"text-blue-primary":"text-gray-400","text-xxs font-semibold uppercase"])},A(e.$t("general.select")),3)])])]),r("div",Te,[c(ke,{"transaction-fee":String(y.value),"total-fee-formatted":String(K.value),"get-multi-sig-cosigner":o.value,"check-cosign-balance":String(te.value),"lock-fund-currency":String(V.value),"lock-fund-tx-fee":String(U.value),balance:Q.value,"selected-acc-add":e.address,"is-cosigner":z.value,"fund-status":_.value},null,8,["transaction-fee","total-fee-formatted","get-multi-sig-cosigner","check-cosign-balance","lock-fund-currency","lock-fund-tx-fee","balance","selected-acc-add","is-cosigner","fund-status"]),r("div",xe,A(e.$t("general.enterPasswordContinue")),1),c(ge,{placeholder:e.$t("general.enterPassword"),errorMessage:e.$t("general.passwordRequired"),modelValue:h.value,"onUpdate:modelValue":l[6]||(l[6]=u=>h.value=u),icon:"lock",disabled:$.value},null,8,["placeholder","errorMessage","modelValue","disabled"]),$e,r("button",{class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:se,disabled:X.value},A(n.value.value=="Unlink"?e.$t("namespace.unlinkNamespace"):e.$t("general.linkToNamespace")),9,Se),r("div",We,[c(W,{to:{name:"ViewAccountDetails",params:{address:e.address}},class:"content-center text-xs text-white underline"},{default:j(()=>[ve(A(e.$t("general.cancel")),1)]),_:1},8,["to"])])])])])])}}});export{Qe as default};
