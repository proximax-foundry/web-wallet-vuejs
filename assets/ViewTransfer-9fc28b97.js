import{d as R,I as we,c as H,w as E,r as T,k as X,o as m,b as p,f as $,s as C,z as U,e,t as d,C as L,i as me,_ as W,O as ke,a as z,A as u,E as v,m as ue,P as Ae,Q as te,l as Te,B as $e,F as le,R as je,S as He,U as Ee,W as ce,n as se,V as Z,h as de,u as qe,H as D,D as Ke,q as Ue,X as Re}from"./index-401acdd9.js";import{t as ie}from"./jdenticon-module-3e81fcaa.js";import{S as We}from"./SelectAccountAndContact-754c3622.js";import{_ as ve}from"./proximax-logo-ecfc3767.js";import{P as De}from"./PasswordInput-357714d6.js";import{_ as Oe}from"./icon-red-x-a5511f99.js";import{_ as ze}from"./icon-green-tick-1b766454.js";const Xe={key:0,class:"text-blue-primary font-semibold uppercase text-xxs mt-3"},Ze={key:0,class:"account-item-value account-item"},Qe={class:"flex"},Ge=["innerHTML"],Je={class:"flex flex-col ml-2 text-left"},Ye=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Account to create / initiate transfer",-1),et={class:"mt-1 text-tsm font-bold"},tt={class:"account-item"},lt={class:"flex"},st=["innerHTML"],at={class:"text-xs ml-2 font-semibold"},nt=R({__name:"SelectInputAccount",emits:["select-account","update:modelValue"],setup(i){const g=me().appContext.config.globalProperties.emitter;let f=new we("ThemeStyleConfig");f.init();let l=f.jdenticonConfig;const o=H(()=>E.currentLoggedInWallet?[...E.currentLoggedInWallet.accounts.filter(_=>_.multisigInfo.length==0||_.multisigInfo.find(b=>b.level==0).cosignaturies.length==0)].map(_=>({value:_.address,label:E.currentLoggedInWallet.convertAddressToName(_.address,!0)})):[]),n=T(null),h=T(null),M=(k,_)=>{if(k==null&&_==null){n.value=null,g.emit("select-account",null);return}g.emit("select-account",_),n.value.label=k,n.value.value=_,h.value=ie(_,25,l)};return(k,_)=>{const b=X("Dropdown");return m(),p("div",null,[n.value?$("v-if",!0):(m(),p("div",Xe,"Select Account to create / initiate transfer")),C(b,{showClear:!0,modelValue:n.value,"onUpdate:modelValue":_[0]||(_[0]=r=>n.value=r),style:{width:"100%"},options:o.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:_[1]||(_[1]=r=>{var x,c,a,w;M((x=r.value)==null?void 0:x.label,(c=r.value)==null?void 0:c.value),k.$emit("update:modelValue",(a=r.value)==null?void 0:a.value),k.$emit("select-account",(w=r.value)==null?void 0:w.value)})},{value:U(r=>[r.value?(m(),p("div",Ze,[e("div",Qe,[e("div",{innerHTML:h.value},null,8,Ge),e("div",Je,[Ye,e("div",et,d(r.value.label),1)])])])):$("v-if",!0)]),option:U(r=>[e("div",tt,[e("div",lt,[e("div",{innerHTML:L(ie)(r.option.value,20,L(l))},null,8,st),e("div",at,d(r.option.label),1)])])]),_:1},8,["modelValue","options"])])}}}),ot=W(nt,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/SelectInputAccount.vue"]]),it={key:1,class:"text-xxs font-semibold uppercase mt-3 text-blue-primary"},rt={key:0,class:"account-item-value account-item"},ct={class:"flex"},ut=["innerHTML"],dt={class:"flex flex-col ml-2 text-left"},mt=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Multisig Account",-1),vt={class:"mt-1 text-tsm font-bold"},pt={class:"account-item"},ft={class:"flex items-center"},gt=["innerHTML"],bt={class:"text-xs ml-2 font-semibold"},ht=R({__name:"SelectInputMultisigAccount",props:{selectedAddress:{type:String,required:!1}},emits:["select-multisig-account","update:modelValue"],setup(i){const y=i,g=T(!1),{selectedAddress:f}=ke(y),l=T([]),n=me().appContext.config.globalProperties.emitter;let h=new we("ThemeStyleConfig");h.init();let M=h.jdenticonConfig;const k=T(null);z(f,r=>{if(b(null,null),r==null){b(null,null),l.value=[];return}const x=E.currentLoggedInWallet.accounts.find(a=>a.address==r),c=x.multisigInfo.find(a=>a.level==0);l.value=c?[...x.multisigInfo].filter(a=>a.level<0).map(a=>{const F=[...E.currentLoggedInWallet.accounts,...E.currentLoggedInWallet.others].find(I=>I.publicKey==a.publicKey);return{label:F?E.currentLoggedInWallet.convertAddressToName(F.address):u.PublicAccount.createFromPublicKey(a.publicKey,v.networkType).address.plain(),value:u.PublicAccount.createFromPublicKey(a.publicKey,v.networkType).address.plain()}}):[]}),z(k,r=>{r==null&&(g.value=!1)});const _=T(null),b=(r,x)=>{if(r==null&&x==null){k.value=null,n.emit("select-multisig-account",null);return}n.emit("select-multisig-account",x),k.value.label=r,k.value.value=x,_.value=ie(x,25,M)};return(r,x)=>{const c=X("Dropdown");return m(),p("div",null,[l.value.length&&!g.value?(m(),p("button",{key:0,class:"blue-btn py-2 px-3 mt-3",onClick:x[0]||(x[0]=a=>g.value=!0)},"Select Multisig Account")):$("v-if",!0),l.value.length&&g.value&&!k.value?(m(),p("div",it,"Select Multisig Account")):$("v-if",!0),g.value&&l.value.length?(m(),ue(c,{key:2,showClear:!0,modelValue:k.value,"onUpdate:modelValue":x[1]||(x[1]=a=>k.value=a),style:{width:"100%"},options:l.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:x[2]||(x[2]=a=>{var w,F,I,V;b((w=a.value)==null?void 0:w.label,(F=a.value)==null?void 0:F.value),r.$emit("update:modelValue",(I=a.value)==null?void 0:I.value),r.$emit("select-multisig-account",(V=a.value)==null?void 0:V.value)})},{value:U(a=>[a.value?(m(),p("div",rt,[e("div",ct,[e("div",{innerHTML:_.value},null,8,ut),e("div",dt,[mt,e("div",vt,d(a.value.label),1)])])])):$("v-if",!0)]),option:U(a=>[e("div",pt,[e("div",ft,[e("div",{innerHTML:L(ie)(a.option.value,20,L(M))},null,8,gt),e("div",bt,d(a.option.label),1)])])]),_:1},8,["modelValue","options"])):$("v-if",!0)])}}}),yt=W(ht,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/SelectInputMultisigAccount.vue"]]),xt={key:0},_t={class:"flex justify-between"},wt={class:"flex flex-col ml-2 text-left"},kt=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Asset",-1),At={class:"mt-1 text-tsm font-bold"},Tt={class:"mt-1 text-tsm font-bold"},$t={class:"account-item"},It={class:"flex justify-between"},Mt={class:"mt-1 text-tsm font-bold"},Ft={class:"mt-1 text-tsm font-bold"},Pt=R({__name:"SelectInputAsset",props:{index:{type:Number,required:!0},assetOptions:{type:Object,required:!0},selectedAssets:{type:Object,required:!1}},emits:["select-asset","update:modelValue"],setup(i){const y=i,g=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],f=b=>{const r=g.find(x=>x.namespace==b);return r?r.name:b},{assetOptions:l,selectedAssets:o,index:n}=ke(y),h=T(!1),M=H(()=>{const b=new Set(o.value.map(r=>r.id));return l.value.filter(r=>!b.has(r.id))}),k=async b=>{if(h.value)return;h.value=!0;const{first:r,last:x}=b,c=[];for(let N=r;N<x;N++)l.value[N].hasUpdated||c.push(new u.MosaicId(l.value[N].id));if(!c.length){h.value=!1;return}const a=await v.chainAPI.assetAPI.getMosaicsNames(c),w=await v.chainAPI.assetAPI.getMosaics(c);let F=0,I=0;const V=new Map;a.forEach((N,B)=>{V.set(N.mosaicId.toHex(),B)}),w.sort((N,B)=>{const A=V.get(N.mosaicId.toHex()),q=V.get(B.mosaicId.toHex());return A-q});for(let N=r;N<x;N++){if(!a[F])continue;const B=l.value.find(A=>A.id==a[F].mosaicId.toHex());B&&(B.namespace=a[F].names.length?a[F].names[0].name:"",B.balance=B.balance/Math.pow(10,w[I].divisibility),B.divisibility=w[I].divisibility,B.hasUpdated=!0,F++,I++)}h.value=!1},_=b=>{if(b==null){o.value.splice(n.value,1);return}o.value[n.value].balance=b.balance,o.value[n.value].id=b.id,o.value[n.value].namespace=b.namespace,o.value[n.value].divisibility=b.divisibility,o.value[n.value].amount="0"};return(b,r)=>{const x=X("Dropdown");return m(),p("div",null,[C(x,{showClear:!0,modelValue:L(o)[L(n)],"onUpdate:modelValue":r[0]||(r[0]=c=>L(o)[L(n)]=c),style:{width:"100%"},options:M.value,filter:!0,filterFields:["id","namespace"],emptyFilterMessage:" ",placeholder:"Select Asset",virtualScrollerOptions:{lazy:!0,onLazyLoad:k,showLoader:!0,loading:h.value,delay:0,itemSize:38},onChange:r[1]||(r[1]=c=>{var a;_(c.value),b.$emit("update:modelValue",(a=c.value)==null?void 0:a.value)})},{value:U(c=>[c.value.id?(m(),p("div",xt,[e("div",_t,[e("div",wt,[kt,e("div",At,d(f(c.value.namespace==""?c.value.id:c.value.namespace)),1)]),e("div",Tt,"Balance: "+d(c.value.balance),1)])])):$("v-if",!0)]),option:U(c=>[e("div",$t,[e("div",It,[e("div",Mt,d(f(c.option.namespace==""?c.option.id:c.option.namespace)),1),e("div",Ft,"Balance: "+d(c.option.balance),1)])])]),_:1},8,["modelValue","options","virtualScrollerOptions"])])}}}),Vt=W(Pt,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/SelectInputAsset.vue"]]),St={class:"border border-gray-200 px-2 py-1 rounded-md"},Nt={class:"flex justify-between"},Lt={class:"flex flex-col"},Ct={class:"uppercase font-light text-gray-500 text-txs text-left mb-2"},Bt={class:"flex w-full"},jt={key:0,src:ve,class:"h-5 w-5 mt-0.5"},Ht=["value","data-maska","placeholder"],Et=["disabled"],qt=R({__name:"TransferInputClean",props:{modelValue:{type:String,required:!0},decimal:{type:Number,required:!0},placeholder:{type:String,required:!0},toolTip:{type:String,required:!1},disabled:{type:Boolean,required:!1},showError:{type:Boolean,required:!1},logo:{type:Boolean,required:!1},balance:{type:Number,required:!1}},emits:["update:modelValue","show-error","clickedMaxAvailable"],setup(i){const y=i,g=()=>{let l="0";return y.decimal>0&&(l=l+"."+"9".repeat(y.decimal)),l},f={preProcess:l=>l.replace(/,/g,""),postProcess:l=>{if(!l)return"";let o=0;return y.decimal>0&&(o=1+y.decimal-(l.includes(".")?l.length-l.indexOf("."):0)),Intl.NumberFormat("en-US",{minimumFractionDigits:y.decimal}).format(parseFloat(l)).slice(0,o?-o:void 0)}};return(l,o)=>{const n=Ae("maska");return m(),p("div",{class:Te(i.disabled?"opacity-50":"")},[e("div",St,[e("div",Nt,[e("div",Lt,[e("div",Ct,d(i.placeholder),1),e("div",Bt,[i.logo?(m(),p("img",jt)):$("v-if",!0),te(e("input",{value:i.modelValue,class:"supply_input","data-maska":g(),"data-maska-tokens":"0:\\d:multiple|9:\\d:optional",placeholder:i.placeholder,onInput:o[0]||(o[0]=h=>l.$emit("update:modelValue",parseFloat(h.target.value.replace(/,/g,"")).toString()))},null,40,Ht),[[n,void 0,f]])])]),i.logo?(m(),p("button",{key:0,disabled:i.disabled==!0,class:"w-24 cursor-pointer focus:outline-none text-blue-primary text-xs font-bold",onClick:o[1]||(o[1]=h=>l.$emit("clickedMaxAvailable",!0))},d(l.$t("swap.maxAmount")),9,Et)):$("v-if",!0)])])],2)}}});const he=W(qt,[["__scopeId","data-v-03ac6095"],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/TransferInputClean.vue"]]),Kt={class:"rounded-md bg-white flex border mt-3"},Ut=["value","placeholder"],Rt=e("div",{class:"w-1 flex-none"},null,-1),Wt={class:"text-gray-800"},Dt=R({__name:"TextAreaInput",props:{modelValue:{type:String,required:!1},currentBytes:{type:Number,required:!0},limit:{type:Number,required:!0},placeholder:{type:String,required:!0}},emits:["update:modelValue"],setup(i){return(y,g)=>(m(),p(le,null,[e("div",Kt,[e("textarea",{value:i.modelValue,onInput:g[0]||(g[0]=f=>y.$emit("update:modelValue",f.target.value)),rows:"2",class:"w-full text-gray-500 px-2 py-1 outline-none bg-white text-xs",placeholder:i.placeholder.toUpperCase()},null,40,Ut),Rt]),e("div",{class:Te(["float-right mt-1 text-tsm",i.currentBytes>i.limit?"text-red-500":"text-gray-800"])},[$e(d(i.currentBytes)+" ",1),e("span",Wt,"/"+d(i.limit),1)],2)],64))}}),Ot=W(Dt,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/TextAreaInput.vue"]]),zt={class:"border border-gray-200 px-2 py-2 rounded-md w-full"},Xt={class:"flex gap-2"},Zt={class:"flex flex-col w-full"},Qt={class:"uppercase text-gray-500 font-light text-xxs text-left"},Gt={key:0,class:"flex flex-col ml-auto justify-center mt-1"},Jt=e("img",{src:Oe,class:"h-5 w-5 mr-auto ml-auto"},null,-1),Yt={class:"text-xxs text-red-400 font-bold uppercase"},el={key:1,class:"flex flex-col ml-auto justify-center mt-1"},tl=e("img",{src:ze,class:"h-5 w-5 mr-auto ml-auto"},null,-1),ll={class:"text-xxs text-green-400 font-bold uppercase"},sl=R({__name:"FieldValidationInput",props:je({placeholder:{type:null,required:!0},showError:{type:null,required:!0}},{modelValue:{}}),emits:["update:modelValue"],setup(i){const y=He(i,"modelValue");return(g,f)=>(m(),p("div",zt,[e("div",Xt,[e("div",Zt,[e("div",Qt,d(g.placeholder),1),te(e("input",{type:"text","onUpdate:modelValue":f[0]||(f[0]=l=>y.value=l),class:"w-full font-semibold text-tsm outline-none mt-1"},null,512),[[Ee,y.value]])]),g.showError&&y.value.length!=0?(m(),p("div",Gt,[Jt,e("div",Yt,d(g.$t("general.invalid")),1)])):g.showError?$("v-if",!0):(m(),p("div",el,[tl,e("div",ll,d(g.$t("general.valid")),1)]))])]))}});const ye=W(sl,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/FieldValidationInput.vue"]]),Ie="0".repeat(64),xe=u.PublicAccount.createFromPublicKey(Ie,v.networkType).address.plain(),_e=(i,y)=>{let g=[];return parseInt(i)>0&&g.push(new u.Mosaic(new u.MosaicId(v.nativeToken.assetId),u.UInt64.fromUint(Number(i)))),y.length>0&&y.forEach(f=>{parseInt(f.amount)>0&&g.push(new u.Mosaic(new u.MosaicId(f.id),u.UInt64.fromUint(Number(f.amount))))}),g},ne=class ne{};ne.createTransaction=async(y,g,f,l,o,n,h,M,k)=>{if(!ce.verifyWalletPassword(E.currentLoggedInWallet.name,se.chainNetworkName,o))return!1;const b=se.currentNetworkProfile.generationHash;let r=v.networkType,x=parseFloat(g)*Math.pow(10,v.nativeToken.divisibility),c=[];x>0&&c.push(new u.Mosaic(new u.MosaicId(v.nativeToken.assetId),u.UInt64.fromUint(Number(x)))),l.length>0&&l.forEach(A=>{A.amount>0&&c.push(new u.Mosaic(new u.MosaicId(A.id),u.UInt64.fromUint(Number(A.amount*Math.pow(10,A.divisibility)))))});let a=v.buildTxn,w,F;if(!h)w=E.currentLoggedInWallet.accounts.find(A=>A.address===n);else{w=E.currentLoggedInWallet.accounts.find(q=>q.address===n);const A=await v.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(h));F=u.PublicAccount.createFromPublicKey(A.publicKey,r)}let I=ce.decryptPrivateKey(new u.Password(o),w.encrypted,w.iv),V;if(M&&f.length>0)try{const A=await v.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(y));V=u.EncryptedMessage.create(f,A.publicAccount,I)}catch{V=u.EncryptedMessage.create(f,u.PublicAccount.createFromPublicKey(k,v.networkType),I)}else V=u.PlainMessage.create(f);let N=a.transferBuilder().recipient(u.Address.createFromRawAddress(y)).mosaics(c).message(V).build();const B=u.Account.createFromPrivateKey(I,r,1);if(h){let A=E.currentLoggedInWallet.accounts.find(re=>re.address==n),q=ce.decryptPrivateKey(new u.Password(o),A.encrypted,A.iv),Q=u.Account.createFromPrivateKey(q,r,1);const G=[N.toAggregateV1(F)],J=a.aggregateBonded(G),Y=Q.preV2Sign(J,b),ee=Z.lockFundTx(Y),K=Q.preV2Sign(ee,b);Z.announceLF_AND_addAutoAnnounceABT(K,Y)}else{const A=B.preV2Sign(N,b);Z.announceTransaction(A)}return!0},ne.calculateAggregateFee=(y,g,f,l)=>{let o=v.buildTxn,n=_e(g,f),M=[o.transferBuilder().recipient(u.Address.createFromRawAddress(xe)).mosaics(n).message(l&&y.length>0?u.EncryptedMessage.create(y,u.PublicAccount.createFromPublicKey("0".repeat(64),v.networkType),"0".repeat(64)):u.PlainMessage.create(y)).build().toAggregateV1(u.PublicAccount.createFromPublicKey(Ie,v.networkType))];return o.aggregateBondedBuilder().innerTransactions(M).build().maxFee.compact()/Math.pow(10,v.nativeToken.divisibility)},ne.calculateFee=(y,g,f,l)=>{let o=v.buildTxn,n=_e(g,f);return o.transferBuilder().recipient(u.Address.createFromRawAddress(xe)).mosaics(n).message(l&&y.length>0?u.EncryptedMessage.create(y,u.PublicAccount.createFromPublicKey("0".repeat(64),v.networkType),"0".repeat(64)):u.PlainMessage.create(y)).build().maxFee.compact()/Math.pow(10,v.nativeToken.divisibility)};let ae=ne;const al={key:0},nl={class:"font-bold text-xs text-blue-primary uppercase"},ol={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},il={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},rl=["innerHTML"],cl={class:"flex"},ul={class:"ml-1 text-blue-400 font-bold"},dl=e("img",{src:ve,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),ml={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs pt-2"},vl={class:"font-semibold lg:col-span-2 col-span-3"},pl={key:0,class:"lg:col-span-2 col-span-3 ml-auto"},fl=["innerHTML"],gl={class:"ml-1 text-blue-400"},bl={key:0,class:"lg:col-span-4 col-span-6 ml-auto"},hl={key:1,class:"lg:col-span-4 col-span-6 ml-auto"},yl=["index"],xl=e("div",{class:"border-b-2 border-gray-600 my-2"},null,-1),_l={class:"font-bold text-xs text-blue-primary uppercase"},wl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},kl={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},Al=["innerHTML"],Tl={class:"flex"},$l={class:"ml-1 text-blue-400 font-bold"},Il=e("img",{src:ve,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),Ml=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),Fl={key:1,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs pt-2"},Pl={class:"font-semibold lg:col-span-2 col-span-3"},Vl={key:0,class:"lg:col-span-2 col-span-3 ml-auto"},Sl=["innerHTML"],Nl={class:"ml-1 text-blue-400"},Ll={key:0,class:"lg:col-span-4 col-span-6 ml-auto"},Cl={key:1,class:"lg:col-span-4 col-span-6 ml-auto"},Bl=["index"],jl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Hl={class:"font-semibold lg:col-span-2 col-span-3"},El=["innerHTML"],ql={class:"ml-1 text-blue-400"},Kl={key:3,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs"},Ul={class:"font-semibold lg:col-span-2 col-span-3"},Rl=["innerHTML"],Wl={class:"ml-1 text-blue-400"},Dl={key:4,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Ol={class:"font-semibold lg:col-span-2 col-span-3"},zl=["innerHTML"],Xl={class:"ml-1 text-blue-400"},Zl=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),Ql={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Gl=e("div",{class:"font-semibold lg:col-span-2 col-span-3 uppercase"},"Total",-1),Jl=["innerHTML"],Yl={class:"ml-1 text-blue-400"},es=R({__name:"TransferTxnSummary",props:{selectedMultisigAddress:{type:String||null},nativeTokenBalance:{type:Number,required:!0},selectedAssets:{type:Array,required:!0},lockFund:{type:Number,required:!0},txnFee:{type:Number,required:!0},lockFundTxFee:{type:Number,required:!0},totalFee:{type:Number,required:!0},nativeAmount:{type:String,required:!0},signerNativeTokenBalance:{type:Number,required:!0}},setup(i){const y=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],g=l=>{const o=y.find(n=>n.namespace==l);return o?o.name:l.length==16?l.substring(0,4)+"..."+l.substring(l.length-4,l.length+1):l},f=l=>{let o=l.toString().split(".");return o[1]!=null?'<span class="font-semibold text-sm">'+o[0]+'</span>.<span class="font-semibold text-xs">'+o[1]+"</span>":'<span class="font-semibold text-sm">'+o[0]+"</span>"};return(l,o)=>(m(),p(le,null,[i.selectedMultisigAddress?(m(),p("div",al,[e("div",nl,d(l.$t("general.multisigAcc")),1),e("div",ol,[e("div",il,d(l.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:f(i.nativeTokenBalance??0)},null,8,rl),e("div",cl,[e("div",ul,d(L(v).nativeToken.label),1),dl])]),e("div",ml,[e("div",vl,d(l.$t("transfer.transferAmount")),1),isNaN(parseFloat(i.nativeAmount))?(m(),p("div",pl,"0")):(m(),p("div",{key:1,class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(i.nativeAmount??0)},null,8,fl)),e("div",gl,d(L(v).nativeToken.label),1)]),(m(!0),p(le,null,de(i.selectedAssets,(n,h)=>(m(),p("div",{class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-white text-xs",key:h},[isNaN(parseFloat(n.amount))&&n.id!=null?(m(),p("div",bl,"0")):(m(),p("div",hl,d(n.amount),1)),n.id!=null?(m(),p("div",{key:2,class:"ml-1 text-blue-400",index:h},d(g(n.namespace==""?n.id:n.namespace)),9,yl)):$("v-if",!0)]))),128)),xl])):$("v-if",!0),$(" { end of multisig summary } "),$(" { beginning of signer summary } "),e("div",_l,d(l.$t("general.signerAcc")),1),e("div",wl,[e("div",kl,d(l.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:f(i.selectedMultisigAddress?i.signerNativeTokenBalance:i.nativeTokenBalance??0)},null,8,Al),e("div",Tl,[e("div",$l,d(L(v).nativeToken.label),1),Il])]),Ml,i.selectedMultisigAddress?$("v-if",!0):(m(),p("div",Fl,[e("div",Pl,d(l.$t("transfer.transferAmount")),1),isNaN(parseFloat(i.nativeAmount))?(m(),p("div",Vl,"0")):(m(),p("div",{key:1,class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(i.nativeAmount??0)},null,8,Sl)),e("div",Nl,d(L(v).nativeToken.label),1)])),i.selectedMultisigAddress?$("v-if",!0):(m(!0),p(le,{key:2},de(i.selectedAssets,(n,h)=>(m(),p("div",{class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-white text-xs",key:h},[isNaN(parseFloat(n.amount))&&n.id!=null?(m(),p("div",Ll,"0")):(m(),p("div",Cl,d(n.amount),1)),n.id!=null?(m(),p("div",{key:2,class:"ml-1 text-blue-400",index:h},d(g(n.namespace==""?n.id:n.namespace)),9,Bl)):$("v-if",!0)]))),128)),e("div",jl,[e("div",Hl,d(i.selectedMultisigAddress!=null?l.$t("general.aggregateFee"):l.$t("general.transactionFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(i.txnFee)},null,8,El),e("div",ql,d(L(v).nativeToken.label),1)]),i.selectedMultisigAddress!=null?(m(),p("div",Kl,[e("div",Ul,d(l.$t("general.lockFund")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(i.lockFund??0)},null,8,Rl),e("div",Wl,d(L(v).nativeToken.label),1)])):$("v-if",!0),i.selectedMultisigAddress!=null?(m(),p("div",Dl,[e("div",Ol,d(l.$t("general.lockFundTxFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(i.lockFundTxFee??0)},null,8,zl),e("div",Xl,d(L(v).nativeToken.label),1)])):$("v-if",!0),Zl,e("div",Ql,[Gl,e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(i.totalFee)},null,8,Jl),e("div",Yl,d(L(v).nativeToken.label),1)])],64))}}),ts=W(es,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/TransferTxnSummary.vue"]]),ls={class:"w-10/12 ml-auto mr-auto mt-5"},ss={class:"border filter shadow-lg xl:grid xl:grid-cols-3 mt-8"},as={class:"xl:col-span-2 p-12"},ns={key:0,class:"mb-3 rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},os={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},is={class:"inline-block text-xs"},rs={class:"text-sm font-semibold"},cs=e("div",{class:"text-blue-primary font-semibold uppercase mt-3 text-xxs"},"Transfer to",-1),us={class:"flex mt-1 gap-1 items-center"},ds={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},ms={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},vs={key:2,class:"h-3"},ps={key:3,class:"mb-5"},fs={for:"encryptedMsg",class:"cursor-pointer font-bold ml-4 mr-5 text-tsm"},gs={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},bs={class:"font-semibold text-xs text-white mb-1.5"},hs=["disabled"],ys={class:"text-center"},xs="^[0-9A-Za-z]{40}$",_s="^[0-9A-Za-z-]{46}$",ws="^[^ ]{8,}$",ks=R({__name:"ViewTransfer",setup(i){const y=me(),{t:g}=qe(),f=y.appContext.config.globalProperties.emitter,l=T(null),o=T(null),n=T(!1),h=T(""),M=T(!1),k=T(!1),_=T(""),b=T(!0),r=T(!0),x=T([]),c=T([]),a=T("0"),w=T(0),F=T(""),I=T(""),V=T(0),N=H(()=>!(_.value.match(ws)&&!b.value&&!A.value&&q.value<Q.value&&B.value)),B=H(()=>!(k.value&&M.value&&q.value>0&&r.value));z(c,t=>{for(let s=0;s<t.length;s++)isNaN(parseFloat(t[s].amount))&&(t[s].amount="0")},{deep:!0}),z(a,t=>{isNaN(parseFloat(t))&&(a.value="0")});const A=H(()=>o.value?l.value?parseFloat(a.value)>w.value||!c.value.every(t=>parseFloat(t.amount)<=t.balance)?!0:ee.value>V.value:ee.value>w.value||!c.value.every(t=>parseFloat(t.amount)<=t.balance):!1),q=H(()=>I.value.length==0?0:M.value?Z.getFakeEncryptedMessageSize(I.value):Z.getPlainMessageSize(I.value)),Q=H(()=>{var t;return((t=se)==null?void 0:t.currentNetworkProfileConfig.maxMessageSize)-1}),G=H(()=>{var t;return D.convertToExact((t=se)==null?void 0:t.currentNetworkProfileConfig.lockedFundsPerAggregate,v.nativeToken.divisibility)}),J=H(()=>se.currentNetworkProfile?D.convertToExact(Z.getLockFundFee(),v.nativeToken.divisibility):0),Y=H(()=>{if(!o.value)return 0;let t=v.nativeToken.divisibility;return l.value?D.convertNumberMinimumFormat(w.value,t):D.convertNumberMinimumFormat(w.value-K.value,t)}),ee=H(()=>{let t=v.nativeToken.divisibility;return l.value?t==0?Math.trunc(K.value+J.value+G.value):Math.round((K.value+J.value+G.value)*Math.pow(10,t))/Math.pow(10,t):t==0?Math.trunc(parseFloat(a.value.replace(/,/g,""))+K.value):Math.round((parseFloat(a.value.replace(/,/g,""))+K.value)*Math.pow(10,t))/Math.pow(10,t)}),K=H(()=>{const t=c.value.map(s=>({id:s.id,amount:s.amount}));return t.push({id:v.nativeToken.assetId,amount:a.value}),l.value?ae.calculateAggregateFee(I.value,a.value,t,M.value):o.value?ae.calculateFee(I.value,a.value,t,M.value):0}),re=()=>{a.value=Y.value.toString(),a.value=Y.value.toString()},Me=Ke(),Fe=Ue(),Pe=async()=>{if(!await ae.createTransaction(h.value,a.value,I.value,c.value.map(s=>({id:s.id,amount:parseFloat(s.amount),divisibility:s.divisibility})),_.value,o.value,l.value,M.value,F.value)){Me.add({severity:"error",summary:"Error",detail:"Password is incorrect",group:"br-custom",life:1e3});return}Fe.push({name:"ViewAccountPendingTransactions",params:{address:o.value}})},Ve=async()=>{if(v.chainAPI)try{const t=await v.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(o.value)),s=t.mosaics.findIndex(P=>P.id.toHex()==v.nativeToken.assetId);s!=-1?(V.value=t.mosaics[s].amount.compact()/Math.pow(10,v.nativeToken.divisibility),t.mosaics.splice(s,1)):V.value=0}catch{V.value=0}},pe=async t=>{if(v.chainAPI&&t){x.value=[];try{const s=await v.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(t)),P=s.mosaics.findIndex(j=>j.id.toHex()==v.nativeToken.assetId);P!=-1?(w.value=s.mosaics[P].amount.compact()/Math.pow(10,v.nativeToken.divisibility),s.mosaics.splice(P,1)):w.value=0;for(let j=0;j<s.mosaics.length;j++){const oe=s.mosaics[j];x.value.push({id:oe.id.toHex(),balance:oe.amount.compact(),divisibility:0,namespace:"",hasUpdated:!1})}}catch{x.value=[],w.value=0}}};z([o,l],async([t,s])=>{x.value=[],c.value=[],t==null&&(w.value=0),t!=null&&s==null?(V.value=0,await pe(t)):t!=null&&s!=null&&(await Ve(),await pe(s))}),f.on("select-account",t=>{o.value=t}),f.on("select-multisig-account",t=>{l.value=t});const Se=t=>{n.value=!1,h.value=t.data},Ne=H(()=>{const t=E.currentLoggedInWallet;if(!t)return[];const s=[...t.accounts,...t.others];return t.contacts.length?[{key:"0",label:g("general.ownerAcc"),selectable:!1,children:s.map((P,j)=>({key:"0-"+j.toString(),label:P.name,data:u.Address.createFromRawAddress(P.address).pretty(),selectable:!0}))},{key:"1",label:g("general.contact"),selectable:!1,children:t.contacts.map((P,j)=>({key:"1-"+j.toString(),label:P.name,data:u.Address.createFromRawAddress(P.address).pretty(),selectable:!0}))}]:[{key:"0",label:g("general.ownerAcc"),selectable:!1,children:s.map((P,j)=>({key:"0-"+j.toString(),label:P.name,data:u.Address.createFromRawAddress(P.address).pretty(),selectable:!0}))}]});z([h,b],t=>{if(t[0].match(_s)||t[0].match(xs)){if(!t[1]){Le();return}fe()}else b.value=!0});const Le=()=>{v.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(h.value)).then(t=>{k.value=t.publicKey=="0".repeat(64)}).catch(t=>k.value=!0)},Ce=()=>{try{u.PublicAccount.createFromPublicKey(F.value,v.networkType).address.plain()==u.Address.createFromRawAddress(h.value).plain()&&(r.value=!1)}catch{r.value=!0}},fe=()=>{if(E.currentLoggedInWallet)try{let t=D.createAddress(h.value);D.checkAddressNetwork(t,v.networkType)?b.value=!1:b.value=!0}catch{try{let s=D.createNamespaceId(h.value);v.chainAPI.namespaceAPI.getLinkedAddress(s).then(P=>{h.value=P.plain(),b.value=!1}).catch(P=>{b.value=!0})}catch{b.value=!0}}};return(t,s)=>{const P=X("Sidebar"),j=X("font-awesome-icon"),oe=X("router-link"),ge=Ae("debounce");return m(),p("div",null,[C(P,{visible:n.value,"onUpdate:visible":s[0]||(s[0]=S=>n.value=S),baseZIndex:1e4,position:"full"},{default:U(()=>[C(We,{contacts:Ne.value,onNodeSelect:Se},null,8,["contacts"])]),_:1},8,["visible"]),e("div",ls,[e("div",ss,[e("div",as,[A.value?(m(),p("div",ns,[e("div",os,[C(j,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),e("div",is,d(t.$t("general.insufficientBalance")),1)])):$("v-if",!0),e("div",rs,d(t.$t("transfer.newTransfer")),1),C(ot),C(yt,{class:"md:mt-3","selected-address":o.value},null,8,["selected-address"]),cs,e("div",us,[te(C(ye,{placeholder:t.$t("transfer.transferPlaceholder"),modelValue:h.value,"onUpdate:modelValue":s[1]||(s[1]=S=>h.value=S),showError:b.value},null,8,["placeholder","modelValue","showError"]),[[ge,fe,"1000"]]),e("div",{onClick:s[2]||(s[2]=S=>n.value=!n.value),class:"border rounded-md cursor-pointer flex flex-col justify-center p-1.5"},[C(j,{icon:"id-card-alt",class:"text-blue-primary ml-auto mr-auto"}),e("div",ds,d(t.$t("general.select")),1),e("div",ms,d(t.$t("general.contact")),1)])]),(m(!0),p(le,null,de(c.value,(S,O)=>{var be;return m(),p("div",{key:O},[C(Vt,{class:"mt-3","asset-options":x.value,index:O,"selected-assets":c.value},null,8,["asset-options","index","selected-assets"]),((be=c.value[O].id)==null?void 0:be.length)==16?(m(),ue(he,{key:0,class:"mt-3",modelValue:c.value[O].amount,"onUpdate:modelValue":Be=>c.value[O].amount=Be,placeholder:t.$t("transfer.assetAmount"),type:"text",decimal:c.value[O].divisibility},null,8,["modelValue","onUpdate:modelValue","placeholder","decimal"])):$("v-if",!0)])}),128)),c.value.length!=x.value.length?(m(),p("button",{key:1,class:"my-2 font-semibold text-xs text-blue-primary outline-none focus:outline-none disabled:opacity-50",onClick:s[3]||(s[3]=S=>c.value.push({id:null,balance:0,amount:"0",namespace:"",divisibility:0}))}," + "+d(t.$t("transfer.addAssets")),1)):(m(),p("div",vs)),C(he,{modelValue:a.value,"onUpdate:modelValue":s[4]||(s[4]=S=>a.value=S),balance:w.value,placeholder:t.$t("transfer.transferAmount"),logo:!0,type:"text",onClickedMaxAvailable:s[5]||(s[5]=S=>re()),decimal:6},null,8,["modelValue","balance","placeholder"]),C(Ot,{modelValue:I.value,"onUpdate:modelValue":s[6]||(s[6]=S=>I.value=S),limit:Q.value,placeholder:t.$t("general.message"),"current-bytes":q.value},null,8,["modelValue","limit","placeholder","current-bytes"]),b.value?$("v-if",!0):(m(),p("div",ps,[te(e("input",{id:"encryptedMsg",type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=S=>M.value=S)},null,512),[[Re,M.value]]),e("label",fs,d(t.$t("transfer.enableEncryption")),1)])),!b.value&&k.value&&M.value&&q.value>0?te((m(),ue(ye,{key:4,placeholder:"Recipient Public Key",modelValue:F.value,"onUpdate:modelValue":s[8]||(s[8]=S=>F.value=S),showError:r.value},null,8,["modelValue","showError"])),[[ge,Ce,"1000"]]):$("v-if",!0)]),e("div",gs,[C(ts,{"signer-native-token-balance":V.value,"native-amount":a.value,"native-token-balance":w.value,"lock-fund":G.value,"lock-fund-tx-fee":J.value,"selected-multisig-address":l.value,"txn-fee":K.value,"total-fee":ee.value,"selected-assets":c.value},null,8,["signer-native-token-balance","native-amount","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee","selected-assets"]),e("div",bs,d(t.$t("general.enterPasswordContinue")),1),C(De,{placeholder:t.$t("general.enterPassword"),errorMessage:t.$t("general.passwordRequired"),modelValue:_.value,"onUpdate:modelValue":s[9]||(s[9]=S=>_.value=S),icon:"lock",class:"mt-5 mb-3"},null,8,["placeholder","errorMessage","modelValue"]),e("button",{type:"submit",class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",disabled:N.value,onClick:s[10]||(s[10]=S=>Pe())},d(t.$t("general.transfer")),9,hs),e("div",ys,[C(oe,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white underline"},{default:U(()=>[$e(d(t.$t("general.cancel")),1)]),_:1})])])])])])}}}),Vs=W(ks,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/views/ViewTransfer.vue"]]);export{Vs as default};
