import"./vue-86063517.js";import{A as o,_ as R}from"./index-5f2b4e3e.js";import{d as r}from"./tsjs-xpx-chain-sdk-84426b6a.js";import{f as g,g as B}from"./primevue-e09f7e84.js";import{I as X}from"./InputId-29c05412.js";import{l as D}from"./rxjs-1250b26d.js";import{d as O,r as x,c as U,w as N,B as F,C as j,o as y,z as k,A as s,D as G,e as b,p as z,b as L,m as p,l as q,a as d,bf as u,g as h}from"./@vue-a9ecc9f1.js";import"./@js-joda-d98eb16f.js";import"./vue-router-21fffbbf.js";import"./crypto-js-e64ac54c.js";import"./crypto-browserify-4fd8cccd.js";import"./randombytes-685e9383.js";import"./node-stdlib-browser-23a8bc7f.js";import"./buffer-6d367910.js";import"./base64-js-50a5cdf9.js";import"./ieee754-44f7831e.js";import"./process-2209b2b3.js";import"./safe-buffer-c463177b.js";import"./create-hash-92c04a28.js";import"./inherits-804453d8.js";import"./md5.js-8d474739.js";import"./hash-base-bb85fc42.js";import"./readable-stream-2241ee9e.js";import"./events-86ccc6d8.js";import"./util-06f7ff32.js";import"./is-arguments-86164331.js";import"./has-tostringtag-7c6352d6.js";import"./has-symbols-cd7870b9.js";import"./call-bind-9e7f09da.js";import"./get-intrinsic-f35014ba.js";import"./has-proto-8ede3a55.js";import"./function-bind-68631a08.js";import"./has-ab8e2922.js";import"./is-generator-function-06dfaf9d.js";import"./which-typed-array-cf6b6a29.js";import"./for-each-f57c5052.js";import"./is-callable-7492318c.js";import"./available-typed-arrays-61974ec7.js";import"./gopd-bab4d6bd.js";import"./is-typed-array-037eef20.js";import"./util-deprecate-c3aabb3c.js";import"./string_decoder-ef7b01fe.js";import"./ripemd160-58dcfa02.js";import"./sha.js-cea3da2e.js";import"./cipher-base-aee0e03d.js";import"./stream-browserify-7496a08f.js";import"./create-hmac-e8b5ea4a.js";import"./browserify-sign-a708a95f.js";import"./browserify-rsa-bfbdcbb6.js";import"./bn.js-1ae23332.js";import"./elliptic-75e883ee.js";import"./minimalistic-assert-4cc49674.js";import"./minimalistic-crypto-utils-6f869a51.js";import"./brorand-03f0f79d.js";import"./hash.js-4f5dfe73.js";import"./hmac-drbg-87799258.js";import"./parse-asn1-465c125b.js";import"./asn1.js-405e93e4.js";import"./safer-buffer-2ac6237e.js";import"./evp_bytestokey-e91543fa.js";import"./browserify-aes-ce20a0e6.js";import"./buffer-xor-87a7236a.js";import"./pbkdf2-e2ae8643.js";import"./browserify-cipher-c4c37ca3.js";import"./browserify-des-3f7e64d9.js";import"./des.js-d262604a.js";import"./diffie-hellman-c8260aab.js";import"./miller-rabin-de27bf02.js";import"./create-ecdh-ffe720e9.js";import"./public-encrypt-fc0568a2.js";import"./randomfill-2874e5f1.js";import"./mathjs-2a513dae.js";import"./@babel-484168fe.js";import"./typed-function-4896e4f1.js";import"./decimal.js-d133ee8e.js";import"./complex.js-cf2520e8.js";import"./fraction.js-39e7906a.js";import"./javascript-natural-sort-c4dd0c27.js";import"./escape-latex-c8a96e7a.js";import"./seedrandom-c8f991ad.js";import"./tiny-emitter-56d49cfd.js";import"./js-sha3-d7d4f583.js";import"./crypto-random-string-d158262e.js";import"./jose-92e5544c.js";import"./vue-i18n-728f748b.js";import"./@intlify-16888cd3.js";import"./vue-loading-overlay-b89251b1.js";import"./jspdf-30014160.js";import"./fflate-8981c52c.js";import"./vue-debounce-3bbbf8c6.js";import"./mitt-f7ef348c.js";/* empty css                   */import"./maska-6f10db43.js";import"./@fortawesome-014b81f2.js";import"./vue3-blocks-tree-e53499e3.js";import"./@noble-f8eff84a.js";import"./utf8-c941a4a0.js";import"./bip39-936aefa9.js";import"./axios-b48d2c29.js";import"./flatbuffers-edc4f8d7.js";import"./ws-0a714537.js";import"./tslib-8dbab242.js";import"./icon-red-x-a5511f99.js";import"./icon-green-tick-1b766454.js";const K={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5 border-2 p-3"},W={class:"flex text-xs flex-wrap font-semibold gap-3 mb-3"},J={key:0,class:"text-sm text-blue-primary"},Q={key:2,class:"flex justify-center"},Y=["disabled"],Z={class:"flex"},ee={class:"mr-1"},te={class:"text-blue-primary"},ie={class:"flex"},ae={class:"mr-1"},oe={class:"text-blue-primary"},se={class:"flex"},re={class:"mr-1"},me=s("button",{class:"blue-btn py-2 px-3"},"Exchange",-1),ne=O({__name:"ViewExchangeListing",setup(ce){const l=x(""),P=x(!0),E=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],S=t=>t.substring(0,4)+"..."+t.substring(t.length-4,t.length+1),A=t=>{const i=E.find(n=>n.namespace==t);return i?i.name:t.length==16?t.substring(0,4)+"...":t},m=x(!1),$=async()=>{try{new r.NamespaceId(l.value).fullName;const t=await o.chainAPI.namespaceAPI.getLinkedMosaicId(new r.NamespaceId(l.value));l.value=t.toHex();const i=await o.chainAPI.assetAPI.getMosaic(t),n=await o.chainAPI.assetAPI.getMosaicsNames([t]);m.value=!0;return}catch{m.value=!1}try{const t=new r.MosaicId(l.value.toUpperCase()),i=await o.chainAPI.assetAPI.getMosaic(t),n=await o.chainAPI.assetAPI.getMosaicsNames([t]);m.value=!0}catch{m.value=!1}},a=x("xpx"),M=x([]),H=x([]),_=async()=>{let t=[],i;a.value=="others"&&m.value&&(i=l.value),a.value=="xpx"&&(i=o.nativeToken.assetId),a.value=="metx"&&(i=(await o.chainAPI.namespaceAPI.getLinkedMosaicId(new r.NamespaceId("prx.metx"))).id.toHex());const n=new r.ExchangeSdaHttp(o.nodeFullURL);t=await D(n.getExchangeSdaOffers(r.SdaExchangeOfferType.GET,new r.MosaicId(i)));for(let e=0;e<t.length;e++){const c=await o.chainAPI.assetAPI.getMosaicsNames([t[e].mosaicIdGet,t[e].mosaicIdGive]),I=await o.chainAPI.assetAPI.getMosaics([t[e].mosaicIdGet,t[e].mosaicIdGive]);t[e].mosaicGetName=c[0].names.length?c[0].names[0].name:t[e].mosaicIdGet.toHex(),t[e].mosaicGiveName=c[1].names.length?c[1].names[0].name:t[e].mosaicIdGive.toHex(),t[e].mosaicGetDivisibility=I.find(v=>v.mosaicId.toHex()==t[e].mosaicIdGet.toHex()).divisibility,t[e].mosaicGiveDivisibility=I.find(v=>v.mosaicId.toHex()==t[e].mosaicIdGive.toHex()).divisibility}const w=await o.chainAPI.chainAPI.getBlockchainHeight();M.value=t.map(e=>({owner:e.owner.address.pretty(),idPair:`${e.mosaicIdGive.toHex()}/${e.mosaicIdGet.toHex()}`,deadline:new Date(Date.now()+(e.deadline.compact()-w)*15e3).toLocaleString(),pair:`${A(e.mosaicGiveName)}/${A(e.mosaicGetName)} `,giveAmount:e.currentMosaicGiveAmount.compact()/Math.pow(10,e.mosaicGiveDivisibility),getAmount:e.currentMosaicGetAmount.compact()/Math.pow(10,e.mosaicGetDivisibility),rate:e.initialMosaicGiveAmount.compact()/Math.pow(10,e.mosaicGiveDivisibility)/(e.initialMosaicGetAmount.compact()/Math.pow(10,e.mosaicGetDivisibility))}))},T=async()=>{await f(),await _(),P.value=!0},f=async()=>{let t=[],i;a.value=="others"&&m.value&&(i=l.value),a.value=="xpx"&&(i=o.nativeToken.assetId),a.value=="metx"&&(i=(await o.chainAPI.namespaceAPI.getLinkedMosaicId(new r.NamespaceId("prx.metx"))).id.toHex());const n=new r.ExchangeSdaHttp(o.nodeFullURL);t=await D(n.getExchangeSdaOffers(r.SdaExchangeOfferType.GIVE,new r.MosaicId(i)));for(let e=0;e<t.length;e++){const c=await o.chainAPI.assetAPI.getMosaicsNames([t[e].mosaicIdGet,t[e].mosaicIdGive]),I=await o.chainAPI.assetAPI.getMosaics([t[e].mosaicIdGet,t[e].mosaicIdGive]);t[e].mosaicGetName=c[0].names.length?c[0].names[0].name:t[e].mosaicIdGet.toHex(),t[e].mosaicGiveName=c[1].names.length?c[1].names[0].name:t[e].mosaicIdGive.toHex(),t[e].mosaicGetDivisibility=I.find(v=>v.mosaicId.toHex()==t[e].mosaicIdGet.toHex()).divisibility,t[e].mosaicGiveDivisibility=I.find(v=>v.mosaicId.toHex()==t[e].mosaicIdGive.toHex()).divisibility}const w=await o.chainAPI.chainAPI.getBlockchainHeight();H.value=t.map(e=>({owner:e.owner.address.pretty(),idPair:`${e.mosaicIdGet.toHex()}/${e.mosaicIdGive.toHex()}`,deadline:new Date(Date.now()+(e.deadline.compact()-w)*15e3).toLocaleString(),pair:`${A(e.mosaicGetName)}/${A(e.mosaicGiveName)} `,giveAmount:e.currentMosaicGetAmount.compact()/Math.pow(10,e.mosaicGetDivisibility),getAmount:e.currentMosaicGiveAmount.compact()/Math.pow(10,e.mosaicGiveDivisibility),rate:e.initialMosaicGetAmount.compact()/Math.pow(10,e.mosaicGetDivisibility)/(e.initialMosaicGiveAmount.compact()/Math.pow(10,e.mosaicGiveDivisibility))}))},V=U(()=>[...M.value.map(t=>({type:"Sell",owner:t.owner,idPair:t.idPair,deadline:t.deadline,pair:t.pair,giveAmount:t.giveAmount,getAmount:t.getAmount,rate:t.rate})),...H.value.map(t=>({type:"Buy",owner:t.owner,idPair:t.idPair,deadline:t.deadline,pair:t.pair,giveAmount:t.giveAmount,getAmount:t.getAmount,rate:t.rate}))].sort((t,i)=>new Date(i.deadline).getTime()-new Date(t.deadline).getTime()));N(a,async t=>{t=="others"&&!m.value?P.value=!1:(await _(),await f())});const C=N(o,async t=>{t.isReady&&(await _(),await f(),C())},{immediate:!0});return(t,i)=>{const n=F("router-link"),w=j("debounce");return y(),k("div",null,[s("div",K,[s("div",W,[s("button",{onClick:i[0]||(i[0]=e=>a.value="xpx"),class:G([`${a.value=="xpx"?"border-b-2  text-blue-primary border-blue-primary":""}`,"w-12 text-center py-3 word-break"])},"XPX",2),s("button",{onClick:i[1]||(i[1]=e=>a.value="metx"),class:G([`${a.value=="metx"?"border-b-2  text-blue-primary border-blue-primary":""}`,"w-12 text-center py-3 word-break"])},"METX",2),s("button",{onClick:i[2]||(i[2]=e=>a.value="others"),class:G([`${a.value=="others"?"border-b-2  text-blue-primary border-blue-primary":""}`,"w-12 text-center py-3 word-break"])},"OTHERS",2)]),a.value=="others"?(y(),k("div",J,"Input Asset ID/ Namespace")):b("v-if",!0),a.value=="others"?z((y(),L(X,{key:1,class:"mt-3",modelValue:l.value,"onUpdate:modelValue":i[3]||(i[3]=e=>l.value=e),"show-error":!m.value},null,8,["modelValue","show-error"])),[[w,$,"1000"]]):b("v-if",!0),a.value=="others"?(y(),k("div",Q,[s("button",{disabled:!m.value,onClick:i[4]||(i[4]=e=>T()),class:"disabled:opacity-50 bg-blue-primary my-3 px-6 py-1.5 rounded-lg text-white font-semibold"},"Search listing",8,Y)])):b("v-if",!0),P.value||a.value!="others"?(y(),L(u(B),{key:3,value:V.value,paginator:!0,rows:10,responsiveLayout:"scroll",scrollDirection:"horizontal",alwaysShowPaginator:!1,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",class:"w-full"},{empty:p(()=>[q(" No exchanges found. ")]),default:p(()=>[d(u(g),{field:"deadline",header:"Deadline"}),d(u(g),{field:"type",header:"Type"},{body:p(({data:e})=>[s("div",{class:G(e.type=="Sell"?"text-red-500":"text-green-500")},h(e.type),3)]),_:1}),d(u(g),{field:"rate",header:"Price"},{body:p(({data:e})=>[s("div",Z,[s("div",ee,h(e.rate),1),s("div",te,h(e.pair),1)])]),_:1}),d(u(g),{field:"giveAmount",header:"SDA Amount"},{body:p(({data:e})=>[s("div",ie,[s("div",ae,h(e.giveAmount),1),s("div",oe,h(e.pair.split("/")[0]),1)])]),_:1}),d(u(g),{field:"getAmount",header:`${a.value.toUpperCase()} Amount`},{body:p(({data:e})=>[s("div",se,[s("div",re,h(e.getAmount),1),b(` <div class="text-blue-primary">{{  data.pair.split('/')[1]  }}</div> `)])]),_:1},8,["header"]),d(u(g),{field:"owner",header:"Maker"},{body:p(({data:e})=>[s("div",null,h(S(e.owner)),1)]),_:1}),d(u(g),{header:"Action"},{body:p(({data:e})=>[d(n,{to:{name:"ViewExchange",query:{p:e.idPair,o:e.owner,t:e.type}}},{default:p(()=>[me]),_:2},1032,["to"])]),_:1})]),_:1},8,["value"])):b("v-if",!0)])])}}}),ri=R(ne,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/services/submodule/exchange/ViewExchangeListing.vue"]]);export{ri as default};
