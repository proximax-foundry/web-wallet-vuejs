import{d as H,r as N,o as b,f as x,l,b as n,s as w,t as f,v,e as d,i as T,_ as V,g as M,c as C,w as h,A as g,D as S,x as i}from"./index-49f5eac9.js";import{_ as D}from"./icon-plus-7207f329.js";import{a as I,A as E,_ as R}from"./AccountTabs.vue_vue_type_script_setup_true_lang-c57c1e13.js";import{s as P,a as $}from"./column.esm-ea5445c4.js";import{U as W}from"./UTF8-18787633.js";import"./jdenticon-module-80457c6f.js";import"./functions-fa076abc.js";import"./TextInput-2430a15b.js";import"./TextInputClean-ae76feb7.js";import"./icon-key-5b3f7dda.js";const F={class:"flex"},Q={key:0,class:"ml-3 text-gray-400 font-semibold"},B={key:0,class:"flex"},O={class:"text-xs"},Z=H({__name:"AccountMetadataDatatable",props:{accMetadata:Array,publicKey:String},setup(u){return(p,a)=>{const m=N("router-link");return b(),x("div",null,[l(v($),{value:u.accMetadata,paginator:!0,rows:10,dataKey:"id",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink  RowsPerPageDropdown",rowsPerPageOptions:[10,20,30,40,50],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",responsiveLayout:"scroll"},{empty:n(()=>[w(f(p.$t("general.noRecord")),1)]),loading:n(()=>[w(f(p.$t("dashboard.fetchingTx")),1)]),default:n(()=>[l(v(P),{field:"scopedMetadataKey",header:"Scoped Metadata Key"},{body:n(({data:s})=>[d("div",F,[d("div",null,f(s.scopedMetadataKeyHex),1),s.scopedMetadataKeyUtf8?(b(),x("div",Q,"hex")):T("",!0)]),s.scopedMetadataKeyUtf8?(b(),x("div",B,[d("div",null,f(s.scopedMetadataKeyUtf8),1),a[0]||(a[0]=d("div",{class:"ml-3 text-gray-400 font-semibold"},"utf-8",-1))])):T("",!0)]),_:1}),l(v(P),{field:"currentValue",header:"Current Value"},{body:n(({data:s})=>[d("span",O,f(s.value),1)]),_:1}),l(v(P),{field:"action",header:"Action"},{body:n(({data:s})=>[l(m,{to:{name:"ViewUpdateAccountMetadata",params:{targetPublicKey:u.publicKey,scopedMetadataKey:s.scopedMetadataKeyUtf8?s.scopedMetadataKeyUtf8:s.scopedMetadataKeyHex}}},{default:n(()=>a[1]||(a[1]=[d("img",{src:I,title:"Update Metadata",class:"inline-block w-3 h-3 text-black cursor-pointer ml-1"},null,-1)])),_:2},1032,["to"])]),_:1})]),_:1},8,["value"])])}}});const z=V(Z,[["__scopeId","data-v-cc8d5c31"]]),j={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},q={class:"border-2 border-t-0"},de=H({__name:"ViewAccountMetadata",props:{address:String},setup(u){const p=u;M(0);const a=C(()=>{if(!h.currentLoggedInWallet)return null;let e=h.currentLoggedInWallet.accounts.find(t=>t.address==p.address)||h.currentLoggedInWallet.others.find(t=>t.address==p.address);return e||null});C(()=>a.value?a.value.getDirectParentMultisig().length>0:!1);const m=M([]);M([]),M([]);const s=e=>new Promise(t=>setTimeout(t,e)),L=async()=>{if(!a.value)return;let e=new i.MetadataQueryParams;e.metadataType=i.MetadataType.ACCOUNT,e.pageSize=100,e.pageNumber=1,e.targetKey=i.PublicAccount.createFromPublicKey(a.value.publicKey,g.networkType);let t=await g.chainAPI.metadataAPI.searchMetadatas(e);for(let o=0;o<t.metadataEntries.length;o++){let r=t.metadataEntries;m.value.push({scopedMetadataKeyUtf8:r[o].scopedMetadataKey.toHex()==_(r[o].scopedMetadataKey.toHex())?null:_(r[o].scopedMetadataKey.toHex()),scopedMetadataKeyHex:r[o].scopedMetadataKey.toHex(),value:r[o].value})}let K=t.pagination.totalPages;await s(250);for(let o=2;o<=K;o++){let r=new i.MetadataQueryParams;r.metadataType=i.MetadataType.ACCOUNT,r.pageSize=100,r.pageNumber=o,r.targetKey=a.value.publicKey;let k=await g.chainAPI.metadataAPI.searchMetadatas(r);for(let c=0;c<k.metadataEntries.length;c++){let y=k.metadataEntries;m.value.push({scopedMetadataKeyUtf8:y[c].scopedMetadataKey.toHex()==_(y[c].scopedMetadataKey.toHex())?null:_(y[c].scopedMetadataKey.toHex()),scopedMetadataKeyHex:y[c].scopedMetadataKey.toHex(),value:y[c].value}),await s(250)}}},A=e=>(e.endsWith("00")&&(e=e.substring(0,e.length-2),e=A(e)),e),_=e=>{e=A(e);let t=i.Convert.hexToUint8(e);return W.isNotUTF8(t)||(e=i.Convert.decodeHexToUtf8(e)),e},U=async()=>{L()};if(g.isReady)U();else{let e=S(g,t=>{t.isReady&&(U(),e())})}return(e,t)=>{const K=N("router-link");return b(),x("div",null,[d("div",j,[l(E,{address:u.address,class:"mb-6"},null,8,["address"]),l(R,{address:u.address,selected:"metadata"},null,8,["address"]),d("div",q,[l(z,{publicKey:a.value?a.value.publicKey:"0".repeat(64),accMetadata:m.value},null,8,["publicKey","accMetadata"]),l(K,{to:{name:"ViewUpdateAccountMetadata",params:{targetPublicKey:a.value?a.value.publicKey:"0".repeat(64)}}},{default:n(()=>t[0]||(t[0]=[d("button",{class:"mx-6 my-4 blue-btn py-3 px-3 flex items-center"},[d("img",{src:D,class:"inline-block w-4 h-4 mr-2"}),w("Create New Account Metadata")],-1)])),_:1},8,["to"])])])])}}});export{de as default};
