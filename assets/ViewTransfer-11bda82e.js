import{d as U,I as ke,c as H,w as q,r as T,k as K,o as u,b as m,f as P,s as F,z as R,e,t as i,C as L,i as ne,O as Ae,a as Z,m as de,A as d,E as v,P as $e,Q as ee,l as Te,_ as Me,B as Ie,F as te,R as Ue,S as Re,U as De,W as ue,n as le,V as G,h as me,T as Oe,u as je,H as O,D as We,q as ze,X as Xe}from"./index-6032540d.js";import{t as ve}from"./jdenticon-module-14e7ce04.js";import{_ as Ze}from"./SelectAccountAndContact.vue_vue_type_script_setup_true_lang-ac7f81db.js";import{_ as pe}from"./proximax-logo-ecfc3767.js";import{_ as Ge}from"./PasswordInput.vue_vue_type_script_setup_true_lang-df65fbea.js";import{_ as Qe}from"./icon-red-x-a5511f99.js";import{_ as Je}from"./icon-green-tick-1b766454.js";const Ye={class:"w-full"},et={key:0,class:"text-blue-primary font-semibold uppercase text-xxs"},tt={key:0,class:"account-item-value account-item"},lt={class:"flex"},st=["innerHTML"],at={class:"flex flex-col ml-2 text-left"},nt=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Account to create / initiate transfer",-1),ot={class:"mt-2 text-tsm font-bold"},it={class:"account-item"},rt={class:"flex"},ct=["innerHTML"],ut={class:"text-xs ml-2 font-semibold"},dt=U({__name:"SelectInputAccount",emits:["select-account","update:modelValue"],setup(n){const p=ne().appContext.config.globalProperties.emitter;let o=new ke("ThemeStyleConfig");o.init();let l=o.jdenticonConfig;const r=H(()=>q.currentLoggedInWallet?[...q.currentLoggedInWallet.accounts.filter(h=>h.multisigInfo.length==0||h.multisigInfo.find(g=>g.level==0).cosignaturies.length==0)].map(h=>({value:h.address,label:q.currentLoggedInWallet.convertAddressToName(h.address,!0)})):[]),s=T(null),b=T(null),k=(y,h)=>{if(y==null&&h==null){s.value=null,p.emit("select-account",null);return}p.emit("select-account",h),s.value.label=y,s.value.value=h,b.value=ve(h,25,l)};return(y,h)=>{const g=K("Dropdown");return u(),m("div",Ye,[s.value?P("",!0):(u(),m("div",et,"Select Account to create / initiate transfer")),F(g,{modelValue:s.value,"onUpdate:modelValue":h[0]||(h[0]=f=>s.value=f),style:{width:"100%"},options:r.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",placeholder:"Select Account",onChange:h[1]||(h[1]=f=>{var x,_,M,w;k((x=f.value)==null?void 0:x.label,(_=f.value)==null?void 0:_.value),y.$emit("update:modelValue",(M=f.value)==null?void 0:M.value),y.$emit("select-account",(w=f.value)==null?void 0:w.value)})},{value:R(f=>[f.value?(u(),m("div",tt,[e("div",lt,[e("div",{innerHTML:b.value},null,8,st),e("div",at,[nt,e("div",ot,i(f.value.label),1)])])])):P("",!0)]),option:R(f=>[e("div",it,[e("div",rt,[e("div",{innerHTML:L(ve)(f.option.value,20,L(l))},null,8,ct),e("div",ut,i(f.option.label),1)])])]),_:1},8,["modelValue","options"])])}}}),mt={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},vt={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},pt=U({__name:"SelectInputMultisigAccount",props:{selectedAddress:{type:String,required:!1}},emits:["select-multisig-account","update:modelValue"],setup(n){const c=n,p=T(!1),{selectedAddress:o}=Ae(c),l=T([]),s=ne().appContext.config.globalProperties.emitter;Z(o,k=>{if(k==null){l.value=[];return}const y=q.currentLoggedInWallet.accounts.find(g=>g.address==k),h=y.multisigInfo.find(g=>g.level==0);l.value=h?[...y.multisigInfo].filter(g=>g.level<0).map(g=>{const x=[...q.currentLoggedInWallet.accounts,...q.currentLoggedInWallet.others].find(_=>_.publicKey==g.publicKey);return{label:x?q.currentLoggedInWallet.convertAddressToName(x.address):d.PublicAccount.createFromPublicKey(g.publicKey,v.networkType).address.plain(),value:d.PublicAccount.createFromPublicKey(g.publicKey,v.networkType).address.plain()}}):[]});const b=k=>{s.emit("update:modelValue",k==null?void 0:k.value),s.emit("select-multisig-account",k),p.value=!1};return(k,y)=>{const h=K("font-awesome-icon"),g=K("Tree"),f=K("Sidebar");return u(),m("div",null,[l.value.length&&!p.value&&L(o)?(u(),m("button",{key:0,class:"border rounded-md cursor-pointer flex flex-col justify-center p-1.5",onClick:y[0]||(y[0]=x=>p.value=!0)},[F(h,{icon:"id-card-alt",class:"text-blue-primary ml-auto mr-auto"}),e("div",mt,i(k.$t("general.select")),1),e("div",vt,i(k.$t("general.multisig")),1)])):P("",!0),F(f,{visible:p.value,"onUpdate:visible":y[1]||(y[1]=x=>p.value=x),baseZIndex:1e4,position:"full"},{default:R(()=>[p.value&&l.value.length?(u(),de(g,{key:0,showClear:!0,style:{width:"100%"},value:l.value,filter:!0,selectionMode:"single",filterFields:["label","value"],emptyFilterMessage:" ",onNodeSelect:b},null,8,["value"])):P("",!0)]),_:1},8,["visible"])])}}}),gt={class:"w-full mt-0 border border-gray-200 px-2 py-2 rounded-md"},ft={class:"flex"},bt=["innerHTML"],yt={class:"flex flex-col ml-2 text-left"},ht={class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}},_t={class:"mt-2 text-tsm font-bold"},xt={class:"ml-auto mt-auto mb-auto mr-6"},wt=U({__name:"MultisigInput",props:{selectDefaultAddress:{type:String,required:!0},selectDefaultName:{type:String,required:!0}},setup(n){const c=n,o=ne().appContext.config.globalProperties.emitter;let l=new ke("ThemeStyleConfig");l.init();let r=T(l.jdenticonConfig);const s=H(()=>ve(c.selectDefaultAddress,25,r.value)),b=()=>{o.emit("CLOSE_MULTISIG")};return(k,y)=>{const h=K("font-awesome-icon");return u(),m("div",gt,[e("div",ft,[e("div",{innerHTML:s.value},null,8,bt),e("div",yt,[e("div",ht,i(k.$t("transfer.transferFrom"))+" "+i(k.$t("general.multisig")),1),e("div",_t,i(n.selectDefaultName),1)]),e("div",xt,[F(h,{icon:"times",class:"delete-icon-style",onClick:y[0]||(y[0]=g=>b())})])])])}}}),kt={key:0},At={class:"flex justify-between"},$t={class:"flex flex-col ml-2 text-left"},Tt=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Asset",-1),Mt={class:"mt-1 text-tsm font-bold"},It={class:"mt-1 text-tsm font-bold"},Ft={class:"account-item"},Pt={class:"flex justify-between"},St={class:"mt-1 text-tsm font-bold"},Ct={class:"mt-1 text-tsm font-bold"},Nt=U({__name:"SelectInputAsset",props:{index:{type:Number,required:!0},assetOptions:{type:Object,required:!0},selectedAssets:{type:Object,required:!1}},emits:["select-asset","update:modelValue"],setup(n){const c=n,p=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],o=g=>{const f=p.find(x=>x.namespace==g);return f?f.name:g},{assetOptions:l,selectedAssets:r,index:s}=Ae(c),b=T(!1),k=H(()=>{const g=new Set(r.value.map(f=>f.id));return l.value.filter(f=>!g.has(f.id))}),y=async g=>{if(b.value)return;b.value=!0;const{first:f,last:x}=g,_=[];for(let $=f;$<x;$++)l.value[$].hasUpdated||_.push(new d.MosaicId(l.value[$].id));if(!_.length){b.value=!1;return}const M=await v.chainAPI.assetAPI.getMosaicsNames(_),w=await v.chainAPI.assetAPI.getMosaics(_);let A=0,N=0;const E=new Map;M.forEach(($,S)=>{E.set($.mosaicId.toHex(),S)}),w.sort(($,S)=>{const I=E.get($.mosaicId.toHex()),D=E.get(S.mosaicId.toHex());return I-D});for(let $=f;$<x;$++){if(!M[A])continue;const S=l.value.find(I=>I.id==M[A].mosaicId.toHex());S&&(S.namespace=M[A].names.length?M[A].names[0].name:"",S.balance=S.balance/Math.pow(10,w[N].divisibility),S.divisibility=w[N].divisibility,S.hasUpdated=!0,A++,N++)}b.value=!1},h=g=>{if(g==null){r.value.splice(s.value,1);return}r.value[s.value].balance=g.balance,r.value[s.value].id=g.id,r.value[s.value].namespace=g.namespace,r.value[s.value].divisibility=g.divisibility,r.value[s.value].amount="0"};return(g,f)=>{const x=K("Dropdown");return u(),m("div",null,[F(x,{showClear:!0,modelValue:L(r)[L(s)],"onUpdate:modelValue":f[0]||(f[0]=_=>L(r)[L(s)]=_),style:{width:"100%"},options:k.value,filter:!0,filterFields:["id","namespace"],emptyFilterMessage:" ",placeholder:"Select Asset",virtualScrollerOptions:{lazy:!0,onLazyLoad:y,showLoader:!0,loading:b.value,delay:0,itemSize:38},onChange:f[1]||(f[1]=_=>{var M;h(_.value),g.$emit("update:modelValue",(M=_.value)==null?void 0:M.value)})},{value:R(_=>[_.value.id?(u(),m("div",kt,[e("div",At,[e("div",$t,[Tt,e("div",Mt,i(o(_.value.namespace==""?_.value.id:_.value.namespace)),1)]),e("div",It,"Balance: "+i(_.value.balance),1)])])):P("",!0)]),option:R(_=>[e("div",Ft,[e("div",Pt,[e("div",St,i(o(_.option.namespace==""?_.option.id:_.option.namespace)),1),e("div",Ct,"Balance: "+i(_.option.balance),1)])])]),_:1},8,["modelValue","options","virtualScrollerOptions"])])}}}),Vt={class:"border border-gray-200 px-2 py-1 rounded-md"},Lt={class:"flex justify-between"},Et={class:"flex flex-col"},Bt={class:"uppercase font-light text-gray-500 text-txs text-left mb-2"},Ht={class:"flex w-full"},qt={key:0,src:pe,class:"h-5 w-5 mt-0.5"},Kt=["value","data-maska","placeholder"],Ut=["disabled"],Rt=U({__name:"TransferInputClean",props:{modelValue:{type:String,required:!0},decimal:{type:Number,required:!0},placeholder:{type:String,required:!0},toolTip:{type:String,required:!1},disabled:{type:Boolean,required:!1},showError:{type:Boolean,required:!1},logo:{type:Boolean,required:!1},balance:{type:Number,required:!1}},emits:["update:modelValue","show-error","clickedMaxAvailable"],setup(n){const c=n,p=()=>{let l="0";return c.decimal>0&&(l=l+"."+"9".repeat(c.decimal)),l},o={preProcess:l=>l.replace(/,/g,""),postProcess:l=>{if(!l)return"";let r=0;return c.decimal>0&&(r=1+c.decimal-(l.includes(".")?l.length-l.indexOf("."):0)),Intl.NumberFormat("en-US",{minimumFractionDigits:c.decimal}).format(parseFloat(l)).slice(0,r?-r:void 0)}};return(l,r)=>{const s=$e("maska");return u(),m("div",{class:Te(n.disabled?"opacity-50":"")},[e("div",Vt,[e("div",Lt,[e("div",Et,[e("div",Bt,i(n.placeholder),1),e("div",Ht,[n.logo?(u(),m("img",qt)):P("",!0),ee(e("input",{value:n.modelValue,class:"supply_input","data-maska":p(),"data-maska-tokens":"0:\\d:multiple|9:\\d:optional",placeholder:n.placeholder,onInput:r[0]||(r[0]=b=>l.$emit("update:modelValue",parseFloat(b.target.value.replace(/,/g,"")).toString()))},null,40,Kt),[[s,void 0,o]])])]),n.logo?(u(),m("button",{key:0,disabled:n.disabled==!0,class:"w-24 cursor-pointer focus:outline-none text-blue-primary text-xs font-bold",onClick:r[1]||(r[1]=b=>l.$emit("clickedMaxAvailable",!0))},i(l.$t("swap.maxAmount")),9,Ut)):P("",!0)])])],2)}}});const he=Me(Rt,[["__scopeId","data-v-ac217733"]]),Dt={class:"rounded-md bg-white flex border mt-3"},Ot=["value","placeholder"],jt=e("div",{class:"w-1 flex-none"},null,-1),Wt={class:"text-gray-800"},zt=U({__name:"TextAreaInput",props:{modelValue:{type:String,required:!1},currentBytes:{type:Number,required:!0},limit:{type:Number,required:!0},placeholder:{type:String,required:!0}},emits:["update:modelValue"],setup(n){return(c,p)=>(u(),m(te,null,[e("div",Dt,[e("textarea",{value:n.modelValue,onInput:p[0]||(p[0]=o=>c.$emit("update:modelValue",o.target.value)),rows:"2",class:"w-full text-gray-500 px-2 py-1 outline-none bg-white text-xs",placeholder:n.placeholder.toUpperCase()},null,40,Ot),jt]),e("div",{class:Te(["float-right mt-1 text-tsm",n.currentBytes>n.limit?"text-red-500":"text-gray-800"])},[Ie(i(n.currentBytes)+" ",1),e("span",Wt,"/"+i(n.limit),1)],2)],64))}}),Xt={class:"border border-gray-200 px-2 py-2 rounded-md w-full"},Zt={class:"flex gap-2"},Gt={class:"flex flex-col w-full"},Qt={class:"uppercase text-gray-500 font-light text-xxs text-left"},Jt={key:0,class:"flex flex-col ml-auto justify-center mt-1"},Yt=e("img",{src:Qe,class:"h-5 w-5 mr-auto ml-auto"},null,-1),el={class:"text-xxs text-red-400 font-bold uppercase"},tl={key:1,class:"flex flex-col ml-auto justify-center mt-1"},ll=e("img",{src:Je,class:"h-5 w-5 mr-auto ml-auto"},null,-1),sl={class:"text-xxs text-green-400 font-bold uppercase"},_e=U({__name:"FieldValidationInput",props:Ue({placeholder:{},showError:{}},{modelValue:{}}),emits:["update:modelValue"],setup(n){const c=Re(n,"modelValue");return(p,o)=>(u(),m("div",Xt,[e("div",Zt,[e("div",Gt,[e("div",Qt,i(p.placeholder),1),ee(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=l=>c.value=l),class:"w-full font-semibold text-tsm outline-none mt-1"},null,512),[[De,c.value]])]),p.showError&&c.value.length!=0?(u(),m("div",Jt,[Yt,e("div",el,i(p.$t("general.invalid")),1)])):p.showError?P("",!0):(u(),m("div",tl,[ll,e("div",sl,i(p.$t("general.valid")),1)]))])]))}});const Fe="0".repeat(64),xe=d.PublicAccount.createFromPublicKey(Fe,v.networkType).address.plain(),we=(n,c)=>{let p=[];return parseInt(n)>0&&p.push(new d.Mosaic(new d.MosaicId(v.nativeToken.assetId),d.UInt64.fromUint(Number(n)))),c.length>0&&c.forEach(o=>{parseInt(o.amount)>0&&p.push(new d.Mosaic(new d.MosaicId(o.id),d.UInt64.fromUint(Number(o.amount))))}),p},ae=class ae{};ae.createTransaction=async(c,p,o,l,r,s,b,k,y)=>{if(!ue.verifyWalletPassword(q.currentLoggedInWallet.name,le.chainNetworkName,r))return!1;const g=le.currentNetworkProfile.generationHash;let f=v.networkType,x=parseFloat(p)*Math.pow(10,v.nativeToken.divisibility),_=[];x>0&&_.push(new d.Mosaic(new d.MosaicId(v.nativeToken.assetId),d.UInt64.fromUint(Number(x)))),l.length>0&&l.forEach(I=>{I.amount>0&&_.push(new d.Mosaic(new d.MosaicId(I.id),d.UInt64.fromUint(Number(I.amount*Math.pow(10,I.divisibility)))))});let M=v.buildTxn,w,A;if(!b)w=q.currentLoggedInWallet.accounts.find(I=>I.address===s);else{w=q.currentLoggedInWallet.accounts.find(D=>D.address===s);const I=await v.chainAPI.accountAPI.getAccountInfo(d.Address.createFromRawAddress(b));A=d.PublicAccount.createFromPublicKey(I.publicKey,f)}let N=ue.decryptPrivateKey(new d.Password(r),w.encrypted,w.iv),E;if(k&&o.length>0)try{const I=await v.chainAPI.accountAPI.getAccountInfo(d.Address.createFromRawAddress(c));E=d.EncryptedMessage.create(o,I.publicAccount,N)}catch{E=d.EncryptedMessage.create(o,d.PublicAccount.createFromPublicKey(y,v.networkType),N)}else E=d.PlainMessage.create(o);let $=M.transferBuilder().recipient(d.Address.createFromRawAddress(c)).mosaics(_).message(E).build();const S=d.Account.createFromPrivateKey(N,f,1);if(b){let I=q.currentLoggedInWallet.accounts.find(Y=>Y.address==s),D=ue.decryptPrivateKey(new d.Password(r),I.encrypted,I.iv),Q=d.Account.createFromPrivateKey(D,f,1);const j=[$.toAggregateV1(A)],oe=M.aggregateBonded(j),W=Q.preV2Sign(oe,g),J=G.lockFundTx(W),ie=Q.preV2Sign(J,g);G.announceLF_AND_addAutoAnnounceABT(ie,W)}else{const I=S.preV2Sign($,g);G.announceTransaction(I)}return!0},ae.calculateAggregateFee=(c,p,o,l)=>{let r=v.buildTxn,s=we(p,o),k=[r.transferBuilder().recipient(d.Address.createFromRawAddress(xe)).mosaics(s).message(l&&c.length>0?d.EncryptedMessage.create(c,d.PublicAccount.createFromPublicKey("0".repeat(64),v.networkType),"0".repeat(64)):d.PlainMessage.create(c)).build().toAggregateV1(d.PublicAccount.createFromPublicKey(Fe,v.networkType))];return r.aggregateBondedBuilder().innerTransactions(k).build().maxFee.compact()/Math.pow(10,v.nativeToken.divisibility)},ae.calculateFee=(c,p,o,l)=>{let r=v.buildTxn,s=we(p,o);return r.transferBuilder().recipient(d.Address.createFromRawAddress(xe)).mosaics(s).message(l&&c.length>0?d.EncryptedMessage.create(c,d.PublicAccount.createFromPublicKey("0".repeat(64),v.networkType),"0".repeat(64)):d.PlainMessage.create(c)).build().maxFee.compact()/Math.pow(10,v.nativeToken.divisibility)};let se=ae;const al={key:0},nl={class:"font-bold text-xs text-blue-primary uppercase"},ol={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},il={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},rl=["innerHTML"],cl={class:"flex"},ul={class:"ml-1 text-blue-400 font-bold"},dl=e("img",{src:pe,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),ml={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs pt-2"},vl={class:"font-semibold lg:col-span-2 col-span-3"},pl={key:0,class:"lg:col-span-2 col-span-3 ml-auto"},gl=["innerHTML"],fl={class:"ml-1 text-blue-400"},bl={key:0,class:"lg:col-span-4 col-span-6 ml-auto"},yl={key:1,class:"lg:col-span-4 col-span-6 ml-auto"},hl=["index"],_l=e("div",{class:"border-b-2 border-gray-600 my-2"},null,-1),xl={class:"font-bold text-xs text-blue-primary uppercase"},wl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},kl={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},Al=["innerHTML"],$l={class:"flex"},Tl={class:"ml-1 text-blue-400 font-bold"},Ml=e("img",{src:pe,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),Il=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),Fl={key:1,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs pt-2"},Pl={class:"font-semibold lg:col-span-2 col-span-3"},Sl={key:0,class:"lg:col-span-2 col-span-3 ml-auto"},Cl=["innerHTML"],Nl={class:"ml-1 text-blue-400"},Vl={key:0,class:"lg:col-span-4 col-span-6 ml-auto"},Ll={key:1,class:"lg:col-span-4 col-span-6 ml-auto"},El=["index"],Bl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Hl={class:"font-semibold lg:col-span-2 col-span-3"},ql=["innerHTML"],Kl={class:"ml-1 text-blue-400"},Ul={key:3,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs"},Rl={class:"font-semibold lg:col-span-2 col-span-3"},Dl=["innerHTML"],Ol={class:"ml-1 text-blue-400"},jl={key:4,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Wl={class:"font-semibold lg:col-span-2 col-span-3"},zl=["innerHTML"],Xl={class:"ml-1 text-blue-400"},Zl=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),Gl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Ql=e("div",{class:"font-semibold lg:col-span-2 col-span-3 uppercase"},"Total",-1),Jl=["innerHTML"],Yl={class:"ml-1 text-blue-400"},es=U({__name:"TransferTxnSummary",props:{selectedMultisigAddress:{type:String||null},nativeTokenBalance:{type:Number,required:!0},selectedAssets:{type:Array,required:!0},lockFund:{type:Number,required:!0},txnFee:{type:Number,required:!0},lockFundTxFee:{type:Number,required:!0},totalFee:{type:Number,required:!0},nativeAmount:{type:String,required:!0},signerNativeTokenBalance:{type:Number,required:!0}},setup(n){const c=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],p=l=>{const r=c.find(s=>s.namespace==l);return r?r.name:l.length==16?l.substring(0,4)+"..."+l.substring(l.length-4,l.length+1):l},o=l=>{let r=l.toString().split(".");return r[1]!=null?'<span class="font-semibold text-sm">'+r[0]+'</span>.<span class="font-semibold text-xs">'+r[1]+"</span>":'<span class="font-semibold text-sm">'+r[0]+"</span>"};return(l,r)=>(u(),m(te,null,[n.selectedMultisigAddress?(u(),m("div",al,[e("div",nl,i(l.$t("general.multisigAcc")),1),e("div",ol,[e("div",il,i(l.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:o(n.nativeTokenBalance??0)},null,8,rl),e("div",cl,[e("div",ul,i(L(v).nativeToken.label),1),dl])]),e("div",ml,[e("div",vl,i(l.$t("transfer.transferAmount")),1),isNaN(parseFloat(n.nativeAmount))?(u(),m("div",pl,"0")):(u(),m("div",{key:1,class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:o(n.nativeAmount??0)},null,8,gl)),e("div",fl,i(L(v).nativeToken.label),1)]),(u(!0),m(te,null,me(n.selectedAssets,(s,b)=>(u(),m("div",{class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-white text-xs",key:b},[isNaN(parseFloat(s.amount))&&s.id!=null?(u(),m("div",bl,"0")):(u(),m("div",yl,i(s.amount),1)),s.id!=null?(u(),m("div",{key:2,class:"ml-1 text-blue-400",index:b},i(p(s.namespace==""?s.id:s.namespace)),9,hl)):P("",!0)]))),128)),_l])):P("",!0),e("div",xl,i(l.$t("general.signerAcc")),1),e("div",wl,[e("div",kl,i(l.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:o(n.selectedMultisigAddress?n.signerNativeTokenBalance:n.nativeTokenBalance??0)},null,8,Al),e("div",$l,[e("div",Tl,i(L(v).nativeToken.label),1),Ml])]),Il,n.selectedMultisigAddress?P("",!0):(u(),m("div",Fl,[e("div",Pl,i(l.$t("transfer.transferAmount")),1),isNaN(parseFloat(n.nativeAmount))?(u(),m("div",Sl,"0")):(u(),m("div",{key:1,class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:o(n.nativeAmount??0)},null,8,Cl)),e("div",Nl,i(L(v).nativeToken.label),1)])),n.selectedMultisigAddress?P("",!0):(u(!0),m(te,{key:2},me(n.selectedAssets,(s,b)=>(u(),m("div",{class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-white text-xs",key:b},[isNaN(parseFloat(s.amount))&&s.id!=null?(u(),m("div",Vl,"0")):(u(),m("div",Ll,i(s.amount),1)),s.id!=null?(u(),m("div",{key:2,class:"ml-1 text-blue-400",index:b},i(p(s.namespace==""?s.id:s.namespace)),9,El)):P("",!0)]))),128)),e("div",Bl,[e("div",Hl,i(n.selectedMultisigAddress!=null?l.$t("general.aggregateFee"):l.$t("general.transactionFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:o(n.txnFee)},null,8,ql),e("div",Kl,i(L(v).nativeToken.label),1)]),n.selectedMultisigAddress!=null?(u(),m("div",Ul,[e("div",Rl,i(l.$t("general.lockFund")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:o(n.lockFund??0)},null,8,Dl),e("div",Ol,i(L(v).nativeToken.label),1)])):P("",!0),n.selectedMultisigAddress!=null?(u(),m("div",jl,[e("div",Wl,i(l.$t("general.lockFundTxFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:o(n.lockFundTxFee??0)},null,8,zl),e("div",Xl,i(L(v).nativeToken.label),1)])):P("",!0),Zl,e("div",Gl,[Ql,e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:o(n.totalFee)},null,8,Jl),e("div",Yl,i(L(v).nativeToken.label),1)])],64))}}),ts={name:"ConfirmSendModal",props:["toggleModal"],setup(){const c=ne().appContext.config.globalProperties.emitter;return{closeConfirmModal:()=>{c.emit("CLOSE_CONFIRM_SEND_MODAL",!1)},proceedSend:()=>{c.emit("CONFIRM_PROCEED_SEND",!0)}}}},ls={key:0,class:"popup-outer fixed flex z-50"},ss={class:"modal-popup-box"},as={class:"delete-position"},ns={class:"w-92"},os={class:"text-center"},is={class:"mt-3"};function rs(n,c,p,o,l,r){const s=K("font-awesome-icon");return u(),m("div",null,[F(Oe,{"enter-active-class":"animate__animated animate__fadeInDown","leave-active-class":"animate__animated animate__fadeOutUp"},{default:R(()=>[p.toggleModal?(u(),m("div",ls,[e("div",ss,[e("div",as,[F(s,{icon:"times",class:"delete-icon-style",onClick:c[0]||(c[0]=b=>{o.closeConfirmModal()})})]),e("div",ns,[e("div",os,i(n.$t("transfer.proceedWithZero")),1),e("div",is,[e("div",{onClick:c[1]||(c[1]=b=>o.proceedSend()),class:"blue-btn py-2 font-semibold cursor-pointer text-center ml-auto mr-auto w-7/12"},i(n.$t("general.confirm")),1),e("div",{class:"text-center cursor-pointer text-xs font-semibold text-blue-link mt-2",onClick:c[2]||(c[2]=b=>o.closeConfirmModal())},i(n.$t("general.cancel")),1)])])])])):P("",!0)]),_:1}),p.toggleModal?(u(),m("div",{key:0,onClick:c[3]||(c[3]=b=>{o.closeConfirmModal()}),class:"fixed inset-0 bg-opacity-90 bg-gray-100 z-20"})):P("",!0)])}const cs=Me(ts,[["render",rs]]),us={class:"w-10/12 ml-auto mr-auto mt-5"},ds={class:"border filter shadow-lg xl:grid xl:grid-cols-3 mt-8"},ms={class:"xl:col-span-2 p-12"},vs={key:0,class:"mb-3 rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},ps={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},gs={class:"inline-block text-xs"},fs={class:"text-sm font-semibold"},bs={class:"flex gap-1 mt-3"},ys={key:1,class:"mt-3"},hs=e("div",{class:"text-blue-primary font-semibold uppercase mt-3 text-xxs"},"Transfer to",-1),_s={class:"flex mt-1 gap-1 items-center"},xs={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},ws={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},ks={key:3,class:"h-3"},As={key:4,class:"mb-5"},$s={for:"encryptedMsg",class:"cursor-pointer font-bold ml-4 mr-5 text-tsm"},Ts={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},Ms={class:"font-semibold text-xs text-white mb-1.5"},Is=["disabled"],Fs={class:"text-center"},Ps="^[0-9A-Za-z]{40}$",Ss="^[0-9A-Za-z-]{46}$",Cs="^[^ ]{8,}$",Ks=U({__name:"ViewTransfer",setup(n){const c=ne(),{t:p}=je(),o=c.appContext.config.globalProperties.emitter,l=T(null),r=T(null),s=T(null),b=T(!1),k=T(!1),y=T(""),h=T(!1),g=T(!1),f=T(""),x=T(!0),_=T(!0),M=T([]),w=T([]),A=T("0"),N=T(0),E=T(""),$=T(""),S=T(0),I=H(()=>!(f.value.match(Cs)&&!x.value&&!Q.value&&j.value<oe.value&&D.value)),D=H(()=>!(g.value&&h.value&&j.value>0&&_.value));Z(w,t=>{for(let a=0;a<t.length;a++)isNaN(parseFloat(t[a].amount))&&(t[a].amount="0")},{deep:!0}),Z(A,t=>{isNaN(parseFloat(t))&&(A.value="0")});const Q=H(()=>s.value?l.value?parseFloat(A.value)>N.value||!w.value.every(t=>parseFloat(t.amount)<=t.balance)?!0:Y.value>S.value:Y.value>N.value||!w.value.every(t=>parseFloat(t.amount)<=t.balance):!1),j=H(()=>$.value.length==0?0:h.value?G.getFakeEncryptedMessageSize($.value):G.getPlainMessageSize($.value)),oe=H(()=>{var t;return((t=le)==null?void 0:t.currentNetworkProfileConfig.maxMessageSize)-1}),W=H(()=>{var t;return O.convertToExact((t=le)==null?void 0:t.currentNetworkProfileConfig.lockedFundsPerAggregate,v.nativeToken.divisibility)}),J=H(()=>le.currentNetworkProfile?O.convertToExact(G.getLockFundFee(),v.nativeToken.divisibility):0),ie=H(()=>{if(!s.value)return 0;let t=v.nativeToken.divisibility;return l.value?O.convertNumberMinimumFormat(N.value,t):O.convertNumberMinimumFormat(N.value-z.value,t)}),Y=H(()=>{let t=v.nativeToken.divisibility;return l.value?t==0?Math.trunc(z.value+J.value+W.value):Math.round((z.value+J.value+W.value)*Math.pow(10,t))/Math.pow(10,t):t==0?Math.trunc(parseFloat(A.value.replace(/,/g,""))+z.value):Math.round((parseFloat(A.value.replace(/,/g,""))+z.value)*Math.pow(10,t))/Math.pow(10,t)}),z=H(()=>{const t=w.value.map(a=>({id:a.id,amount:a.amount}));return t.push({id:v.nativeToken.assetId,amount:A.value}),l.value?se.calculateAggregateFee($.value,A.value,t,h.value):s.value?se.calculateFee($.value,A.value,t,h.value):0}),Pe=()=>{A.value=ie.value.toString(),A.value=ie.value.toString()},Se=()=>{s.value=null,f.value="",y.value="",h.value=!1,$.value="",A.value="0",o.emit("CLEAR_SELECT",0),w.value=[],l.value=null,E.value=""},Ce=We(),Ne=ze(),ge=async()=>{if(!await se.createTransaction(y.value,A.value,$.value,w.value.map(a=>({id:a.id,amount:parseFloat(a.amount),divisibility:a.divisibility})),f.value,s.value,l.value,h.value,E.value)){Ce.add({severity:"error",summary:"Error",detail:"Password is incorrect",group:"br-custom",life:1e3});return}Ne.push({name:"ViewAccountPendingTransactions",params:{address:s.value}}),Se()},Ve=()=>{A.value=="0"&&w.value.length==0?k.value=!0:ge()},Le=async()=>{if(v.chainAPI)try{const t=await v.chainAPI.accountAPI.getAccountInfo(d.Address.createFromRawAddress(s.value)),a=t.mosaics.findIndex(C=>C.id.toHex()==v.nativeToken.assetId);a!=-1?(S.value=t.mosaics[a].amount.compact()/Math.pow(10,v.nativeToken.divisibility),t.mosaics.splice(a,1)):S.value=0}catch{S.value=0}},ce=async t=>{if(v.chainAPI&&t){M.value=[];try{const a=await v.chainAPI.accountAPI.getAccountInfo(d.Address.createFromRawAddress(t)),C=a.mosaics.findIndex(B=>B.id.toHex()==v.nativeToken.assetId);C!=-1?(N.value=a.mosaics[C].amount.compact()/Math.pow(10,v.nativeToken.divisibility),a.mosaics.splice(C,1)):N.value=0;for(let B=0;B<a.mosaics.length;B++){const re=a.mosaics[B];M.value.push({id:re.id.toHex(),balance:re.amount.compact(),divisibility:0,namespace:"",hasUpdated:!1})}}catch{M.value=[],N.value=0}}};Z(s,async(t,a)=>{M.value=[],w.value=[],t==null?(N.value=0,r.value=null,l.value=null):t!=a&&(r.value=null,l.value=null,await ce(t))}),Z(l,async(t,a)=>{M.value=[],w.value=[],t==null&&(S.value=0,r.value=null,l.value=null,await ce(s.value)),t!=a&&(await Le(),await ce(t))}),o.on("select-account",t=>{s.value=t}),o.on("select-multisig-account",t=>{r.value=t.label,l.value=t.value}),o.on("CLOSE_MULTISIG",()=>{r.value=null,l.value=null}),o.on("CLOSE_CONFIRM_SEND_MODAL",t=>{k.value=t}),o.on("CONFIRM_PROCEED_SEND",t=>{t&&(k.value=!1,ge())});const Ee=t=>{b.value=!1,y.value=t.data},Be=H(()=>{const t=q.currentLoggedInWallet;if(!t)return[];const a=[...t.accounts,...t.others];return t.contacts.length?[{key:"0",label:p("general.ownerAcc"),selectable:!1,children:a.map((C,B)=>({key:"0-"+B.toString(),label:C.name,data:d.Address.createFromRawAddress(C.address).pretty(),selectable:!0}))},{key:"1",label:p("general.contact"),selectable:!1,children:t.contacts.map((C,B)=>({key:"1-"+B.toString(),label:C.name,data:d.Address.createFromRawAddress(C.address).pretty(),selectable:!0}))}]:[{key:"0",label:p("general.ownerAcc"),selectable:!1,children:a.map((C,B)=>({key:"0-"+B.toString(),label:C.name,data:d.Address.createFromRawAddress(C.address).pretty(),selectable:!0}))}]});Z([y,x],t=>{if(t[0].match(Ss)||t[0].match(Ps)){if(!t[1]){He();return}fe()}else x.value=!0});const He=()=>{v.chainAPI.accountAPI.getAccountInfo(d.Address.createFromRawAddress(y.value)).then(t=>{g.value=t.publicKey=="0".repeat(64)}).catch(t=>g.value=!0)},qe=()=>{try{d.PublicAccount.createFromPublicKey(E.value,v.networkType).address.plain()==d.Address.createFromRawAddress(y.value).plain()&&(_.value=!1)}catch{_.value=!0}},fe=()=>{if(q.currentLoggedInWallet)try{let t=O.createAddress(y.value);O.checkAddressNetwork(t,v.networkType)?x.value=!1:x.value=!0}catch{try{let a=O.createNamespaceId(y.value);v.chainAPI.namespaceAPI.getLinkedAddress(a).then(C=>{y.value=C.plain(),x.value=!1}).catch(C=>{x.value=!0})}catch{x.value=!0}}};return(t,a)=>{const C=K("Sidebar"),B=K("font-awesome-icon"),re=K("router-link"),be=$e("debounce");return u(),m("div",null,[F(C,{visible:b.value,"onUpdate:visible":a[0]||(a[0]=V=>b.value=V),baseZIndex:1e4,position:"full"},{default:R(()=>[F(Ze,{contacts:Be.value,onNodeSelect:Ee},null,8,["contacts"])]),_:1},8,["visible"]),F(cs,{toggleModal:k.value},null,8,["toggleModal"]),e("div",us,[e("div",ds,[e("div",ms,[Q.value?(u(),m("div",vs,[e("div",ps,[F(B,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),e("div",gs,i(t.$t("general.insufficientBalance")),1)])):P("",!0),e("div",fs,i(t.$t("transfer.newTransfer")),1),e("div",bs,[F(dt),F(pt,{"selected-address":s.value},null,8,["selected-address"])]),l.value?(u(),m("div",ys,[F(wt,{"select-default-address":l.value,"select-default-name":r.value},null,8,["select-default-address","select-default-name"])])):P("",!0),hs,e("div",_s,[ee(F(_e,{placeholder:t.$t("transfer.transferPlaceholder"),modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=V=>y.value=V),showError:x.value},null,8,["placeholder","modelValue","showError"]),[[be,fe,"1000"]]),e("div",{onClick:a[2]||(a[2]=V=>b.value=!b.value),class:"border rounded-md cursor-pointer flex flex-col justify-center p-1.5"},[F(B,{icon:"id-card-alt",class:"text-blue-primary ml-auto mr-auto"}),e("div",xs,i(t.$t("general.select")),1),e("div",ws,i(t.$t("general.contact")),1)])]),(u(!0),m(te,null,me(w.value,(V,X)=>{var ye;return u(),m("div",{key:X},[F(Nt,{class:"mt-3","asset-options":M.value,index:X,"selected-assets":w.value},null,8,["asset-options","index","selected-assets"]),((ye=w.value[X].id)==null?void 0:ye.length)==16?(u(),de(he,{key:0,class:"mt-3",modelValue:w.value[X].amount,"onUpdate:modelValue":Ke=>w.value[X].amount=Ke,placeholder:t.$t("transfer.assetAmount"),type:"text",decimal:w.value[X].divisibility},null,8,["modelValue","onUpdate:modelValue","placeholder","decimal"])):P("",!0)])}),128)),w.value.length!=M.value.length?(u(),m("button",{key:2,class:"my-2 font-semibold text-xs text-blue-primary outline-none focus:outline-none disabled:opacity-50",onClick:a[3]||(a[3]=V=>w.value.push({id:null,balance:0,amount:"0",namespace:"",divisibility:0}))}," + "+i(t.$t("transfer.addAssets")),1)):(u(),m("div",ks)),F(he,{modelValue:A.value,"onUpdate:modelValue":a[4]||(a[4]=V=>A.value=V),balance:N.value,placeholder:t.$t("transfer.transferAmount"),logo:!0,type:"text",onClickedMaxAvailable:a[5]||(a[5]=V=>Pe()),decimal:6},null,8,["modelValue","balance","placeholder"]),F(zt,{modelValue:$.value,"onUpdate:modelValue":a[6]||(a[6]=V=>$.value=V),limit:oe.value,placeholder:t.$t("general.message"),"current-bytes":j.value},null,8,["modelValue","limit","placeholder","current-bytes"]),x.value?P("",!0):(u(),m("div",As,[ee(e("input",{id:"encryptedMsg",type:"checkbox","onUpdate:modelValue":a[7]||(a[7]=V=>h.value=V)},null,512),[[Xe,h.value]]),e("label",$s,i(t.$t("transfer.enableEncryption")),1)])),!x.value&&g.value&&h.value&&j.value>0?ee((u(),de(_e,{key:5,placeholder:"Recipient Public Key",modelValue:E.value,"onUpdate:modelValue":a[8]||(a[8]=V=>E.value=V),showError:_.value},null,8,["modelValue","showError"])),[[be,qe,"1000"]]):P("",!0)]),e("div",Ts,[F(es,{"signer-native-token-balance":S.value,"native-amount":A.value,"native-token-balance":N.value,"lock-fund":W.value,"lock-fund-tx-fee":J.value,"selected-multisig-address":l.value,"txn-fee":z.value,"total-fee":Y.value,"selected-assets":w.value},null,8,["signer-native-token-balance","native-amount","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee","selected-assets"]),e("div",Ms,i(t.$t("general.enterPasswordContinue")),1),F(Ge,{placeholder:t.$t("general.enterPassword"),errorMessage:t.$t("general.passwordRequired"),modelValue:f.value,"onUpdate:modelValue":a[9]||(a[9]=V=>f.value=V),icon:"lock",class:"mt-5 mb-3"},null,8,["placeholder","errorMessage","modelValue"]),e("button",{type:"submit",class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",disabled:I.value,onClick:a[10]||(a[10]=V=>Ve())},i(t.$t("general.transfer")),9,Is),e("div",Fs,[F(re,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white underline"},{default:R(()=>[Ie(i(t.$t("general.cancel")),1)]),_:1})])])])])])}}});export{Ks as default};
