import"./vue-86063517.js";import{T as we,w as E,_ as R,A as p,W as ce,n as te,f as X,H as D}from"./index-e91c98d3.js";import{t as ie}from"./jdenticon-e4458e79.js";import{d as W,c as H,r as T,B as Z,o as m,z as v,e as $,a as C,m as U,A as e,g as d,bf as L,u as me,t as ke,w as O,b as ue,C as Ae,p as oe,D as Te,l as $e,F as le,k as de,bn as je}from"./@vue-a9ecc9f1.js";import{d as u}from"./tsjs-xpx-chain-sdk-84426b6a.js";import{S as He}from"./SelectAccountAndContact-03b5149d.js";import{u as Ee}from"./vue-i18n-728f748b.js";import{_ as pe}from"./proximax-logo-ecfc3767.js";import{P as Ke}from"./PasswordInput-342be278.js";import{_ as qe}from"./icon-red-x-a5511f99.js";import{_ as Ue}from"./icon-green-tick-1b766454.js";import{u as Re}from"./primevue-e09f7e84.js";import{u as We}from"./vue-router-21fffbbf.js";import"./@js-joda-d98eb16f.js";import"./rxjs-1250b26d.js";import"./tslib-8dbab242.js";import"./crypto-js-e64ac54c.js";import"./crypto-browserify-4fd8cccd.js";import"./randombytes-685e9383.js";import"./node-stdlib-browser-23a8bc7f.js";import"./buffer-6d367910.js";import"./base64-js-50a5cdf9.js";import"./ieee754-44f7831e.js";import"./process-2209b2b3.js";import"./safe-buffer-c463177b.js";import"./create-hash-92c04a28.js";import"./inherits-804453d8.js";import"./md5.js-8d474739.js";import"./hash-base-bb85fc42.js";import"./readable-stream-2241ee9e.js";import"./events-86ccc6d8.js";import"./util-06f7ff32.js";import"./is-arguments-86164331.js";import"./has-tostringtag-7c6352d6.js";import"./has-symbols-cd7870b9.js";import"./call-bind-9e7f09da.js";import"./get-intrinsic-f35014ba.js";import"./has-proto-8ede3a55.js";import"./function-bind-68631a08.js";import"./has-ab8e2922.js";import"./is-generator-function-06dfaf9d.js";import"./which-typed-array-cf6b6a29.js";import"./for-each-f57c5052.js";import"./is-callable-7492318c.js";import"./available-typed-arrays-61974ec7.js";import"./gopd-bab4d6bd.js";import"./is-typed-array-037eef20.js";import"./util-deprecate-c3aabb3c.js";import"./string_decoder-ef7b01fe.js";import"./ripemd160-58dcfa02.js";import"./sha.js-cea3da2e.js";import"./cipher-base-aee0e03d.js";import"./stream-browserify-7496a08f.js";import"./create-hmac-e8b5ea4a.js";import"./browserify-sign-a708a95f.js";import"./browserify-rsa-bfbdcbb6.js";import"./bn.js-1ae23332.js";import"./elliptic-75e883ee.js";import"./minimalistic-assert-4cc49674.js";import"./minimalistic-crypto-utils-6f869a51.js";import"./brorand-03f0f79d.js";import"./hash.js-4f5dfe73.js";import"./hmac-drbg-87799258.js";import"./parse-asn1-465c125b.js";import"./asn1.js-405e93e4.js";import"./safer-buffer-2ac6237e.js";import"./evp_bytestokey-e91543fa.js";import"./browserify-aes-ce20a0e6.js";import"./buffer-xor-87a7236a.js";import"./pbkdf2-e2ae8643.js";import"./browserify-cipher-c4c37ca3.js";import"./browserify-des-3f7e64d9.js";import"./des.js-d262604a.js";import"./diffie-hellman-c8260aab.js";import"./miller-rabin-de27bf02.js";import"./create-ecdh-ffe720e9.js";import"./public-encrypt-fc0568a2.js";import"./randomfill-2874e5f1.js";import"./mathjs-2a513dae.js";import"./@babel-484168fe.js";import"./typed-function-4896e4f1.js";import"./decimal.js-d133ee8e.js";import"./complex.js-cf2520e8.js";import"./fraction.js-39e7906a.js";import"./javascript-natural-sort-c4dd0c27.js";import"./escape-latex-c8a96e7a.js";import"./seedrandom-c8f991ad.js";import"./tiny-emitter-56d49cfd.js";import"./js-sha3-d7d4f583.js";import"./crypto-random-string-d158262e.js";import"./jose-92e5544c.js";import"./vue-loading-overlay-b89251b1.js";import"./jspdf-30014160.js";import"./fflate-8981c52c.js";import"./vue-debounce-3bbbf8c6.js";import"./mitt-f7ef348c.js";/* empty css                   */import"./maska-6f10db43.js";import"./@fortawesome-014b81f2.js";import"./vue3-blocks-tree-e53499e3.js";import"./@noble-f8eff84a.js";import"./utf8-c941a4a0.js";import"./bip39-936aefa9.js";import"./axios-b48d2c29.js";import"./flatbuffers-edc4f8d7.js";import"./ws-0a714537.js";import"./@intlify-16888cd3.js";const De={key:0,class:"text-blue-primary font-semibold uppercase text-xxs mt-3"},ze={key:0,class:"account-item-value account-item"},Oe={class:"flex"},Xe=["innerHTML"],Ze={class:"flex flex-col ml-2 text-left"},Ge=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Account to create / initiate transfer",-1),Je={class:"mt-1 text-tsm font-bold"},Qe={class:"account-item"},Ye={class:"flex"},et=["innerHTML"],tt={class:"text-xs ml-2 font-semibold"},lt=W({__name:"SelectInputAccount",emits:["select-account","update:modelValue"],setup(o){const h=me().appContext.config.globalProperties.emitter;let f=new we("ThemeStyleConfig");f.init();let l=f.jdenticonConfig;const i=H(()=>E.currentLoggedInWallet?[...E.currentLoggedInWallet.accounts.filter(_=>_.multisigInfo.length==0||_.multisigInfo.find(g=>g.level==0).cosignaturies.length==0)].map(_=>({value:_.address,label:E.currentLoggedInWallet.convertAddressToName(_.address,!0)})):[]),n=T(null),b=T(null),M=(k,_)=>{if(k==null&&_==null){n.value=null,h.emit("select-account",null);return}h.emit("select-account",_),n.value.label=k,n.value.value=_,b.value=ie(_,25,l)};return(k,_)=>{const g=Z("Dropdown");return m(),v("div",null,[n.value?$("v-if",!0):(m(),v("div",De,"Select Account to create / initiate transfer")),C(g,{showClear:!0,modelValue:n.value,"onUpdate:modelValue":_[0]||(_[0]=r=>n.value=r),style:{width:"100%"},options:i.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:_[1]||(_[1]=r=>{var x,c,a,w;M((x=r.value)==null?void 0:x.label,(c=r.value)==null?void 0:c.value),k.$emit("update:modelValue",(a=r.value)==null?void 0:a.value),k.$emit("select-account",(w=r.value)==null?void 0:w.value)})},{value:U(r=>[r.value?(m(),v("div",ze,[e("div",Oe,[e("div",{innerHTML:b.value},null,8,Xe),e("div",Ze,[Ge,e("div",Je,d(r.value.label),1)])])])):$("v-if",!0)]),option:U(r=>[e("div",Qe,[e("div",Ye,[e("div",{innerHTML:L(ie)(r.option.value,20,L(l))},null,8,et),e("div",tt,d(r.option.label),1)])])]),_:1},8,["modelValue","options"])])}}}),st=R(lt,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/SelectInputAccount.vue"]]),at={key:1,class:"text-xxs font-semibold uppercase mt-3 text-blue-primary"},nt={key:0,class:"account-item-value account-item"},ot={class:"flex"},it=["innerHTML"],rt={class:"flex flex-col ml-2 text-left"},ct=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Multisig Account",-1),ut={class:"mt-1 text-tsm font-bold"},dt={class:"account-item"},mt={class:"flex items-center"},pt=["innerHTML"],vt={class:"text-xs ml-2 font-semibold"},ft=W({__name:"SelectInputMultisigAccount",props:{selectedAddress:{type:String,required:!1}},emits:["select-multisig-account","update:modelValue"],setup(o){const y=o,h=T(!1),{selectedAddress:f}=ke(y),l=T([]),n=me().appContext.config.globalProperties.emitter;let b=new we("ThemeStyleConfig");b.init();let M=b.jdenticonConfig;const k=T(null);O(f,r=>{if(g(null,null),r==null){g(null,null),l.value=[];return}const x=E.currentLoggedInWallet.accounts.find(a=>a.address==r),c=x.multisigInfo.find(a=>a.level==0);l.value=c?[...x.multisigInfo].filter(a=>a.level<0).map(a=>{const F=[...E.currentLoggedInWallet.accounts,...E.currentLoggedInWallet.others].find(I=>I.publicKey==a.publicKey);return{label:F?E.currentLoggedInWallet.convertAddressToName(F.address):u.PublicAccount.createFromPublicKey(a.publicKey,p.networkType).address.plain(),value:u.PublicAccount.createFromPublicKey(a.publicKey,p.networkType).address.plain()}}):[]}),O(k,r=>{r==null&&(h.value=!1)});const _=T(null),g=(r,x)=>{if(r==null&&x==null){k.value=null,n.emit("select-multisig-account",null);return}n.emit("select-multisig-account",x),k.value.label=r,k.value.value=x,_.value=ie(x,25,M)};return(r,x)=>{const c=Z("Dropdown");return m(),v("div",null,[l.value.length&&!h.value?(m(),v("button",{key:0,class:"blue-btn py-2 px-3 mt-3",onClick:x[0]||(x[0]=a=>h.value=!0)},"Select Multisig Account")):$("v-if",!0),l.value.length&&h.value&&!k.value?(m(),v("div",at,"Select Multisig Account")):$("v-if",!0),h.value&&l.value.length?(m(),ue(c,{key:2,showClear:!0,modelValue:k.value,"onUpdate:modelValue":x[1]||(x[1]=a=>k.value=a),style:{width:"100%"},options:l.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:x[2]||(x[2]=a=>{var w,F,I,V;g((w=a.value)==null?void 0:w.label,(F=a.value)==null?void 0:F.value),r.$emit("update:modelValue",(I=a.value)==null?void 0:I.value),r.$emit("select-multisig-account",(V=a.value)==null?void 0:V.value)})},{value:U(a=>[a.value?(m(),v("div",nt,[e("div",ot,[e("div",{innerHTML:_.value},null,8,it),e("div",rt,[ct,e("div",ut,d(a.value.label),1)])])])):$("v-if",!0)]),option:U(a=>[e("div",dt,[e("div",mt,[e("div",{innerHTML:L(ie)(a.option.value,20,L(M))},null,8,pt),e("div",vt,d(a.option.label),1)])])]),_:1},8,["modelValue","options"])):$("v-if",!0)])}}}),gt=R(ft,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/SelectInputMultisigAccount.vue"]]),bt={key:0},ht={class:"flex justify-between"},yt={class:"flex flex-col ml-2 text-left"},xt=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Asset",-1),_t={class:"mt-1 text-tsm font-bold"},wt={class:"mt-1 text-tsm font-bold"},kt={class:"account-item"},At={class:"flex justify-between"},Tt={class:"mt-1 text-tsm font-bold"},$t={class:"mt-1 text-tsm font-bold"},It=W({__name:"SelectInputAsset",props:{index:{type:Number,required:!0},assetOptions:{type:Object,required:!0},selectedAssets:{type:Object,required:!1}},emits:["select-asset","update:modelValue"],setup(o){const y=o,h=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],f=g=>{const r=h.find(x=>x.namespace==g);return r?r.name:g},{assetOptions:l,selectedAssets:i,index:n}=ke(y),b=T(!1),M=H(()=>{const g=new Set(i.value.map(r=>r.id));return l.value.filter(r=>!g.has(r.id))}),k=async g=>{if(b.value)return;b.value=!0;const{first:r,last:x}=g,c=[];for(let N=r;N<x;N++)l.value[N].hasUpdated||c.push(new u.MosaicId(l.value[N].id));if(!c.length){b.value=!1;return}const a=await p.chainAPI.assetAPI.getMosaicsNames(c),w=await p.chainAPI.assetAPI.getMosaics(c);let F=0,I=0;const V=new Map;a.forEach((N,B)=>{V.set(N.mosaicId.toHex(),B)}),w.sort((N,B)=>{const A=V.get(N.mosaicId.toHex()),K=V.get(B.mosaicId.toHex());return A-K});for(let N=r;N<x;N++){if(!a[F])continue;const B=l.value.find(A=>A.id==a[F].mosaicId.toHex());B&&(B.namespace=a[F].names.length?a[F].names[0].name:"",B.balance=B.balance/Math.pow(10,w[I].divisibility),B.divisibility=w[I].divisibility,B.hasUpdated=!0,F++,I++)}b.value=!1},_=g=>{if(g==null){i.value.splice(n.value,1);return}i.value[n.value].balance=g.balance,i.value[n.value].id=g.id,i.value[n.value].namespace=g.namespace,i.value[n.value].divisibility=g.divisibility,i.value[n.value].amount="0"};return(g,r)=>{const x=Z("Dropdown");return m(),v("div",null,[C(x,{showClear:!0,modelValue:L(i)[L(n)],"onUpdate:modelValue":r[0]||(r[0]=c=>L(i)[L(n)]=c),style:{width:"100%"},options:M.value,filter:!0,filterFields:["id","namespace"],emptyFilterMessage:" ",placeholder:"Select Asset",virtualScrollerOptions:{lazy:!0,onLazyLoad:k,showLoader:!0,loading:b.value,delay:0,itemSize:38},onChange:r[1]||(r[1]=c=>{var a;_(c.value),g.$emit("update:modelValue",(a=c.value)==null?void 0:a.value)})},{value:U(c=>[c.value.id?(m(),v("div",bt,[e("div",ht,[e("div",yt,[xt,e("div",_t,d(f(c.value.namespace==""?c.value.id:c.value.namespace)),1)]),e("div",wt,"Balance: "+d(c.value.balance),1)])])):$("v-if",!0)]),option:U(c=>[e("div",kt,[e("div",At,[e("div",Tt,d(f(c.option.namespace==""?c.option.id:c.option.namespace)),1),e("div",$t,"Balance: "+d(c.option.balance),1)])])]),_:1},8,["modelValue","options","virtualScrollerOptions"])])}}}),Mt=R(It,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/SelectInputAsset.vue"]]),Ft={class:"border border-gray-200 px-2 py-1 rounded-md"},Pt={class:"flex justify-between"},Vt={class:"flex flex-col"},St={class:"uppercase font-light text-gray-500 text-txs text-left mb-2"},Nt={class:"flex w-full"},Lt={key:0,src:pe,class:"h-5 w-5 mt-0.5"},Ct=["value","data-maska","placeholder"],Bt=["disabled"],jt=W({__name:"TransferInputClean",props:{modelValue:{type:String,required:!0},decimal:{type:Number,required:!0},placeholder:{type:String,required:!0},toolTip:{type:String,required:!1},disabled:{type:Boolean,required:!1},showError:{type:Boolean,required:!1},logo:{type:Boolean,required:!1},balance:{type:Number,required:!1}},emits:["update:modelValue","show-error","clickedMaxAvailable"],setup(o){const y=o,h=()=>{let l="0";return y.decimal>0&&(l=l+"."+"9".repeat(y.decimal)),l},f={preProcess:l=>l.replace(/,/g,""),postProcess:l=>{if(!l)return"";let i=0;return y.decimal>0&&(i=1+y.decimal-(l.includes(".")?l.length-l.indexOf("."):0)),Intl.NumberFormat("en-US",{minimumFractionDigits:y.decimal}).format(parseFloat(l)).slice(0,i?-i:void 0)}};return(l,i)=>{const n=Ae("maska");return m(),v("div",{class:Te(o.disabled?"opacity-50":"")},[e("div",Ft,[e("div",Pt,[e("div",Vt,[e("div",St,d(o.placeholder),1),e("div",Nt,[o.logo?(m(),v("img",Lt)):$("v-if",!0),oe(e("input",{value:o.modelValue,class:"supply_input","data-maska":h(),"data-maska-tokens":"0:\\d:multiple|9:\\d:optional",placeholder:o.placeholder,onInput:i[0]||(i[0]=b=>l.$emit("update:modelValue",parseFloat(b.target.value.replace(/,/g,"")).toString()))},null,40,Ct),[[n,void 0,f]])])]),o.logo?(m(),v("button",{key:0,disabled:o.disabled==!0,class:"w-24 cursor-pointer focus:outline-none text-blue-primary text-xs font-bold",onClick:i[1]||(i[1]=b=>l.$emit("clickedMaxAvailable",!0))},d(l.$t("swap.maxAmount")),9,Bt)):$("v-if",!0)])])],2)}}});const he=R(jt,[["__scopeId","data-v-03ac6095"],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/TransferInputClean.vue"]]),Ht={class:"rounded-md bg-white flex border mt-3"},Et=["value","placeholder"],Kt=e("div",{class:"w-1 flex-none"},null,-1),qt={class:"text-gray-800"},Ut=W({__name:"TextAreaInput",props:{modelValue:{type:String,required:!1},currentBytes:{type:Number,required:!0},limit:{type:Number,required:!0},placeholder:{type:String,required:!0}},emits:["update:modelValue"],setup(o){return(y,h)=>(m(),v(le,null,[e("div",Ht,[e("textarea",{value:o.modelValue,onInput:h[0]||(h[0]=f=>y.$emit("update:modelValue",f.target.value)),rows:"2",class:"w-full text-gray-500 px-2 py-1 outline-none bg-white text-xs",placeholder:o.placeholder.toUpperCase()},null,40,Et),Kt]),e("div",{class:Te(["float-right mt-1 text-tsm",o.currentBytes>o.limit?"text-red-500":"text-gray-800"])},[$e(d(o.currentBytes)+" ",1),e("span",qt,"/"+d(o.limit),1)],2)],64))}}),Rt=R(Ut,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/TextAreaInput.vue"]]),Wt={class:"border border-gray-200 px-2 py-2 rounded-md w-full"},Dt={class:"flex gap-2"},zt={class:"flex flex-col w-full"},Ot={class:"uppercase text-gray-500 font-light text-xxs text-left"},Xt=["value"],Zt={key:0,class:"flex flex-col ml-auto justify-center mt-1"},Gt=e("img",{src:qe,class:"h-5 w-5 mr-auto ml-auto"},null,-1),Jt={class:"text-xxs text-red-400 font-bold uppercase"},Qt={key:1,class:"flex flex-col ml-auto justify-center mt-1"},Yt=e("img",{src:Ue,class:"h-5 w-5 mr-auto ml-auto"},null,-1),el={class:"text-xxs text-green-400 font-bold uppercase"},tl=W({__name:"FieldValidationInput",props:{placeholder:String,showError:Boolean,modelValue:String},emits:["update:modelValue"],setup(o){return(y,h)=>(m(),v("div",Wt,[e("div",Dt,[e("div",zt,[e("div",Ot,d(o.placeholder),1),e("input",{type:"text",value:o.modelValue,onInput:h[0]||(h[0]=f=>y.$emit("update:modelValue",f.target.value)),class:"w-full font-semibold text-tsm outline-none mt-1"},null,40,Xt)]),o.showError&&o.modelValue.length!=0?(m(),v("div",Zt,[Gt,e("div",Jt,d(y.$t("general.invalid")),1)])):o.showError?$("v-if",!0):(m(),v("div",Qt,[Yt,e("div",el,d(y.$t("general.valid")),1)]))])]))}});const ye=R(tl,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/FieldValidationInput.vue"]]),Ie="0".repeat(64),xe=u.PublicAccount.createFromPublicKey(Ie,p.networkType).address.plain(),_e=(o,y)=>{let h=[];return parseInt(o)>0&&h.push(new u.Mosaic(new u.MosaicId(p.nativeToken.assetId),u.UInt64.fromUint(Number(o)))),y.length>0&&y.forEach(f=>{parseInt(f.amount)>0&&h.push(new u.Mosaic(new u.MosaicId(f.id),u.UInt64.fromUint(Number(f.amount))))}),h},ae=class ae{};ae.createTransaction=async(y,h,f,l,i,n,b,M,k)=>{if(!ce.verifyWalletPassword(E.currentLoggedInWallet.name,te.chainNetworkName,i))return!1;const g=te.currentNetworkProfile.generationHash;let r=p.networkType,x=parseFloat(h)*Math.pow(10,p.nativeToken.divisibility),c=[];x>0&&c.push(new u.Mosaic(new u.MosaicId(p.nativeToken.assetId),u.UInt64.fromUint(Number(x)))),l.length>0&&l.forEach(A=>{A.amount>0&&c.push(new u.Mosaic(new u.MosaicId(A.id),u.UInt64.fromUint(Number(A.amount*Math.pow(10,A.divisibility)))))});let a=p.buildTxn,w,F;if(!b)w=E.currentLoggedInWallet.accounts.find(A=>A.address===n);else{w=E.currentLoggedInWallet.accounts.find(K=>K.address===n);const A=await p.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(b));F=u.PublicAccount.createFromPublicKey(A.publicKey,r)}let I=ce.decryptPrivateKey(new u.Password(i),w.encrypted,w.iv),V;if(M&&f.length>0)try{const A=await p.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(y));V=u.EncryptedMessage.create(f,A.publicAccount,I)}catch{V=u.EncryptedMessage.create(f,u.PublicAccount.createFromPublicKey(k,p.networkType),I)}else V=u.PlainMessage.create(f);let N=a.transferBuilder().recipient(u.Address.createFromRawAddress(y)).mosaics(c).message(V).build();const B=u.Account.createFromPrivateKey(I,r,1);if(b){let A=E.currentLoggedInWallet.accounts.find(re=>re.address==n),K=ce.decryptPrivateKey(new u.Password(i),A.encrypted,A.iv),G=u.Account.createFromPrivateKey(K,r,1);const J=[N.toAggregateV1(F)],Q=a.aggregateBonded(J),Y=G.preV2Sign(Q,g),ee=X.lockFundTx(Y),q=G.preV2Sign(ee,g);X.announceLF_AND_addAutoAnnounceABT(q,Y)}else{const A=B.preV2Sign(N,g);X.announceTransaction(A)}return!0},ae.calculateAggregateFee=(y,h,f,l)=>{let i=p.buildTxn,n=_e(h,f),M=[i.transferBuilder().recipient(u.Address.createFromRawAddress(xe)).mosaics(n).message(l&&y.length>0?u.EncryptedMessage.create(y,u.PublicAccount.createFromPublicKey("0".repeat(64),p.networkType),"0".repeat(64)):u.PlainMessage.create(y)).build().toAggregateV1(u.PublicAccount.createFromPublicKey(Ie,p.networkType))];return i.aggregateBondedBuilder().innerTransactions(M).build().maxFee.compact()/Math.pow(10,p.nativeToken.divisibility)},ae.calculateFee=(y,h,f,l)=>{let i=p.buildTxn,n=_e(h,f);return i.transferBuilder().recipient(u.Address.createFromRawAddress(xe)).mosaics(n).message(l&&y.length>0?u.EncryptedMessage.create(y,u.PublicAccount.createFromPublicKey("0".repeat(64),p.networkType),"0".repeat(64)):u.PlainMessage.create(y)).build().maxFee.compact()/Math.pow(10,p.nativeToken.divisibility)};let se=ae;const ll={key:0},sl={class:"font-bold text-xs text-blue-primary uppercase"},al={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},nl={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},ol=["innerHTML"],il={class:"flex"},rl={class:"ml-1 text-blue-400 font-bold"},cl=e("img",{src:pe,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),ul={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs pt-2"},dl={class:"font-semibold lg:col-span-2 col-span-3"},ml={key:0,class:"lg:col-span-2 col-span-3 ml-auto"},pl=["innerHTML"],vl={class:"ml-1 text-blue-400"},fl={key:0,class:"lg:col-span-4 col-span-6 ml-auto"},gl={key:1,class:"lg:col-span-4 col-span-6 ml-auto"},bl=["index"],hl=e("div",{class:"border-b-2 border-gray-600 my-2"},null,-1),yl={class:"font-bold text-xs text-blue-primary uppercase"},xl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},_l={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},wl=["innerHTML"],kl={class:"flex"},Al={class:"ml-1 text-blue-400 font-bold"},Tl=e("img",{src:pe,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),$l=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),Il={key:1,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs pt-2"},Ml={class:"font-semibold lg:col-span-2 col-span-3"},Fl={key:0,class:"lg:col-span-2 col-span-3 ml-auto"},Pl=["innerHTML"],Vl={class:"ml-1 text-blue-400"},Sl={key:0,class:"lg:col-span-4 col-span-6 ml-auto"},Nl={key:1,class:"lg:col-span-4 col-span-6 ml-auto"},Ll=["index"],Cl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Bl={class:"font-semibold lg:col-span-2 col-span-3"},jl=["innerHTML"],Hl={class:"ml-1 text-blue-400"},El={key:3,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs"},Kl={class:"font-semibold lg:col-span-2 col-span-3"},ql=["innerHTML"],Ul={class:"ml-1 text-blue-400"},Rl={key:4,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Wl={class:"font-semibold lg:col-span-2 col-span-3"},Dl=["innerHTML"],zl={class:"ml-1 text-blue-400"},Ol=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),Xl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Zl=e("div",{class:"font-semibold lg:col-span-2 col-span-3 uppercase"},"Total",-1),Gl=["innerHTML"],Jl={class:"ml-1 text-blue-400"},Ql=W({__name:"TransferTxnSummary",props:{selectedMultisigAddress:{type:String||null},nativeTokenBalance:{type:Number,required:!0},selectedAssets:{type:Array,required:!0},lockFund:{type:Number,required:!0},txnFee:{type:Number,required:!0},lockFundTxFee:{type:Number,required:!0},totalFee:{type:Number,required:!0},nativeAmount:{type:String,required:!0},signerNativeTokenBalance:{type:Number,required:!0}},setup(o){const y=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],h=l=>{const i=y.find(n=>n.namespace==l);return i?i.name:l.length==16?l.substring(0,4)+"..."+l.substring(l.length-4,l.length+1):l},f=l=>{let i=l.toString().split(".");return i[1]!=null?'<span class="font-semibold text-sm">'+i[0]+'</span>.<span class="font-semibold text-xs">'+i[1]+"</span>":'<span class="font-semibold text-sm">'+i[0]+"</span>"};return(l,i)=>(m(),v(le,null,[o.selectedMultisigAddress?(m(),v("div",ll,[e("div",sl,d(l.$t("general.multisigAcc")),1),e("div",al,[e("div",nl,d(l.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:f(o.nativeTokenBalance??0)},null,8,ol),e("div",il,[e("div",rl,d(L(p).nativeToken.label),1),cl])]),e("div",ul,[e("div",dl,d(l.$t("transfer.transferAmount")),1),isNaN(parseFloat(o.nativeAmount))?(m(),v("div",ml,"0")):(m(),v("div",{key:1,class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.nativeAmount??0)},null,8,pl)),e("div",vl,d(L(p).nativeToken.label),1)]),(m(!0),v(le,null,de(o.selectedAssets,(n,b)=>(m(),v("div",{class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-white text-xs",key:b},[isNaN(parseFloat(n.amount))&&n.id!=null?(m(),v("div",fl,"0")):(m(),v("div",gl,d(n.amount),1)),n.id!=null?(m(),v("div",{key:2,class:"ml-1 text-blue-400",index:b},d(h(n.namespace==""?n.id:n.namespace)),9,bl)):$("v-if",!0)]))),128)),hl])):$("v-if",!0),$(" { end of multisig summary } "),$(" { beginning of signer summary } "),e("div",yl,d(l.$t("general.signerAcc")),1),e("div",xl,[e("div",_l,d(l.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:f(o.selectedMultisigAddress?o.signerNativeTokenBalance:o.nativeTokenBalance??0)},null,8,wl),e("div",kl,[e("div",Al,d(L(p).nativeToken.label),1),Tl])]),$l,o.selectedMultisigAddress?$("v-if",!0):(m(),v("div",Il,[e("div",Ml,d(l.$t("transfer.transferAmount")),1),isNaN(parseFloat(o.nativeAmount))?(m(),v("div",Fl,"0")):(m(),v("div",{key:1,class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.nativeAmount??0)},null,8,Pl)),e("div",Vl,d(L(p).nativeToken.label),1)])),o.selectedMultisigAddress?$("v-if",!0):(m(!0),v(le,{key:2},de(o.selectedAssets,(n,b)=>(m(),v("div",{class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-white text-xs",key:b},[isNaN(parseFloat(n.amount))&&n.id!=null?(m(),v("div",Sl,"0")):(m(),v("div",Nl,d(n.amount),1)),n.id!=null?(m(),v("div",{key:2,class:"ml-1 text-blue-400",index:b},d(h(n.namespace==""?n.id:n.namespace)),9,Ll)):$("v-if",!0)]))),128)),e("div",Cl,[e("div",Bl,d(o.selectedMultisigAddress!=null?l.$t("general.aggregateFee"):l.$t("general.transactionFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.txnFee)},null,8,jl),e("div",Hl,d(L(p).nativeToken.label),1)]),o.selectedMultisigAddress!=null?(m(),v("div",El,[e("div",Kl,d(l.$t("general.lockFund")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.lockFund??0)},null,8,ql),e("div",Ul,d(L(p).nativeToken.label),1)])):$("v-if",!0),o.selectedMultisigAddress!=null?(m(),v("div",Rl,[e("div",Wl,d(l.$t("general.lockFundTxFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.lockFundTxFee??0)},null,8,Dl),e("div",zl,d(L(p).nativeToken.label),1)])):$("v-if",!0),Ol,e("div",Xl,[Zl,e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.totalFee)},null,8,Gl),e("div",Jl,d(L(p).nativeToken.label),1)])],64))}}),Yl=R(Ql,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/TransferTxnSummary.vue"]]),es={class:"w-10/12 ml-auto mr-auto mt-5"},ts={class:"border filter shadow-lg xl:grid xl:grid-cols-3 mt-8"},ls={class:"xl:col-span-2 p-12"},ss={key:0,class:"mb-3 rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},as={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},ns={class:"inline-block text-xs"},os={class:"text-sm font-semibold"},is=e("div",{class:"text-blue-primary font-semibold uppercase mt-3 text-xxs"},"Transfer to",-1),rs={class:"flex mt-1 gap-1 items-center"},cs={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},us={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},ds={key:2,class:"h-3"},ms={key:3,class:"mb-5"},ps={for:"encryptedMsg",class:"cursor-pointer font-bold ml-4 mr-5 text-tsm"},vs={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},fs={class:"font-semibold text-xs text-white mb-1.5"},gs=["disabled"],bs={class:"text-center"},hs="^[0-9A-Za-z]{40}$",ys="^[0-9A-Za-z-]{46}$",xs="^[^ ]{8,}$",_s=W({__name:"ViewTransfer",setup(o){const y=me(),{t:h}=Ee(),f=y.appContext.config.globalProperties.emitter,l=T(null),i=T(null),n=T(!1),b=T(""),M=T(!1),k=T(!1),_=T(""),g=T(!0),r=T(!0),x=T([]),c=T([]),a=T("0"),w=T(0),F=T(""),I=T(""),V=T(0),N=H(()=>!(_.value.match(xs)&&!g.value&&!A.value&&K.value<G.value&&B.value)),B=H(()=>!(k.value&&M.value&&K.value>0&&r.value));O(c,t=>{for(let s=0;s<t.length;s++)isNaN(parseFloat(t[s].amount))&&(t[s].amount="0")},{deep:!0}),O(a,t=>{isNaN(parseFloat(t))&&(a.value="0")});const A=H(()=>i.value?l.value?parseFloat(a.value)>w.value||!c.value.every(t=>parseFloat(t.amount)<=t.balance)?!0:ee.value>V.value:ee.value>w.value||!c.value.every(t=>parseFloat(t.amount)<=t.balance):!1),K=H(()=>I.value.length==0?0:M.value?X.getFakeEncryptedMessageSize(I.value):X.getPlainMessageSize(I.value)),G=H(()=>{var t;return((t=te)==null?void 0:t.currentNetworkProfileConfig.maxMessageSize)-1}),J=H(()=>{var t;return D.convertToExact((t=te)==null?void 0:t.currentNetworkProfileConfig.lockedFundsPerAggregate,p.nativeToken.divisibility)}),Q=H(()=>te.currentNetworkProfile?D.convertToExact(X.getLockFundFee(),p.nativeToken.divisibility):0),Y=H(()=>{if(!i.value)return 0;let t=p.nativeToken.divisibility;return l.value?D.convertNumberMinimumFormat(w.value,t):D.convertNumberMinimumFormat(w.value-q.value,t)}),ee=H(()=>{let t=p.nativeToken.divisibility;return l.value?t==0?Math.trunc(q.value+Q.value+J.value):Math.round((q.value+Q.value+J.value)*Math.pow(10,t))/Math.pow(10,t):t==0?Math.trunc(parseFloat(a.value.replace(/,/g,""))+q.value):Math.round((parseFloat(a.value.replace(/,/g,""))+q.value)*Math.pow(10,t))/Math.pow(10,t)}),q=H(()=>{const t=c.value.map(s=>({id:s.id,amount:s.amount}));return t.push({id:p.nativeToken.assetId,amount:a.value}),l.value?se.calculateAggregateFee(I.value,a.value,t,M.value):i.value?se.calculateFee(I.value,a.value,t,M.value):0}),re=()=>{a.value=Y.value.toString(),a.value=Y.value.toString()},Me=Re(),Fe=We(),Pe=async()=>{if(!await se.createTransaction(b.value,a.value,I.value,c.value.map(s=>({id:s.id,amount:parseFloat(s.amount),divisibility:s.divisibility})),_.value,i.value,l.value,M.value,F.value)){Me.add({severity:"error",summary:"Error",detail:"Password is incorrect",group:"br-custom",life:1e3});return}Fe.push({name:"ViewAccountPendingTransactions",params:{address:i.value}})},Ve=async()=>{if(p.chainAPI)try{const t=await p.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(i.value)),s=t.mosaics.findIndex(P=>P.id.toHex()==p.nativeToken.assetId);s!=-1?(V.value=t.mosaics[s].amount.compact()/Math.pow(10,p.nativeToken.divisibility),t.mosaics.splice(s,1)):V.value=0}catch{V.value=0}},ve=async t=>{if(p.chainAPI&&t){x.value=[];try{const s=await p.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(t)),P=s.mosaics.findIndex(j=>j.id.toHex()==p.nativeToken.assetId);P!=-1?(w.value=s.mosaics[P].amount.compact()/Math.pow(10,p.nativeToken.divisibility),s.mosaics.splice(P,1)):w.value=0;for(let j=0;j<s.mosaics.length;j++){const ne=s.mosaics[j];x.value.push({id:ne.id.toHex(),balance:ne.amount.compact(),divisibility:0,namespace:"",hasUpdated:!1})}}catch{x.value=[],w.value=0}}};O([i,l],async([t,s])=>{x.value=[],c.value=[],t==null&&(w.value=0),t!=null&&s==null?(V.value=0,await ve(t)):t!=null&&s!=null&&(await Ve(),await ve(s))}),f.on("select-account",t=>{i.value=t}),f.on("select-multisig-account",t=>{l.value=t});const Se=t=>{n.value=!1,b.value=t.data},Ne=H(()=>{const t=E.currentLoggedInWallet;if(!t)return[];const s=[...t.accounts,...t.others];return t.contacts.length?[{key:"0",label:h("general.ownerAcc"),selectable:!1,children:s.map((P,j)=>({key:"0-"+j.toString(),label:P.name,data:u.Address.createFromRawAddress(P.address).pretty(),selectable:!0}))},{key:"1",label:h("general.contact"),selectable:!1,children:t.contacts.map((P,j)=>({key:"1-"+j.toString(),label:P.name,data:u.Address.createFromRawAddress(P.address).pretty(),selectable:!0}))}]:[{key:"0",label:h("general.ownerAcc"),selectable:!1,children:s.map((P,j)=>({key:"0-"+j.toString(),label:P.name,data:u.Address.createFromRawAddress(P.address).pretty(),selectable:!0}))}]});O([b,g],t=>{if(t[0].match(ys)||t[0].match(hs)){if(!t[1]){Le();return}fe()}else g.value=!0});const Le=()=>{p.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(b.value)).then(t=>{k.value=t.publicKey=="0".repeat(64)}).catch(t=>k.value=!0)},Ce=()=>{try{u.PublicAccount.createFromPublicKey(F.value,p.networkType).address.plain()==u.Address.createFromRawAddress(b.value).plain()&&(r.value=!1)}catch{r.value=!0}},fe=()=>{if(E.currentLoggedInWallet)try{let t=D.createAddress(b.value);D.checkAddressNetwork(t,p.networkType)?g.value=!1:g.value=!0}catch{try{let s=D.createNamespaceId(b.value);p.chainAPI.namespaceAPI.getLinkedAddress(s).then(P=>{b.value=P.plain(),g.value=!1}).catch(P=>{g.value=!0})}catch{g.value=!0}}};return(t,s)=>{const P=Z("Sidebar"),j=Z("font-awesome-icon"),ne=Z("router-link"),ge=Ae("debounce");return m(),v("div",null,[C(P,{visible:n.value,"onUpdate:visible":s[0]||(s[0]=S=>n.value=S),baseZIndex:1e4,position:"full"},{default:U(()=>[C(He,{contacts:Ne.value,onNodeSelect:Se},null,8,["contacts"])]),_:1},8,["visible"]),e("div",es,[e("div",ts,[e("div",ls,[A.value?(m(),v("div",ss,[e("div",as,[C(j,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),e("div",ns,d(t.$t("general.insufficientBalance")),1)])):$("v-if",!0),e("div",os,d(t.$t("transfer.newTransfer")),1),C(st),C(gt,{class:"md:mt-3","selected-address":i.value},null,8,["selected-address"]),is,e("div",rs,[oe(C(ye,{placeholder:t.$t("transfer.transferPlaceholder"),modelValue:b.value,"onUpdate:modelValue":s[1]||(s[1]=S=>b.value=S),showError:g.value},null,8,["placeholder","modelValue","showError"]),[[ge,fe,"1000"]]),e("div",{onClick:s[2]||(s[2]=S=>n.value=!n.value),class:"border rounded-md cursor-pointer flex flex-col justify-center p-1.5"},[C(j,{icon:"id-card-alt",class:"text-blue-primary ml-auto mr-auto"}),e("div",cs,d(t.$t("general.select")),1),e("div",us,d(t.$t("general.contact")),1)])]),(m(!0),v(le,null,de(c.value,(S,z)=>{var be;return m(),v("div",{key:z},[C(Mt,{class:"mt-3","asset-options":x.value,index:z,"selected-assets":c.value},null,8,["asset-options","index","selected-assets"]),((be=c.value[z].id)==null?void 0:be.length)==16?(m(),ue(he,{key:0,class:"mt-3",modelValue:c.value[z].amount,"onUpdate:modelValue":Be=>c.value[z].amount=Be,placeholder:t.$t("transfer.assetAmount"),type:"text",decimal:c.value[z].divisibility},null,8,["modelValue","onUpdate:modelValue","placeholder","decimal"])):$("v-if",!0)])}),128)),c.value.length!=x.value.length?(m(),v("button",{key:1,class:"my-2 font-semibold text-xs text-blue-primary outline-none focus:outline-none disabled:opacity-50",onClick:s[3]||(s[3]=S=>c.value.push({id:null,balance:0,amount:"0",namespace:"",divisibility:0}))}," + "+d(t.$t("transfer.addAssets")),1)):(m(),v("div",ds)),C(he,{modelValue:a.value,"onUpdate:modelValue":s[4]||(s[4]=S=>a.value=S),balance:w.value,placeholder:t.$t("transfer.transferAmount"),logo:!0,type:"text",onClickedMaxAvailable:s[5]||(s[5]=S=>re()),decimal:6},null,8,["modelValue","balance","placeholder"]),C(Rt,{modelValue:I.value,"onUpdate:modelValue":s[6]||(s[6]=S=>I.value=S),limit:G.value,placeholder:t.$t("general.message"),"current-bytes":K.value},null,8,["modelValue","limit","placeholder","current-bytes"]),g.value?$("v-if",!0):(m(),v("div",ms,[oe(e("input",{id:"encryptedMsg",type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=S=>M.value=S)},null,512),[[je,M.value]]),e("label",ps,d(t.$t("transfer.enableEncryption")),1)])),!g.value&&k.value&&M.value&&K.value>0?oe((m(),ue(ye,{key:4,placeholder:"Recipient Public Key",modelValue:F.value,"onUpdate:modelValue":s[8]||(s[8]=S=>F.value=S),showError:r.value},null,8,["modelValue","showError"])),[[ge,Ce,"1000"]]):$("v-if",!0)]),e("div",vs,[C(Yl,{"signer-native-token-balance":V.value,"native-amount":a.value,"native-token-balance":w.value,"lock-fund":J.value,"lock-fund-tx-fee":Q.value,"selected-multisig-address":l.value,"txn-fee":q.value,"total-fee":ee.value,"selected-assets":c.value},null,8,["signer-native-token-balance","native-amount","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee","selected-assets"]),e("div",fs,d(t.$t("general.enterPasswordContinue")),1),C(Ke,{placeholder:t.$t("general.enterPassword"),errorMessage:t.$t("general.passwordRequired"),modelValue:_.value,"onUpdate:modelValue":s[9]||(s[9]=S=>_.value=S),icon:"lock",class:"mt-5 mb-3"},null,8,["placeholder","errorMessage","modelValue"]),e("button",{type:"submit",class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",disabled:N.value,onClick:s[10]||(s[10]=S=>Pe())},d(t.$t("general.transfer")),9,gs),e("div",bs,[C(ne,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white underline"},{default:U(()=>[$e(d(t.$t("general.cancel")),1)]),_:1})])])])])])}}}),wn=R(_s,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/views/ViewTransfer.vue"]]);export{wn as default};
