import"./vue-86063517.js";import{P as fe}from"./PasswordInput-342be278.js";import{T as be}from"./TransactionFeeDisplay-e48a7b0f.js";import{_ as ye,w as m,H as _,A as h,q as p,n as A,f as _e,r as he,C as we,W as ee}from"./index-e91c98d3.js";import{c as ke}from"./functions-3b5b4af7.js";import{u as Ae}from"./primevue-e09f7e84.js";import{u as Pe}from"./vue-router-21fffbbf.js";import{d as S}from"./tsjs-xpx-chain-sdk-84426b6a.js";import{u as Ce}from"./vue-i18n-728f748b.js";import{a as H}from"./accountUtils-37b7cf79.js";import{A as xe,a as Ie}from"./AccountTabs-238f9695.js";import{M as W}from"./multisigUtils-f2f699ac.js";import{r as d,c as l,w as R,B as I,o as g,z as v,A as r,a as P,g as n,e as F,l as te,p as Le,bq as Ke,F as Fe,k as Te,m as De,u as Ve}from"./@vue-a9ecc9f1.js";import"./@js-joda-d98eb16f.js";import"./proximax-logo-ecfc3767.js";import"./rxjs-1250b26d.js";import"./tslib-8dbab242.js";import"./crypto-js-e64ac54c.js";import"./crypto-browserify-4fd8cccd.js";import"./randombytes-685e9383.js";import"./node-stdlib-browser-23a8bc7f.js";import"./buffer-6d367910.js";import"./base64-js-50a5cdf9.js";import"./ieee754-44f7831e.js";import"./process-2209b2b3.js";import"./safe-buffer-c463177b.js";import"./create-hash-92c04a28.js";import"./inherits-804453d8.js";import"./md5.js-8d474739.js";import"./hash-base-bb85fc42.js";import"./readable-stream-2241ee9e.js";import"./events-86ccc6d8.js";import"./util-06f7ff32.js";import"./is-arguments-86164331.js";import"./has-tostringtag-7c6352d6.js";import"./has-symbols-cd7870b9.js";import"./call-bind-9e7f09da.js";import"./get-intrinsic-f35014ba.js";import"./has-proto-8ede3a55.js";import"./function-bind-68631a08.js";import"./has-ab8e2922.js";import"./is-generator-function-06dfaf9d.js";import"./which-typed-array-cf6b6a29.js";import"./for-each-f57c5052.js";import"./is-callable-7492318c.js";import"./available-typed-arrays-61974ec7.js";import"./gopd-bab4d6bd.js";import"./is-typed-array-037eef20.js";import"./util-deprecate-c3aabb3c.js";import"./string_decoder-ef7b01fe.js";import"./ripemd160-58dcfa02.js";import"./sha.js-cea3da2e.js";import"./cipher-base-aee0e03d.js";import"./stream-browserify-7496a08f.js";import"./create-hmac-e8b5ea4a.js";import"./browserify-sign-a708a95f.js";import"./browserify-rsa-bfbdcbb6.js";import"./bn.js-1ae23332.js";import"./elliptic-75e883ee.js";import"./minimalistic-assert-4cc49674.js";import"./minimalistic-crypto-utils-6f869a51.js";import"./brorand-03f0f79d.js";import"./hash.js-4f5dfe73.js";import"./hmac-drbg-87799258.js";import"./parse-asn1-465c125b.js";import"./asn1.js-405e93e4.js";import"./safer-buffer-2ac6237e.js";import"./evp_bytestokey-e91543fa.js";import"./browserify-aes-ce20a0e6.js";import"./buffer-xor-87a7236a.js";import"./pbkdf2-e2ae8643.js";import"./browserify-cipher-c4c37ca3.js";import"./browserify-des-3f7e64d9.js";import"./des.js-d262604a.js";import"./diffie-hellman-c8260aab.js";import"./miller-rabin-de27bf02.js";import"./create-ecdh-ffe720e9.js";import"./public-encrypt-fc0568a2.js";import"./randomfill-2874e5f1.js";import"./mathjs-2a513dae.js";import"./@babel-484168fe.js";import"./typed-function-4896e4f1.js";import"./decimal.js-d133ee8e.js";import"./complex.js-cf2520e8.js";import"./fraction.js-39e7906a.js";import"./javascript-natural-sort-c4dd0c27.js";import"./escape-latex-c8a96e7a.js";import"./seedrandom-c8f991ad.js";import"./tiny-emitter-56d49cfd.js";import"./js-sha3-d7d4f583.js";import"./crypto-random-string-d158262e.js";import"./jose-92e5544c.js";import"./vue-loading-overlay-b89251b1.js";import"./jspdf-30014160.js";import"./fflate-8981c52c.js";import"./vue-debounce-3bbbf8c6.js";import"./mitt-f7ef348c.js";/* empty css                   */import"./maska-6f10db43.js";import"./@fortawesome-014b81f2.js";import"./vue3-blocks-tree-e53499e3.js";import"./@noble-f8eff84a.js";import"./utf8-c941a4a0.js";import"./bip39-936aefa9.js";import"./axios-b48d2c29.js";import"./flatbuffers-edc4f8d7.js";import"./ws-0a714537.js";import"./@intlify-16888cd3.js";import"./jdenticon-e4458e79.js";import"./TextInput-909d01ae.js";import"./TextInputClean-5873929f.js";import"./icon-key-5b3f7dda.js";const Be="/web-wallet-vuejs/assets/icon-blue-tick-41ef93f6.svg";const Se={name:"ViewAccountDelegate",components:{AccountComponent:xe,PasswordInput:fe,AccountTabs:Ie,TransactionFeeDisplay:be},props:{address:String},setup(a){const{t:s}=Ce(),L="^(0x|0X)?[a-fA-F0-9].{63,65}$";let e=d(""),T=d(!0);const b=d(""),M=d(!1),C=d(!1),w=m.currentLoggedInWallet?m.currentLoggedInWallet.selectDefaultAccount():null,K=d(w?w.address:""),N=d(_.toCurrencyFormat(w?w.balance:0,h.nativeToken.divisibility)),i=l(()=>{if(!m.currentLoggedInWallet)return null;let t=m.currentLoggedInWallet.accounts.find(c=>c.address==a.address)||m.currentLoggedInWallet.others.find(c=>c.address==a.address);return t||null}),u=()=>i.value?W.getCosignerInWallet(i.value.publicKey).cosignerList:[],x=l(()=>{let t=u(),c=[];return t.forEach(o=>{c.push({publicKey:o,name:p(o).name,balance:p(o).balance})}),c}),z=l(()=>i.value?W.getCosignerInWallet(i.value.publicKey).cosignerList.length>0:!1),f=d(x.value[0]?x.value[0].publicKey:"");R(x,t=>{t.length&&(f.value=t[0]?t[0].publicKey:"")},{deep:!0});let D=d(!1);(()=>{i.value&&W.onPartial(S.PublicAccount.createFromPublicKey(i.value.publicKey,h.networkType)).then(t=>D.value=t).catch(t=>{D.value=!1})})();const G=l(()=>A.currentNetworkProfileConfig?_.convertToExact(A.currentNetworkProfileConfig.lockedFundsPerAggregate,h.nativeToken.divisibility):0),O=l(()=>A.currentNetworkProfile?_.convertToExact(_e.getLockFundFee(),h.nativeToken.divisibility):0),y=l(()=>i.value?!!i.value.getDirectParentMultisig().length:!1);let E=l(()=>H.getDelegateFee(y.value));const V=l(()=>y.value?E.value+G.value+O.value:E.value),X=l(()=>i.value?i.value.balance:0),oe=l(()=>h.nativeToken.label),J=l(()=>h.nativeToken.divisibility),re=l(()=>m.currentLoggedInWallet?y.value?p(f.value)?_.toCurrencyFormat(p(f.value).balance,J.value):"0":_.toCurrencyFormat(X.value,J.value):"0"),Q=l(()=>{var t=!1;return y.value?p(f.value)&&(p(f.value).balance<V.value?t=!0:t=!1):X.value<V.value&&(t=!0),t}),ae=l(()=>{let t=re.value.split(".");return t[1]!=null?{left:t[0],right:t[1]}:{left:t[0],right:null}});R(e,t=>{t.match(L)?T.value=!1:T.value=!0});const k=d(""),B=d(""),le=d(""),ie=Pe(),ne=Ae();d(a.address);const Y="^[^ ]{8,}$",se=Ve(),ce=new he(we.buildAPIEndpoint(A.selectedAPIEndpoint,A.currentNetworkProfile.httpPort));se.appContext.config.globalProperties.emitter;const j=m.currentLoggedInWallet?m.currentLoggedInWallet.name:"",ue=l(()=>D.value||Q.value||!z.value&&y.value?!0:q.value?q.value?!b.value.match(Y):!0:!b.value.match(Y)),de=t=>{let c=document.getElementById(t).getAttribute("copyValue"),o=document.getElementById(t).getAttribute("copySubject");ke(c),ne.add({severity:"info",detail:o+" "+s("general.copied"),group:"br-custom",life:3e3})},U=async()=>{if(i.value&&i.value){const t=_.createPublicAccount(i.value.publicKey,h.networkType),c=await ce.accountAPI.getAccountInfo(t.address);k.value=c.linkedAccountKey}};U(),R(()=>i,t=>{U()},{deep:!0});const q=l(()=>{let t=!1;return k.value!=""&&(k.value==="0".repeat(64)?t=!1:k.value!=="0".repeat(64)&&(t=!0)),t}),Z=async()=>{e.value=S.Account.generateNewAccount().privateKey};Z();const me=async()=>{const t=ee.createAccountFromPrivateKey(e.value,h.networkType);t&&(B.value=t.publicKey),ee.verifyWalletPassword(j,A.chainNetworkName,b.value)?(k.value!=="0".repeat(64)?(H.createDelegateTransaction(f.value,y.value,i.value,b.value,k.value,S.LinkAction.Unlink),b.value="",C.value=""):B.value!=""&&(H.createDelegateTransaction(f.value,y.value,i.value,b.value,B.value,S.LinkAction.Link),b.value="",C.value=""),ie.push({name:"ViewAccountPendingTransactions",params:{address:a.address}})):C.value=s("general.walletPasswordInvalid",{name:j})},$=l(()=>{if(!m.currentLoggedInWallet)return[];let t=m.currentLoggedInWallet.accounts.map(o=>({name:o.name,balance:o.balance,address:o.address,publicKey:o.publicKey,isMultisig:!!o.getDirectParentMultisig().length})),c=m.currentLoggedInWallet.others.filter(o=>o.type==="MULTISIG").map(o=>({name:o.name,balance:o.balance,address:o.address,publicKey:o.publicKey,isMultisig:!0}));return t.concat(c)}),pe=l(()=>_.amountFormatterSimple(V.value,0)),ge=l(()=>{if(A.currentNetworkProfileConfig){let t=W.getCosignerInWallet($.value.find(o=>o.address==K.value)?$.value.find(o=>o.address==K.value).publicKey:""),c=[];return t.cosignerList.forEach(o=>{c.push({publicKey:o,name:p(o).name,balance:p(o).balance,address:p(o).address})}),t.cosignerList=c,t}else return{hasCosigner:!1,cosignerList:[]}}),ve=l(()=>{let t=p(f.value)?p(f.value).balance:0;return _.toCurrencyFormat(t,3)});return{showPrivateKeyError:T,findAcc:p,privateKey:e,currentNativeTokenName:oe,splitBalance:ae,isMultisig:y,acc:i,walletPassword:b,showPasswdError:M,walletState:m,createDelegate:me,verifyDelegateAcc:U,delegateAcc:k,AccPublicKey:B,AccPrivateKey:le,disableLinkBtn:ue,copy:de,err:C,walletName:j,delegateValue:q,isCosigner:z,lockFund:G,transactionFee:E,totalFee:V,lockFundTxFee:O,onPartial:D,walletCosignerList:x,selectedCosignPublicKey:f,fundStatus:Q,generatePrivateKey:Z,totalFeeFormatted:pe,selectedAccAdd:K,accBalance:N,getMultiSigCosigner:ge,checkCosignBalance:ve}}},We={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},Me={class:"border-2 border-t-0 filter shadow-lg lg:grid lg:grid-cols-3"},Ne={class:"lg:col-span-2 py-6 pr-6"},Ee={class:"pl-6"},je={key:0,class:"error error_box mb-5"},Ue={key:0,class:"text-left mt-2 mb-5 ml-6"},qe={key:0},He={class:"text-tsm"},Re={key:0,class:"font-bold"},ze={key:1,class:"font-bold"},Ge=["value"],Oe={key:1},Xe={class:"text-xs font-semibold pl-6"},Je={class:"text-xxs pl-6 mt-2"},Qe=r("div",{class:"mt-4"},null,-1),Ye=r("div",{class:"ml-6 my-7 gray-line"},null,-1),Ze={class:"pl-6"},$e={class:"text-xs text-blue-primary mt-0.5 font-semibold uppercase"},et={class:"flex"},tt=["copyValue","copySubject"],ot={class:"text-txs mt-1 text-red-400 border px-1.5 py-2 border-red-400 rounded-md"},rt={key:2},at={class:"text-xs font-semibold pl-6"},lt={class:"ml-6 px-3 py-2 mt-3 bg-green-100"},it=r("img",{src:Be,class:"h-3 w-3 inline-block mr-2"},null,-1),nt={class:"text-xs mt-2 inline-block"},st={class:"border border-blue-300 rounded-md ml-6 p-3 mt-3 bg-blue-50 overflow-x-auto"},ct={class:"text-xs inline-block"},ut=["copyValue","copySubject"],dt={class:"bg-navy-primary p-6 lg:col-span-1"},mt=r("div",{class:"mt-5"},null,-1),pt={class:"font-semibold text-xs text-white mb-1.5"},gt={class:"mt-3"},vt=["disabled"],ft=["disabled"],bt={class:"text-center"};function yt(a,s,L,e,T,b){const M=I("AccountComponent"),C=I("AccountTabs"),w=I("font-awesome-icon"),K=I("TransactionFeeDisplay"),N=I("PasswordInput"),i=I("router-link");return g(),v("div",null,[r("div",We,[P(M,{address:L.address,class:"mb-6"},null,8,["address"]),P(C,{address:L.address,selected:"details"},null,8,["address"]),r("div",Me,[r("div",Ne,[r("div",Ee,[e.err!=""?(g(),v("div",je,n(e.err),1)):F("v-if",!0)]),e.isMultisig?(g(),v("div",Ue,[e.walletCosignerList.length>0?(g(),v("div",qe,[r("div",He,[te(n(a.$t("general.initiateBy"))+": ",1),e.walletCosignerList.length==1?(g(),v("span",Re,n(e.walletCosignerList[0].name),1)):(g(),v("span",ze,[Le(r("select",{class:"","onUpdate:modelValue":s[0]||(s[0]=u=>e.selectedCosignPublicKey=u)},[(g(!0),v(Fe,null,Te(e.walletCosignerList,(u,x)=>(g(),v("option",{value:e.findAcc(u.publicKey).publicKey,key:x},n(u.name),9,Ge))),128))],512),[[Ke,e.selectedCosignPublicKey]])]))])])):F("v-if",!0)])):F("v-if",!0),e.delegateValue?(g(),v("div",rt,[r("div",at,n(a.$t("delegate.accDelegated")),1),r("div",lt,[it,r("div",nt,n(a.$t("delegate.linked")),1)]),r("div",st,[r("div",ct,n(a.$t("delegate.publicKeyOfDelegate")),1),P(w,{icon:"copy",onClick:s[2]||(s[2]=u=>e.copy("delegatePublicKey")),title:a.$t("general.copy"),class:"inline-block float-right mt-1 w-5 h-5 text-blue-link cursor-pointer"},null,8,["title"]),r("div",{class:"text-xs mt-0.5 font-semibold",id:"delegatePublicKey",copyValue:e.delegateAcc,copySubject:a.$t("delegate.delegatePublicKey")},n(e.delegateAcc),9,ut)])])):(g(),v("div",Oe,[r("div",Xe,n(a.$t("general.delegate")),1),r("div",Je,n(a.$t("delegate.notLinked")),1),Qe,Ye,r("div",Ze,[r("div",$e,n(a.$t("general.privateKey")),1),r("div",et,[r("div",{id:"private",class:"truncate text-xs mt-1 font-semibold",type:"text",copyValue:e.privateKey,copySubject:a.$t("general.privateKey")},n(e.privateKey),9,tt),P(w,{title:a.$t("general.copy"),icon:"copy",onClick:s[1]||(s[1]=u=>e.copy("private")),class:"ml-2 pb-1 w-5 h-5 text-blue-link mt-0.5 cursor-pointer"},null,8,["title"])]),r("div",ot,n(a.$t("general.pkWarning")),1)])]))]),r("div",dt,[P(K,{"fund-status":e.fundStatus,"is-multisig":e.isMultisig,"is-cosigner":e.isCosigner,"on-partial":e.onPartial,"transaction-fee":e.transactionFee,"total-fee-formatted":e.totalFeeFormatted,"get-multi-sig-cosigner":e.getMultiSigCosigner,"check-cosign-balance":e.checkCosignBalance,"lock-fund-currency":e.lockFund,"lock-fund-tx-fee":e.lockFundTxFee,balance:e.accBalance,"selected-acc-add":e.selectedAccAdd},null,8,["fund-status","is-multisig","is-cosigner","on-partial","transaction-fee","total-fee-formatted","get-multi-sig-cosigner","check-cosign-balance","lock-fund-currency","lock-fund-tx-fee","balance","selected-acc-add"]),mt,r("div",pt,n(a.$t("general.enterPasswordContinue")),1),P(N,{placeholder:a.$t("general.enterPassword"),errorMessage:a.$t("general.passwordRequired"),showError:e.showPasswdError,modelValue:e.walletPassword,"onUpdate:modelValue":s[3]||(s[3]=u=>e.walletPassword=u)},null,8,["placeholder","errorMessage","showError","modelValue"]),r("div",gt,[e.delegateValue?(g(),v("button",{key:0,type:"submit",class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:s[4]||(s[4]=(...u)=>e.createDelegate&&e.createDelegate(...u)),disabled:e.disableLinkBtn},n(a.$t("delegate.unlinkAcc")),9,vt)):F("v-if",!0),e.delegateValue?F("v-if",!0):(g(),v("button",{key:1,type:"submit",class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:s[5]||(s[5]=(...u)=>e.createDelegate&&e.createDelegate(...u)),disabled:e.disableLinkBtn},n(a.$t("delegate.delegateAcc")),9,ft))]),r("div",bt,[P(i,{to:{name:"ViewAccountDetails",params:{address:L.address}},class:"content-center text-xs text-white underline"},{default:De(()=>[te(n(a.$t("general.cancel")),1)]),_:1},8,["to"])])])])])])}const Cr=ye(Se,[["render",yt],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/account/submodule/delegate/views/ViewAccountDelegate.vue"]]);export{Cr as default};
