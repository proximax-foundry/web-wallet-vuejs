import{_ as me,u as be,r as g,w as c,H as p,B as y,c as l,am as v,a as j,n as w,S as ye,l as pe,A as _e,aX as ke,G as he,i as T,o as f,b as m,e as a,m as x,t as r,f as K,x as Y,O as Ae,aa as Ce,F as we,g as xe,v as Pe,z as S,h as Le,W as Te}from"./index-ca9ee916.js";import{_ as Ke}from"./PasswordInput.vue_vue_type_script_setup_true_lang-523abb96.js";import{_ as Ie}from"./TransactionFeeDisplay.vue_vue_type_script_setup_true_lang-92bd7dba.js";import{c as Fe}from"./functions-424b64e8.js";import{a as De}from"./accountUtils-12053197.js";import{A as Be,_ as Se}from"./AccountTabs.vue_vue_type_script_setup_true_lang-a1050f5b.js";import{M as V}from"./multisigUtils-84f82ba8.js";import{T as W}from"./transactionState-85c61020.js";import"./proximax-logo-ecfc3767.js";import"./jdenticon-module-183f847b.js";import"./TextInput-ff117c5b.js";import"./TextInputClean-09777343.js";import"./icon-key-5b3f7dda.js";const Ve="/web-wallet-vuejs/assets/icon-blue-tick-41ef93f6.svg";const We={name:"ViewAccountDelegate",components:{AccountComponent:Be,PasswordInput:Ke,AccountTabs:Se,TransactionFeeDisplay:Ie},props:{address:String},setup(s){const{t:u}=be(),P="^(0x|0X)?[a-fA-F0-9].{63,65}$";let t=g(""),I=g(!0);const z=g(!1),L=g(!1),h=c.currentLoggedInWallet?c.currentLoggedInWallet.selectDefaultAccount():null,A=g(h?h.address:""),M=g(p.toCurrencyFormat(h?h.balance:0,y.nativeToken.divisibility)),o=l(()=>{if(!c.currentLoggedInWallet)return null;let e=c.currentLoggedInWallet.accounts.find(i=>i.address==s.address)||c.currentLoggedInWallet.others.find(i=>i.address==s.address);return e||null}),d=()=>o.value?V.getCosignerInWallet(o.value.publicKey).cosignerList:[],C=l(()=>{let e=d(),i=[];return e.forEach(n=>{i.push({publicKey:n,name:v(n).name,balance:v(n).balance})}),i}),G=l(()=>o.value?V.getCosignerInWallet(o.value.publicKey).cosignerList.length>0:!1),b=g(C.value[0]?C.value[0].publicKey:"");j(C,e=>{e.length&&(b.value=e[0]?e[0].publicKey:"")},{deep:!0});let F=g(!1);(()=>{o.value&&V.onPartial(S.PublicAccount.createFromPublicKey(o.value.publicKey,y.networkType)).then(e=>F.value=e).catch(e=>{F.value=!1})})();const H=l(()=>w.currentNetworkProfileConfig?p.convertToExact(w.currentNetworkProfileConfig.lockedFundsPerAggregate,y.nativeToken.divisibility):0),O=l(()=>w.currentNetworkProfile?p.convertToExact(ye.getLockFundFee(),y.nativeToken.divisibility):0),_=l(()=>o.value?!!o.value.getDirectParentMultisig().length:!1);let N=l(()=>De.getDelegateFee(_.value));const D=l(()=>_.value?N.value+H.value+O.value:N.value),X=l(()=>o.value?o.value.balance:0),Z=l(()=>y.nativeToken.label),R=l(()=>y.nativeToken.divisibility),$=l(()=>c.currentLoggedInWallet?_.value?v(b.value)?p.toCurrencyFormat(v(b.value).balance,R.value):"0":p.toCurrencyFormat(X.value,R.value):"0"),q=l(()=>{var e=!1;return _.value?v(b.value)&&(v(b.value).balance<D.value?e=!0:e=!1):X.value<D.value&&(e=!0),e}),ee=l(()=>{let e=$.value.split(".");return e[1]!=null?{left:e[0],right:e[1]}:{left:e[0],right:null}});j(t,e=>{e.match(P)?I.value=!1:I.value=!0});const k=g(""),B=g(""),te=g(""),ne=pe(),ae=_e();g(s.address);const le=Le(),se=new ke(he.buildAPIEndpoint(w.selectedAPIEndpoint,w.currentNetworkProfile.httpPort));le.appContext.config.globalProperties.emitter;const oe=c.currentLoggedInWallet?c.currentLoggedInWallet.name:"",ie=l(()=>!!(F.value||q.value||!G.value&&_.value)),re=e=>{let i=document.getElementById(e).getAttribute("copyValue"),n=document.getElementById(e).getAttribute("copySubject");Fe(i),ae.add({severity:"info",detail:n+" "+u("general.copied"),group:"br-custom",life:3e3})},E=async()=>{if(o.value&&o.value){const e=p.createPublicAccount(o.value.publicKey,y.networkType),i=await se.accountAPI.getAccountInfo(e.address);k.value=i.linkedAccountKey}};E(),j(()=>o,e=>{E()},{deep:!0});const ce=l(()=>{let e=!1;return k.value!=""&&(k.value==="0".repeat(64)?e=!1:k.value!=="0".repeat(64)&&(e=!0)),e}),J=async()=>{t.value=S.Account.generateNewAccount().privateKey};J();const ue=async()=>{const e=Te.createAccountFromPrivateKey(t.value,y.networkType);e&&(B.value=e.publicKey);let i="";const n=y.buildTxn;if(k.value!=="0".repeat(64)?(i=n.accountLinkBuilder().remoteAccountKey(k.value).linkAction(S.LinkAction.Unlink).build().serialize(),L.value=""):B.value!=""&&(i=n.accountLinkBuilder().remoteAccountKey(B.value).linkAction(S.LinkAction.Link).build().serialize(),L.value=""),_.value){let U=c.currentLoggedInWallet.accounts.find(fe=>fe.publicKey==b.value).address;W.selectedAddress=U,W.selectedMultisigAddress=o.value.address}else W.selectedAddress=o.value.address;W.unsignedTransactionPayload=i,ne.push({name:"ViewConfirmTransaction"})},Q=l(()=>{if(!c.currentLoggedInWallet)return[];let e=c.currentLoggedInWallet.accounts.map(n=>({name:n.name,balance:n.balance,address:n.address,publicKey:n.publicKey,isMultisig:!!n.getDirectParentMultisig().length})),i=c.currentLoggedInWallet.others.filter(n=>n.type==="MULTISIG").map(n=>({name:n.name,balance:n.balance,address:n.address,publicKey:n.publicKey,isMultisig:!0}));return e.concat(i)}),de=l(()=>p.amountFormatterSimple(D.value,0)),ge=l(()=>{if(w.currentNetworkProfileConfig){let e=V.getCosignerInWallet(Q.value.find(n=>n.address==A.value)?Q.value.find(n=>n.address==A.value).publicKey:""),i=[];return e.cosignerList.forEach(n=>{i.push({publicKey:n,name:v(n).name,balance:v(n).balance,address:v(n).address})}),e.cosignerList=i,e}else return{hasCosigner:!1,cosignerList:[]}}),ve=l(()=>{let e=v(b.value)?v(b.value).balance:0;return p.toCurrencyFormat(e,3)});return{showPrivateKeyError:I,findAcc:v,privateKey:t,currentNativeTokenName:Z,splitBalance:ee,isMultisig:_,acc:o,showPasswdError:z,walletState:c,createDelegate:ue,verifyDelegateAcc:E,delegateAcc:k,AccPublicKey:B,AccPrivateKey:te,disableLinkBtn:ie,copy:re,err:L,walletName:oe,delegateValue:ce,isCosigner:G,lockFund:H,transactionFee:N,totalFee:D,lockFundTxFee:O,onPartial:F,walletCosignerList:C,selectedCosignPublicKey:b,fundStatus:q,generatePrivateKey:J,totalFeeFormatted:de,selectedAccAdd:A,accBalance:M,getMultiSigCosigner:ge,checkCosignBalance:ve}}},Me={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},Ne={class:"border-2 border-t-0 filter shadow-lg lg:grid lg:grid-cols-3"},Ee={class:"lg:col-span-2 py-6 pr-6"},Ue={class:"pl-6"},je={key:0,class:"error error_box mb-5"},ze={key:0,class:"text-left mt-2 mb-5 ml-6"},Ge={key:0},He={class:"text-tsm"},Oe={key:0,class:"font-bold"},Xe={key:1,class:"font-bold"},Re=["value"],qe={key:1},Je={class:"text-xs font-semibold pl-6"},Qe={class:"text-xxs pl-6 mt-2"},Ye=a("div",{class:"mt-4"},null,-1),Ze=a("div",{class:"ml-6 my-7 gray-line"},null,-1),$e={class:"pl-6"},et={class:"text-xs text-blue-primary mt-0.5 font-semibold uppercase"},tt={class:"flex"},nt=["copyValue","copySubject"],at={class:"text-txs mt-1 text-red-400 border px-1.5 py-2 border-red-400 rounded-md"},lt={key:2},st={class:"text-xs font-semibold pl-6"},ot={class:"ml-6 px-3 py-2 mt-3 bg-green-100"},it=a("img",{src:Ve,class:"h-3 w-3 inline-block mr-2"},null,-1),rt={class:"text-xs mt-2 inline-block"},ct={class:"border border-blue-300 rounded-md ml-6 p-3 mt-3 bg-blue-50 overflow-x-auto"},ut={class:"text-xs inline-block"},dt=["copyValue","copySubject"],gt={class:"bg-navy-primary p-6 lg:col-span-1"},vt=a("div",{class:"mt-5"},null,-1),ft={class:"mt-3"},mt=["disabled"],bt=["disabled"],yt={class:"text-center"};function pt(s,u,P,t,I,z){const L=T("AccountComponent"),h=T("AccountTabs"),A=T("font-awesome-icon"),M=T("TransactionFeeDisplay"),o=T("router-link");return f(),m("div",null,[a("div",Me,[x(L,{address:P.address,class:"mb-6"},null,8,["address"]),x(h,{address:P.address,selected:"details"},null,8,["address"]),a("div",Ne,[a("div",Ee,[a("div",Ue,[t.err!=""?(f(),m("div",je,r(t.err),1)):K("",!0)]),t.isMultisig?(f(),m("div",ze,[t.walletCosignerList.length>0?(f(),m("div",Ge,[a("div",He,[Y(r(s.$t("general.initiateBy"))+": ",1),t.walletCosignerList.length==1?(f(),m("span",Oe,r(t.walletCosignerList[0].name),1)):(f(),m("span",Xe,[Ae(a("select",{class:"","onUpdate:modelValue":u[0]||(u[0]=d=>t.selectedCosignPublicKey=d)},[(f(!0),m(we,null,xe(t.walletCosignerList,(d,C)=>(f(),m("option",{value:t.findAcc(d.publicKey).publicKey,key:C},r(d.name),9,Re))),128))],512),[[Ce,t.selectedCosignPublicKey]])]))])])):K("",!0)])):K("",!0),t.delegateValue?(f(),m("div",lt,[a("div",st,r(s.$t("delegate.accDelegated")),1),a("div",ot,[it,a("div",rt,r(s.$t("delegate.linked")),1)]),a("div",ct,[a("div",ut,r(s.$t("delegate.publicKeyOfDelegate")),1),x(A,{icon:"copy",onClick:u[2]||(u[2]=d=>t.copy("delegatePublicKey")),title:s.$t("general.copy"),class:"inline-block float-right mt-1 w-5 h-5 text-blue-link cursor-pointer"},null,8,["title"]),a("div",{class:"text-xs mt-0.5 font-semibold",id:"delegatePublicKey",copyValue:t.delegateAcc,copySubject:s.$t("delegate.delegatePublicKey")},r(t.delegateAcc),9,dt)])])):(f(),m("div",qe,[a("div",Je,r(s.$t("general.delegate")),1),a("div",Qe,r(s.$t("delegate.notLinked")),1),Ye,Ze,a("div",$e,[a("div",et,r(s.$t("general.privateKey")),1),a("div",tt,[a("div",{id:"private",class:"truncate text-xs mt-1 font-semibold",type:"text",copyValue:t.privateKey,copySubject:s.$t("general.privateKey")},r(t.privateKey),9,nt),x(A,{title:s.$t("general.copy"),icon:"copy",onClick:u[1]||(u[1]=d=>t.copy("private")),class:"ml-2 pb-1 w-5 h-5 text-blue-link mt-0.5 cursor-pointer"},null,8,["title"])]),a("div",at,r(s.$t("general.pkWarning")),1)])]))]),a("div",gt,[x(M,{"fund-status":t.fundStatus,"is-multisig":t.isMultisig,"is-cosigner":t.isCosigner,"on-partial":t.onPartial,"transaction-fee":t.transactionFee,"total-fee-formatted":t.totalFeeFormatted,"get-multi-sig-cosigner":t.getMultiSigCosigner,"check-cosign-balance":t.checkCosignBalance,"lock-fund-currency":t.lockFund,"lock-fund-tx-fee":t.lockFundTxFee,balance:t.accBalance,"selected-acc-add":t.selectedAccAdd},null,8,["fund-status","is-multisig","is-cosigner","on-partial","transaction-fee","total-fee-formatted","get-multi-sig-cosigner","check-cosign-balance","lock-fund-currency","lock-fund-tx-fee","balance","selected-acc-add"]),vt,a("div",ft,[t.delegateValue?(f(),m("button",{key:0,type:"submit",class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:u[3]||(u[3]=(...d)=>t.createDelegate&&t.createDelegate(...d)),disabled:t.disableLinkBtn},r(s.$t("delegate.unlinkAcc")),9,mt)):K("",!0),t.delegateValue?K("",!0):(f(),m("button",{key:1,type:"submit",class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:u[4]||(u[4]=(...d)=>t.createDelegate&&t.createDelegate(...d)),disabled:t.disableLinkBtn},r(s.$t("delegate.delegateAcc")),9,bt))]),a("div",yt,[x(o,{to:{name:"ViewAccountDetails",params:{address:P.address}},class:"content-center text-xs text-white underline"},{default:Pe(()=>[Y(r(s.$t("general.cancel")),1)]),_:1},8,["to"])])])])])])}const Bt=me(We,[["render",pt]]);export{Bt as default};
