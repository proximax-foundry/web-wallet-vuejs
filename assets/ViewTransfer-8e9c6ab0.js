import{d as R,I as we,c as H,w as E,r as T,k as X,o as m,b as p,f as $,s as C,z as U,e,t as d,C as L,i as me,_ as W,O as ke,a as z,A as u,E as v,m as ue,P as Ae,Q as oe,l as Te,B as $e,F as te,W as ce,n as le,R as Z,h as de,u as je,H as D,D as He,q as Ee,S as Ke}from"./index-9f44b159.js";import{t as ie}from"./jdenticon-module-342376c0.js";import{S as qe}from"./SelectAccountAndContact-fe3483f3.js";import{_ as ve}from"./proximax-logo-ecfc3767.js";import{P as Ue}from"./PasswordInput-0577d8e3.js";import{_ as Re}from"./icon-red-x-a5511f99.js";import{_ as We}from"./icon-green-tick-1b766454.js";const De={key:0,class:"text-blue-primary font-semibold uppercase text-xxs mt-3"},Oe={key:0,class:"account-item-value account-item"},ze={class:"flex"},Xe=["innerHTML"],Ze={class:"flex flex-col ml-2 text-left"},Qe=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Account to create / initiate transfer",-1),Ge={class:"mt-1 text-tsm font-bold"},Je={class:"account-item"},Ye={class:"flex"},et=["innerHTML"],tt={class:"text-xs ml-2 font-semibold"},lt=R({__name:"SelectInputAccount",emits:["select-account","update:modelValue"],setup(o){const h=me().appContext.config.globalProperties.emitter;let f=new we("ThemeStyleConfig");f.init();let l=f.jdenticonConfig;const i=H(()=>E.currentLoggedInWallet?[...E.currentLoggedInWallet.accounts.filter(_=>_.multisigInfo.length==0||_.multisigInfo.find(g=>g.level==0).cosignaturies.length==0)].map(_=>({value:_.address,label:E.currentLoggedInWallet.convertAddressToName(_.address,!0)})):[]),n=T(null),b=T(null),M=(k,_)=>{if(k==null&&_==null){n.value=null,h.emit("select-account",null);return}h.emit("select-account",_),n.value.label=k,n.value.value=_,b.value=ie(_,25,l)};return(k,_)=>{const g=X("Dropdown");return m(),p("div",null,[n.value?$("v-if",!0):(m(),p("div",De,"Select Account to create / initiate transfer")),C(g,{showClear:!0,modelValue:n.value,"onUpdate:modelValue":_[0]||(_[0]=r=>n.value=r),style:{width:"100%"},options:i.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:_[1]||(_[1]=r=>{var x,c,a,w;M((x=r.value)==null?void 0:x.label,(c=r.value)==null?void 0:c.value),k.$emit("update:modelValue",(a=r.value)==null?void 0:a.value),k.$emit("select-account",(w=r.value)==null?void 0:w.value)})},{value:U(r=>[r.value?(m(),p("div",Oe,[e("div",ze,[e("div",{innerHTML:b.value},null,8,Xe),e("div",Ze,[Qe,e("div",Ge,d(r.value.label),1)])])])):$("v-if",!0)]),option:U(r=>[e("div",Je,[e("div",Ye,[e("div",{innerHTML:L(ie)(r.option.value,20,L(l))},null,8,et),e("div",tt,d(r.option.label),1)])])]),_:1},8,["modelValue","options"])])}}}),st=W(lt,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/SelectInputAccount.vue"]]),at={key:1,class:"text-xxs font-semibold uppercase mt-3 text-blue-primary"},nt={key:0,class:"account-item-value account-item"},ot={class:"flex"},it=["innerHTML"],rt={class:"flex flex-col ml-2 text-left"},ct=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Multisig Account",-1),ut={class:"mt-1 text-tsm font-bold"},dt={class:"account-item"},mt={class:"flex items-center"},vt=["innerHTML"],pt={class:"text-xs ml-2 font-semibold"},gt=R({__name:"SelectInputMultisigAccount",props:{selectedAddress:{type:String,required:!1}},emits:["select-multisig-account","update:modelValue"],setup(o){const y=o,h=T(!1),{selectedAddress:f}=ke(y),l=T([]),n=me().appContext.config.globalProperties.emitter;let b=new we("ThemeStyleConfig");b.init();let M=b.jdenticonConfig;const k=T(null);z(f,r=>{if(g(null,null),r==null){g(null,null),l.value=[];return}const x=E.currentLoggedInWallet.accounts.find(a=>a.address==r),c=x.multisigInfo.find(a=>a.level==0);l.value=c?[...x.multisigInfo].filter(a=>a.level<0).map(a=>{const F=[...E.currentLoggedInWallet.accounts,...E.currentLoggedInWallet.others].find(I=>I.publicKey==a.publicKey);return{label:F?E.currentLoggedInWallet.convertAddressToName(F.address):u.PublicAccount.createFromPublicKey(a.publicKey,v.networkType).address.plain(),value:u.PublicAccount.createFromPublicKey(a.publicKey,v.networkType).address.plain()}}):[]}),z(k,r=>{r==null&&(h.value=!1)});const _=T(null),g=(r,x)=>{if(r==null&&x==null){k.value=null,n.emit("select-multisig-account",null);return}n.emit("select-multisig-account",x),k.value.label=r,k.value.value=x,_.value=ie(x,25,M)};return(r,x)=>{const c=X("Dropdown");return m(),p("div",null,[l.value.length&&!h.value?(m(),p("button",{key:0,class:"blue-btn py-2 px-3 mt-3",onClick:x[0]||(x[0]=a=>h.value=!0)},"Select Multisig Account")):$("v-if",!0),l.value.length&&h.value&&!k.value?(m(),p("div",at,"Select Multisig Account")):$("v-if",!0),h.value&&l.value.length?(m(),ue(c,{key:2,showClear:!0,modelValue:k.value,"onUpdate:modelValue":x[1]||(x[1]=a=>k.value=a),style:{width:"100%"},options:l.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:x[2]||(x[2]=a=>{var w,F,I,V;g((w=a.value)==null?void 0:w.label,(F=a.value)==null?void 0:F.value),r.$emit("update:modelValue",(I=a.value)==null?void 0:I.value),r.$emit("select-multisig-account",(V=a.value)==null?void 0:V.value)})},{value:U(a=>[a.value?(m(),p("div",nt,[e("div",ot,[e("div",{innerHTML:_.value},null,8,it),e("div",rt,[ct,e("div",ut,d(a.value.label),1)])])])):$("v-if",!0)]),option:U(a=>[e("div",dt,[e("div",mt,[e("div",{innerHTML:L(ie)(a.option.value,20,L(M))},null,8,vt),e("div",pt,d(a.option.label),1)])])]),_:1},8,["modelValue","options"])):$("v-if",!0)])}}}),ft=W(gt,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/SelectInputMultisigAccount.vue"]]),bt={key:0},ht={class:"flex justify-between"},yt={class:"flex flex-col ml-2 text-left"},xt=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Asset",-1),_t={class:"mt-1 text-tsm font-bold"},wt={class:"mt-1 text-tsm font-bold"},kt={class:"account-item"},At={class:"flex justify-between"},Tt={class:"mt-1 text-tsm font-bold"},$t={class:"mt-1 text-tsm font-bold"},It=R({__name:"SelectInputAsset",props:{index:{type:Number,required:!0},assetOptions:{type:Object,required:!0},selectedAssets:{type:Object,required:!1}},emits:["select-asset","update:modelValue"],setup(o){const y=o,h=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],f=g=>{const r=h.find(x=>x.namespace==g);return r?r.name:g},{assetOptions:l,selectedAssets:i,index:n}=ke(y),b=T(!1),M=H(()=>{const g=new Set(i.value.map(r=>r.id));return l.value.filter(r=>!g.has(r.id))}),k=async g=>{if(b.value)return;b.value=!0;const{first:r,last:x}=g,c=[];for(let N=r;N<x;N++)l.value[N].hasUpdated||c.push(new u.MosaicId(l.value[N].id));if(!c.length){b.value=!1;return}const a=await v.chainAPI.assetAPI.getMosaicsNames(c),w=await v.chainAPI.assetAPI.getMosaics(c);let F=0,I=0;const V=new Map;a.forEach((N,B)=>{V.set(N.mosaicId.toHex(),B)}),w.sort((N,B)=>{const A=V.get(N.mosaicId.toHex()),K=V.get(B.mosaicId.toHex());return A-K});for(let N=r;N<x;N++){if(!a[F])continue;const B=l.value.find(A=>A.id==a[F].mosaicId.toHex());B&&(B.namespace=a[F].names.length?a[F].names[0].name:"",B.balance=B.balance/Math.pow(10,w[I].divisibility),B.divisibility=w[I].divisibility,B.hasUpdated=!0,F++,I++)}b.value=!1},_=g=>{if(g==null){i.value.splice(n.value,1);return}i.value[n.value].balance=g.balance,i.value[n.value].id=g.id,i.value[n.value].namespace=g.namespace,i.value[n.value].divisibility=g.divisibility,i.value[n.value].amount="0"};return(g,r)=>{const x=X("Dropdown");return m(),p("div",null,[C(x,{showClear:!0,modelValue:L(i)[L(n)],"onUpdate:modelValue":r[0]||(r[0]=c=>L(i)[L(n)]=c),style:{width:"100%"},options:M.value,filter:!0,filterFields:["id","namespace"],emptyFilterMessage:" ",placeholder:"Select Asset",virtualScrollerOptions:{lazy:!0,onLazyLoad:k,showLoader:!0,loading:b.value,delay:0,itemSize:38},onChange:r[1]||(r[1]=c=>{var a;_(c.value),g.$emit("update:modelValue",(a=c.value)==null?void 0:a.value)})},{value:U(c=>[c.value.id?(m(),p("div",bt,[e("div",ht,[e("div",yt,[xt,e("div",_t,d(f(c.value.namespace==""?c.value.id:c.value.namespace)),1)]),e("div",wt,"Balance: "+d(c.value.balance),1)])])):$("v-if",!0)]),option:U(c=>[e("div",kt,[e("div",At,[e("div",Tt,d(f(c.option.namespace==""?c.option.id:c.option.namespace)),1),e("div",$t,"Balance: "+d(c.option.balance),1)])])]),_:1},8,["modelValue","options","virtualScrollerOptions"])])}}}),Mt=W(It,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/SelectInputAsset.vue"]]),Ft={class:"border border-gray-200 px-2 py-1 rounded-md"},Pt={class:"flex justify-between"},Vt={class:"flex flex-col"},St={class:"uppercase font-light text-gray-500 text-txs text-left mb-2"},Nt={class:"flex w-full"},Lt={key:0,src:ve,class:"h-5 w-5 mt-0.5"},Ct=["value","data-maska","placeholder"],Bt=["disabled"],jt=R({__name:"TransferInputClean",props:{modelValue:{type:String,required:!0},decimal:{type:Number,required:!0},placeholder:{type:String,required:!0},toolTip:{type:String,required:!1},disabled:{type:Boolean,required:!1},showError:{type:Boolean,required:!1},logo:{type:Boolean,required:!1},balance:{type:Number,required:!1}},emits:["update:modelValue","show-error","clickedMaxAvailable"],setup(o){const y=o,h=()=>{let l="0";return y.decimal>0&&(l=l+"."+"9".repeat(y.decimal)),l},f={preProcess:l=>l.replace(/,/g,""),postProcess:l=>{if(!l)return"";let i=0;return y.decimal>0&&(i=1+y.decimal-(l.includes(".")?l.length-l.indexOf("."):0)),Intl.NumberFormat("en-US",{minimumFractionDigits:y.decimal}).format(parseFloat(l)).slice(0,i?-i:void 0)}};return(l,i)=>{const n=Ae("maska");return m(),p("div",{class:Te(o.disabled?"opacity-50":"")},[e("div",Ft,[e("div",Pt,[e("div",Vt,[e("div",St,d(o.placeholder),1),e("div",Nt,[o.logo?(m(),p("img",Lt)):$("v-if",!0),oe(e("input",{value:o.modelValue,class:"supply_input","data-maska":h(),"data-maska-tokens":"0:\\d:multiple|9:\\d:optional",placeholder:o.placeholder,onInput:i[0]||(i[0]=b=>l.$emit("update:modelValue",parseFloat(b.target.value.replace(/,/g,"")).toString()))},null,40,Ct),[[n,void 0,f]])])]),o.logo?(m(),p("button",{key:0,disabled:o.disabled==!0,class:"w-24 cursor-pointer focus:outline-none text-blue-primary text-xs font-bold",onClick:i[1]||(i[1]=b=>l.$emit("clickedMaxAvailable",!0))},d(l.$t("swap.maxAmount")),9,Bt)):$("v-if",!0)])])],2)}}});const he=W(jt,[["__scopeId","data-v-03ac6095"],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/TransferInputClean.vue"]]),Ht={class:"rounded-md bg-white flex border mt-3"},Et=["value","placeholder"],Kt=e("div",{class:"w-1 flex-none"},null,-1),qt={class:"text-gray-800"},Ut=R({__name:"TextAreaInput",props:{modelValue:{type:String,required:!1},currentBytes:{type:Number,required:!0},limit:{type:Number,required:!0},placeholder:{type:String,required:!0}},emits:["update:modelValue"],setup(o){return(y,h)=>(m(),p(te,null,[e("div",Ht,[e("textarea",{value:o.modelValue,onInput:h[0]||(h[0]=f=>y.$emit("update:modelValue",f.target.value)),rows:"2",class:"w-full text-gray-500 px-2 py-1 outline-none bg-white text-xs",placeholder:o.placeholder.toUpperCase()},null,40,Et),Kt]),e("div",{class:Te(["float-right mt-1 text-tsm",o.currentBytes>o.limit?"text-red-500":"text-gray-800"])},[$e(d(o.currentBytes)+" ",1),e("span",qt,"/"+d(o.limit),1)],2)],64))}}),Rt=W(Ut,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/TextAreaInput.vue"]]),Wt={class:"border border-gray-200 px-2 py-2 rounded-md w-full"},Dt={class:"flex gap-2"},Ot={class:"flex flex-col w-full"},zt={class:"uppercase text-gray-500 font-light text-xxs text-left"},Xt=["value"],Zt={key:0,class:"flex flex-col ml-auto justify-center mt-1"},Qt=e("img",{src:Re,class:"h-5 w-5 mr-auto ml-auto"},null,-1),Gt={class:"text-xxs text-red-400 font-bold uppercase"},Jt={key:1,class:"flex flex-col ml-auto justify-center mt-1"},Yt=e("img",{src:We,class:"h-5 w-5 mr-auto ml-auto"},null,-1),el={class:"text-xxs text-green-400 font-bold uppercase"},tl=R({__name:"FieldValidationInput",props:{placeholder:String,showError:Boolean,modelValue:String},emits:["update:modelValue"],setup(o){return(y,h)=>(m(),p("div",Wt,[e("div",Dt,[e("div",Ot,[e("div",zt,d(o.placeholder),1),e("input",{type:"text",value:o.modelValue,onInput:h[0]||(h[0]=f=>y.$emit("update:modelValue",f.target.value)),class:"w-full font-semibold text-tsm outline-none mt-1"},null,40,Xt)]),o.showError&&o.modelValue.length!=0?(m(),p("div",Zt,[Qt,e("div",Gt,d(y.$t("general.invalid")),1)])):o.showError?$("v-if",!0):(m(),p("div",Jt,[Yt,e("div",el,d(y.$t("general.valid")),1)]))])]))}});const ye=W(tl,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/FieldValidationInput.vue"]]),Ie="0".repeat(64),xe=u.PublicAccount.createFromPublicKey(Ie,v.networkType).address.plain(),_e=(o,y)=>{let h=[];return parseInt(o)>0&&h.push(new u.Mosaic(new u.MosaicId(v.nativeToken.assetId),u.UInt64.fromUint(Number(o)))),y.length>0&&y.forEach(f=>{parseInt(f.amount)>0&&h.push(new u.Mosaic(new u.MosaicId(f.id),u.UInt64.fromUint(Number(f.amount))))}),h},ae=class ae{};ae.createTransaction=async(y,h,f,l,i,n,b,M,k)=>{if(!ce.verifyWalletPassword(E.currentLoggedInWallet.name,le.chainNetworkName,i))return!1;const g=le.currentNetworkProfile.generationHash;let r=v.networkType,x=parseFloat(h)*Math.pow(10,v.nativeToken.divisibility),c=[];x>0&&c.push(new u.Mosaic(new u.MosaicId(v.nativeToken.assetId),u.UInt64.fromUint(Number(x)))),l.length>0&&l.forEach(A=>{A.amount>0&&c.push(new u.Mosaic(new u.MosaicId(A.id),u.UInt64.fromUint(Number(A.amount*Math.pow(10,A.divisibility)))))});let a=v.buildTxn,w,F;if(!b)w=E.currentLoggedInWallet.accounts.find(A=>A.address===n);else{w=E.currentLoggedInWallet.accounts.find(K=>K.address===n);const A=await v.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(b));F=u.PublicAccount.createFromPublicKey(A.publicKey,r)}let I=ce.decryptPrivateKey(new u.Password(i),w.encrypted,w.iv),V;if(M)try{const A=await v.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(y));V=u.EncryptedMessage.create(f,A.publicAccount,I)}catch{V=u.EncryptedMessage.create(f,u.PublicAccount.createFromPublicKey(k,v.networkType),I)}else V=u.PlainMessage.create(f);let N=a.transferBuilder().recipient(u.Address.createFromRawAddress(y)).mosaics(c).message(V).build();const B=u.Account.createFromPrivateKey(I,r,1);if(b){let A=E.currentLoggedInWallet.accounts.find(re=>re.address==n),K=ce.decryptPrivateKey(new u.Password(i),A.encrypted,A.iv),Q=u.Account.createFromPrivateKey(K,r,1);const G=[N.toAggregateV1(F)],J=a.aggregateBonded(G),Y=Q.preV2Sign(J,g),ee=Z.lockFundTx(Y),q=Q.preV2Sign(ee,g);Z.announceLF_AND_addAutoAnnounceABT(q,Y)}else{const A=B.preV2Sign(N,g);Z.announceTransaction(A)}return!0},ae.calculateAggregateFee=(y,h,f,l)=>{let i=v.buildTxn,n=_e(h,f),M=[i.transferBuilder().recipient(u.Address.createFromRawAddress(xe)).mosaics(n).message(l&&y.length>0?u.EncryptedMessage.create(y,u.PublicAccount.createFromPublicKey("0".repeat(64),v.networkType),"0".repeat(64)):u.PlainMessage.create(y)).build().toAggregateV1(u.PublicAccount.createFromPublicKey(Ie,v.networkType))];return i.aggregateBondedBuilder().innerTransactions(M).build().maxFee.compact()/Math.pow(10,v.nativeToken.divisibility)},ae.calculateFee=(y,h,f,l)=>{let i=v.buildTxn,n=_e(h,f);return i.transferBuilder().recipient(u.Address.createFromRawAddress(xe)).mosaics(n).message(l&&y.length>0?u.EncryptedMessage.create(y,u.PublicAccount.createFromPublicKey("0".repeat(64),v.networkType),"0".repeat(64)):u.PlainMessage.create(y)).build().maxFee.compact()/Math.pow(10,v.nativeToken.divisibility)};let se=ae;const ll={key:0},sl={class:"font-bold text-xs text-blue-primary uppercase"},al={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},nl={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},ol=["innerHTML"],il={class:"flex"},rl={class:"ml-1 text-blue-400 font-bold"},cl=e("img",{src:ve,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),ul={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs pt-2"},dl={class:"font-semibold lg:col-span-2 col-span-3"},ml={key:0,class:"lg:col-span-2 col-span-3 ml-auto"},vl=["innerHTML"],pl={class:"ml-1 text-blue-400"},gl={key:0,class:"lg:col-span-4 col-span-6 ml-auto"},fl={key:1,class:"lg:col-span-4 col-span-6 ml-auto"},bl=["index"],hl=e("div",{class:"border-b-2 border-gray-600 my-2"},null,-1),yl={class:"font-bold text-xs text-blue-primary uppercase"},xl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},_l={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},wl=["innerHTML"],kl={class:"flex"},Al={class:"ml-1 text-blue-400 font-bold"},Tl=e("img",{src:ve,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),$l=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),Il={key:1,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs pt-2"},Ml={class:"font-semibold lg:col-span-2 col-span-3"},Fl={key:0,class:"lg:col-span-2 col-span-3 ml-auto"},Pl=["innerHTML"],Vl={class:"ml-1 text-blue-400"},Sl={key:0,class:"lg:col-span-4 col-span-6 ml-auto"},Nl={key:1,class:"lg:col-span-4 col-span-6 ml-auto"},Ll=["index"],Cl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Bl={class:"font-semibold lg:col-span-2 col-span-3"},jl=["innerHTML"],Hl={class:"ml-1 text-blue-400"},El={key:3,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs"},Kl={class:"font-semibold lg:col-span-2 col-span-3"},ql=["innerHTML"],Ul={class:"ml-1 text-blue-400"},Rl={key:4,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Wl={class:"font-semibold lg:col-span-2 col-span-3"},Dl=["innerHTML"],Ol={class:"ml-1 text-blue-400"},zl=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),Xl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Zl=e("div",{class:"font-semibold lg:col-span-2 col-span-3 uppercase"},"Total",-1),Ql=["innerHTML"],Gl={class:"ml-1 text-blue-400"},Jl=R({__name:"TransferTxnSummary",props:{selectedMultisigAddress:{type:String||null},nativeTokenBalance:{type:Number,required:!0},selectedAssets:{type:Array,required:!0},lockFund:{type:Number,required:!0},txnFee:{type:Number,required:!0},lockFundTxFee:{type:Number,required:!0},totalFee:{type:Number,required:!0},nativeAmount:{type:String,required:!0},signerNativeTokenBalance:{type:Number,required:!0}},setup(o){const y=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],h=l=>{const i=y.find(n=>n.namespace==l);return i?i.name:l.length==16?l.substring(0,4)+"..."+l.substring(l.length-4,l.length+1):l},f=l=>{let i=l.toString().split(".");return i[1]!=null?'<span class="font-semibold text-sm">'+i[0]+'</span>.<span class="font-semibold text-xs">'+i[1]+"</span>":'<span class="font-semibold text-sm">'+i[0]+"</span>"};return(l,i)=>(m(),p(te,null,[o.selectedMultisigAddress?(m(),p("div",ll,[e("div",sl,d(l.$t("general.multisigAcc")),1),e("div",al,[e("div",nl,d(l.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:f(o.nativeTokenBalance??0)},null,8,ol),e("div",il,[e("div",rl,d(L(v).nativeToken.label),1),cl])]),e("div",ul,[e("div",dl,d(l.$t("transfer.transferAmount")),1),isNaN(parseFloat(o.nativeAmount))?(m(),p("div",ml,"0")):(m(),p("div",{key:1,class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.nativeAmount??0)},null,8,vl)),e("div",pl,d(L(v).nativeToken.label),1)]),(m(!0),p(te,null,de(o.selectedAssets,(n,b)=>(m(),p("div",{class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-white text-xs",key:b},[isNaN(parseFloat(n.amount))&&n.id!=null?(m(),p("div",gl,"0")):(m(),p("div",fl,d(n.amount),1)),n.id!=null?(m(),p("div",{key:2,class:"ml-1 text-blue-400",index:b},d(h(n.namespace==""?n.id:n.namespace)),9,bl)):$("v-if",!0)]))),128)),hl])):$("v-if",!0),$(" { end of multisig summary } "),$(" { beginning of signer summary } "),e("div",yl,d(l.$t("general.signerAcc")),1),e("div",xl,[e("div",_l,d(l.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:f(o.selectedMultisigAddress?o.signerNativeTokenBalance:o.nativeTokenBalance??0)},null,8,wl),e("div",kl,[e("div",Al,d(L(v).nativeToken.label),1),Tl])]),$l,o.selectedMultisigAddress?$("v-if",!0):(m(),p("div",Il,[e("div",Ml,d(l.$t("transfer.transferAmount")),1),isNaN(parseFloat(o.nativeAmount))?(m(),p("div",Fl,"0")):(m(),p("div",{key:1,class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.nativeAmount??0)},null,8,Pl)),e("div",Vl,d(L(v).nativeToken.label),1)])),o.selectedMultisigAddress?$("v-if",!0):(m(!0),p(te,{key:2},de(o.selectedAssets,(n,b)=>(m(),p("div",{class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-white text-xs",key:b},[isNaN(parseFloat(n.amount))&&n.id!=null?(m(),p("div",Sl,"0")):(m(),p("div",Nl,d(n.amount),1)),n.id!=null?(m(),p("div",{key:2,class:"ml-1 text-blue-400",index:b},d(h(n.namespace==""?n.id:n.namespace)),9,Ll)):$("v-if",!0)]))),128)),e("div",Cl,[e("div",Bl,d(o.selectedMultisigAddress!=null?l.$t("general.aggregateFee"):l.$t("general.transactionFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.txnFee)},null,8,jl),e("div",Hl,d(L(v).nativeToken.label),1)]),o.selectedMultisigAddress!=null?(m(),p("div",El,[e("div",Kl,d(l.$t("general.lockFund")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.lockFund??0)},null,8,ql),e("div",Ul,d(L(v).nativeToken.label),1)])):$("v-if",!0),o.selectedMultisigAddress!=null?(m(),p("div",Rl,[e("div",Wl,d(l.$t("general.lockFundTxFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.lockFundTxFee??0)},null,8,Dl),e("div",Ol,d(L(v).nativeToken.label),1)])):$("v-if",!0),zl,e("div",Xl,[Zl,e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:f(o.totalFee)},null,8,Ql),e("div",Gl,d(L(v).nativeToken.label),1)])],64))}}),Yl=W(Jl,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/components/TransferTxnSummary.vue"]]),es={class:"w-10/12 ml-auto mr-auto mt-5"},ts={class:"border filter shadow-lg xl:grid xl:grid-cols-3 mt-8"},ls={class:"xl:col-span-2 p-12"},ss={key:0,class:"mb-3 rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},as={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},ns={class:"inline-block text-xs"},os={class:"text-sm font-semibold"},is=e("div",{class:"text-blue-primary font-semibold uppercase mt-3 text-xxs"},"Transfer to",-1),rs={class:"flex mt-1 gap-1 items-center"},cs={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},us={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},ds={key:2,class:"h-3"},ms={key:3,class:"mb-5"},vs={for:"encryptedMsg",class:"cursor-pointer font-bold ml-4 mr-5 text-tsm"},ps={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},gs={class:"font-semibold text-xs text-white mb-1.5"},fs=["disabled"],bs={class:"text-center"},hs="^[0-9A-Za-z]{40}$",ys="^[0-9A-Za-z-]{46}$",xs="^[^ ]{8,}$",_s=R({__name:"ViewTransfer",setup(o){const y=me(),{t:h}=je(),f=y.appContext.config.globalProperties.emitter,l=T(null),i=T(null),n=T(!1),b=T(""),M=T(!1),k=T(!1),_=T(""),g=T(!0),r=T(!0),x=T([]),c=T([]),a=T("0"),w=T(0),F=T(""),I=T(""),V=T(0),N=H(()=>!(_.value.match(xs)&&!g.value&&!A.value&&K.value<Q.value&&B.value)),B=H(()=>!(k.value&&M.value&&K.value>0&&r.value));z(c,t=>{for(let s=0;s<t.length;s++)isNaN(parseFloat(t[s].amount))&&(t[s].amount="0")},{deep:!0}),z(a,t=>{isNaN(parseFloat(t))&&(a.value="0")});const A=H(()=>i.value?l.value?parseFloat(a.value)>w.value||!c.value.every(t=>parseFloat(t.amount)<=t.balance)?!0:ee.value>V.value:ee.value>w.value||!c.value.every(t=>parseFloat(t.amount)<=t.balance):!1),K=H(()=>I.value.length==0?0:M.value?Z.getFakeEncryptedMessageSize(I.value):Z.getPlainMessageSize(I.value)),Q=H(()=>{var t;return((t=le)==null?void 0:t.currentNetworkProfileConfig.maxMessageSize)-1}),G=H(()=>{var t;return D.convertToExact((t=le)==null?void 0:t.currentNetworkProfileConfig.lockedFundsPerAggregate,v.nativeToken.divisibility)}),J=H(()=>le.currentNetworkProfile?D.convertToExact(Z.getLockFundFee(),v.nativeToken.divisibility):0),Y=H(()=>{if(!i.value)return 0;let t=v.nativeToken.divisibility;return l.value?D.convertNumberMinimumFormat(w.value,t):D.convertNumberMinimumFormat(w.value-q.value,t)}),ee=H(()=>{let t=v.nativeToken.divisibility;return l.value?t==0?Math.trunc(q.value+J.value+G.value):Math.round((q.value+J.value+G.value)*Math.pow(10,t))/Math.pow(10,t):t==0?Math.trunc(parseFloat(a.value.replace(/,/g,""))+q.value):Math.round((parseFloat(a.value.replace(/,/g,""))+q.value)*Math.pow(10,t))/Math.pow(10,t)}),q=H(()=>{const t=c.value.map(s=>({id:s.id,amount:s.amount}));return t.push({id:v.nativeToken.assetId,amount:a.value}),l.value?se.calculateAggregateFee(I.value,a.value,t,M.value):i.value?se.calculateFee(I.value,a.value,t,M.value):0}),re=()=>{a.value=Y.value.toString(),a.value=Y.value.toString()},Me=He(),Fe=Ee(),Pe=async()=>{if(!await se.createTransaction(b.value,a.value,I.value,c.value.map(s=>({id:s.id,amount:parseFloat(s.amount),divisibility:s.divisibility})),_.value,i.value,l.value,M.value,F.value)){Me.add({severity:"error",summary:"Error",detail:"Password is incorrect",group:"br-custom",life:1e3});return}Fe.push({name:"ViewAccountPendingTransactions",params:{address:i.value}})},Ve=async()=>{if(v.chainAPI)try{const t=await v.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(i.value)),s=t.mosaics.findIndex(P=>P.id.toHex()==v.nativeToken.assetId);s!=-1?(V.value=t.mosaics[s].amount.compact()/Math.pow(10,v.nativeToken.divisibility),t.mosaics.splice(s,1)):V.value=0}catch{V.value=0}},pe=async t=>{if(v.chainAPI&&t){x.value=[];try{const s=await v.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(t)),P=s.mosaics.findIndex(j=>j.id.toHex()==v.nativeToken.assetId);P!=-1?(w.value=s.mosaics[P].amount.compact()/Math.pow(10,v.nativeToken.divisibility),s.mosaics.splice(P,1)):w.value=0;for(let j=0;j<s.mosaics.length;j++){const ne=s.mosaics[j];x.value.push({id:ne.id.toHex(),balance:ne.amount.compact(),divisibility:0,namespace:"",hasUpdated:!1})}}catch{x.value=[],w.value=0}}};z([i,l],async([t,s])=>{x.value=[],c.value=[],t!=null&&s==null?(V.value=0,await pe(t)):t!=null&&s!=null&&(await Ve(),await pe(s))}),f.on("select-account",t=>{i.value=t}),f.on("select-multisig-account",t=>{l.value=t});const Se=t=>{n.value=!1,b.value=t.data},Ne=H(()=>{const t=E.currentLoggedInWallet;if(!t)return[];const s=[...t.accounts,...t.others];return t.contacts.length?[{key:"0",label:h("general.ownerAcc"),selectable:!0,children:s.map((P,j)=>({key:"0-"+j.toString(),label:P.name,data:u.Address.createFromRawAddress(P.address).pretty(),selectable:!0}))},{key:"1",label:h("general.contact"),selectable:!0,children:t.contacts.map((P,j)=>({key:"1-"+j.toString(),label:P.name,data:u.Address.createFromRawAddress(P.address).pretty(),selectable:!0}))}]:[{key:"0",label:h("general.ownerAcc"),selectable:!0,children:s.map((P,j)=>({key:"0-"+j.toString(),label:P.name,data:u.Address.createFromRawAddress(P.address).pretty(),selectable:!0}))}]});z([b,g],t=>{if(t[0].match(ys)||t[0].match(hs)){if(!t[1]){Le();return}ge()}else g.value=!0});const Le=()=>{v.chainAPI.accountAPI.getAccountInfo(u.Address.createFromRawAddress(b.value)).then(t=>{k.value=t.publicKey=="0".repeat(64)}).catch(t=>k.value=!0)},Ce=()=>{try{u.PublicAccount.createFromPublicKey(F.value,v.networkType).address.plain()==u.Address.createFromRawAddress(b.value).plain()&&(r.value=!1)}catch{r.value=!0}},ge=()=>{if(E.currentLoggedInWallet)try{let t=D.createAddress(b.value);D.checkAddressNetwork(t,v.networkType)?g.value=!1:g.value=!0}catch{try{let s=D.createNamespaceId(b.value);v.chainAPI.namespaceAPI.getLinkedAddress(s).then(P=>{b.value=P.plain(),g.value=!1}).catch(P=>{g.value=!0})}catch{g.value=!0}}};return(t,s)=>{const P=X("Sidebar"),j=X("font-awesome-icon"),ne=X("router-link"),fe=Ae("debounce");return m(),p("div",null,[C(P,{visible:n.value,"onUpdate:visible":s[0]||(s[0]=S=>n.value=S),baseZIndex:1e4,position:"full"},{default:U(()=>[C(qe,{contacts:Ne.value,onNodeSelect:Se},null,8,["contacts"])]),_:1},8,["visible"]),e("div",es,[e("div",ts,[e("div",ls,[A.value?(m(),p("div",ss,[e("div",as,[C(j,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),e("div",ns,d(t.$t("general.insufficientBalance")),1)])):$("v-if",!0),e("div",os,d(t.$t("transfer.newTransfer")),1),C(st),C(ft,{class:"md:mt-3","selected-address":i.value},null,8,["selected-address"]),is,e("div",rs,[oe(C(ye,{placeholder:t.$t("transfer.transferPlaceholder"),modelValue:b.value,"onUpdate:modelValue":s[1]||(s[1]=S=>b.value=S),showError:g.value},null,8,["placeholder","modelValue","showError"]),[[fe,ge,"1000"]]),e("div",{onClick:s[2]||(s[2]=S=>n.value=!n.value),class:"border rounded-md cursor-pointer flex flex-col justify-center p-1.5"},[C(j,{icon:"id-card-alt",class:"text-blue-primary ml-auto mr-auto"}),e("div",cs,d(t.$t("general.select")),1),e("div",us,d(t.$t("general.contact")),1)])]),(m(!0),p(te,null,de(c.value,(S,O)=>{var be;return m(),p("div",{key:O},[C(Mt,{class:"mt-3","asset-options":x.value,index:O,"selected-assets":c.value},null,8,["asset-options","index","selected-assets"]),((be=c.value[O].id)==null?void 0:be.length)==16?(m(),ue(he,{key:0,class:"mt-3",modelValue:c.value[O].amount,"onUpdate:modelValue":Be=>c.value[O].amount=Be,placeholder:t.$t("transfer.assetAmount"),type:"text",decimal:c.value[O].divisibility},null,8,["modelValue","onUpdate:modelValue","placeholder","decimal"])):$("v-if",!0)])}),128)),c.value.length!=x.value.length?(m(),p("button",{key:1,class:"my-2 font-semibold text-xs text-blue-primary outline-none focus:outline-none disabled:opacity-50",onClick:s[3]||(s[3]=S=>c.value.push({id:null,balance:0,amount:"0",namespace:"",divisibility:0}))}," + "+d(t.$t("transfer.addAssets")),1)):(m(),p("div",ds)),C(he,{modelValue:a.value,"onUpdate:modelValue":s[4]||(s[4]=S=>a.value=S),balance:w.value,placeholder:t.$t("transfer.transferAmount"),logo:!0,type:"text",onClickedMaxAvailable:s[5]||(s[5]=S=>re()),decimal:6},null,8,["modelValue","balance","placeholder"]),C(Rt,{modelValue:I.value,"onUpdate:modelValue":s[6]||(s[6]=S=>I.value=S),limit:Q.value,placeholder:t.$t("general.message"),"current-bytes":K.value},null,8,["modelValue","limit","placeholder","current-bytes"]),g.value?$("v-if",!0):(m(),p("div",ms,[oe(e("input",{id:"encryptedMsg",type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=S=>M.value=S)},null,512),[[Ke,M.value]]),e("label",vs,d(t.$t("transfer.enableEncryption")),1)])),!g.value&&k.value&&M.value&&K.value>0?oe((m(),ue(ye,{key:4,placeholder:"Recipient Public Key",modelValue:F.value,"onUpdate:modelValue":s[8]||(s[8]=S=>F.value=S),showError:r.value},null,8,["modelValue","showError"])),[[fe,Ce,"1000"]]):$("v-if",!0)]),e("div",ps,[C(Yl,{"signer-native-token-balance":V.value,"native-amount":a.value,"native-token-balance":w.value,"lock-fund":G.value,"lock-fund-tx-fee":J.value,"selected-multisig-address":l.value,"txn-fee":q.value,"total-fee":ee.value,"selected-assets":c.value},null,8,["signer-native-token-balance","native-amount","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee","selected-assets"]),e("div",gs,d(t.$t("general.enterPasswordContinue")),1),C(Ue,{placeholder:t.$t("general.enterPassword"),errorMessage:t.$t("general.passwordRequired"),modelValue:_.value,"onUpdate:modelValue":s[9]||(s[9]=S=>_.value=S),icon:"lock",class:"mt-5 mb-3"},null,8,["placeholder","errorMessage","modelValue"]),e("button",{type:"submit",class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",disabled:N.value,onClick:s[10]||(s[10]=S=>Pe())},d(t.$t("general.transfer")),9,fs),e("div",bs,[C(ne,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white underline"},{default:U(()=>[$e(d(t.$t("general.cancel")),1)]),_:1})])])])])])}}}),Fs=W(_s,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/transfer/views/ViewTransfer.vue"]]);export{Fs as default};
