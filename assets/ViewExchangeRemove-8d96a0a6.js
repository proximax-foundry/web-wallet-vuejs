import{d as J,r as k,L as de,D as Q,a as Y,i as Z,o as f,b as w,k as ue,v as O,e,t as l,f as I,y as T,h as ee,w as d,z as i,B as s,c as y,A as ge,H as q,n as D,S as W,l as me,m as K,x as ve,W as z,be as pe}from"./index-66552444.js";import{_ as te}from"./proximax-logo-ecfc3767.js";import{M as fe}from"./multisigUtils-0273cae6.js";import{t as j}from"./jdenticon-module-9d66d486.js";import{_ as _e}from"./PasswordInput.vue_vue_type_script_setup_true_lang-e7fe7fe2.js";const he={key:0,class:"account-item-value account-item"},xe={class:"flex"},be=["innerHTML"],ye={class:"flex flex-col ml-2 text-left"},we=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Multisig Account",-1),Te={class:"mt-1 text-tsm font-bold"},Ae={class:"account-item"},Ie={class:"flex items-center"},ke=["innerHTML"],Le={class:"text-xs ml-2 font-semibold"},Me=J({__name:"SelectInputCosignerAccount",props:{cosignerList:{type:Array,required:!1}},emits:["select-cosigner-account","update:modelValue"],setup(F){k(!1);const v=F,{cosignerList:R}=de(v),p=k([]),_=ee().appContext.config.globalProperties.emitter;let S=new Q("ThemeStyleConfig");S.init();let H=S.jdenticonConfig;const A=k(null);Y(R,h=>{p.value=h.map(m=>{const r=[...d.currentLoggedInWallet.accounts,...d.currentLoggedInWallet.others].find(n=>n.publicKey==m);return{label:r?d.currentLoggedInWallet.convertAddressToName(r.address):i.PublicAccount.createFromPublicKey(m,s.networkType).address.plain(),value:i.PublicAccount.createFromPublicKey(m,s.networkType).address.plain()}})},{deep:!0,immediate:!0});const $=k(null),L=(h,m)=>{if(h==null&&m==null){A.value=null,_.emit("select-cosigner-account",null);return}_.emit("select-cosigner-account",m),A.value.label=h,A.value.value=m,$.value=j(m,25,H)};return(h,m)=>{const u=Z("Dropdown");return f(),w("div",null,[p.value.length?(f(),ue(u,{key:0,showClear:!0,modelValue:A.value,"onUpdate:modelValue":m[0]||(m[0]=r=>A.value=r),style:{width:"100%"},options:p.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:m[1]||(m[1]=r=>{var n,x,C,P;L((n=r.value)==null?void 0:n.label,(x=r.value)==null?void 0:x.value),h.$emit("update:modelValue",(C=r.value)==null?void 0:C.value),h.$emit("select-cosigner-account",(P=r.value)==null?void 0:P.value)})},{value:O(r=>[r.value?(f(),w("div",he,[e("div",xe,[e("div",{innerHTML:$.value},null,8,be),e("div",ye,[we,e("div",Te,l(r.value.label),1)])])])):I("",!0)]),option:O(r=>[e("div",Ae,[e("div",Ie,[e("div",{innerHTML:T(j)(r.option.value,20,T(H))},null,8,ke),e("div",Le,l(r.option.label),1)])])]),_:1},8,["modelValue","options"])):I("",!0)])}}}),Fe={class:"border-2 xl:grid xl:grid-cols-3"},Se={class:"xl:col-span-2 p-12"},He=e("div",null,"SDA-SDA Exchange - Remove Offer",-1),Ce={key:0,class:"text-blue-primary mt-3"},Pe={key:1,class:"text-red-500"},Ee={class:"border border-blue-300 rounded-md p-3 mt-3 bg-blue-50"},$e={class:"flex items-center gap-2"},Ge=["innerHTML"],Ve={class:"flex flex-col gap-0.5"},We=e("div",{class:"uppercase text-xxs text-blue-primary"},"Selected Account",-1),Re={class:"font-semibold"},Ne=e("div",{class:"text-blue-primary mt-3"},"Amount to give ",-1),Be=e("div",{class:"text-blue-primary mt-3"},"Amount to get ",-1),De={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},Ke={key:0},Oe={class:"font-bold text-xs text-blue-primary uppercase"},je={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},Ue={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},Xe=["innerHTML"],qe={class:"flex"},ze={class:"ml-1 text-blue-400 font-bold"},Je=e("img",{src:te,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),Qe=e("div",{class:"border-b-2 border-gray-600 my-2"},null,-1),Ye={class:"font-bold text-xs text-blue-primary uppercase"},Ze={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},et={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},tt=["innerHTML"],st={class:"flex"},nt={class:"ml-1 text-blue-400 font-bold"},at=e("img",{src:te,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),ot=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),lt={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},it={class:"font-semibold lg:col-span-2 col-span-3"},rt=["innerHTML"],ct={class:"ml-1 text-blue-400"},dt={key:1,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs"},ut={class:"font-semibold lg:col-span-2 col-span-3"},gt=["innerHTML"],mt={class:"ml-1 text-blue-400"},vt={key:2,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},pt={class:"font-semibold lg:col-span-2 col-span-3"},ft=["innerHTML"],_t={class:"ml-1 text-blue-400"},ht=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),xt={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},bt=e("div",{class:"font-semibold lg:col-span-2 col-span-3 uppercase"},"Total",-1),yt=["innerHTML"],wt={class:"ml-1 text-blue-400"},Tt={class:"font-semibold text-xs text-white mb-1.5"},At={class:"text-center"},St=J({__name:"ViewExchangeRemove",props:{owner:String,pair:String},setup(F){const v=F,R=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],p=k(""),N=t=>{if(!t)return"0";const a=i.Address.createFromRawAddress(t).plain(),o=d.currentLoggedInWallet.accounts.find(g=>g.address==a)||d.currentLoggedInWallet.others.find(g=>g.address==a);return o?_(o.balance):0},_=t=>{let a=t.toString().split(".");return a[1]!=null?'<span class="font-semibold text-sm">'+a[0]+'</span>.<span class="font-semibold text-xs">'+a[1]+"</span>":'<span class="font-semibold text-sm">'+a[0]+"</span>"},S=t=>{const a=R.find(o=>o.namespace==t);return a?a.name:t},H=new Q("ThemeStyleConfig");H.init();const A=y(()=>j(v.owner,40,H.jdenticonConfig)),$=y(()=>{const t=i.Address.createFromRawAddress(v.owner).plain();return d.currentLoggedInWallet.convertAddressToName(t,!0)}),L=k(null);ee().appContext.config.globalProperties.emitter.on("select-cosigner-account",t=>{L.value=t});const u=y(()=>{const t=i.Address.createFromRawAddress(v.owner).plain();return(d.currentLoggedInWallet.accounts.find(o=>o.address==t)||d.currentLoggedInWallet.others.find(o=>o.address==t)).getDirectParentMultisig().length}),r=y(()=>{if(!u.value)return[];const t=i.Address.createFromRawAddress(v.owner).plain(),a=d.currentLoggedInWallet.accounts.find(o=>o.address==t)||d.currentLoggedInWallet.others.find(o=>o.address==t);return fe.getCosignerInWallet(a.publicKey).cosignerList}),n=k(null),x=ge(),C=v.pair.split("/")[0],P=v.pair.split("/")[1],se=async()=>{if(!C||!P){x.add({severity:"error",summary:"Error",detail:"Invalid",group:"br-custom",life:1e3});return}const t=new i.ExchangeSdaHttp(s.nodeFullURL),a=await pe(t.getAccountSdaExchangeOffers(i.Address.createFromRawAddress(v.owner)));if(n.value=a.sdaOfferBalances.find(c=>c.mosaicIdGive.toHex()==C&&c.mosaicIdGet.toHex()==P),!n.value){x.add({severity:"error",summary:"Error",detail:"Offer not found",group:"br-custom",life:1e3});return}const o=await s.chainAPI.assetAPI.getMosaicsNames([n.value.mosaicIdGet,n.value.mosaicIdGive]),g=await s.chainAPI.assetAPI.getMosaics([n.value.mosaicIdGet,n.value.mosaicIdGive]);n.value.mosaicGetName=o[0].names.length?o[0].names[0].name:n.value.mosaicIdGet.toHex(),n.value.mosaicGiveName=o[1].names.length?o[1].names[0].name:n.value.mosaicIdGive.toHex(),n.value.mosaicGetDivisibility=g.find(c=>c.mosaicId.toHex()==n.value.mosaicIdGet.toHex()).divisibility,n.value.mosaicGiveDivisibility=g.find(c=>c.mosaicId.toHex()==n.value.mosaicIdGive.toHex()).divisibility},ne=Y(s,async(t,a)=>{t.isReady&&(await se(),ne())},{immediate:!0}),U=y(()=>q.convertToExact(D.currentNetworkProfileConfig.lockedFundsPerAggregate,s.nativeToken.divisibility)),X=y(()=>q.convertToExact(W.getLockFundFee(),s.nativeToken.divisibility)),B=y(()=>{var g;if(!s.isReady)return 0;const t=i.RemoveSdaExchangeOfferTransaction.create(i.Deadline.create(),[new i.RemoveSdaExchangeOffer(new i.MosaicId(s.nativeToken.assetId),new i.MosaicId(s.nativeToken.assetId))],s.networkType);if(!u.value)return((g=t.maxFee)==null?void 0:g.compact())/Math.pow(10,s.nativeToken.divisibility);const a=[...d.currentLoggedInWallet.accounts,...d.currentLoggedInWallet.others].find(c=>c.address==i.Address.createFromRawAddress(v.owner).plain()),o=[t.toAggregateV1(i.PublicAccount.createFromPublicKey(a.publicKey,s.networkType))];return s.buildTxn.aggregateBonded(o).maxFee.compact()/Math.pow(10,s.nativeToken.divisibility)}),ae=y(()=>u.value?Math.round((U.value+X.value+B.value)*Math.pow(10,s.nativeToken.divisibility))/Math.pow(10,s.nativeToken.divisibility):B.value),oe=me(),le=async()=>{if(u.value&&!L.value){x.add({severity:"error",summary:"Error",detail:"Initiator not selected",group:"br-custom",life:1e3});return}if(p.value.length<8){x.add({severity:"error",summary:"Error",detail:"password must be at least 8 characters",group:"br-custom",life:1e3});return}if(!z.verifyWalletPassword(d.currentLoggedInWallet.name,D.chainNetworkName,p.value)){x.add({severity:"error",summary:"Error",detail:"Incorrect password",group:"br-custom",life:1e3});return}const t=i.Address.createFromRawAddress(v.owner).plain(),a=d.currentLoggedInWallet.accounts.find(b=>b.address==(u.value?L.value:t)),o=z.decryptPrivateKey(new i.Password(p.value),a.encrypted,a.iv);p.value="";const g=i.RemoveSdaExchangeOfferTransaction.create(i.Deadline.create(),[new i.RemoveSdaExchangeOffer(n.value.mosaicIdGive,n.value.mosaicIdGet)],s.networkType),c=i.Account.createFromPrivateKeyV1(o,s.networkType),M=D.currentNetworkProfile.generationHash;if(u.value){const b=[...d.currentLoggedInWallet.accounts,...d.currentLoggedInWallet.others].find(ce=>ce.address==t),G=[g.toAggregateV1(i.PublicAccount.createFromPublicKey(b.publicKey,s.networkType))],V=s.buildTxn.aggregateBonded(G),E=c.preV2Sign(V,M),ie=W.lockFundTx(E),re=c.preV2Sign(ie,M);W.announceLF_AND_addAutoAnnounceABT(re,E)}else{const b=c.preV2Sign(g,M);await W.announceTransaction(b)}oe.push({name:"ViewAccountPendingTransactions",params:{address:c.address.plain()}})};return(t,a)=>{var g,c,M,b,G,V;const o=Z("router-link");return f(),w("div",null,[e("div",Fe,[e("div",Se,[He,r.value.length?(f(),w("div",Ce,"Select Initiator")):I("",!0),K(Me,{"cosigner-list":r.value},null,8,["cosigner-list"]),u.value&&!r.value.length?(f(),w("div",Pe,"Cosigner not found")):I("",!0),e("div",Ee,[e("div",$e,[e("div",{innerHTML:A.value},null,8,Ge),e("div",Ve,[We,e("div",Re,l($.value),1)])])]),Ne,e("div",null,l(((g=n.value)==null?void 0:g.currentMosaicGiveAmount.compact())/Math.pow(10,(c=n.value)==null?void 0:c.mosaicGiveDivisibility))+" "+l(S((M=n.value)==null?void 0:M.mosaicGiveName)),1),Be,e("div",null,l(((b=n.value)==null?void 0:b.currentMosaicGetAmount.compact())/Math.pow(10,(G=n.value)==null?void 0:G.mosaicGetDivisibility))+" "+l(S((V=n.value)==null?void 0:V.mosaicGetName)),1)])]),e("div",De,[u.value?(f(),w("div",Ke,[e("div",Oe,l(t.$t("general.multisigAcc")),1),e("div",je,[e("div",Ue,l(t.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:N(F.owner)},null,8,Xe),e("div",qe,[e("div",ze,l(T(s).nativeToken.label),1),Je])]),Qe])):I("",!0),e("div",Ye,l(t.$t("general.signerAcc")),1),e("div",Ze,[e("div",et,l(t.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:N(u.value?L.value:F.owner)},null,8,tt),e("div",st,[e("div",nt,l(T(s).nativeToken.label),1),at])]),ot,e("div",lt,[e("div",it,l(u.value?t.$t("general.aggregateFee"):t.$t("general.transactionFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(B.value)},null,8,rt),e("div",ct,l(T(s).nativeToken.label),1)]),u.value?(f(),w("div",dt,[e("div",ut,l(t.$t("general.lockFund")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(U.value??0)},null,8,gt),e("div",mt,l(T(s).nativeToken.label),1)])):I("",!0),u.value?(f(),w("div",vt,[e("div",pt,l(t.$t("general.lockFundTxFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(X.value??0)},null,8,ft),e("div",_t,l(T(s).nativeToken.label),1)])):I("",!0),ht,e("div",xt,[bt,e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(ae.value)},null,8,yt),e("div",wt,l(T(s).nativeToken.label),1)]),e("div",Tt,l(t.$t("general.enterPasswordContinue")),1),K(_e,{placeholder:t.$t("general.enterPassword"),modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=E=>p.value=E),icon:"lock",class:"mt-5 mb-3"},null,8,["placeholder","modelValue"]),e("button",{class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:a[1]||(a[1]=E=>le())}," Sell "),e("div",At,[K(o,{to:{name:"ViewExchangeListing"},class:"content-center text-xs text-white underline"},{default:O(()=>[ve(l(t.$t("general.cancel")),1)]),_:1})])])])}}});export{St as default};
