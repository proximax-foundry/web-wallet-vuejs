import{_ as F,u as j,D as K,g as P,r as x,k as T,o as c,b as i,e as n,A as N,t as s,s as C,z as W,f as k,F as Q,i as q,T as G,w as u,Q as J,p as X,j as Y}from"./index-8ffe16f8.js";import{A as V}from"./addressBookUtils-0d3294bf.js";const Z="/web-wallet-vuejs/assets/icon-download-ec27e33c.svg";const ee={name:"DisplayImportContactModal",props:[],components:{},data(){return{toggleModal:!1}},setup(){const{t:e}=j(),a=K(),t=P().appContext.config.globalProperties.emitter,o=x([]),g=x(0),v=x(0),r=x([]),B=A=>{var M=A.target.files||A.dataTransfer.files;M.length&&O(M[0])},R=()=>{g.value=0,v.value=0,r.value=[]},O=A=>{new Promise(y=>{var m=new FileReader;m.onload=()=>{y(m.result)},m.readAsText(A)}).then(y=>{if(!u.currentLoggedInWallet)return;const m=u.currentLoggedInWallet;var $=y.match(/[^\r\n]+/g);let L=[],I=[],S=[];$.shift(),$.forEach(w=>{var l,p,b,h,f=w.split(",");if(f.length>4){let d="";for(var E=0;E<f.length-1;++E)d=d+f[E]+",";l=d.replace(/['"]+/g,"")}else l=f[0].replace(/['"]+/g,"");p=f[1].replace(/['"]+/g,""),f[2]?b=f[2].replace(/['"]+/g,""):b="-none-",f[3]?h=f[3].replace(/['"]+/g,""):h=null;const z=m.accounts.findIndex(d=>d.name.toLowerCase()==l.toLowerCase()),U=m.contacts!=null?m.contacts.findIndex(d=>d.address==p):-1,H=m.contacts!=null?m.contacts.findIndex(d=>d.name.toLowerCase()==l.toLowerCase()):-1,D=u.currentLoggedInWallet.accounts.find(d=>d.default==!0);U>=0?L.push({label:l,address:p,group:b,publicKey:h}):H>=0||z>=0?V.verifyNetworkAddress(D.address,p).isPassed?I.push({label:l+" - 2",address:p,group:b,publicKey:h}):S.push({label:l,address:p,group:b,publicKey:h}):V.verifyNetworkAddress(D.address,p).isPassed?I.push({label:l,address:p,group:b,publicKey:h}):S.push({label:l,address:p,group:b,publicKey:h})}),L.length>0&&(v.value=L.length),I.length>0&&(I.forEach(w=>{let l=new J(w.label,w.address,w.group,w.publicKey);u.currentLoggedInWallet.addAddressBook(l)}),u.wallets.saveMyWalletOnlytoLocalStorage(u.currentLoggedInWallet),g.value=I.length,t.emit("REFRESH_CONTACT_LIST",!0),a.add({severity:"info",summary:e("general.addressBook"),detail:e("addressBook.newContactImported",g.value),group:"br-custom",life:5e3})),r.value=S},y=>{console.log(y)})};return{csv:o,contactAdded:g,contactExisted:v,contactInvalidAddress:r,onFileChange:B,closeModel:R}}},te=e=>(X("data-v-b03246ac"),e=e(),Y(),e),se=te(()=>n("img",{src:Z,class:"inline-block mr-4 relative top-1"},null,-1)),oe={key:0,class:"popup-outer fixed flex z-50"},ne={class:"modal-popup-box"},ae={class:"delete-position"},re={class:"w-104"},de={class:"default-title font-bold mt-0 mb-5"},le={key:0,class:"bg-blue-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},ce={key:1,class:"bg-yellow-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},ie={key:2,class:"bg-red-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},ue={key:3,class:"text-left text-gray-800 mt-5"},ge={class:"font-bold mb-2"},me={class:"inline-block mr-3 w-40"},pe={class:"inline-block"},fe={class:"py-5 my-5 text-tsm"},ve={enctype:"multipart/form-data"};function _e(e,a,_,t,o,g){const v=T("font-awesome-icon");return c(),i("div",null,[n("div",{onClick:a[0]||(a[0]=r=>o.toggleModal=!o.toggleModal),class:"cursor-pointer mt-5 py-2 px-5 rounded-md bg-blue-primary text-white text-tsm drop-shadow-lg filter hover:bg-blue-600 transition-all duration-500"},[se,N(s(e.$t("general.import")),1)]),C(G,{"enter-active-class":"animate__animated animate__fadeInDown","leave-active-class":"animate__animated animate__fadeOutUp"},{default:W(()=>[o.toggleModal?(c(),i("div",oe,[n("div",ne,[n("div",ae,[C(v,{icon:"times",class:"delete-icon-style",onClick:a[1]||(a[1]=r=>{o.toggleModal=!o.toggleModal,t.closeModel()})})]),n("div",re,[n("h1",de,s(e.$t("addressBook.importAddress")),1),t.contactAdded>0?(c(),i("div",le,s(t.contactAdded)+" "+s(e.$t("general.contact",t.contactAdded))+" "+s(e.$t("addressBook.addressBookMessage1")),1)):k("v-if",!0),t.contactExisted>0?(c(),i("div",ce,s(t.contactExisted)+" "+s(e.$t("general.contact",t.contactExisted))+" "+s(e.$t("addressBook.addressBookMessage2")),1)):k("v-if",!0),t.contactInvalidAddress.length>0?(c(),i("div",ie,s(t.contactInvalidAddress.length)+" "+s(e.$t("general.contact",t.contactInvalidAddress.length))+" "+s(e.$t("addressBook.addressBookMessage3")),1)):k("v-if",!0),t.contactInvalidAddress.length>0?(c(),i("div",ue,[n("div",ge,s(e.$t("general.contact",t.contactInvalidAddress.length))+" "+s(e.$t("addressBook.addressBookMessage4"))+":",1),(c(!0),i(Q,null,q(t.contactInvalidAddress,(r,B)=>(c(),i("div",{key:B,class:"text-left mb-2"},[n("div",me,s(r.label),1),n("div",pe,s(r.address),1)]))),128))])):k("v-if",!0),n("div",fe,[n("form",ve,[n("input",{type:"file",onChange:a[2]||(a[2]=(...r)=>t.onFileChange&&t.onFileChange(...r))},null,32)])])])])])):k("v-if",!0)]),_:1}),o.toggleModal?(c(),i("div",{key:0,onClick:a[3]||(a[3]=r=>{o.toggleModal=!o.toggleModal,t.closeModel()}),class:"fixed inset-0 bg-opacity-60 bg-gray-100 z-20"})):k("v-if",!0)])}const be=F(ee,[["render",_e],["__scopeId","data-v-b03246ac"],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/services/submodule/addressbook/components/DisplayImportContactModal.vue"]]),he={name:"ViewServicesAddressBook",components:{DisplayImportContactModal:be},setup(){j();const a=P().appContext.config.globalProperties.emitter,_=x([]),t=()=>{u.currentLoggedInWallet&&(_.value=[],u.currentLoggedInWallet.contacts!=null&&u.currentLoggedInWallet.contacts.length>0&&(u.currentLoggedInWallet.contacts.forEach(o=>{_.value.push(o)}),_.value.sort((o,g)=>o.name>g.name?1:o.name<g.name?-1:0)))};return t(),a.on("REFRESH_CONTACT_LIST",o=>{o&&setTimeout(()=>{t()},1e3)}),{list:_}}},we={class:"w-9/12 ml-auto mr-auto mt-5"},ke={class:"flex text-xs font-semibold border-b-2 menu_title_div"},ye={class:"w-18 text-center border-b-2 pb-3 border-yellow-500"},Ie={class:"mt-10"},xe={class:"text-md my-5 font-semibold"},Ce={class:"text-tsm"};function Ae(e,a,_,t,o,g){const v=T("router-link"),r=T("DisplayImportContactModal");return c(),i("div",null,[n("div",we,[n("div",ke,[C(v,{to:{name:"ViewServicesAddressBook"},class:"w-18 text-center border-b pb-3"},{default:W(()=>[N(s(e.$t("general.list")),1)]),_:1}),n("div",ye,s(e.$t("general.import")),1),C(v,{to:{name:"ViewServicesAddressBookExport"},class:"w-18 text-center border-b pb-3"},{default:W(()=>[N(s(e.$t("general.export")),1)]),_:1})]),n("div",Ie,[n("div",xe,s(e.$t("addressBook.importContacts")),1),n("div",Ce,s(e.$t("addressBook.addBackUpContact")),1),C(r,{class:"inline-block w-36 flex-none"})])])])}const Le=F(he,[["render",Ae],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/services/submodule/addressbook/views/ViewServicesAddressBookImport.vue"]]);export{Le as default};
