import{S as Ae}from"./SelectInputPluginClean-0ae26a66.js";import{P as _e}from"./PasswordInput-342be278.js";import{_ as Ne,w as m,n as C,H as M,A as b,f as Ce,W as Te}from"./index-e91c98d3.js";import{a as h}from"./accountUtils-37b7cf79.js";import{u as xe}from"./primevue-e09f7e84.js";import{d as V}from"./tsjs-xpx-chain-sdk-84426b6a.js";import"./vue-86063517.js";import{u as Le}from"./vue-i18n-728f748b.js";import{A as Ie,a as Pe}from"./AccountTabs-238f9695.js";import{M as X}from"./multisigUtils-f2f699ac.js";import{A as Se}from"./AddressInputClean-2f9b7ad8.js";import{u as Fe}from"./vue-router-21fffbbf.js";import{T as Me}from"./TransactionFeeDisplay-e48a7b0f.js";import{c as o,r as d,w as K,B as N,o as r,z as n,A as f,a as y,l as ae,g as u,p as We,bq as Ue,F as se,k as oe,e as g,m as Ve}from"./@vue-a9ecc9f1.js";import"./@vueform-4d3340af.js";import"./rxjs-1250b26d.js";import"./@js-joda-d98eb16f.js";import"./tslib-8dbab242.js";import"./crypto-js-e64ac54c.js";import"./crypto-browserify-4fd8cccd.js";import"./randombytes-685e9383.js";import"./node-stdlib-browser-23a8bc7f.js";import"./buffer-6d367910.js";import"./base64-js-50a5cdf9.js";import"./ieee754-44f7831e.js";import"./process-2209b2b3.js";import"./safe-buffer-c463177b.js";import"./create-hash-92c04a28.js";import"./inherits-804453d8.js";import"./md5.js-8d474739.js";import"./hash-base-bb85fc42.js";import"./readable-stream-2241ee9e.js";import"./events-86ccc6d8.js";import"./util-06f7ff32.js";import"./is-arguments-86164331.js";import"./has-tostringtag-7c6352d6.js";import"./has-symbols-cd7870b9.js";import"./call-bind-9e7f09da.js";import"./get-intrinsic-f35014ba.js";import"./has-proto-8ede3a55.js";import"./function-bind-68631a08.js";import"./has-ab8e2922.js";import"./is-generator-function-06dfaf9d.js";import"./which-typed-array-cf6b6a29.js";import"./for-each-f57c5052.js";import"./is-callable-7492318c.js";import"./available-typed-arrays-61974ec7.js";import"./gopd-bab4d6bd.js";import"./is-typed-array-037eef20.js";import"./util-deprecate-c3aabb3c.js";import"./string_decoder-ef7b01fe.js";import"./ripemd160-58dcfa02.js";import"./sha.js-cea3da2e.js";import"./cipher-base-aee0e03d.js";import"./stream-browserify-7496a08f.js";import"./create-hmac-e8b5ea4a.js";import"./browserify-sign-a708a95f.js";import"./browserify-rsa-bfbdcbb6.js";import"./bn.js-1ae23332.js";import"./elliptic-75e883ee.js";import"./minimalistic-assert-4cc49674.js";import"./minimalistic-crypto-utils-6f869a51.js";import"./brorand-03f0f79d.js";import"./hash.js-4f5dfe73.js";import"./hmac-drbg-87799258.js";import"./parse-asn1-465c125b.js";import"./asn1.js-405e93e4.js";import"./safer-buffer-2ac6237e.js";import"./evp_bytestokey-e91543fa.js";import"./browserify-aes-ce20a0e6.js";import"./buffer-xor-87a7236a.js";import"./pbkdf2-e2ae8643.js";import"./browserify-cipher-c4c37ca3.js";import"./browserify-des-3f7e64d9.js";import"./des.js-d262604a.js";import"./diffie-hellman-c8260aab.js";import"./miller-rabin-de27bf02.js";import"./create-ecdh-ffe720e9.js";import"./public-encrypt-fc0568a2.js";import"./randomfill-2874e5f1.js";import"./mathjs-2a513dae.js";import"./@babel-484168fe.js";import"./typed-function-4896e4f1.js";import"./decimal.js-d133ee8e.js";import"./complex.js-cf2520e8.js";import"./fraction.js-39e7906a.js";import"./javascript-natural-sort-c4dd0c27.js";import"./escape-latex-c8a96e7a.js";import"./seedrandom-c8f991ad.js";import"./tiny-emitter-56d49cfd.js";import"./js-sha3-d7d4f583.js";import"./crypto-random-string-d158262e.js";import"./jose-92e5544c.js";import"./vue-loading-overlay-b89251b1.js";import"./jspdf-30014160.js";import"./fflate-8981c52c.js";import"./vue-debounce-3bbbf8c6.js";import"./mitt-f7ef348c.js";/* empty css                   */import"./maska-6f10db43.js";import"./@fortawesome-014b81f2.js";import"./vue3-blocks-tree-e53499e3.js";import"./@noble-f8eff84a.js";import"./utf8-c941a4a0.js";import"./bip39-936aefa9.js";import"./axios-b48d2c29.js";import"./flatbuffers-edc4f8d7.js";import"./ws-0a714537.js";import"./@intlify-16888cd3.js";import"./jdenticon-e4458e79.js";import"./functions-3b5b4af7.js";import"./TextInput-909d01ae.js";import"./TextInputClean-5873929f.js";import"./icon-key-5b3f7dda.js";import"./icon-red-x-a5511f99.js";import"./icon-green-tick-1b766454.js";import"./proximax-logo-ecfc3767.js";const Ke={name:"ViewAccountAliasAddressToNamespace",components:{PasswordInput:_e,SelectInputPluginClean:Ae,AccountComponent:Ie,AddressInputClean:Se,AccountTabs:Pe,TransactionFeeDisplay:Me},props:{address:String},setup(s){const{t:i}=Le(),T=o(()=>{if(!m.currentLoggedInWallet)return[];let t=m.currentLoggedInWallet.accounts.map(l=>({name:l.name,balance:l.balance,address:l.address,publicKey:l.publicKey,isMultisig:!!l.getDirectParentMultisig().length,multisigInfo:l.multisigInfo})),c=m.currentLoggedInWallet.others.filter(l=>l.type==="MULTISIG").map(l=>({name:l.name,balance:l.balance,address:l.address,publicKey:l.publicKey,isMultisig:!0,multisigInfo:l.multisigInfo}));return t.concat(c)}),e=o(()=>{if(!m.currentLoggedInWallet)return null;let t=m.currentLoggedInWallet.accounts.find(c=>c.address==s.address)||m.currentLoggedInWallet.others.find(c=>c.address==s.address);return t||null}),w=t=>T.value.find(c=>c.publicKey==t),F=d(!1);(()=>{e.value&&X.onPartial(V.PublicAccount.createFromPublicKey(e.value.publicKey,b.networkType)).then(t=>F.value=t).catch(t=>{F.value=!1})})();const B=o(()=>v.value==""),x=d(null),D=d(null),A=d(s.address),L=d(""),E=d(null),R=d(null),a=d(""),p=d(""),v=d(""),_=o(()=>{let t=!1;return m.currentLoggedInWallet&&(t=h.getMultisig(A.value)),t}),k=d(""),I=d(!0),j=d(!1),W=d(""),le="^[^ ]{8,}$",re="^[0-9A-Za-z]{40}$",ne="^[0-9A-Za-z-]{46}$",O=o(()=>C.currentNetworkProfileConfig?M.convertToExact(C.currentNetworkProfileConfig.lockedFundsPerAggregate,b.nativeToken.divisibility):0),z=o(()=>C.currentNetworkProfile?M.convertToExact(Ce.getLockFundFee(),b.nativeToken.divisibility):0);xe();const q=m.currentLoggedInWallet?m.currentLoggedInWallet.name:"";let ie=d("");const P=d(0),H=o(()=>{let t=b.nativeToken.divisibility;return _.value?t==0?Math.trunc(parseFloat(P.value)+O.value+z.value):Math.round((parseFloat(P.value)+O.value+z.value)*Math.pow(10,b.nativeToken.divisibility))/Math.pow(10,b.nativeToken.divisibility):P.value}),$=o(()=>e.value?e.value.balance:0),ce=o(()=>b.nativeToken.label),de=o(()=>b.nativeToken.divisibility),ue=o(()=>m.currentLoggedInWallet?M.toCurrencyFormat($.value,de.value):"0"),ee=o(()=>{var t=!1;return _.value?w(S.value)&&(w(S.value).balance<H.value?t=!0:t=!1):$.value<H.value&&(t=!0),t}),me=o(()=>!(F.value==!1&&ee.value==!1&&p.value.match(le)&&v.value!=null&&k.value!=""&&a.value!=null&&I.value==!1)),pe=o(()=>{let t=[];return t.push({value:"Link",label:i("general.link")},{value:"Unlink",label:i("general.unlink")}),t}),ve=o(()=>{let t=[];return v.value!=null&&(t=h.namespaceOption(A.value,v.value)),t}),Z=o(()=>m.currentLoggedInWallet?h.getNamespaceListByAddress(A.value).length==0:null),U=o(()=>{if(C.currentNetworkProfileConfig){let t=X.getCosignerInWallet(e.value.publicKey?e.value.publicKey:""),c=[];return t.cosignerList.forEach(l=>{c.push({publicKey:l,name:w(l).name,balance:w(l).balance,address:w(l).address})}),t.cosignerList=c,t}else return{hasCosigner:!1,cosignerList:[]}}),S=d(U.value.cosignerList[0]?U.value.cosignerList[0].publicKey:"");K(U,t=>{t.cosignerList.length&&(S.value=t.cosignerList[0]?t.cosignerList[0].publicKey:"")},{deep:!0});const G=o(()=>e.value?X.getCosignerInWallet(e.value.publicKey).cosignerList.length>0:!1),fe=o(()=>G.value==!1&&_.value==!0||Z.value==!0||v.value=="Unlink"),ge=o(()=>G.value==!1&&_.value==!0||Z.value==!0);K(v,(t,c)=>{t!=c&&(k.value="",x.value.clear(),a.value=null,j.value=!1)}),K(a,t=>{const l=h.getNamespaceListByAddress(A.value).find(Q=>Q.name===a.value);if(v.value=="Unlink"&&t!=null)k.value=V.Address.createFromRawAddress(l.linkedId).pretty();else if(v.value=="Link"&&k.value!=""&&t!=null){let Q=V.Address.createFromRawAddress(k.value).plain();P.value=M.amountFormatterSimple(h.getLinkNamespaceToAddressTransactionFee(_.value,Q,a.value,v.value),b.nativeToken.divisibility)}});const be=o(()=>h.getContact());K(k,t=>{if(t.length==46&&t.match(ne)||t.length==40&&t.match(re))if(h.verifyAddress(A.value,k.value).isPassed==!1)W.value="Invalid Address",I.value=!0;else{let l=V.Address.createFromRawAddress(t).plain();P.value=M.amountFormatterSimple(h.getLinkNamespaceToAddressTransactionFee(_.value,l,a.value,v.value),b.nativeToken.divisibility),W.value="",I.value=!1}else I.value=!0});const ke=Fe(),ye=()=>{if(!Te.verifyWalletPassword(q,C.chainNetworkName,p.value))L.value=i("general.walletPasswordInvalid",{name:q}),p.value="";else{let t=m.currentLoggedInWallet.accounts.find(c=>c.address==s.address)?m.currentLoggedInWallet.accounts.find(c=>c.address==s.address):m.currentLoggedInWallet.others.find(c=>c.address==s.address);L.value="",ie.value=v.value,h.linkNamespaceToAddress(S.value,_.value,t,p.value,a.value,v.value,k.value),te(),ke.push({name:"ViewAccountPendingTransactions",params:{address:s.address}})}},te=()=>{j.value=!1,x.value.clear(),I.value=!1,p.value="",W.value="",L.value="",k.value=""},J=o(()=>b.networkType),he=o(()=>J.value==168&&C.chainNetworkName=="Sirius Testnet 1"?"https://bctestnetfaucet.xpxsirius.io/#/":J.value==168&&C.chainNetworkName=="Sirius Testnet 2"?"https://bctestnet2faucet.xpxsirius.io/#/":""),we=o(()=>{let t=w(S.value);return t?t.balance:0});return{currentNativeTokenName:ce,acc:e,walletState:m,clearInput:te,actionsOptions:pe,disableNamespace:ge,selectAction:v,walletPassword:p,disableCreate:me,noNamespace:Z,namespaceOptions:ve,selectNamespace:a,showContactSelection:j,isMultiSig:_,selectContactRef:E,selectContact:R,disableContactSelection:fe,namespaceAddress:k,lockFundTxFee:z,showAddressError:I,err:L,addressErrorMsg:W,trxFee:P,contact:be,walletName:q,selectNamespaceRef:x,selectActionRef:D,aliasAddressToNamespace:ye,isCosigner:G,lockFund:O,totalFee:H,onPartial:F,walletCosignerList:U,selectedCosignPublicKey:S,findAcc:w,fundStatus:ee,topUpUrl:he,networkType:J,disableSelectNamespace:B,checkCosignBalance:we,accountDisplayBalance:ue}}},Be={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},De={class:"border-2 border-t-0 filter shadow-lg lg:grid lg:grid-cols-3"},Ee={class:"lg:col-span-2 py-6 px-6"},Re={key:0,class:"text-left mt-2 mb-5"},je={key:0},Oe={class:"text-tsm"},ze={key:0,class:"font-bold"},qe={key:1,class:"font-bold"},He=["value"],Ze={key:1,class:"font-semibold"},Ge={key:2,class:"font-semibold"},Je={key:3,class:"error error_box mb-5"},Qe={class:"flex mt-3 gap-1"},Xe={class:"text-xxs text-blue-primary font-semibold uppercase"},Ye={key:1,class:"border rounded-md cursor-pointer flex flex-col justify-around p-2"},$e={class:"text-xxs text-gray-400 font-semibold uppercase"},et={key:4,class:"border"},tt={class:"text-xxs text-gray-300 font-semibold py-2 px-2 uppercase"},at=["onClick"],st={key:0,class:"text-xs py-2 bg-gray-100 pl-2 w-full"},ot={key:1,class:"text-xs py-2 pl-2 w-full"},lt={key:2,class:"ml-auto pr-2 text-xxs py-2 font-semibold text-blue-primary bg-gray-100 uppercase"},rt={key:3,class:"ml-auto mr-2 text-xxs py-2 font-semibold text-blue-primary uppercase"},nt={class:"bg-navy-primary p-6 lg:col-span-1"},it={class:"font-semibold text-xs text-white mb-1.5"},ct=f("div",{class:"mt-3"},null,-1),dt=["disabled"],ut=["disabled"],mt={class:"text-center"};function pt(s,i,T,e,w,F){const Y=N("AccountComponent"),B=N("AccountTabs"),x=N("SelectInputPluginClean"),D=N("AddressInputClean"),A=N("font-awesome-icon"),L=N("TransactionFeeDisplay"),E=N("PasswordInput"),R=N("router-link");return r(),n("div",null,[f("div",Be,[y(Y,{address:T.address,class:"mb-6"},null,8,["address"]),y(B,{address:T.address,selected:"details"},null,8,["address"]),f("div",De,[f("div",Ee,[e.isMultiSig?(r(),n("div",Re,[e.walletCosignerList.cosignerList.length>0?(r(),n("div",je,[f("div",Oe,[ae(u(s.$t("general.initiateBy"))+": ",1),e.walletCosignerList.length==1?(r(),n("span",ze,u(e.walletCosignerList.cosignerList[0].name),1)):(r(),n("span",qe,[We(f("select",{class:"","onUpdate:modelValue":i[0]||(i[0]=a=>e.selectedCosignPublicKey=a)},[(r(!0),n(se,null,oe(e.walletCosignerList.cosignerList,(a,p)=>(r(),n("option",{value:e.findAcc(a.publicKey).publicKey,key:p},u(a.name),9,He))),128))],512),[[Ue,e.selectedCosignPublicKey]])]))])])):g("v-if",!0)])):g("v-if",!0),e.selectAction=="Link"?(r(),n("div",Ze,u(s.$t("general.linkToNamespace")),1)):g("v-if",!0),e.selectAction=="Unlink"?(r(),n("div",Ge,u(s.$t("namespace.manageNamespace")),1)):g("v-if",!0),e.err!=""?(r(),n("div",Je,u(e.err),1)):g("v-if",!0),y(x,{class:"my-3",placeholder:s.$t("namespace.selectAction"),modelValue:e.selectAction,"onUpdate:modelValue":i[1]||(i[1]=a=>e.selectAction=a),options:e.actionsOptions,ref:"selectActionRef",disabled:e.disableNamespace},null,8,["placeholder","modelValue","options","disabled"]),y(x,{placeholder:s.$t("namespace.selectNamespace"),ref:"selectNamespaceRef",modelValue:e.selectNamespace,"onUpdate:modelValue":i[2]||(i[2]=a=>e.selectNamespace=a),options:e.namespaceOptions,disabled:e.disableNamespace||e.disableSelectNamespace},null,8,["placeholder","modelValue","options","disabled"]),f("div",Qe,[y(D,{placeholder:s.$t("general.addAccAddress"),modelValue:e.namespaceAddress,"onUpdate:modelValue":i[3]||(i[3]=a=>e.namespaceAddress=a),errorMessage:e.addressErrorMsg,showError:e.showAddressError,disabled:e.disableNamespace||e.selectAction=="Unlink"||e.selectNamespace==null},null,8,["placeholder","modelValue","errorMessage","showError","disabled"]),e.selectNamespace!=null&&e.selectAction=="Link"?(r(),n("div",{key:0,onClick:i[4]||(i[4]=a=>e.showContactSelection=!e.showContactSelection),class:"border rounded-md cursor-pointer flex flex-col justify-around p-2"},[y(A,{icon:"id-card-alt",class:"text-blue-primary ml-auto mr-auto"}),f("div",Xe,u(s.$t("general.select")),1)])):(r(),n("div",Ye,[y(A,{icon:"id-card-alt",class:"text-gray-400 ml-auto mr-auto"}),f("div",$e,u(s.$t("general.select")),1)]))]),e.showContactSelection?(r(),n("div",et,[f("div",tt,u(s.$t("general.importFromAB")),1),(r(!0),n(se,null,oe(e.contact,(a,p)=>(r(),n("div",{key:p,class:"cursor-pointer"},[f("div",{onClick:v=>{e.namespaceAddress=a.value,e.showContactSelection=!1},class:"flex justify-center"},[p%2==0?(r(),n("div",st,u(a.label),1)):g("v-if",!0),p%2==1?(r(),n("div",ot,u(a.label),1)):g("v-if",!0),p%2==0?(r(),n("div",lt,u(s.$t("general.select")),1)):g("v-if",!0),p%2==1?(r(),n("div",rt,u(s.$t("general.select")),1)):g("v-if",!0)],8,at)]))),128))])):g("v-if",!0)]),f("div",nt,[y(L,{"transaction-fee":Number(e.trxFee),"total-fee-formatted":String(e.totalFee),"get-multi-sig-cosigner":e.walletCosignerList,"check-cosign-balance":String(e.checkCosignBalance),"lock-fund-currency":e.lockFund,"lock-fund-tx-fee":e.lockFundTxFee,balance:e.accountDisplayBalance,"selected-acc-add":T.address,"no-namespace":e.noNamespace,"on-partial":e.onPartial,"is-cosigner":e.isCosigner,"fund-status":e.fundStatus},null,8,["transaction-fee","total-fee-formatted","get-multi-sig-cosigner","check-cosign-balance","lock-fund-currency","lock-fund-tx-fee","balance","selected-acc-add","no-namespace","on-partial","is-cosigner","fund-status"]),f("div",it,u(s.$t("general.enterPasswordContinue")),1),y(E,{placeholder:s.$t("general.enterPassword"),errorMessage:s.$t("general.passwordRequired"),modelValue:e.walletPassword,"onUpdate:modelValue":i[5]||(i[5]=a=>e.walletPassword=a),icon:"lock",disabled:e.disableNamespace},null,8,["placeholder","errorMessage","modelValue","disabled"]),ct,e.selectAction=="Link"?(r(),n("button",{key:0,class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:i[6]||(i[6]=(...a)=>e.aliasAddressToNamespace&&e.aliasAddressToNamespace(...a)),disabled:e.disableCreate},u(s.$t("general.linkToNamespace")),9,dt)):g("v-if",!0),e.selectAction=="Unlink"?(r(),n("button",{key:1,class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:i[7]||(i[7]=(...a)=>e.aliasAddressToNamespace&&e.aliasAddressToNamespace(...a)),disabled:e.disableCreate},u(s.$t("namespace.unlinkNamespace")),9,ut)):g("v-if",!0),f("div",mt,[y(R,{to:{name:"ViewAccountDetails",params:{address:T.address}},class:"content-center text-xs text-white underline"},{default:Ve(()=>[ae(u(s.$t("general.cancel")),1)]),_:1},8,["to"])])])])])])}const _s=Ne(Ke,[["render",pt],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/account/submodule/linkToNamespace/views/ViewAccountAliasAddressToNamespace.vue"]]);export{_s as default};
