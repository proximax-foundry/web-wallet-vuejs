import{_ as D,j as P,y as j,g as C,r as N,o as i,f as c,e as s,s as B,t as o,l as k,b as M,i as x,F as q,K as G,T as J,E as R,w as g,b3 as Q}from"./index-bab83e60.js";import{A as V}from"./addressBookUtils-0d3294bf.js";import{_ as X}from"./icon-download-26660e63.js";const Y={name:"DisplayImportContactModal",props:[],components:{},data(){return{toggleModal:!1}},setup(){const{t:e}=P(),a=j(),t=R().appContext.config.globalProperties.emitter,n=C([]),m=C(0),u=C(0),r=C([]),L=A=>{var E=A.target.files||A.dataTransfer.files;E.length&&K(E[0])},O=()=>{m.value=0,u.value=0,r.value=[]},K=A=>{new Promise(I=>{var p=new FileReader;p.onload=()=>{I(p.result)},p.readAsText(A)}).then(I=>{if(!g.currentLoggedInWallet)return;const p=g.currentLoggedInWallet;var W=I.match(/[^\r\n]+/g);let $=[],w=[],T=[];W.shift(),W.forEach(y=>{var d,f,b,h,v=y.split(",");if(v.length>4){let l="";for(var S=0;S<v.length-1;++S)l=l+v[S]+",";d=l.replace(/['"]+/g,"")}else d=v[0].replace(/['"]+/g,"");f=v[1].replace(/['"]+/g,""),v[2]?b=v[2].replace(/['"]+/g,""):b="-none-",v[3]?h=v[3].replace(/['"]+/g,""):h=null;const U=p.accounts.findIndex(l=>l.name.toLowerCase()==d.toLowerCase()),z=p.contacts!=null?p.contacts.findIndex(l=>l.address==f):-1,H=p.contacts!=null?p.contacts.findIndex(l=>l.name.toLowerCase()==d.toLowerCase()):-1,F=g.currentLoggedInWallet.accounts.find(l=>l.default==!0);z>=0?$.push({label:d,address:f,group:b,publicKey:h}):H>=0||U>=0?V.verifyNetworkAddress(F.address,f).isPassed?w.push({label:d+" - 2",address:f,group:b,publicKey:h}):T.push({label:d,address:f,group:b,publicKey:h}):V.verifyNetworkAddress(F.address,f).isPassed?w.push({label:d,address:f,group:b,publicKey:h}):T.push({label:d,address:f,group:b,publicKey:h})}),$.length>0&&(u.value=$.length),w.length>0&&(w.forEach(y=>{let d=new Q(y.label,y.address,y.group,y.publicKey);g.currentLoggedInWallet.addAddressBook(d)}),g.wallets.saveMyWalletOnlytoLocalStorage(g.currentLoggedInWallet),m.value=w.length,t.emit("REFRESH_CONTACT_LIST",!0),a.add({severity:"info",summary:e("general.addressBook"),detail:e("addressBook.newContactImported",m.value),group:"br-custom",life:5e3})),r.value=T},I=>{console.log(I)})};return{csv:n,contactAdded:m,contactExisted:u,contactInvalidAddress:r,onFileChange:L,closeModel:O}}},Z={key:0,class:"popup-outer fixed flex z-50"},ee={class:"modal-popup-box"},te={class:"delete-position"},oe={class:"w-104"},se={class:"default-title font-bold mt-0 mb-5"},ne={key:0,class:"bg-blue-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},ae={key:1,class:"bg-yellow-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},re={key:2,class:"bg-red-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},le={key:3,class:"text-left text-gray-800 mt-5"},de={class:"font-bold mb-2"},ie={class:"inline-block mr-3 w-40"},ce={class:"inline-block"},ge={class:"py-5 my-5 text-tsm"},me={enctype:"multipart/form-data"};function ue(e,a,_,t,n,m){const u=N("font-awesome-icon");return i(),c("div",null,[s("div",{onClick:a[0]||(a[0]=r=>n.toggleModal=!n.toggleModal),class:"cursor-pointer mt-5 py-2 px-5 rounded-md bg-blue-primary text-white text-tsm drop-shadow-lg filter hover:bg-blue-600 transition-all duration-500"},[a[4]||(a[4]=s("img",{src:X,class:"inline-block mr-4 relative top-1"},null,-1)),B(o(e.$t("general.import")),1)]),k(J,{"enter-active-class":"animate__animated animate__fadeInDown","leave-active-class":"animate__animated animate__fadeOutUp"},{default:M(()=>[n.toggleModal?(i(),c("div",Z,[s("div",ee,[s("div",te,[k(u,{icon:"times",class:"delete-icon-style",onClick:a[1]||(a[1]=r=>{n.toggleModal=!n.toggleModal,t.closeModel()})})]),s("div",oe,[s("h1",se,o(e.$t("addressBook.importAddress")),1),t.contactAdded>0?(i(),c("div",ne,o(t.contactAdded)+" "+o(e.$t("general.contact",t.contactAdded))+" "+o(e.$t("addressBook.addressBookMessage1")),1)):x("",!0),t.contactExisted>0?(i(),c("div",ae,o(t.contactExisted)+" "+o(e.$t("general.contact",t.contactExisted))+" "+o(e.$t("addressBook.addressBookMessage2")),1)):x("",!0),t.contactInvalidAddress.length>0?(i(),c("div",re,o(t.contactInvalidAddress.length)+" "+o(e.$t("general.contact",t.contactInvalidAddress.length))+" "+o(e.$t("addressBook.addressBookMessage3")),1)):x("",!0),t.contactInvalidAddress.length>0?(i(),c("div",le,[s("div",de,o(e.$t("general.contact",t.contactInvalidAddress.length))+" "+o(e.$t("addressBook.addressBookMessage4"))+":",1),(i(!0),c(q,null,G(t.contactInvalidAddress,(r,L)=>(i(),c("div",{key:L,class:"text-left mb-2"},[s("div",ie,o(r.label),1),s("div",ce,o(r.address),1)]))),128))])):x("",!0),s("div",ge,[s("form",me,[s("input",{type:"file",onChange:a[2]||(a[2]=(...r)=>t.onFileChange&&t.onFileChange(...r))},null,32)])])])])])):x("",!0)]),_:1}),n.toggleModal?(i(),c("div",{key:0,onClick:a[3]||(a[3]=r=>{n.toggleModal=!n.toggleModal,t.closeModel()}),class:"fixed inset-0 bg-opacity-60 bg-gray-100 z-20"})):x("",!0)])}const pe=D(Y,[["render",ue],["__scopeId","data-v-897f86eb"]]),fe={name:"ViewServicesAddressBook",components:{DisplayImportContactModal:pe},setup(){P();const a=R().appContext.config.globalProperties.emitter,_=C([]),t=()=>{g.currentLoggedInWallet&&(_.value=[],g.currentLoggedInWallet.contacts!=null&&g.currentLoggedInWallet.contacts.length>0&&(g.currentLoggedInWallet.contacts.forEach(n=>{_.value.push(n)}),_.value.sort((n,m)=>n.name>m.name?1:n.name<m.name?-1:0)))};return t(),a.on("REFRESH_CONTACT_LIST",n=>{n&&setTimeout(()=>{t()},1e3)}),{list:_}}},ve={class:"w-9/12 ml-auto mr-auto mt-5"},_e={class:"flex text-xs font-semibold border-b-2 menu_title_div"},be={class:"w-18 text-center border-b-2 pb-3 border-yellow-500"},he={class:"mt-10"},ye={class:"text-md my-5 font-semibold"},xe={class:"flex cursor-pointer"},ke={class:"border-2 border-blue-primary p-1 mb-3 w-20 text-white bg-blue-primary text-xs text-center font-semibold"},Ie={class:"text-tsm"};function we(e,a,_,t,n,m){const u=N("router-link"),r=N("DisplayImportContactModal");return i(),c("div",null,[s("div",ve,[s("div",_e,[k(u,{to:{name:"ViewServicesAddressBook"},class:"w-18 text-center border-b pb-3"},{default:M(()=>[B(o(e.$t("general.list")),1)]),_:1}),s("div",be,o(e.$t("general.import")),1),k(u,{to:{name:"ViewServicesAddressBookExport"},class:"w-18 text-center border-b pb-3"},{default:M(()=>[B(o(e.$t("general.export")),1)]),_:1})]),s("div",he,[s("div",ye,o(e.$t("addressBook.importContacts")),1),s("div",xe,[s("div",ke,o(e.$t("wallet.importFile")),1),k(u,{to:{name:"ViewServicesAddressBookImportAccount"},class:"border-2 border-blue-primary p-1 mb-3 w-16 text-blue-primary text-xs text-center font-semibold"},{default:M(()=>[B(o(e.$t("general.account")),1)]),_:1})]),s("div",Ie,o(e.$t("addressBook.addBackUpContact")),1),k(r,{class:"inline-block w-36 flex-none"})])])])}const Me=D(fe,[["render",we]]);export{Me as default};
