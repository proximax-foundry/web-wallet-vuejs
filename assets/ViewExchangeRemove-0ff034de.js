import{d as J,r as k,O as ue,I as Q,a as Y,w as d,A as l,E as s,k as Z,o as f,b as w,m as me,z as O,e,t as i,f as I,C as T,i as ee,_ as te,c as y,D as ge,H as q,n as D,V as R,q as ve,s as j,B as pe,bl as fe,W as z}from"./index-401acdd9.js";import{_ as se}from"./proximax-logo-ecfc3767.js";import{M as _e}from"./multisigUtils-bf9a3788.js";import{t as K}from"./jdenticon-module-3e81fcaa.js";import{P as he}from"./PasswordInput-357714d6.js";const xe={key:0,class:"account-item-value account-item"},be={class:"flex"},ye=["innerHTML"],we={class:"flex flex-col ml-2 text-left"},Te=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Multisig Account",-1),Ae={class:"mt-1 text-tsm font-bold"},Ie={class:"account-item"},ke={class:"flex items-center"},Le=["innerHTML"],Me={class:"text-xs ml-2 font-semibold"},Se=J({__name:"SelectInputCosignerAccount",props:{cosignerList:{type:Array,required:!1}},emits:["select-cosigner-account","update:modelValue"],setup(S){const v=S;k(!1);const{cosignerList:W}=ue(v),p=k([]),_=ee().appContext.config.globalProperties.emitter;let F=new Q("ThemeStyleConfig");F.init();let H=F.jdenticonConfig;const A=k(null);Y(W,h=>{p.value=h.map(g=>{const r=[...d.currentLoggedInWallet.accounts,...d.currentLoggedInWallet.others].find(n=>n.publicKey==g);return{label:r?d.currentLoggedInWallet.convertAddressToName(r.address):l.PublicAccount.createFromPublicKey(g,s.networkType).address.plain(),value:l.PublicAccount.createFromPublicKey(g,s.networkType).address.plain()}})},{deep:!0,immediate:!0});const V=k(null),L=(h,g)=>{if(h==null&&g==null){A.value=null,_.emit("select-cosigner-account",null);return}_.emit("select-cosigner-account",g),A.value.label=h,A.value.value=g,V.value=K(g,25,H)};return(h,g)=>{const u=Z("Dropdown");return f(),w("div",null,[p.value.length?(f(),me(u,{key:0,showClear:!0,modelValue:A.value,"onUpdate:modelValue":g[0]||(g[0]=r=>A.value=r),style:{width:"100%"},options:p.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:g[1]||(g[1]=r=>{var n,x,C,P;L((n=r.value)==null?void 0:n.label,(x=r.value)==null?void 0:x.value),h.$emit("update:modelValue",(C=r.value)==null?void 0:C.value),h.$emit("select-cosigner-account",(P=r.value)==null?void 0:P.value)})},{value:O(r=>[r.value?(f(),w("div",xe,[e("div",be,[e("div",{innerHTML:V.value},null,8,ye),e("div",we,[Te,e("div",Ae,i(r.value.label),1)])])])):I("v-if",!0)]),option:O(r=>[e("div",Ie,[e("div",ke,[e("div",{innerHTML:T(K)(r.option.value,20,T(H))},null,8,Le),e("div",Me,i(r.option.label),1)])])]),_:1},8,["modelValue","options"])):I("v-if",!0)])}}}),Fe=te(Se,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/services/submodule/exchange/components/SelectInputCosignerAccount.vue"]]),He={class:"border-2 xl:grid xl:grid-cols-3"},Ce={class:"xl:col-span-2 p-12"},Pe=e("div",null,"SDA-SDA Exchange - Remove Offer",-1),Ee={key:0,class:"text-blue-primary mt-3"},Ve={key:1,class:"text-red-500"},Ge={class:"border border-blue-300 rounded-md p-3 mt-3 bg-blue-50"},$e={class:"flex items-center gap-2"},Re=["innerHTML"],We={class:"flex flex-col gap-0.5"},Ne=e("div",{class:"uppercase text-xxs text-blue-primary"},"Selected Account",-1),Be={class:"font-semibold"},De=e("div",{class:"text-blue-primary mt-3"},"Amount to give ",-1),je=e("div",{class:"text-blue-primary mt-3"},"Amount to get ",-1),Oe={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},Ke={key:0},Ue={class:"font-bold text-xs text-blue-primary uppercase"},Xe={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},qe={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},ze=["innerHTML"],Je={class:"flex"},Qe={class:"ml-1 text-blue-400 font-bold"},Ye=e("img",{src:se,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),Ze=e("div",{class:"border-b-2 border-gray-600 my-2"},null,-1),et={class:"font-bold text-xs text-blue-primary uppercase"},tt={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},st={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},nt=["innerHTML"],ot={class:"flex"},at={class:"ml-1 text-blue-400 font-bold"},lt=e("img",{src:se,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),it=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),rt={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},ct={class:"font-semibold lg:col-span-2 col-span-3"},dt=["innerHTML"],ut={class:"ml-1 text-blue-400"},mt={key:1,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs"},gt={class:"font-semibold lg:col-span-2 col-span-3"},vt=["innerHTML"],pt={class:"ml-1 text-blue-400"},ft={key:2,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},_t={class:"font-semibold lg:col-span-2 col-span-3"},ht=["innerHTML"],xt={class:"ml-1 text-blue-400"},bt=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),yt={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},wt=e("div",{class:"font-semibold lg:col-span-2 col-span-3 uppercase"},"Total",-1),Tt=["innerHTML"],At={class:"ml-1 text-blue-400"},It={class:"font-semibold text-xs text-white mb-1.5"},kt={class:"text-center"},Lt=J({__name:"ViewExchangeRemove",props:{owner:String,pair:String},setup(S){const v=S,W=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],p=k(""),N=t=>{if(!t)return"0";const o=l.Address.createFromRawAddress(t).plain(),a=d.currentLoggedInWallet.accounts.find(m=>m.address==o)||d.currentLoggedInWallet.others.find(m=>m.address==o);return a?_(a.balance):0},_=t=>{let o=t.toString().split(".");return o[1]!=null?'<span class="font-semibold text-sm">'+o[0]+'</span>.<span class="font-semibold text-xs">'+o[1]+"</span>":'<span class="font-semibold text-sm">'+o[0]+"</span>"},F=t=>{const o=W.find(a=>a.namespace==t);return o?o.name:t},H=new Q("ThemeStyleConfig");H.init();const A=y(()=>K(v.owner,40,H.jdenticonConfig)),V=y(()=>{const t=l.Address.createFromRawAddress(v.owner).plain();return d.currentLoggedInWallet.convertAddressToName(t,!0)}),L=k(null);ee().appContext.config.globalProperties.emitter.on("select-cosigner-account",t=>{L.value=t});const u=y(()=>{const t=l.Address.createFromRawAddress(v.owner).plain();return(d.currentLoggedInWallet.accounts.find(a=>a.address==t)||d.currentLoggedInWallet.others.find(a=>a.address==t)).getDirectParentMultisig().length}),r=y(()=>{if(!u.value)return[];const t=l.Address.createFromRawAddress(v.owner).plain(),o=d.currentLoggedInWallet.accounts.find(a=>a.address==t)||d.currentLoggedInWallet.others.find(a=>a.address==t);return _e.getCosignerInWallet(o.publicKey).cosignerList}),n=k(null),x=ge(),C=v.pair.split("/")[0],P=v.pair.split("/")[1],ne=async()=>{if(!C||!P){x.add({severity:"error",summary:"Error",detail:"Invalid",group:"br-custom",life:1e3});return}const t=new l.ExchangeSdaHttp(s.nodeFullURL),o=await fe(t.getAccountSdaExchangeOffers(l.Address.createFromRawAddress(v.owner)));if(n.value=o.sdaOfferBalances.find(c=>c.mosaicIdGive.toHex()==C&&c.mosaicIdGet.toHex()==P),!n.value){x.add({severity:"error",summary:"Error",detail:"Offer not found",group:"br-custom",life:1e3});return}const a=await s.chainAPI.assetAPI.getMosaicsNames([n.value.mosaicIdGet,n.value.mosaicIdGive]),m=await s.chainAPI.assetAPI.getMosaics([n.value.mosaicIdGet,n.value.mosaicIdGive]);n.value.mosaicGetName=a[0].names.length?a[0].names[0].name:n.value.mosaicIdGet.toHex(),n.value.mosaicGiveName=a[1].names.length?a[1].names[0].name:n.value.mosaicIdGive.toHex(),n.value.mosaicGetDivisibility=m.find(c=>c.mosaicId.toHex()==n.value.mosaicIdGet.toHex()).divisibility,n.value.mosaicGiveDivisibility=m.find(c=>c.mosaicId.toHex()==n.value.mosaicIdGive.toHex()).divisibility},oe=Y(s,async(t,o)=>{t.isReady&&(await ne(),oe())},{immediate:!0}),U=y(()=>q.convertToExact(D.currentNetworkProfileConfig.lockedFundsPerAggregate,s.nativeToken.divisibility)),X=y(()=>q.convertToExact(R.getLockFundFee(),s.nativeToken.divisibility)),B=y(()=>{var m;if(!s.isReady)return 0;const t=l.RemoveSdaExchangeOfferTransaction.create(l.Deadline.create(),[new l.RemoveSdaExchangeOffer(new l.MosaicId(s.nativeToken.assetId),new l.MosaicId(s.nativeToken.assetId))],s.networkType);if(!u.value)return((m=t.maxFee)==null?void 0:m.compact())/Math.pow(10,s.nativeToken.divisibility);const o=[...d.currentLoggedInWallet.accounts,...d.currentLoggedInWallet.others].find(c=>c.address==l.Address.createFromRawAddress(v.owner).plain()),a=[t.toAggregateV1(l.PublicAccount.createFromPublicKey(o.publicKey,s.networkType))];return s.buildTxn.aggregateBonded(a).maxFee.compact()/Math.pow(10,s.nativeToken.divisibility)}),ae=y(()=>u.value?Math.round((U.value+X.value+B.value)*Math.pow(10,s.nativeToken.divisibility))/Math.pow(10,s.nativeToken.divisibility):B.value),le=ve(),ie=async()=>{if(u.value&&!L.value){x.add({severity:"error",summary:"Error",detail:"Initiator not selected",group:"br-custom",life:1e3});return}if(p.value.length<8){x.add({severity:"error",summary:"Error",detail:"password must be at least 8 characters",group:"br-custom",life:1e3});return}if(!z.verifyWalletPassword(d.currentLoggedInWallet.name,D.chainNetworkName,p.value)){x.add({severity:"error",summary:"Error",detail:"Incorrect password",group:"br-custom",life:1e3});return}const t=l.Address.createFromRawAddress(v.owner).plain(),o=d.currentLoggedInWallet.accounts.find(b=>b.address==(u.value?L.value:t)),a=z.decryptPrivateKey(new l.Password(p.value),o.encrypted,o.iv);p.value="";const m=l.RemoveSdaExchangeOfferTransaction.create(l.Deadline.create(),[new l.RemoveSdaExchangeOffer(n.value.mosaicIdGive,n.value.mosaicIdGet)],s.networkType),c=l.Account.createFromPrivateKeyV1(a,s.networkType),M=D.currentNetworkProfile.generationHash;if(u.value){const b=[...d.currentLoggedInWallet.accounts,...d.currentLoggedInWallet.others].find(de=>de.address==t),G=[m.toAggregateV1(l.PublicAccount.createFromPublicKey(b.publicKey,s.networkType))],$=s.buildTxn.aggregateBonded(G),E=c.preV2Sign($,M),re=R.lockFundTx(E),ce=c.preV2Sign(re,M);R.announceLF_AND_addAutoAnnounceABT(ce,E)}else{const b=c.preV2Sign(m,M);await R.announceTransaction(b)}le.push({name:"ViewAccountPendingTransactions",params:{address:c.address.plain()}})};return(t,o)=>{var m,c,M,b,G,$;const a=Z("router-link");return f(),w("div",null,[e("div",He,[e("div",Ce,[Pe,r.value.length?(f(),w("div",Ee,"Select Initiator")):I("v-if",!0),j(Fe,{"cosigner-list":r.value},null,8,["cosigner-list"]),u.value&&!r.value.length?(f(),w("div",Ve,"Cosigner not found")):I("v-if",!0),e("div",Ge,[e("div",$e,[e("div",{innerHTML:A.value},null,8,Re),e("div",We,[Ne,e("div",Be,i(V.value),1)])])]),De,e("div",null,i(((m=n.value)==null?void 0:m.currentMosaicGiveAmount.compact())/Math.pow(10,(c=n.value)==null?void 0:c.mosaicGiveDivisibility))+" "+i(F((M=n.value)==null?void 0:M.mosaicGiveName)),1),je,e("div",null,i(((b=n.value)==null?void 0:b.currentMosaicGetAmount.compact())/Math.pow(10,(G=n.value)==null?void 0:G.mosaicGetDivisibility))+" "+i(F(($=n.value)==null?void 0:$.mosaicGetName)),1)])]),e("div",Oe,[u.value?(f(),w("div",Ke,[e("div",Ue,i(t.$t("general.multisigAcc")),1),e("div",Xe,[e("div",qe,i(t.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:N(S.owner)},null,8,ze),e("div",Je,[e("div",Qe,i(T(s).nativeToken.label),1),Ye])]),Ze])):I("v-if",!0),e("div",et,i(t.$t("general.signerAcc")),1),e("div",tt,[e("div",st,i(t.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:N(u.value?L.value:S.owner)},null,8,nt),e("div",ot,[e("div",at,i(T(s).nativeToken.label),1),lt])]),it,e("div",rt,[e("div",ct,i(u.value?t.$t("general.aggregateFee"):t.$t("general.transactionFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(B.value)},null,8,dt),e("div",ut,i(T(s).nativeToken.label),1)]),u.value?(f(),w("div",mt,[e("div",gt,i(t.$t("general.lockFund")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(U.value??0)},null,8,vt),e("div",pt,i(T(s).nativeToken.label),1)])):I("v-if",!0),u.value?(f(),w("div",ft,[e("div",_t,i(t.$t("general.lockFundTxFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(X.value??0)},null,8,ht),e("div",xt,i(T(s).nativeToken.label),1)])):I("v-if",!0),bt,e("div",yt,[wt,e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(ae.value)},null,8,Tt),e("div",At,i(T(s).nativeToken.label),1)]),e("div",It,i(t.$t("general.enterPasswordContinue")),1),j(he,{placeholder:t.$t("general.enterPassword"),modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=E=>p.value=E),icon:"lock",class:"mt-5 mb-3"},null,8,["placeholder","modelValue"]),e("button",{class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:o[1]||(o[1]=E=>ie())}," Sell "),e("div",kt,[j(a,{to:{name:"ViewExchangeListing"},class:"content-center text-xs text-white underline"},{default:O(()=>[pe(i(t.$t("general.cancel")),1)]),_:1})])])])}}}),Pt=te(Lt,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/services/submodule/exchange/ViewExchangeRemove.vue"]]);export{Pt as default};
