import{d as Q,r as k,L as ue,D as Y,a as Z,i as ee,o as f,b as w,k as me,v as O,e,t as i,f as I,y as T,h as te,w as d,z as l,B as s,c as y,A as ge,H as z,n as D,R as W,l as ve,m as K,x as pe,W as J,be as fe}from"./index-afd1020c.js";import{_ as se}from"./proximax-logo-ecfc3767.js";import{M as _e}from"./multisigUtils-20f56368.js";import{t as j}from"./jdenticon-module-971263f4.js";import{_ as he}from"./PasswordInput.vue_vue_type_script_setup_true_lang-1607cb6e.js";const xe={key:0,class:"account-item-value account-item"},be={class:"flex"},ye=["innerHTML"],we={class:"flex flex-col ml-2 text-left"},Te=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Multisig Account",-1),Ae={class:"mt-1 text-tsm font-bold"},Ie={class:"account-item"},ke={class:"flex items-center"},Le=["innerHTML"],Me={class:"text-xs ml-2 font-semibold"},Fe=Q({__name:"SelectInputCosignerAccount",props:{cosignerList:{type:Array,required:!1}},emits:["select-cosigner-account","update:modelValue"],setup(F){k(!1);const v=F,{cosignerList:R}=ue(v),p=k([]),_=te().appContext.config.globalProperties.emitter;let S=new Y("ThemeStyleConfig");S.init();let H=S.jdenticonConfig;const A=k(null);Z(R,h=>{p.value=h.map(g=>{const r=[...d.currentLoggedInWallet.accounts,...d.currentLoggedInWallet.others].find(n=>n.publicKey==g);return{label:r?d.currentLoggedInWallet.convertAddressToName(r.address):l.PublicAccount.createFromPublicKey(g,s.networkType).address.plain(),value:l.PublicAccount.createFromPublicKey(g,s.networkType).address.plain()}})},{deep:!0,immediate:!0});const E=k(null),L=(h,g)=>{if(h==null&&g==null){A.value=null,_.emit("select-cosigner-account",null);return}_.emit("select-cosigner-account",g),A.value.label=h,A.value.value=g,E.value=j(g,25,H)};return(h,g)=>{const u=ee("Dropdown");return f(),w("div",null,[p.value.length?(f(),me(u,{key:0,showClear:!0,modelValue:A.value,"onUpdate:modelValue":g[0]||(g[0]=r=>A.value=r),style:{width:"100%"},options:p.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:g[1]||(g[1]=r=>{var n,x,P,C;L((n=r.value)==null?void 0:n.label,(x=r.value)==null?void 0:x.value),h.$emit("update:modelValue",(P=r.value)==null?void 0:P.value),h.$emit("select-cosigner-account",(C=r.value)==null?void 0:C.value)})},{value:O(r=>[r.value?(f(),w("div",xe,[e("div",be,[e("div",{innerHTML:E.value},null,8,ye),e("div",we,[Te,e("div",Ae,i(r.value.label),1)])])])):I("",!0)]),option:O(r=>[e("div",Ie,[e("div",ke,[e("div",{innerHTML:T(j)(r.option.value,20,T(H))},null,8,Le),e("div",Me,i(r.option.label),1)])])]),_:1},8,["modelValue","options"])):I("",!0)])}}}),Se={class:"border-2 xl:grid xl:grid-cols-3"},He={class:"xl:col-span-2 p-12"},Pe=e("div",null,"SDA-SDA Exchange - Remove Offer",-1),Ce={key:0,class:"text-blue-primary mt-3"},Ee={key:1,class:"text-red-500"},$e={class:"border border-blue-300 rounded-md p-3 mt-3 bg-blue-50"},Ge={class:"flex items-center gap-2"},Ve=["innerHTML"],We={class:"flex flex-col gap-0.5"},Re=e("div",{class:"uppercase text-xxs text-blue-primary"},"Selected Account",-1),Ne={class:"font-semibold"},Be=e("div",{class:"text-blue-primary mt-3"},"Amount to give ",-1),De=e("div",{class:"text-blue-primary mt-3"},"Amount to get ",-1),Ke={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},Oe={key:0},je={class:"font-bold text-xs text-blue-primary uppercase"},Ue={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},Xe={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},qe=["innerHTML"],ze={class:"flex"},Je={class:"ml-1 text-blue-400 font-bold"},Qe=e("img",{src:se,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),Ye=e("div",{class:"border-b-2 border-gray-600 my-2"},null,-1),Ze={class:"font-bold text-xs text-blue-primary uppercase"},et={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},tt={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},st=["innerHTML"],nt={class:"flex"},at={class:"ml-1 text-blue-400 font-bold"},ot=e("img",{src:se,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),lt=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),it={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},rt={class:"font-semibold lg:col-span-2 col-span-3"},ct=["innerHTML"],dt={class:"ml-1 text-blue-400"},ut={key:1,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs"},mt={class:"font-semibold lg:col-span-2 col-span-3"},gt=["innerHTML"],vt={class:"ml-1 text-blue-400"},pt={key:2,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},ft={class:"font-semibold lg:col-span-2 col-span-3"},_t=["innerHTML"],ht={class:"ml-1 text-blue-400"},xt=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),bt={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},yt=e("div",{class:"font-semibold lg:col-span-2 col-span-3 uppercase"},"Total",-1),wt=["innerHTML"],Tt={class:"ml-1 text-blue-400"},At={class:"font-semibold text-xs text-white mb-1.5"},It={class:"text-center"},Ht=Q({__name:"ViewExchangeRemove",props:{owner:String,pair:String},setup(F){const v=F,R=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],p=k(""),N=t=>{if(!t)return"0";const a=l.Address.createFromRawAddress(t).plain(),o=d.currentLoggedInWallet.accounts.find(m=>m.address==a)||d.currentLoggedInWallet.others.find(m=>m.address==a);return o?_(o.balance):0},_=t=>{let a=t.toString().split(".");return a[1]!=null?'<span class="font-semibold text-sm">'+a[0]+'</span>.<span class="font-semibold text-xs">'+a[1]+"</span>":'<span class="font-semibold text-sm">'+a[0]+"</span>"},S=t=>{const a=R.find(o=>o.namespace==t);return a?a.name:t},H=new Y("ThemeStyleConfig");H.init();const A=y(()=>j(v.owner,40,H.jdenticonConfig)),E=y(()=>{const t=l.Address.createFromRawAddress(v.owner).plain();return d.currentLoggedInWallet.convertAddressToName(t,!0)}),L=k(null);te().appContext.config.globalProperties.emitter.on("select-cosigner-account",t=>{L.value=t});const u=y(()=>{const t=l.Address.createFromRawAddress(v.owner).plain();return(d.currentLoggedInWallet.accounts.find(o=>o.address==t)||d.currentLoggedInWallet.others.find(o=>o.address==t)).getDirectParentMultisig().length}),r=y(()=>{if(!u.value)return[];const t=l.Address.createFromRawAddress(v.owner).plain(),a=d.currentLoggedInWallet.accounts.find(o=>o.address==t)||d.currentLoggedInWallet.others.find(o=>o.address==t);return _e.getCosignerInWallet(a.publicKey).cosignerList}),n=k(null),x=ge(),P=v.pair.split("/")[0],C=v.pair.split("/")[1],ne=async()=>{if(!P||!C){x.add({severity:"error",summary:"Error",detail:"Invalid",group:"br-custom",life:1e3});return}const t=new l.ExchangeSdaHttp(s.nodeFullURL),a=await fe(t.getAccountSdaExchangeOffers(l.Address.createFromRawAddress(v.owner)));if(n.value=a.sdaOfferBalances.find(c=>c.mosaicIdGive.toHex()==P&&c.mosaicIdGet.toHex()==C),!n.value){x.add({severity:"error",summary:"Error",detail:"Offer not found",group:"br-custom",life:1e3});return}const o=await s.chainAPI.assetAPI.getMosaicsNames([n.value.mosaicIdGet,n.value.mosaicIdGive]),m=await s.chainAPI.assetAPI.getMosaics([n.value.mosaicIdGet,n.value.mosaicIdGive]);n.value.mosaicGetName=o[0].names.length?o[0].names[0].name:n.value.mosaicIdGet.toHex(),n.value.mosaicGiveName=o[1].names.length?o[1].names[0].name:n.value.mosaicIdGive.toHex(),n.value.mosaicGetDivisibility=m.find(c=>c.mosaicId.toHex()==n.value.mosaicIdGet.toHex()).divisibility,n.value.mosaicGiveDivisibility=m.find(c=>c.mosaicId.toHex()==n.value.mosaicIdGive.toHex()).divisibility},ae=Z(s,async(t,a)=>{t.isReady&&(await ne(),ae())},{immediate:!0}),U=y(()=>z.convertToExact(D.currentNetworkProfileConfig.lockedFundsPerAggregate,s.nativeToken.divisibility)),X=y(()=>z.convertToExact(W.getLockFundFee(),s.nativeToken.divisibility)),B=y(()=>{var m;if(!s.isReady)return 0;const t=l.RemoveSdaExchangeOfferTransaction.create(l.Deadline.create(),[new l.RemoveSdaExchangeOffer(new l.MosaicId(s.nativeToken.assetId),new l.MosaicId(s.nativeToken.assetId))],s.networkType);if(!u.value)return((m=t.maxFee)==null?void 0:m.compact())/Math.pow(10,s.nativeToken.divisibility);const a=[...d.currentLoggedInWallet.accounts,...d.currentLoggedInWallet.others].find(c=>c.address==l.Address.createFromRawAddress(v.owner).plain()),o=[t.toAggregateV1(l.PublicAccount.createFromPublicKey(a.publicKey,s.networkType))];return s.buildTxn.aggregateBonded(o).maxFee.compact()/Math.pow(10,s.nativeToken.divisibility)}),oe=y(()=>u.value?Math.round((U.value+X.value+B.value)*Math.pow(10,s.nativeToken.divisibility))/Math.pow(10,s.nativeToken.divisibility):B.value),le=ve(),ie=async()=>{if(u.value&&!L.value){x.add({severity:"error",summary:"Error",detail:"Initiator not selected",group:"br-custom",life:1e3});return}if(p.value.length<8){x.add({severity:"error",summary:"Error",detail:"password must be at least 8 characters",group:"br-custom",life:1e3});return}if(!J.verifyWalletPassword(d.currentLoggedInWallet.name,D.chainNetworkName,p.value)){x.add({severity:"error",summary:"Error",detail:"Incorrect password",group:"br-custom",life:1e3});return}const t=l.Address.createFromRawAddress(v.owner).plain(),a=d.currentLoggedInWallet.accounts.find(b=>b.address==(u.value?L.value:t)),o=J.decryptPrivateKey(new l.Password(p.value),a.encrypted,a.iv);p.value="";const m=l.RemoveSdaExchangeOfferTransaction.create(l.Deadline.create(),[new l.RemoveSdaExchangeOffer(n.value.mosaicIdGive,n.value.mosaicIdGet)],s.networkType),c=l.Account.createFromPrivateKeyV1(o,s.networkType),M=D.currentNetworkProfile.generationHash;if(u.value){const b=[...d.currentLoggedInWallet.accounts,...d.currentLoggedInWallet.others].find(de=>de.address==t),$=[m.toAggregateV1(l.PublicAccount.createFromPublicKey(b.publicKey,s.networkType))],G=await s.chainAPI.nodeAPI.getNodeTime(),V=s.buildTxn.aggregateBonded($,new l.UInt64(G.sendTimeStamp)),q=c.preV2Sign(V,M),re=W.lockFundTx(q),ce=c.preV2Sign(re,M);W.announceLF_AND_addAutoAnnounceABT(ce,q)}else{const b=c.preV2Sign(m,M);await W.announceTransaction(b)}le.push({name:"ViewAccountPendingTransactions",params:{address:c.address.plain()}})};return(t,a)=>{var m,c,M,b,$,G;const o=ee("router-link");return f(),w("div",null,[e("div",Se,[e("div",He,[Pe,r.value.length?(f(),w("div",Ce,"Select Initiator")):I("",!0),K(Fe,{"cosigner-list":r.value},null,8,["cosigner-list"]),u.value&&!r.value.length?(f(),w("div",Ee,"Cosigner not found")):I("",!0),e("div",$e,[e("div",Ge,[e("div",{innerHTML:A.value},null,8,Ve),e("div",We,[Re,e("div",Ne,i(E.value),1)])])]),Be,e("div",null,i(((m=n.value)==null?void 0:m.currentMosaicGiveAmount.compact())/Math.pow(10,(c=n.value)==null?void 0:c.mosaicGiveDivisibility))+" "+i(S((M=n.value)==null?void 0:M.mosaicGiveName)),1),De,e("div",null,i(((b=n.value)==null?void 0:b.currentMosaicGetAmount.compact())/Math.pow(10,($=n.value)==null?void 0:$.mosaicGetDivisibility))+" "+i(S((G=n.value)==null?void 0:G.mosaicGetName)),1)])]),e("div",Ke,[u.value?(f(),w("div",Oe,[e("div",je,i(t.$t("general.multisigAcc")),1),e("div",Ue,[e("div",Xe,i(t.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:N(F.owner)},null,8,qe),e("div",ze,[e("div",Je,i(T(s).nativeToken.label),1),Qe])]),Ye])):I("",!0),e("div",Ze,i(t.$t("general.signerAcc")),1),e("div",et,[e("div",tt,i(t.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:N(u.value?L.value:F.owner)},null,8,st),e("div",nt,[e("div",at,i(T(s).nativeToken.label),1),ot])]),lt,e("div",it,[e("div",rt,i(u.value?t.$t("general.aggregateFee"):t.$t("general.transactionFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(B.value)},null,8,ct),e("div",dt,i(T(s).nativeToken.label),1)]),u.value?(f(),w("div",ut,[e("div",mt,i(t.$t("general.lockFund")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(U.value??0)},null,8,gt),e("div",vt,i(T(s).nativeToken.label),1)])):I("",!0),u.value?(f(),w("div",pt,[e("div",ft,i(t.$t("general.lockFundTxFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(X.value??0)},null,8,_t),e("div",ht,i(T(s).nativeToken.label),1)])):I("",!0),xt,e("div",bt,[yt,e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:_(oe.value)},null,8,wt),e("div",Tt,i(T(s).nativeToken.label),1)]),e("div",At,i(t.$t("general.enterPasswordContinue")),1),K(he,{placeholder:t.$t("general.enterPassword"),modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=V=>p.value=V),icon:"lock",class:"mt-5 mb-3"},null,8,["placeholder","modelValue"]),e("button",{class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:a[1]||(a[1]=V=>ie())}," Sell "),e("div",It,[K(o,{to:{name:"ViewExchangeListing"},class:"content-center text-xs text-white underline"},{default:O(()=>[pe(i(t.$t("general.cancel")),1)]),_:1})])])])}}});export{Ht as default};
