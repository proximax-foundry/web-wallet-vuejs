import{d as D,D as U,u as z,A as y,c as M,w as v,r as A,W as G,E as c,a7 as H,a as X,k as Z,o as r,b as m,e as n,t as a,C as g,s as T,f,m as q,z as V,b3 as J,_ as O}from"./index-9f44b159.js";import{_ as C}from"./proximax-logo-ecfc3767.js";import{c as Q}from"./functions-2ca43d8c.js";const Y={class:"md:px-40 xl:px-64"},P={class:"border rounded-md p-3 flex flex-col shadow-lg filter mb-2 w-full"},ee={class:"text-blue-primary font-semibold text-xs"},te={class:"flex items-center my-1"},se=["id","copyValue","copySubject"],ne={class:"flex items-center"},le={class:"text-xs font-bold"},oe={key:0,class:"text-xs font-bold"},ae={class:"text-xxs mt-0.5"},ce={class:"ml-1 text-xs font-bold"},ie=n("img",{src:C,class:"h-4 w-4"},null,-1),de={key:0,class:"text-blue-primary"},re={key:1,class:"text-blue-primary text-sm font-semibold my-4"},ue={class:"border rounded-md p-3 flex flex-col shadow-lg filter mb-2 w-full"},me={class:"text-blue-primary font-semibold text-xs"},fe={class:"flex items-center my-1"},pe=["id","copyValue","copySubject"],ve={key:0,class:"flex items-center"},ge={class:"text-xs font-bold"},be={key:0,class:"text-xs font-bold"},ye={class:"text-xxs mt-0.5"},he={class:"ml-1 text-xs font-bold"},_e=n("img",{src:C,class:"h-4 w-4"},null,-1),xe=D({__name:"ViewMultisigAccounts",props:{address:String},setup(p){const k=p,B=U(),{t:j}=z(),I=s=>{let e=document.getElementById(s).getAttribute("copyValue"),l=document.getElementById(s).getAttribute("copySubject");Q(e),B.add({severity:"info",detail:l+" "+j("general.copied"),group:"br-custom",life:3e3})},h=y.Address.createFromRawAddress(k.address).plain(),_=M(()=>v.currentLoggedInWallet?(v.currentLoggedInWallet.accounts.find(e=>e.address==h)||v.currentLoggedInWallet.others.find(e=>e.address==h)).balance:0),u=s=>{if(s==null)return{left:null,right:null};let e=s.toString().split(".");return e[1]!=null?{left:e[0],right:e[1]}:{left:e[0],right:null}},S=A([]),L=async()=>{const s=[];try{const e=await c.chainAPI.accountAPI.getMultisigAccountGraphInfo(y.Address.createFromRawAddress(k.address));for(const[l,t]of e.multisigAccounts){const d=l;for(const o of t){const{account:x,cosignatories:$,multisigAccounts:F,minApproval:N,minRemoval:R}=o,E={publicKey:x.publicKey,level:d,cosignatories:$.map(w=>w.publicKey),multisigAccounts:F.map(w=>w.publicKey),minApproval:N,minRemoval:R,balance:0};s.push(E)}}return s}catch{return s}},i=A(null),W=async()=>{const s=i.value.map(e=>y.PublicAccount.createFromPublicKey(e.publicKey,c.networkType).address);try{const e=await c.chainAPI.accountAPI.getAccountsInfo(s);for(let l=0;l<i.value.length;l++){const t=e.findIndex(o=>o.publicKey==i.value[l].publicKey);if(t==-1)continue;const d=e[t].mosaics.find(o=>o.id.toHex()==c.nativeToken.assetId);d&&(i.value[l].balance=d.amount.compact()/Math.pow(10,c.nativeToken.divisibility))}}catch{}},b=M(()=>{let s=[];if(!i.value)return s;const e=[...i.value.filter(t=>t.level<0)],l=Math.min(...e.map(t=>t.level));if(l==1/0)return s;for(let t=0;t<Math.abs(l);t++){const d=e.filter(o=>o.level==-Math.abs(t+1)).map(o=>({address:G.createAddressFromPublicKey(o.publicKey,c.networkType).pretty(),balance:o.balance}));s.push({key:(t+1).toString(),label:"Level "+(t+1).toString(),selectable:!1,children:d.map((o,x)=>({type:"child",key:"0-"+x.toString(),balance:o.balance,label:v.currentLoggedInWallet.convertAddressToName(y.Address.createFromRawAddress(o.address).plain(),!0),address:o.address,selectable:!0}))})}return s}),K=H();return K.run(()=>{const s=A(!1),e=X(c,async l=>{l.isReady&&!s.value&&(s.value=!0,i.value=await L(),await W(),e(),K.stop())},{immediate:!0})}),(s,e)=>{const l=Z("font-awesome-icon");return r(),m("div",Y,[n("div",P,[n("div",ee,a(g(v).currentLoggedInWallet.convertAddressToName(g(h))),1),n("div",te,[n("div",{id:p.address.substring(-4),copyValue:p.address,copySubject:s.$t("general.address"),class:"truncate font-semibold text-xs mt-1"},a(p.address),9,se),T(l,{icon:"copy",title:s.$t("general.copy"),onClick:e[0]||(e[0]=t=>I(p.address.substring(-4))),class:"ml-2 w-5 h-5 text-blue-link cursor-pointer"},null,8,["title"])]),n("div",ne,[n("div",le,a(u(_.value).left),1),u(_.value).right!=null?(r(),m("div",oe,".")):f("v-if",!0),n("div",ae,a(u(_.value).right),1),n("div",ce,a(g(c).nativeToken.label),1),ie])]),b.value.length?f("v-if",!0):(r(),m("div",de,"This account is not cosignatory of any accounts.")),b.value.length?(r(),m("div",re,"Cosignatories of")):f("v-if",!0),b.value.length?(r(),q(g(J),{key:2,expandedKeys:S.value,"onUpdate:expandedKeys":e[1]||(e[1]=t=>S.value=t),value:b.value,filter:!0,filterMode:"strict",selectionMode:"single",class:"w-full"},{default:V(t=>[n("div",null,a(t.node.label),1)]),child:V(t=>[n("div",ue,[n("div",me,a(t.node.label),1),n("div",fe,[n("div",{id:t.node.address.substring(-4),copyValue:t.node.address,copySubject:s.$t("general.address"),class:"truncate font-semibold text-xs mt-1"},a(t.node.address),9,pe),T(l,{icon:"copy",title:s.$t("general.copy"),onClick:d=>I(t.node.address.substring(-4)),class:"ml-2 w-5 h-5 text-blue-link cursor-pointer"},null,8,["title","onClick"])]),t.node.balance?(r(),m("div",ve,[n("div",ge,a(u(t.node.balance).left),1),u(t.node.balance).right!=null?(r(),m("div",be,".")):f("v-if",!0),n("div",ye,a(u(t.node.balance).right),1),n("div",he,a(g(c).nativeToken.label),1),_e])):f("v-if",!0)])]),_:1},8,["expandedKeys","value"])):f("v-if",!0)])}}});const Ie=O(xe,[["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/account/submodule/multisig/views/ViewMultisigAccounts.vue"]]);export{Ie as default};
