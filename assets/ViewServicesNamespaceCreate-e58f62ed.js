import{_ as W,a5 as ye,S as se,o as i,b as c,e as s,x as le,t as o,P as ne,f as C,j as H,d as oe,r as n,u as re,c as y,z as K,F as xe,g as Ne,h as ie,l as ke,n as h,b3 as $e,b4 as Te,H as m,B as d,R as we,a as R,i as te,m as w,v as Ce,G as Ie}from"./index-3cfaae9e.js";import{_ as Se}from"./icon-info-8b4f1351.js";import{N as S}from"./namespaceUtils-d871aee5.js";import{_ as Pe}from"./delete-8b454e7f.js";import{D as Fe}from"./DurationInputClean-6302dabb.js";import{_ as Ee,a as Re,b as Ve,c as De}from"./TxnSummary.vue_vue_type_script_setup_true_lang-49f6e976.js";import{T as O}from"./transactionState-0a752924.js";import"./jdenticon-module-20d3220f.js";import"./proximax-logo-ecfc3767.js";const Ae={directives:{tooltip:ye},props:{placeholder:String,errorMessage:String,showError:Boolean,disabled:Boolean,modelValue:String,toolTip:String},emits:["update:modelValue"],name:"TextInputTooltip",data(){return{textErr:!1}}},Me={class:"border border-gray-200 px-2 py-1 h-14 rounded-md"},Be={class:"uppercase text-gray-500 text-txs text-left mb-2"},Le={key:0,src:Se,class:"inline-block ml-1 relative cursor-pointer",style:{top:"-1px"}},Ue=["disabled","value"],ze={class:"h-3 mb-2"},Oe={key:0,class:"error error-text text-left"};function He(a,_,u,P,V,x){const r=se("tooltip");return i(),c("div",{class:H(u.disabled?"opacity-50":"")},[s("div",Me,[s("div",Be,[le(o(u.placeholder)+" ",1),u.toolTip?ne((i(),c("img",Le,null,512)),[[r,{value:"<tiptext>"+u.toolTip+"</tiptext>",escape:!1},void 0,{bottom:!0}]]):C("",!0)]),s("input",{disabled:u.disabled,value:u.modelValue,onInput:_[0]||(_[0]=b=>a.$emit("update:modelValue",b.target.value)),type:"text",class:"text_input"},null,40,Ue)]),s("div",ze,[V.textErr||u.showError?(i(),c("div",Oe,o(u.errorMessage),1)):C("",!0)])],2)}const je=W(Ae,[["render",He]]),Ge=oe({emits:["select-namespace","update:modelValue","clear-namespace"],name:"SelectInputParentNamespace",props:["modelValue","action","address","disabled"],setup(a,{emit:_}){const u=n(!1);ie().appContext.config.globalProperties.emitter;const{t:V}=re(),x=n(""),r=n(""),b=g=>{x.value=g.value,r.value=g.label,u.value=!u.value},l=()=>{x.value="",r.value=""},M=y(()=>{let g=[];g.push({value:"1",label:V("namespace.newRootNamespace"),level:0,disabled:!1});const k=S.listNamespaces(K.Address.createFromRawAddress(a.address).plain());return k.length>0&&g.push.apply(g,k),g});return{selectNamespace:b,namespaces:M,toggleSelection:u,selectedNamespace:x,selectedNamespaceLabel:r,selectNs:g=>{g.disabled||(b(g),_("update:modelValue",x.value),_("select-namespace",x.value))},clearLabel:l}}}),Qe={class:"flex"},Ye={class:"flex flex-col ml-2 text-left"},qe={class:"text-blue-primary font-semibold text-xxs mb-1 uppercase",style:{"line-height":"9px"}},Je={key:0,class:"mt-1 text-tsm font-bold"},Ke={key:1,class:"text-tsm font-bold"},We={key:0,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},Xe={key:1,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},Ze={class:"relative"},ea={key:0,class:"absolute border border-t-0 w-full z-50 bg-white max-h-40 overflow-auto px-3 filter drop-shodow-xl"},aa={key:0,class:"uppercase pl-2 pt-4 text-xxs text-gray-400"},ta={key:1,class:"text-xxs pt-2 pl-2 pb-2"},sa=["onClick"],la={key:0,class:"cursor-pointer text-blue-primary text-xxs mt-0.5 ml-auto font-semibold uppercase"},na={key:1,class:"text-gray-300 text-xxs mt-0.5 ml-auto uppercase"},oa={key:2,class:"text-gray-500 text-xxs mt-0.5 ml-auto uppercase"};function ra(a,_,u,P,V,x){return i(),c("div",{class:H(["relative",a.disabled?"opacity-50":"cursor-pointer"])},[s("div",{onClick:_[1]||(_[1]=r=>a.disabled?"":a.toggleSelection=!a.toggleSelection),class:"border ml-auto mr-auto py-3 px-2 rounded-md w-full h-14"},[s("div",Qe,[s("div",Ye,[s("div",qe,o(a.$t("general.namespace")),1),a.selectedNamespace!=""?(i(),c("div",Je,o(a.selectedNamespaceLabel),1)):(i(),c("div",Ke,o(a.$t("namespace.selectNamespace")),1))]),!a.toggleSelection&&a.selectedNamespace==""?(i(),c("div",We,o(a.$t("general.select")),1)):C("",!0),!a.toggleSelection&&a.selectedNamespace!=""?(i(),c("div",Xe,o(a.$t("general.change")),1)):C("",!0),a.toggleSelection?(i(),c("img",{key:2,onClick:_[0]||(_[0]=r=>{a.selectedNamespace="",a.$emit("clear-namespace")}),src:Pe,class:"h-5 w-5 ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"})):C("",!0)])]),s("div",Ze,[a.toggleSelection?(i(),c("div",ea,[a.namespaces.length>0?(i(),c("div",aa,o(a.$t("namespace.selectNamespace")),1)):(i(),c("div",ta,o(a.$t("general.listEmpty")),1)),(i(!0),c(xe,null,Ne(a.namespaces,(r,b)=>(i(),c("div",{key:b,class:H(["px-2 py-3 flex items-center",[b!=a.namespaces.length-1?"border-b border-gray-200":"",r.disabled?"cursor-text":"cursor-pointer"]]),onClick:l=>a.selectNs(r)},[s("div",{class:H(["text-xs truncate",r.disabled?"text-gray-300":"text-black font-semibold"])},o(r.label),3),r.label!=a.selectedNamespace&&!r.disabled?(i(),c("div",la,o(a.$t("general.select")),1)):r.disabled?(i(),c("div",na,o(a.$t("general.disabled")),1)):(i(),c("div",oa,o(a.$t("general.current")),1))],10,sa))),128))])):C("",!0)])],2)}const ia=W(Ge,[["render",ra]]),ca={class:"w-10/12 ml-auto mr-auto"},ua={class:"border filter shadow-lg xl:grid xl:grid-cols-3 mt-8"},da={class:"xl:col-span-2 p-12"},va={class:"font-semibold mb-4"},ma={key:0,class:"rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},pa={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},fa={class:"inline-block text-xs"},ba={key:1,class:"error error_box"},ga={class:"mt-4"},_a={class:"flex gap-1 mt-3"},ha={key:0,class:"mt-3"},ya={class:"lg:grid lg:grid-cols-2 mt-5"},xa={class:"mb-5 lg:mb-0 lg:mr-2"},Na={class:"mb-5 lg:mb-0 lg:ml-2"},ka={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},$a=["disabled"],Ta={class:"text-center"},wa={class:"sm:grid sm:grid-cols-2 mt-10 lg:mt-16"},Ca={class:"mb-8 sm:pr-1"},Ia={href:"https://bcdocs.xpxsirius.io/docs/built-in-features/namespace/",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Sa={class:"text-gray-400 text-tsm my-3 sm:pr-2"},Pa={class:"mb-8"},Fa={href:"https://t.me/proximaxhelpdesk",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Ea={class:"text-gray-400 text-tsm my-3"},Ra=oe({__name:"ViewServicesNamespaceCreate",setup(a){const _=ke(),{t:u}=re(),P=n(null),x=ie().appContext.config.globalProperties.emitter,r=n(!1),b=n(!1),l=n(""),M=n(!1),N=n("1"),g=n(""),k=n(u("namespace.validName"));n("");const F=n(!1),X=n(!1);n(!1);const Z=`^[0-9a-z]{2,${y(()=>h.currentNetworkProfileConfig?h.currentNetworkProfileConfig.maxNameSize:0).value}}$`,p=n(!1),E=y(()=>h.currentNetworkProfileConfig?Math.floor($e.configReturn(h.currentNetworkProfileConfig.maxNamespaceDuration,Te.DAY)):0),v=n(""),D=y(()=>v.value?v.value=="1"?Number(N.value)>0?m.convertToExact(h.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock*S.calculateDuration(Number(N.value)),d.nativeToken.divisibility):m.convertToExact(h.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock,d.nativeToken.divisibility):m.convertToExact(h.currentNetworkProfileConfig.childNamespaceRentalFee,d.nativeToken.divisibility):0),ce=y(()=>m.toCurrencyFormat(D.value,d.nativeToken.divisibility)),j=y(()=>h.currentNetworkProfileConfig?m.convertToExact(h.currentNetworkProfileConfig.lockedFundsPerAggregate,d.nativeToken.divisibility):0),G=y(()=>h.currentNetworkProfile?m.convertToExact(we.getLockFundFee(),d.nativeToken.divisibility):0),ue=y(()=>j.value+G.value),de=y(()=>!(l.value.match(Z)&&!M.value&&!ee.value&&!p.value&&v.value)),f=n(null),B=n(null),I=n(null),$=n(0),L=n(0),Q=async e=>{if(d.chainAPI&&e)try{const t=await d.chainAPI.accountAPI.getAccountInfo(K.Address.createFromRawAddress(e)),z=t.mosaics.findIndex(J=>J.id.toHex()==d.nativeToken.assetId);return z!=-1?t.mosaics[z].amount.compact()/Math.pow(10,d.nativeToken.divisibility):0}catch{return 0}},ee=y(()=>{if(I.value)return f.value?L.value<D.value?!0:$.value<T.value+ue.value:$.value<D.value+T.value});$.value<D.value?(X.value=!0,F.value=!0,r.value=!0,b.value=!0):(X.value=!1,F.value=!1,r.value=!1,b.value=!1);const U=n(0),T=n(0),ve=()=>{v.value=""},me=e=>{let t=0;e=="1"?(N.value="1",F.value=!1,l.value.trim().length>0&&!p.value&&(t=S.getRootNamespaceTransactionFee(l.value),U.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),T.value=m.convertToExact(t,d.nativeToken.divisibility))):(N.value="0",F.value=!0,l.value.trim().length>0&&!p.value&&(t=S.getSubNamespaceTransactionFee(e,l.value),U.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),T.value=m.convertToExact(t,d.nativeToken.divisibility)))};R(v,e=>{e?r.value=!1:(r.value=!0,F.value=!0)},{immediate:!0});const pe=()=>{let e=d.buildTxn;if(v.value==="1"){let t=e.registerRootNamespace(l.value,K.UInt64.fromUint(S.calculateDuration(Number(N.value)))).serialize();O.unsignedTransactionPayload=t}else{let t=e.registersubNamespace(v.value,l.value).serialize();O.unsignedTransactionPayload=t}O.selectedAddress=I.value,O.selectedMultisigAddress=f.value,_.push({name:"ViewConfirmTransaction"})};R(N,e=>{parseInt(e)>E.value&&(N.value=`${E.value}`)});const Y=()=>{N.value="1"},ae=y(()=>{if(f.value){let e=[j.value,G.value,T.value];return m.safeSum(e)}else return D.value+T.value});R(ae,e=>{$.value<e?b.value=!0:b.value=!1});const fe=y(()=>h.currentNetworkProfileConfig?h.currentNetworkProfileConfig.reservedRootNamespaceNames.split(",").map(e=>e.trim()):[]),be=()=>v.value==="1"&&fe.value.includes(l.value.trim())?(p.value=!0,k.value=u("namespace.reservedName"),!0):!1,ge=async()=>{if(v.value==="1"&&l.value.trim())try{let e=await Ie.getNamespaceInfo(m.createNamespaceId(l.value));if(f.value){if(e.owner.address.plain()!==f.value)return p.value=!0,k.value=u("namespace.nameRegistered"),!0}else if(e.owner.address.plain()!==I.value)return p.value=!0,k.value=u("namespace.nameRegistered"),!0}catch{return!1}return!1},_e=async()=>{if(l.value.trim()){if(be())return;if(p.value=!l.value.match(Z),p.value)k.value=u("namespace.validName");else{if(await ge())return;let t=0;v.value=="1"?l.value.trim().length>0&&!p.value&&(t=S.getRootNamespaceTransactionFee(l.value),U.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),T.value=m.convertToExact(t,d.nativeToken.divisibility)):l.value.trim().length>0&&!p.value&&(t=S.getSubNamespaceTransactionFee(l.value,v.value),U.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),T.value=m.convertToExact(t,d.nativeToken.divisibility))}}},q=()=>{l.value="",v.value="",P.value.clearLabel(),p.value=!1,Y(),B.value=null,f.value=null};return R(I,async(e,t)=>{e==null?($.value=0,q()):e!=t&&(q(),$.value=await Q(e))}),R(f,async(e,t)=>{e==null?(L.value=0,q(),$.value=await Q(I.value)):e!=t&&(v.value="",l.value="",P.value.clearLabel(),p.value=!1,Y(),L.value=await Q(e))}),R(l,e=>{v.value===""?(p.value=!1,k.value=""):e.length==0&&(p.value=!0,k.value=u("namespace.validName"))}),x.on("select-account",e=>{I.value=e}),x.on("select-multisig-account",e=>{B.value=e.label,f.value=e.value}),x.on("CLOSE_MULTISIG",()=>{B.value=null,f.value=null}),(e,t)=>{const z=te("font-awesome-icon"),J=te("router-link"),he=se("debounce");return i(),c("div",null,[s("div",ca,[s("div",ua,[s("div",da,[s("div",va,o(e.$t("general.createNamespace")),1),ee.value?(i(),c("div",ma,[s("div",pa,[w(z,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),s("div",fa,o(e.$t("general.insufficientBalance")),1)])):C("",!0),g.value!=""?(i(),c("div",ba,o(g.value),1)):C("",!0),s("div",ga,[s("div",_a,[w(Ee,{type:"namespace"}),w(Re,{"selected-address":I.value},null,8,["selected-address"])]),f.value?(i(),c("div",ha,[w(Ve,{"select-default-address":f.value,"select-default-name":B.value,type:"namespace"},null,8,["select-default-address","select-default-name"])])):C("",!0),w(ia,{onSelectNamespace:me,onClearNamespace:ve,ref_key:"nsRef",ref:P,modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=A=>v.value=A),address:f.value?f.value:I.value,class:"mt-5",disabled:b.value},null,8,["modelValue","address","disabled"]),s("div",ya,[s("div",xa,[ne(w(je,{disabled:r.value,placeholder:e.$t("general.name"),errorMessage:k.value,modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=A=>l.value=A),icon:"id-card-alt",showError:p.value,class:"w-full inline-block",toolTip:e.$t("namespace.namespaceNameMsg1")+"<br><br>"+e.$t("namespace.namespaceNameMsg2")+"<br><br>"+e.$t("namespace.namespaceNameMsg3"),tabindex:"0"},null,8,["disabled","placeholder","errorMessage","modelValue","showError","toolTip"]),[[he,_e,"1000"]])]),s("div",Na,[w(Fe,{disabled:F.value,modelValue:N.value,"onUpdate:modelValue":t[2]||(t[2]=A=>N.value=A),max:E.value,placeholder:e.$t("namespace.duration"),onSetDefaultDuration:Y,showError:M.value,toolTip:e.$t("namespace.durationMsg")+`<br>${E.value===365?"1 "+e.$t("general.year"):""} (${E.value}`+e.$t("general.day",E.value)+")."},null,8,["disabled","modelValue","max","placeholder","showError","toolTip"])])])])]),s("div",ka,[w(De,{"signer-native-token-balance":$.value,"namespace-rental-fee-currency":ce.value,"native-token-balance":f.value?L.value:$.value,"lock-fund":j.value,"lock-fund-tx-fee":G.value,"selected-multisig-address":f.value,"txn-fee":T.value,"total-fee":ae.value},null,8,["signer-native-token-balance","namespace-rental-fee-currency","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee"]),s("button",{type:"submit",class:"mt-3 w-full blue-btn py-4 disabled:opacity-50 disabled:cursor-auto text-white",disabled:de.value,onClick:pe},o(e.$t("namespace.registerNamespace")),9,$a),s("div",Ta,[w(J,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white border-b-2 border-white"},{default:Ce(()=>[le(o(e.$t("general.cancel")),1)]),_:1})])])]),s("div",wa,[s("div",Ca,[s("a",Ia,o(e.$t("general.namespaceQues")),1),s("div",Sa,o(e.$t("namespace.namespaceAns")),1)]),s("div",Pa,[s("a",Fa,o(e.$t("general.feedback")),1),s("div",Ea,o(e.$t("general.feedbackDescription")),1)])])])])}}});const ja=W(Ra,[["__scopeId","data-v-9db15776"]]);export{ja as default};
