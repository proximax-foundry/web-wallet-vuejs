import{d as D,y as U,j as G,x as v,c as T,w as g,g as A,W as H,A as c,af as X,D as Z,r as q,o as r,f as m,e as n,t as a,v as b,l as M,i as f,a as z,b as C,b5 as J}from"./index-d2e8ccc1.js";import{_ as V}from"./proximax-logo-ecfc3767.js";import{c as O}from"./functions-35769730.js";const Q={class:"md:px-40 xl:px-64"},Y={class:"border rounded-md p-3 flex flex-col shadow-lg filter mb-2 w-full"},P={class:"text-blue-primary font-semibold text-xs"},ee={class:"flex items-center my-1"},te=["id","copyValue","copySubject"],se={class:"flex items-center"},ne={class:"text-xs font-bold"},le={key:0,class:"text-xs font-bold"},oe={class:"text-xxs mt-0.5"},ae={class:"ml-1 text-xs font-bold"},ce={key:0,class:"text-blue-primary"},ie={key:1,class:"text-blue-primary text-sm font-semibold my-4"},de={class:"border rounded-md p-3 flex flex-col shadow-lg filter mb-2 w-full"},re={class:"text-blue-primary font-semibold text-xs"},ue={class:"flex items-center my-1"},me=["id","copyValue","copySubject"],fe={key:0,class:"flex items-center"},pe={class:"text-xs font-bold"},ge={key:0,class:"text-xs font-bold"},be={class:"text-xxs mt-0.5"},ye={class:"ml-1 text-xs font-bold"},_e=D({__name:"ViewMultisigAccounts",props:{address:String},setup(p){const I=p,B=U(),{t:L}=G(),k=s=>{let e=document.getElementById(s).getAttribute("copyValue"),l=document.getElementById(s).getAttribute("copySubject");O(e),B.add({severity:"info",detail:l+" "+L("general.copied"),group:"br-custom",life:3e3})},x=v.Address.createFromRawAddress(I.address).plain(),h=T(()=>g.currentLoggedInWallet?(g.currentLoggedInWallet.accounts.find(e=>e.address==x)||g.currentLoggedInWallet.others.find(e=>e.address==x)).balance:0),u=s=>{if(s==null)return{left:null,right:null};let e=s.toString().split(".");return e[1]!=null?{left:e[0],right:e[1]}:{left:e[0],right:null}},S=A([]),W=async()=>{const s=[];try{const e=await c.chainAPI.accountAPI.getMultisigAccountGraphInfo(v.Address.createFromRawAddress(I.address));for(const[l,t]of e.multisigAccounts){const d=l;for(const o of t){const{account:_,cosignatories:$,multisigAccounts:F,minApproval:N,minRemoval:R}=o,E={publicKey:_.publicKey,level:d,cosignatories:$.map(w=>w.publicKey),multisigAccounts:F.map(w=>w.publicKey),minApproval:N,minRemoval:R,balance:0};s.push(E)}}return s}catch{return s}},i=A(null),j=async()=>{const s=i.value.map(e=>v.PublicAccount.createFromPublicKey(e.publicKey,c.networkType).address);try{const e=await c.chainAPI.accountAPI.getAccountsInfo(s);for(let l=0;l<i.value.length;l++){const t=e.findIndex(o=>o.publicKey==i.value[l].publicKey);if(t==-1)continue;const d=e[t].mosaics.find(o=>o.id.toHex()==c.nativeToken.assetId);d&&(i.value[l].balance=d.amount.compact()/Math.pow(10,c.nativeToken.divisibility))}}catch{}},y=T(()=>{let s=[];if(!i.value)return s;const e=[...i.value.filter(t=>t.level<0)],l=Math.min(...e.map(t=>t.level));if(l==1/0)return s;for(let t=0;t<Math.abs(l);t++){const d=e.filter(o=>o.level==-Math.abs(t+1)).map(o=>({address:H.createAddressFromPublicKey(o.publicKey,c.networkType).pretty(),balance:o.balance}));s.push({key:(t+1).toString(),label:"Level "+(t+1).toString(),selectable:!1,children:d.map((o,_)=>({type:"child",key:"0-"+_.toString(),balance:o.balance,label:g.currentLoggedInWallet.convertAddressToName(v.Address.createFromRawAddress(o.address).plain(),!0),address:o.address,selectable:!0}))})}return s}),K=X();return K.run(()=>{const s=A(!1),e=Z(c,async l=>{l.isReady&&!s.value&&(s.value=!0,i.value=await W(),await j(),e(),K.stop())},{immediate:!0})}),(s,e)=>{const l=q("font-awesome-icon");return r(),m("div",Q,[n("div",Y,[n("div",P,a(b(g).currentLoggedInWallet.convertAddressToName(b(x))),1),n("div",ee,[n("div",{id:p.address.substring(-4),copyValue:p.address,copySubject:s.$t("general.address"),class:"truncate font-semibold text-xs mt-1"},a(p.address),9,te),M(l,{icon:"copy",title:s.$t("general.copy"),onClick:e[0]||(e[0]=t=>k(p.address.substring(-4))),class:"ml-2 w-5 h-5 text-blue-link cursor-pointer"},null,8,["title"])]),n("div",se,[n("div",ne,a(u(h.value).left),1),u(h.value).right!=null?(r(),m("div",le,".")):f("",!0),n("div",oe,a(u(h.value).right),1),n("div",ae,a(b(c).nativeToken.label),1),e[2]||(e[2]=n("img",{src:V,class:"h-4 w-4"},null,-1))])]),y.value.length?f("",!0):(r(),m("div",ce,"This account is not cosignatory of any accounts.")),y.value.length?(r(),m("div",ie,"Cosignatories of")):f("",!0),y.value.length?(r(),z(b(J),{key:2,expandedKeys:S.value,"onUpdate:expandedKeys":e[1]||(e[1]=t=>S.value=t),value:y.value,filter:!0,filterMode:"strict",selectionMode:"single",class:"w-full"},{default:C(t=>[n("div",null,a(t.node.label),1)]),child:C(t=>[n("div",de,[n("div",re,a(t.node.label),1),n("div",ue,[n("div",{id:t.node.address.substring(-4),copyValue:t.node.address,copySubject:s.$t("general.address"),class:"truncate font-semibold text-xs mt-1"},a(t.node.address),9,me),M(l,{icon:"copy",title:s.$t("general.copy"),onClick:d=>k(t.node.address.substring(-4)),class:"ml-2 w-5 h-5 text-blue-link cursor-pointer"},null,8,["title","onClick"])]),t.node.balance?(r(),m("div",fe,[n("div",pe,a(u(t.node.balance).left),1),u(t.node.balance).right!=null?(r(),m("div",ge,".")):f("",!0),n("div",be,a(u(t.node.balance).right),1),n("div",ye,a(b(c).nativeToken.label),1),e[3]||(e[3]=n("img",{src:V,class:"h-4 w-4"},null,-1))])):f("",!0)])]),_:1},8,["expandedKeys","value"])):f("",!0)])}}});export{_e as default};
