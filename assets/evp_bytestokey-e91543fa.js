import{r as B}from"./safe-buffer-c463177b.js";import{r as k}from"./md5.js-8d474739.js";var v,m;function E(){if(m)return v;m=1;var e=B().Buffer,p=k();function g(o,f,b,i){if(e.isBuffer(o)||(o=e.from(o,"binary")),f&&(e.isBuffer(f)||(f=e.from(f,"binary")),f.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var a=b/8,y=e.alloc(a),u=e.alloc(i||0),r=e.alloc(0);a>0||i>0;){var n=new p;n.update(r),n.update(o),f&&n.update(f),r=n.digest();var t=0;if(a>0){var c=y.length-a;t=Math.min(a,r.length),r.copy(y,c,0,t),a-=t}if(t<r.length&&i>0){var h=u.length-i,l=Math.min(i,r.length-t);r.copy(u,h,t,t+l),i-=l}}return r.fill(0),{key:y,iv:u}}return v=g,v}export{E as r};
