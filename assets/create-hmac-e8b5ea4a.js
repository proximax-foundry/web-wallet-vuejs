import{r as w}from"./inherits-804453d8.js";import{r as q}from"./safe-buffer-c463177b.js";import{r as B}from"./cipher-base-aee0e03d.js";import{a as x}from"./create-hash-92c04a28.js";import{r as b}from"./ripemd160-58dcfa02.js";import{r as C}from"./sha.js-cea3da2e.js";var d,m;function L(){if(m)return d;m=1;var c=w(),s=q().Buffer,p=B(),f=s.alloc(128),o=64;function h(e,a){p.call(this,"digest"),typeof a=="string"&&(a=s.from(a)),this._alg=e,this._key=a,a.length>o?a=e(a):a.length<o&&(a=s.concat([a,f],o));for(var n=this._ipad=s.allocUnsafe(o),t=this._opad=s.allocUnsafe(o),r=0;r<o;r++)n[r]=a[r]^54,t[r]=a[r]^92;this._hash=[n]}return c(h,p),h.prototype._update=function(e){this._hash.push(e)},h.prototype._final=function(){var e=this._alg(s.concat(this._hash));return this._alg(s.concat([this._opad,e]))},d=h,d}var v,l;function M(){if(l)return v;l=1;var c=w(),s=L(),p=B(),f=q().Buffer,o=x(),h=b(),e=C(),a=f.alloc(128);function n(t,r){p.call(this,"digest"),typeof r=="string"&&(r=f.from(r));var i=t==="sha512"||t==="sha384"?128:64;if(this._alg=t,this._key=r,r.length>i){var g=t==="rmd160"?new h:e(t);r=g.update(r).digest()}else r.length<i&&(r=f.concat([r,a],i));for(var _=this._ipad=f.allocUnsafe(i),R=this._opad=f.allocUnsafe(i),u=0;u<i;u++)_[u]=r[u]^54,R[u]=r[u]^92;this._hash=t==="rmd160"?new h:e(t),this._hash.update(_)}return c(n,p),n.prototype._update=function(t){this._hash.update(t)},n.prototype._final=function(){var t=this._hash.digest(),r=this._alg==="rmd160"?new h:e(this._alg);return r.update(this._opad).update(t).digest()},v=function(r,i){return r=r.toLowerCase(),r==="rmd160"||r==="ripemd160"?new n("rmd160",i):r==="md5"?new s(o,i):new n(r,i)},v}export{M as r};
