import{_ as K,ad as we,P as re,o as u,b as c,e as t,B as oe,t as o,Q as ne,f as P,l as H,d as ie,r,u as ue,c as _,A as ce,g as $e,F as Te,h as Ce,i as de,q as Pe,n as h,b9 as Ie,ba as Se,H as f,E as m,V as Ee,a as M,k as se,s as w,z as Fe,W as Ve,w as le,K as Re}from"./index-d6467577.js";import{_ as De}from"./PasswordInput.vue_vue_type_script_setup_true_lang-1c889bc9.js";import{_ as Me}from"./icon-info-8b4f1351.js";import{N as $}from"./namespaceUtils-a7cea196.js";import{D as Ae}from"./DurationInputClean-93987107.js";import{_ as Le,a as Be,b as Ue,c as ze}from"./TxnSummary.vue_vue_type_script_setup_true_lang-6d032156.js";import"./jdenticon-module-55da8b6d.js";import"./proximax-logo-ecfc3767.js";const We={directives:{tooltip:we},props:{placeholder:String,errorMessage:String,showError:Boolean,disabled:Boolean,modelValue:String,toolTip:String},emits:["update:modelValue"],name:"TextInputTooltip",data(){return{textErr:!1}}},Oe={class:"border border-gray-200 px-2 py-1 h-14 rounded-md"},He={class:"uppercase text-gray-500 text-txs text-left mb-2"},qe={key:0,src:Me,class:"inline-block ml-1 relative cursor-pointer",style:{top:"-1px"}},Qe=["disabled","value"],je={class:"h-3 mb-2"},Ge={key:0,class:"error error-text text-left"};function Ke(a,y,n,V,A,x){const i=re("tooltip");return u(),c("div",{class:H(n.disabled?"opacity-50":"")},[t("div",Oe,[t("div",He,[oe(o(n.placeholder)+" ",1),n.toolTip?ne((u(),c("img",qe,null,512)),[[i,{value:"<tiptext>"+n.toolTip+"</tiptext>",escape:!0},void 0,{bottom:!0}]]):P("",!0)]),t("input",{disabled:n.disabled,value:n.modelValue,onInput:y[0]||(y[0]=g=>a.$emit("update:modelValue",g.target.value)),type:"text",class:"text_input"},null,40,Qe)]),t("div",je,[A.textErr||n.showError?(u(),c("div",Ge,o(n.errorMessage),1)):P("",!0)])],2)}const Ye=K(We,[["render",Ke]]),Je=ie({emits:["select-namespace","update:modelValue","clear-namespace"],name:"SelectInputParentNamespace",props:["modelValue","action","address","disabled"],setup(a,{emit:y}){const n=r(!1);de().appContext.config.globalProperties.emitter;const{t:A}=ue(),x=r(""),i=r(""),g=d=>{x.value=d.value,i.value=d.label,n.value=!n.value},l=()=>{x.value="",i.value=""},B=_(()=>{let d=[];d.push({value:"1",label:A("namespace.newRootNamespace"),level:0,disabled:!1});const R=$.listNamespaces(ce.Address.createFromRawAddress(a.address).plain());return R.length>0&&d.push.apply(d,R),d});return{selectNamespace:g,namespaces:B,toggleSelection:n,selectedNamespace:x,selectedNamespaceLabel:i,selectNs:d=>{d.disabled||(g(d),y("update:modelValue",x.value),y("select-namespace",x.value))},clearLabel:l}}}),Xe={class:"flex"},Ze={class:"flex flex-col ml-2 text-left"},ea={class:"text-blue-primary font-semibold text-xxs mb-1 uppercase",style:{"line-height":"9px"}},aa={key:0,class:"mt-1 text-tsm font-bold"},ta={key:1,class:"text-tsm font-bold"},sa={key:0,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},la={key:1,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},ra={class:"relative"},oa={key:0,class:"absolute border border-t-0 w-full z-50 bg-white max-h-40 overflow-auto px-3 filter drop-shodow-xl"},na={key:0,class:"uppercase pl-2 pt-4 text-xxs text-gray-400"},ia={key:1,class:"text-xxs pt-2 pl-2 pb-2"},ua=["onClick"],ca={key:0,class:"cursor-pointer text-blue-primary text-xxs mt-0.5 ml-auto font-semibold uppercase"},da={key:1,class:"text-gray-300 text-xxs mt-0.5 ml-auto uppercase"},va={key:2,class:"text-gray-500 text-xxs mt-0.5 ml-auto uppercase"};function ma(a,y,n,V,A,x){return u(),c("div",{class:H(["relative",a.disabled?"opacity-50":"cursor-pointer"])},[t("div",{onClick:y[1]||(y[1]=i=>a.disabled?"":a.toggleSelection=!a.toggleSelection),class:"border ml-auto mr-auto py-3 px-2 rounded-md w-full h-14"},[t("div",Xe,[t("div",Ze,[t("div",ea,o(a.$t("general.namespace")),1),a.selectedNamespace!=""?(u(),c("div",aa,o(a.selectedNamespaceLabel),1)):(u(),c("div",ta,o(a.$t("namespace.selectNamespace")),1))]),!a.toggleSelection&&a.selectedNamespace==""?(u(),c("div",sa,o(a.$t("general.select")),1)):P("",!0),!a.toggleSelection&&a.selectedNamespace!=""?(u(),c("div",la,o(a.$t("general.change")),1)):P("",!0),a.toggleSelection?(u(),c("img",{key:2,onClick:y[0]||(y[0]=i=>{a.selectedNamespace="",a.$emit("clear-namespace")}),src:$e,class:"h-5 w-5 ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"})):P("",!0)])]),t("div",ra,[a.toggleSelection?(u(),c("div",oa,[a.namespaces.length>0?(u(),c("div",na,o(a.$t("namespace.selectNamespace")),1)):(u(),c("div",ia,o(a.$t("general.listEmpty")),1)),(u(!0),c(Te,null,Ce(a.namespaces,(i,g)=>(u(),c("div",{key:g,class:H(["px-2 py-3 flex items-center",[g!=a.namespaces.length-1?"border-b border-gray-200":"",i.disabled?"cursor-text":"cursor-pointer"]]),onClick:l=>a.selectNs(i)},[t("div",{class:H(["text-xs truncate",i.disabled?"text-gray-300":"text-black font-semibold"])},o(i.label),3),i.label!=a.selectedNamespace&&!i.disabled?(u(),c("div",ca,o(a.$t("general.select")),1)):i.disabled?(u(),c("div",da,o(a.$t("general.disabled")),1)):(u(),c("div",va,o(a.$t("general.current")),1))],10,ua))),128))])):P("",!0)])],2)}const pa=K(Je,[["render",ma]]),fa={class:"w-10/12 ml-auto mr-auto"},ba={class:"border filter shadow-lg xl:grid xl:grid-cols-3 mt-8"},ga={class:"xl:col-span-2 p-12"},ha={class:"font-semibold mb-4"},_a={key:0,class:"rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},ya={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},Na={class:"inline-block text-xs"},xa={key:1,class:"error error_box"},ka={class:"mt-4"},wa={class:"flex gap-1 mt-3"},$a={key:0,class:"mt-3"},Ta={class:"lg:grid lg:grid-cols-2 mt-5"},Ca={class:"mb-5 lg:mb-0 lg:mr-2"},Pa={class:"mb-5 lg:mb-0 lg:ml-2"},Ia={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},Sa={class:"text-xs text-white my-5"},Ea=["disabled"],Fa={class:"text-center"},Va={class:"sm:grid sm:grid-cols-2 mt-10 lg:mt-16"},Ra={class:"mb-8 sm:pr-1"},Da={href:"https://bcdocs.xpxsirius.io/docs/built-in-features/namespace/",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Ma={class:"text-gray-400 text-tsm my-3 sm:pr-2"},Aa={class:"mb-8"},La={href:"https://t.me/proximaxhelpdesk",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Ba={class:"text-gray-400 text-tsm my-3"},Ua="^[^ ]{8,}$",za=ie({__name:"ViewServicesNamespaceCreate",setup(a){const y=Pe(),{t:n}=ue(),V=r(null),x=de().appContext.config.globalProperties.emitter,i=r(!1),g=r(!1),l=r(""),B=r(!1),k=r("1"),d=r(""),R=r(""),I=r(n("namespace.validName"));r("");const S=r(!1),E=r(!1),Y=r(!1),ve=r(!1),J=`^[0-9a-z]{2,${_(()=>h.currentNetworkProfileConfig?h.currentNetworkProfileConfig.maxNameSize:0).value}}$`,b=r(!1),D=_(()=>h.currentNetworkProfileConfig?Math.floor(Ie.configReturn(h.currentNetworkProfileConfig.maxNamespaceDuration,Se.DAY)):0),v=r(""),L=_(()=>v.value?v.value=="1"?Number(k.value)>0?f.convertToExact(h.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock*$.calculateDuration(Number(k.value)),m.nativeToken.divisibility):f.convertToExact(h.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock,m.nativeToken.divisibility):f.convertToExact(h.currentNetworkProfileConfig.childNamespaceRentalFee,m.nativeToken.divisibility):0),me=_(()=>f.toCurrencyFormat(L.value,m.nativeToken.divisibility)),X=_(()=>h.currentNetworkProfileConfig?f.convertToExact(h.currentNetworkProfileConfig.lockedFundsPerAggregate,m.nativeToken.divisibility):0),Z=_(()=>h.currentNetworkProfile?f.convertToExact(Ee.getLockFundFee(),m.nativeToken.divisibility):0),ee=_(()=>X.value+Z.value),pe=_(()=>!(d.value.match(Ua)&&l.value.match(J)&&!B.value&&!ae.value&&!b.value&&v.value)),p=r(null),U=r(null),N=r(null),T=r(0),z=r(0),q=async e=>{if(m.chainAPI&&e)try{const s=await m.chainAPI.accountAPI.getAccountInfo(ce.Address.createFromRawAddress(e)),O=s.mosaics.findIndex(G=>G.id.toHex()==m.nativeToken.assetId);return O!=-1?s.mosaics[O].amount.compact()/Math.pow(10,m.nativeToken.divisibility):0}catch{return 0}},ae=_(()=>{if(N.value)return p.value?z.value<L.value?!0:T.value<C.value+ee.value:T.value<L.value+C.value});T.value<L.value?(S.value=!0,Y.value=!0,E.value=!0,i.value=!0,g.value=!0):(S.value=!1,Y.value=!1,E.value=!1,i.value=!1,g.value=!1);const W=r(0),C=r(0),fe=()=>{v.value=""},be=e=>{let s=0;e=="1"?(E.value=!1,l.value.trim().length>0&&!b.value&&(s=$.getRootNamespaceTransactionFee(l.value),W.value=Number(f.convertToCurrency(s,m.nativeToken.divisibility)),C.value=f.convertToExact(s,m.nativeToken.divisibility))):(k.value="0",E.value=!0,l.value.trim().length>0&&!b.value&&(s=$.getSubNamespaceTransactionFee(e,l.value),W.value=Number(f.convertToCurrency(s,m.nativeToken.divisibility)),C.value=f.convertToExact(s,m.nativeToken.divisibility)))};M(v,e=>{e?(i.value=!1,E.value=!1,S.value=!1):(i.value=!0,E.value=!0,S.value=!0)},{immediate:!0});const ge=()=>{if(!Ve.verifyWalletPassword(le.currentLoggedInWallet.name,h.chainNetworkName,d.value)){R.value=n("general.walletPasswordInvalid",{name:le.currentLoggedInWallet.name});return}p.value?v.value==="1"?$.createRootNamespaceMultisig(N.value,d.value,l.value,Number(k.value),p.value):$.createSubNamespaceMultisig(N.value,d.value,l.value,v.value,p.value):v.value==="1"?$.createRootNamespace(N.value,d.value,l.value,Number(k.value)):$.createSubNamespace(N.value,d.value,l.value,v.value),y.push({name:"ViewAccountPendingTransactions",params:{address:N.value}})};M(k,e=>{parseInt(e)>D.value&&(k.value=`${D.value}`)});const Q=()=>{k.value="1"},te=_(()=>p.value?ee.value+C.value:L.value+C.value);M(te,e=>{T.value<e?(S.value=!0,g.value=!0):(S.value=!1,g.value=!1)});const he=_(()=>f.amountFormatterSimple(te.value,0)),_e=_(()=>h.currentNetworkProfileConfig?h.currentNetworkProfileConfig.reservedRootNamespaceNames.split(",").map(e=>e.trim()):[]),ye=()=>v.value==="1"&&_e.value.includes(l.value.trim())?(b.value=!0,I.value=n("namespace.reservedName"),!0):!1,Ne=async()=>{if(v.value==="1"&&l.value.trim())try{let e=await Re.getNamespaceInfo(f.createNamespaceId(l.value));if(p.value){if(e.owner.address.plain()!==p.value)return b.value=!0,I.value=n("namespace.nameRegistered"),!0}else if(e.owner.address.plain()!==N.value)return b.value=!0,I.value=n("namespace.nameRegistered"),!0}catch{return!1}return!1},xe=async()=>{if(l.value.trim()){if(ye())return;if(b.value=!l.value.match(J),b.value)I.value=n("namespace.validName");else{if(await Ne())return;let s=0;v.value=="1"?l.value.trim().length>0&&!b.value&&(s=$.getRootNamespaceTransactionFee(l.value),W.value=Number(f.convertToCurrency(s,m.nativeToken.divisibility)),C.value=f.convertToExact(s,m.nativeToken.divisibility)):l.value.trim().length>0&&!b.value&&(s=$.getSubNamespaceTransactionFee(l.value,v.value),W.value=Number(f.convertToCurrency(s,m.nativeToken.divisibility)),C.value=f.convertToExact(s,m.nativeToken.divisibility))}}},j=()=>{l.value="",v.value="",V.value.clearLabel(),b.value=!1,Q(),U.value=null,p.value=null};return M(N,async(e,s)=>{e==null?(T.value=0,j()):e!=s&&(j(),T.value=await q(e))}),M(p,async(e,s)=>{e==null?(z.value=0,j(),T.value=await q(N.value)):e!=s&&(v.value="",l.value="",V.value.clearLabel(),b.value=!1,Q(),z.value=await q(e))}),M(l,e=>{v.value===""?(b.value=!1,I.value=""):e.length==0&&(b.value=!0,I.value=n("namespace.validName"))}),x.on("select-account",e=>{N.value=e}),x.on("select-multisig-account",e=>{U.value=e.label,p.value=e.value}),x.on("CLOSE_MULTISIG",()=>{U.value=null,p.value=null}),(e,s)=>{const O=se("font-awesome-icon"),G=se("router-link"),ke=re("debounce");return u(),c("div",null,[t("div",fa,[t("div",ba,[t("div",ga,[t("div",ha,o(e.$t("general.createNamespace")),1),ae.value?(u(),c("div",_a,[t("div",ya,[w(O,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),t("div",Na,o(e.$t("general.insufficientBalance")),1)])):P("",!0),R.value!=""?(u(),c("div",xa,o(R.value),1)):P("",!0),t("div",ka,[t("div",wa,[w(Le,{type:"namespace"}),w(Be,{"selected-address":N.value},null,8,["selected-address"])]),p.value?(u(),c("div",$a,[w(Ue,{"select-default-address":p.value,"select-default-name":U.value,type:"namespace"},null,8,["select-default-address","select-default-name"])])):P("",!0),w(pa,{onSelectNamespace:be,onClearNamespace:fe,ref_key:"nsRef",ref:V,modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=F=>v.value=F),address:p.value?p.value:N.value,class:"mt-5",disabled:g.value},null,8,["modelValue","address","disabled"]),t("div",Ta,[t("div",Ca,[ne(w(Ye,{disabled:i.value,placeholder:e.$t("general.name"),errorMessage:I.value,modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=F=>l.value=F),icon:"id-card-alt",showError:b.value,class:"w-full inline-block",toolTip:e.$t("namespace.namespaceNameMsg1")+"<br><br>"+e.$t("namespace.namespaceNameMsg2")+"<br><br>"+e.$t("namespace.namespaceNameMsg3"),tabindex:"0"},null,8,["disabled","placeholder","errorMessage","modelValue","showError","toolTip"]),[[ke,xe,"1000"]])]),t("div",Pa,[w(Ae,{disabled:E.value,modelValue:k.value,"onUpdate:modelValue":s[2]||(s[2]=F=>k.value=F),max:D.value,placeholder:e.$t("namespace.duration"),onSetDefaultDuration:Q,showError:B.value,toolTip:e.$t("namespace.durationMsg")+`<br>${D.value===365?"1 "+e.$t("general.year"):""} (${D.value}`+e.$t("general.day",D.value)+")."},null,8,["disabled","modelValue","max","placeholder","showError","toolTip"])])])])]),t("div",Ia,[w(ze,{"signer-native-token-balance":T.value,"namespace-rental-fee-currency":me.value,"native-token-balance":p.value?z.value:T.value,"lock-fund":X.value,"lock-fund-tx-fee":Z.value,"selected-multisig-address":p.value,"txn-fee":C.value,"total-fee":Number(he.value)},null,8,["signer-native-token-balance","namespace-rental-fee-currency","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee"]),t("div",Sa,o(e.$t("general.enterPasswordContinue")),1),w(De,{placeholder:e.$t("general.password"),errorMessage:e.$t("general.passwordRequired"),showError:ve.value,modelValue:d.value,"onUpdate:modelValue":s[3]||(s[3]=F=>d.value=F),disabled:S.value},null,8,["placeholder","errorMessage","showError","modelValue","disabled"]),t("button",{type:"submit",class:"mt-3 w-full blue-btn py-4 disabled:opacity-50 disabled:cursor-auto text-white",disabled:pe.value,onClick:ge},o(e.$t("namespace.registerNamespace")),9,Ea),t("div",Fa,[w(G,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white border-b-2 border-white"},{default:Fe(()=>[oe(o(e.$t("general.cancel")),1)]),_:1})])])]),t("div",Va,[t("div",Ra,[t("a",Da,o(e.$t("general.namespaceQues")),1),t("div",Ma,o(e.$t("namespace.namespaceAns")),1)]),t("div",Aa,[t("a",La,o(e.$t("general.feedback")),1),t("div",Ba,o(e.$t("general.feedbackDescription")),1)])])])])}}});const Ja=K(za,[["__scopeId","data-v-b5e34a78"]]);export{Ja as default};
