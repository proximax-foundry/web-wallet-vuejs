import{r as n,u as j,D as H,q as J,w as u,c as A,a as V,i as Q,A as B,b2 as X,W as Y,E as P,_ as Z,k as h,o as L,b as D,e as f,s as p,z as x,B as y,t as g,f as $}from"./index-47dceba4.js";import{T as ee}from"./TextInputClean-18ea3f44.js";import{A as oe}from"./addressBookUtils-0d3294bf.js";import{S as ae}from"./SelectInputPluginClean-d29a322c.js";import{A as te,_ as se}from"./icon-save-eabd3498.js";import"./multiselect-d473f6e1.js";const le={name:"ViewServicesAddressBookAddContact",components:{TextInputClean:ee,SelectInputPluginClean:ae,AddCustomGroupModal:te},setup(){const l=Q().appContext.config.globalProperties.emitter,k=n(null),{t:e}=j(),E=H(),c=n(""),t=n(""),a=n(""),i=n(""),m=n(""),r=n(!1),I=n(""),G=J(),_=n(""),M=["-none-","Work","Friend","Family","Employee","Director"];let S=[];const w=n([]);if(w.value.push({value:"-none-",label:" - "},{value:"Work",label:e("addressBook.work")},{value:"Friend",label:e("addressBook.friend")},{value:"Family",label:e("addressBook.family")},{value:"Employee",label:e("addressBook.employee")},{value:"Director",label:e("addressBook.director")}),u.currentLoggedInWallet&&u.currentLoggedInWallet.contacts.length>0){u.currentLoggedInWallet.contacts.forEach(s=>{M.includes(s.group)||S.push(s.group)});let o=[...new Set(S)];o.length>0&&(o.sort(),o.forEach(s=>{w.value.push({value:s,label:s})}))}w.value.push({value:"Custom",label:e("addressBook.custom")});const N=A(()=>w.value),W=A(()=>!(r.value&&c.value!="")),O=A(()=>!r.value&&t.value!=""),T=A(()=>t.value!=""&&c.value==""||a.value!=""&&c.value==""),U=A(()=>{let o=e("general.invalidInput");return I.value?I.value:o});V(a,()=>{if(u.currentLoggedInWallet)if(a.value.length<=63||a.value.length>=65){t.value=a.value;const o=u.currentLoggedInWallet.accounts.find(v=>v.default==!0),s=oe.verifyNetworkAddress(o.address,t.value);r.value=s.isPassed,I.value=s.errMessage}else a.value.length==64&&(r.value=!0,t.value=Y.createAddressFromPublicKey(a.value,P.networkType).plain())});const C=n(!1);V(_,o=>{o=="Custom"&&(C.value=!0)});const F=async o=>{try{let s=await P.chainAPI.accountAPI.getAccountInfo(B.Address.createFromRawAddress(o));s.publicKey=="0000000000000000000000000000000000000000000000000000000000000000"?i.value=null:i.value=s.publicKey}catch{i.value=null}},R=async()=>{if(c.value==" "){m.value=e("general.nameRequired");return}a.value.length==64?i.value=a.value:await F(t.value),console.log(t.value);const o=B.Address.createFromRawAddress(t.value);let s=new X(c.value.trim(),o.plain(),_.value,i.value);const v=u.currentLoggedInWallet,K=v.accounts.findIndex(b=>b.name.toLowerCase()==c.value.toLowerCase().trim()),q=v.contacts!=null?v.contacts.findIndex(b=>B.Address.createFromRawAddress(b.address).plain()==o.plain()):-1,z=v.contacts!=null?v.contacts.findIndex(b=>b.name.toLowerCase()==c.value.toLowerCase().trim()):-1;q>=0?m.value=e("addressBook.addressExist"):z>=0||K>=0?m.value=e("addressBook.nameExist"):(u.currentLoggedInWallet.addAddressBook(s),u.wallets.saveMyWalletOnlytoLocalStorage(u.currentLoggedInWallet),m.value="",c.value="",a.value="",E.add({severity:"info",summary:e("general.addressBook"),detail:e("addressBook.newContactAdded"),group:"br-custom",life:5e3}),G.push({name:"ViewServicesAddressBook"}))};return l.on("CLOSE_ADDCUSTOMGROUP_PANEL",()=>{C.value=!1}),l.on("ADD_CUSTOM_GROUP",o=>{w.value.push({value:o,label:o}),k.value&&k.value.select(o),C.value=!1}),{err:m,addErr:U,contactName:c,address:t,addressOrPk:a,disableSave:W,showAddErr:O,showNameErr:T,SaveContact:R,selectContactGroups:_,contactGroups:N,isDisplayAddCustomPanel:C,selectGroupDropdown:k}}},re={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},ne={class:"flex text-xs font-semibold border-b-2 menu_title_div"},de={class:"border border-gray-100 p-5 filter drop-shadow-xl mt-10 bg-white"},ce={class:"text-md mb-5 font-semibold"},ue={key:0,class:"error error_box mb-5"},ie={class:"mt-2 py-3 px-0 md:flex"},me=["disabled"],ve=f("img",{src:se,class:"inline-block mr-2"},null,-1);function pe(d,l,k,e,E,c){const t=h("router-link"),a=h("TextInputClean"),i=h("SelectInputPluginClean"),m=h("AddCustomGroupModal");return L(),D("div",null,[f("div",re,[f("div",ne,[p(t,{to:{name:"ViewServicesAddressBook"},class:"w-18 text-center border-b pb-3"},{default:x(()=>[y(g(d.$t("general.list")),1)]),_:1}),p(t,{to:{name:"ViewServicesAddressBookImport"},class:"w-18 text-center border-b pb-3"},{default:x(()=>[y(g(d.$t("general.import")),1)]),_:1}),p(t,{to:{name:"ViewServicesAddressBookExport"},class:"w-18 text-center border-b pb-3"},{default:x(()=>[y(g(d.$t("general.export")),1)]),_:1})]),f("div",de,[f("div",ce,g(d.$t("addressBook.addNewContact")),1),e.err!=""?(L(),D("div",ue,g(e.err),1)):$("",!0),f("div",ie,[p(a,{placeholder:d.$t("general.name"),errorMessage:d.$t("general.nameRequired"),modelValue:e.contactName,"onUpdate:modelValue":l[0]||(l[0]=r=>e.contactName=r),icon:"id-card-alt",showError:e.showNameErr,class:"w-full md:w-52 inline-block mr-2"},null,8,["placeholder","errorMessage","modelValue","showError"]),p(a,{placeholder:d.$t("multisig.addressOrPk"),errorMessage:e.addErr,modelValue:e.addressOrPk,"onUpdate:modelValue":l[1]||(l[1]=r=>e.addressOrPk=r),icon:"wallet",showError:e.showAddErr,class:"w-full md:w-96 inline-block mr-2"},null,8,["placeholder","errorMessage","modelValue","showError"]),p(i,{modelValue:e.selectContactGroups,"onUpdate:modelValue":l[2]||(l[2]=r=>e.selectContactGroups=r),placeholder:d.$t("general.group"),options:e.contactGroups,selectDefault:"-none-",ref:"selectGroupDropdown",class:"w-full md:w-60 inline-block mr-2"},null,8,["modelValue","placeholder","options"]),f("button",{type:"submit",class:"mt-5 md:mt-0 default-btn py-1 disabled:opacity-50 h-12 flex items-center",disabled:e.disableSave,onClick:l[3]||(l[3]=r=>e.SaveContact())},[ve,y(" "+g(d.$t("addressBook.saveAddress")),1)],8,me)])])]),p(m,{toggleModal:e.isDisplayAddCustomPanel,groups:e.contactGroups},null,8,["toggleModal","groups"])])}const Ce=Z(le,[["render",pe]]);export{Ce as default};
