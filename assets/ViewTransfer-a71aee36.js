import{d as D,I as ke,c as H,w as K,r as $,k as W,o as d,b as p,f as T,s as N,z as q,e,t as u,C as L,i as re,O as we,a as Z,m as ue,A as v,E as g,P as Ae,Q as Y,l as $e,_ as Te,B as Me,F as ee,R as qe,S as Re,U as Ue,W as ce,n as te,V as Q,h as de,T as De,u as Oe,H as j,D as je,q as We,X as ze}from"./index-002fca0b.js";import{t as ie}from"./jdenticon-module-8162ac79.js";import{_ as Xe}from"./SelectAccountAndContact.vue_vue_type_script_setup_true_lang-663f6659.js";import{_ as me}from"./proximax-logo-ecfc3767.js";import{_ as Ze}from"./PasswordInput.vue_vue_type_script_setup_true_lang-1ea1bd95.js";import{_ as Qe}from"./icon-red-x-a5511f99.js";import{_ as Ge}from"./icon-green-tick-1b766454.js";const Je={key:0,class:"text-blue-primary font-semibold uppercase text-xxs mt-3"},Ye={key:0,class:"account-item-value account-item"},et={class:"flex"},tt=["innerHTML"],lt={class:"flex flex-col ml-2 text-left"},st=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Account to create / initiate transfer",-1),at={class:"mt-1 text-tsm font-bold"},nt={class:"account-item"},ot={class:"flex"},it=["innerHTML"],rt={class:"text-xs ml-2 font-semibold"},ct=D({__name:"SelectInputAccount",emits:["select-account","update:modelValue"],setup(i){const f=re().appContext.config.globalProperties.emitter;let c=new ke("ThemeStyleConfig");c.init();let l=c.jdenticonConfig;const r=H(()=>K.currentLoggedInWallet?[...K.currentLoggedInWallet.accounts.filter(w=>w.multisigInfo.length==0||w.multisigInfo.find(y=>y.level==0).cosignaturies.length==0)].map(w=>({value:w.address,label:K.currentLoggedInWallet.convertAddressToName(w.address,!0)})):[]),n=$(null),h=$(null),M=(k,w)=>{if(k==null&&w==null){n.value=null,f.emit("select-account",null);return}f.emit("select-account",w),n.value.label=k,n.value.value=w,h.value=ie(w,25,l)};return(k,w)=>{const y=W("Dropdown");return d(),p("div",null,[n.value?T("",!0):(d(),p("div",Je,"Select Account to create / initiate transfer")),N(y,{showClear:!0,modelValue:n.value,"onUpdate:modelValue":w[0]||(w[0]=o=>n.value=o),style:{width:"100%"},options:r.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:w[1]||(w[1]=o=>{var _,b,s,x;M((_=o.value)==null?void 0:_.label,(b=o.value)==null?void 0:b.value),k.$emit("update:modelValue",(s=o.value)==null?void 0:s.value),k.$emit("select-account",(x=o.value)==null?void 0:x.value)})},{value:q(o=>[o.value?(d(),p("div",Ye,[e("div",et,[e("div",{innerHTML:h.value},null,8,tt),e("div",lt,[st,e("div",at,u(o.value.label),1)])])])):T("",!0)]),option:q(o=>[e("div",nt,[e("div",ot,[e("div",{innerHTML:L(ie)(o.option.value,20,L(l))},null,8,it),e("div",rt,u(o.option.label),1)])])]),_:1},8,["modelValue","options"])])}}}),ut={key:1,class:"text-xxs font-semibold uppercase mt-3 text-blue-primary"},dt={key:0,class:"account-item-value account-item"},mt={class:"flex"},vt=["innerHTML"],pt={class:"flex flex-col ml-2 text-left"},gt=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Multisig Account",-1),ft={class:"mt-1 text-tsm font-bold"},bt={class:"account-item"},ht={class:"flex items-center"},yt=["innerHTML"],_t={class:"text-xs ml-2 font-semibold"},xt=D({__name:"SelectInputMultisigAccount",props:{selectedAddress:{type:String,required:!1}},emits:["select-multisig-account","update:modelValue"],setup(i){const m=i,f=$(!1),{selectedAddress:c}=we(m),l=$([]),n=re().appContext.config.globalProperties.emitter;let h=new ke("ThemeStyleConfig");h.init();let M=h.jdenticonConfig;const k=$(null);Z(c,o=>{if(y(null,null),o==null){y(null,null),l.value=[];return}const _=K.currentLoggedInWallet.accounts.find(s=>s.address==o),b=_.multisigInfo.find(s=>s.level==0);l.value=b?[..._.multisigInfo].filter(s=>s.level<0).map(s=>{const A=[...K.currentLoggedInWallet.accounts,...K.currentLoggedInWallet.others].find(S=>S.publicKey==s.publicKey);return{label:A?K.currentLoggedInWallet.convertAddressToName(A.address):v.PublicAccount.createFromPublicKey(s.publicKey,g.networkType).address.plain(),value:v.PublicAccount.createFromPublicKey(s.publicKey,g.networkType).address.plain()}}):[]}),Z(k,o=>{o==null&&(f.value=!1)});const w=$(null),y=(o,_)=>{if(o==null&&_==null){k.value=null,n.emit("select-multisig-account",null);return}n.emit("select-multisig-account",_),k.value.label=o,k.value.value=_,w.value=ie(_,25,M)};return(o,_)=>{const b=W("Dropdown");return d(),p("div",null,[l.value.length&&!f.value?(d(),p("button",{key:0,class:"blue-btn py-2 px-3 mt-3",onClick:_[0]||(_[0]=s=>f.value=!0)},"Select Multisig Account")):T("",!0),l.value.length&&f.value&&!k.value?(d(),p("div",ut,"Select Multisig Account")):T("",!0),f.value&&l.value.length?(d(),ue(b,{key:2,showClear:!0,modelValue:k.value,"onUpdate:modelValue":_[1]||(_[1]=s=>k.value=s),style:{width:"100%"},options:l.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:_[2]||(_[2]=s=>{var x,A,S,F;y((x=s.value)==null?void 0:x.label,(A=s.value)==null?void 0:A.value),o.$emit("update:modelValue",(S=s.value)==null?void 0:S.value),o.$emit("select-multisig-account",(F=s.value)==null?void 0:F.value)})},{value:q(s=>[s.value?(d(),p("div",dt,[e("div",mt,[e("div",{innerHTML:w.value},null,8,vt),e("div",pt,[gt,e("div",ft,u(s.value.label),1)])])])):T("",!0)]),option:q(s=>[e("div",bt,[e("div",ht,[e("div",{innerHTML:L(ie)(s.option.value,20,L(M))},null,8,yt),e("div",_t,u(s.option.label),1)])])]),_:1},8,["modelValue","options"])):T("",!0)])}}}),kt={key:0},wt={class:"flex justify-between"},At={class:"flex flex-col ml-2 text-left"},$t=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Asset",-1),Tt={class:"mt-1 text-tsm font-bold"},Mt={class:"mt-1 text-tsm font-bold"},It={class:"account-item"},Ft={class:"flex justify-between"},Pt={class:"mt-1 text-tsm font-bold"},Ct={class:"mt-1 text-tsm font-bold"},St=D({__name:"SelectInputAsset",props:{index:{type:Number,required:!0},assetOptions:{type:Object,required:!0},selectedAssets:{type:Object,required:!1}},emits:["select-asset","update:modelValue"],setup(i){const m=i,f=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],c=y=>{const o=f.find(_=>_.namespace==y);return o?o.name:y},{assetOptions:l,selectedAssets:r,index:n}=we(m),h=$(!1),M=H(()=>{const y=new Set(r.value.map(o=>o.id));return l.value.filter(o=>!y.has(o.id))}),k=async y=>{if(h.value)return;h.value=!0;const{first:o,last:_}=y,b=[];for(let P=o;P<_;P++)l.value[P].hasUpdated||b.push(new v.MosaicId(l.value[P].id));if(!b.length){h.value=!1;return}const s=await g.chainAPI.assetAPI.getMosaicsNames(b),x=await g.chainAPI.assetAPI.getMosaics(b);let A=0,S=0;const F=new Map;s.forEach((P,E)=>{F.set(P.mosaicId.toHex(),E)}),x.sort((P,E)=>{const I=F.get(P.mosaicId.toHex()),R=F.get(E.mosaicId.toHex());return I-R});for(let P=o;P<_;P++){if(!s[A])continue;const E=l.value.find(I=>I.id==s[A].mosaicId.toHex());E&&(E.namespace=s[A].names.length?s[A].names[0].name:"",E.balance=E.balance/Math.pow(10,x[S].divisibility),E.divisibility=x[S].divisibility,E.hasUpdated=!0,A++,S++)}h.value=!1},w=y=>{if(y==null){r.value.splice(n.value,1);return}r.value[n.value].balance=y.balance,r.value[n.value].id=y.id,r.value[n.value].namespace=y.namespace,r.value[n.value].divisibility=y.divisibility,r.value[n.value].amount="0"};return(y,o)=>{const _=W("Dropdown");return d(),p("div",null,[N(_,{showClear:!0,modelValue:L(r)[L(n)],"onUpdate:modelValue":o[0]||(o[0]=b=>L(r)[L(n)]=b),style:{width:"100%"},options:M.value,filter:!0,filterFields:["id","namespace"],emptyFilterMessage:" ",placeholder:"Select Asset",virtualScrollerOptions:{lazy:!0,onLazyLoad:k,showLoader:!0,loading:h.value,delay:0,itemSize:38},onChange:o[1]||(o[1]=b=>{var s;w(b.value),y.$emit("update:modelValue",(s=b.value)==null?void 0:s.value)})},{value:q(b=>[b.value.id?(d(),p("div",kt,[e("div",wt,[e("div",At,[$t,e("div",Tt,u(c(b.value.namespace==""?b.value.id:b.value.namespace)),1)]),e("div",Mt,"Balance: "+u(b.value.balance),1)])])):T("",!0)]),option:q(b=>[e("div",It,[e("div",Ft,[e("div",Pt,u(c(b.option.namespace==""?b.option.id:b.option.namespace)),1),e("div",Ct,"Balance: "+u(b.option.balance),1)])])]),_:1},8,["modelValue","options","virtualScrollerOptions"])])}}}),Vt={class:"border border-gray-200 px-2 py-1 rounded-md"},Nt={class:"flex justify-between"},Lt={class:"flex flex-col"},Et={class:"uppercase font-light text-gray-500 text-txs text-left mb-2"},Bt={class:"flex w-full"},Ht={key:0,src:me,class:"h-5 w-5 mt-0.5"},Kt=["value","data-maska","placeholder"],qt=["disabled"],Rt=D({__name:"TransferInputClean",props:{modelValue:{type:String,required:!0},decimal:{type:Number,required:!0},placeholder:{type:String,required:!0},toolTip:{type:String,required:!1},disabled:{type:Boolean,required:!1},showError:{type:Boolean,required:!1},logo:{type:Boolean,required:!1},balance:{type:Number,required:!1}},emits:["update:modelValue","show-error","clickedMaxAvailable"],setup(i){const m=i,f=()=>{let l="0";return m.decimal>0&&(l=l+"."+"9".repeat(m.decimal)),l},c={preProcess:l=>l.replace(/,/g,""),postProcess:l=>{if(!l)return"";let r=0;return m.decimal>0&&(r=1+m.decimal-(l.includes(".")?l.length-l.indexOf("."):0)),Intl.NumberFormat("en-US",{minimumFractionDigits:m.decimal}).format(parseFloat(l)).slice(0,r?-r:void 0)}};return(l,r)=>{const n=Ae("maska");return d(),p("div",{class:$e(i.disabled?"opacity-50":"")},[e("div",Vt,[e("div",Nt,[e("div",Lt,[e("div",Et,u(i.placeholder),1),e("div",Bt,[i.logo?(d(),p("img",Ht)):T("",!0),Y(e("input",{value:i.modelValue,class:"supply_input","data-maska":f(),"data-maska-tokens":"0:\\d:multiple|9:\\d:optional",placeholder:i.placeholder,onInput:r[0]||(r[0]=h=>l.$emit("update:modelValue",parseFloat(h.target.value.replace(/,/g,"")).toString()))},null,40,Kt),[[n,void 0,c]])])]),i.logo?(d(),p("button",{key:0,disabled:i.disabled==!0,class:"w-24 cursor-pointer focus:outline-none text-blue-primary text-xs font-bold",onClick:r[1]||(r[1]=h=>l.$emit("clickedMaxAvailable",!0))},u(l.$t("swap.maxAmount")),9,qt)):T("",!0)])])],2)}}});const he=Te(Rt,[["__scopeId","data-v-ac217733"]]),Ut={class:"rounded-md bg-white flex border mt-3"},Dt=["value","placeholder"],Ot=e("div",{class:"w-1 flex-none"},null,-1),jt={class:"text-gray-800"},Wt=D({__name:"TextAreaInput",props:{modelValue:{type:String,required:!1},currentBytes:{type:Number,required:!0},limit:{type:Number,required:!0},placeholder:{type:String,required:!0}},emits:["update:modelValue"],setup(i){return(m,f)=>(d(),p(ee,null,[e("div",Ut,[e("textarea",{value:i.modelValue,onInput:f[0]||(f[0]=c=>m.$emit("update:modelValue",c.target.value)),rows:"2",class:"w-full text-gray-500 px-2 py-1 outline-none bg-white text-xs",placeholder:i.placeholder.toUpperCase()},null,40,Dt),Ot]),e("div",{class:$e(["float-right mt-1 text-tsm",i.currentBytes>i.limit?"text-red-500":"text-gray-800"])},[Me(u(i.currentBytes)+" ",1),e("span",jt,"/"+u(i.limit),1)],2)],64))}}),zt={class:"border border-gray-200 px-2 py-2 rounded-md w-full"},Xt={class:"flex gap-2"},Zt={class:"flex flex-col w-full"},Qt={class:"uppercase text-gray-500 font-light text-xxs text-left"},Gt={key:0,class:"flex flex-col ml-auto justify-center mt-1"},Jt=e("img",{src:Qe,class:"h-5 w-5 mr-auto ml-auto"},null,-1),Yt={class:"text-xxs text-red-400 font-bold uppercase"},el={key:1,class:"flex flex-col ml-auto justify-center mt-1"},tl=e("img",{src:Ge,class:"h-5 w-5 mr-auto ml-auto"},null,-1),ll={class:"text-xxs text-green-400 font-bold uppercase"},ye=D({__name:"FieldValidationInput",props:qe({placeholder:{},showError:{}},{modelValue:{}}),emits:["update:modelValue"],setup(i){const m=Re(i,"modelValue");return(f,c)=>(d(),p("div",zt,[e("div",Xt,[e("div",Zt,[e("div",Qt,u(f.placeholder),1),Y(e("input",{type:"text","onUpdate:modelValue":c[0]||(c[0]=l=>m.value=l),class:"w-full font-semibold text-tsm outline-none mt-1"},null,512),[[Ue,m.value]])]),f.showError&&m.value.length!=0?(d(),p("div",Gt,[Jt,e("div",Yt,u(f.$t("general.invalid")),1)])):f.showError?T("",!0):(d(),p("div",el,[tl,e("div",ll,u(f.$t("general.valid")),1)]))])]))}});const Ie="0".repeat(64),_e=v.PublicAccount.createFromPublicKey(Ie,g.networkType).address.plain(),xe=(i,m)=>{let f=[];return parseInt(i)>0&&f.push(new v.Mosaic(new v.MosaicId(g.nativeToken.assetId),v.UInt64.fromUint(Number(i)))),m.length>0&&m.forEach(c=>{parseInt(c.amount)>0&&f.push(new v.Mosaic(new v.MosaicId(c.id),v.UInt64.fromUint(Number(c.amount))))}),f},se=class se{};se.createTransaction=async(m,f,c,l,r,n,h,M,k)=>{if(!ce.verifyWalletPassword(K.currentLoggedInWallet.name,te.chainNetworkName,r))return!1;const y=te.currentNetworkProfile.generationHash;let o=g.networkType,_=parseFloat(f)*Math.pow(10,g.nativeToken.divisibility),b=[];_>0&&b.push(new v.Mosaic(new v.MosaicId(g.nativeToken.assetId),v.UInt64.fromUint(Number(_)))),l.length>0&&l.forEach(I=>{I.amount>0&&b.push(new v.Mosaic(new v.MosaicId(I.id),v.UInt64.fromUint(Number(I.amount*Math.pow(10,I.divisibility)))))});let s=g.buildTxn,x,A;if(!h)x=K.currentLoggedInWallet.accounts.find(I=>I.address===n);else{x=K.currentLoggedInWallet.accounts.find(R=>R.address===n);const I=await g.chainAPI.accountAPI.getAccountInfo(v.Address.createFromRawAddress(h));A=v.PublicAccount.createFromPublicKey(I.publicKey,o)}let S=ce.decryptPrivateKey(new v.Password(r),x.encrypted,x.iv),F;if(M&&c.length>0)try{const I=await g.chainAPI.accountAPI.getAccountInfo(v.Address.createFromRawAddress(m));F=v.EncryptedMessage.create(c,I.publicAccount,S)}catch{F=v.EncryptedMessage.create(c,v.PublicAccount.createFromPublicKey(k,g.networkType),S)}else F=v.PlainMessage.create(c);let P=s.transferBuilder().recipient(v.Address.createFromRawAddress(m)).mosaics(b).message(F).build();const E=v.Account.createFromPrivateKey(S,o,1);if(h){let I=K.currentLoggedInWallet.accounts.find(U=>U.address==n),R=ce.decryptPrivateKey(new v.Password(r),I.encrypted,I.iv),O=v.Account.createFromPrivateKey(R,o,1);const ae=[P.toAggregateV1(A)],G=s.aggregateBonded(ae),z=O.preV2Sign(G,y),ne=Q.lockFundTx(z),J=O.preV2Sign(ne,y);Q.announceLF_AND_addAutoAnnounceABT(J,z)}else{const I=E.preV2Sign(P,y);Q.announceTransaction(I)}return!0},se.calculateAggregateFee=(m,f,c,l)=>{let r=g.buildTxn,n=xe(f,c),M=[r.transferBuilder().recipient(v.Address.createFromRawAddress(_e)).mosaics(n).message(l&&m.length>0?v.EncryptedMessage.create(m,v.PublicAccount.createFromPublicKey("0".repeat(64),g.networkType),"0".repeat(64)):v.PlainMessage.create(m)).build().toAggregateV1(v.PublicAccount.createFromPublicKey(Ie,g.networkType))];return r.aggregateBondedBuilder().innerTransactions(M).build().maxFee.compact()/Math.pow(10,g.nativeToken.divisibility)},se.calculateFee=(m,f,c,l)=>{let r=g.buildTxn,n=xe(f,c);return r.transferBuilder().recipient(v.Address.createFromRawAddress(_e)).mosaics(n).message(l&&m.length>0?v.EncryptedMessage.create(m,v.PublicAccount.createFromPublicKey("0".repeat(64),g.networkType),"0".repeat(64)):v.PlainMessage.create(m)).build().maxFee.compact()/Math.pow(10,g.nativeToken.divisibility)};let le=se;const sl={key:0},al={class:"font-bold text-xs text-blue-primary uppercase"},nl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},ol={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},il=["innerHTML"],rl={class:"flex"},cl={class:"ml-1 text-blue-400 font-bold"},ul=e("img",{src:me,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),dl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs pt-2"},ml={class:"font-semibold lg:col-span-2 col-span-3"},vl={key:0,class:"lg:col-span-2 col-span-3 ml-auto"},pl=["innerHTML"],gl={class:"ml-1 text-blue-400"},fl={key:0,class:"lg:col-span-4 col-span-6 ml-auto"},bl={key:1,class:"lg:col-span-4 col-span-6 ml-auto"},hl=["index"],yl=e("div",{class:"border-b-2 border-gray-600 my-2"},null,-1),_l={class:"font-bold text-xs text-blue-primary uppercase"},xl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},kl={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},wl=["innerHTML"],Al={class:"flex"},$l={class:"ml-1 text-blue-400 font-bold"},Tl=e("img",{src:me,class:"ml-1 h-5 w-5 mt-0.5"},null,-1),Ml=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),Il={key:1,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs pt-2"},Fl={class:"font-semibold lg:col-span-2 col-span-3"},Pl={key:0,class:"lg:col-span-2 col-span-3 ml-auto"},Cl=["innerHTML"],Sl={class:"ml-1 text-blue-400"},Vl={key:0,class:"lg:col-span-4 col-span-6 ml-auto"},Nl={key:1,class:"lg:col-span-4 col-span-6 ml-auto"},Ll=["index"],El={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Bl={class:"font-semibold lg:col-span-2 col-span-3"},Hl=["innerHTML"],Kl={class:"ml-1 text-blue-400"},ql={key:3,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs"},Rl={class:"font-semibold lg:col-span-2 col-span-3"},Ul=["innerHTML"],Dl={class:"ml-1 text-blue-400"},Ol={key:4,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},jl={class:"font-semibold lg:col-span-2 col-span-3"},Wl=["innerHTML"],zl={class:"ml-1 text-blue-400"},Xl=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1),Zl={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Ql=e("div",{class:"font-semibold lg:col-span-2 col-span-3 uppercase"},"Total",-1),Gl=["innerHTML"],Jl={class:"ml-1 text-blue-400"},Yl=D({__name:"TransferTxnSummary",props:{selectedMultisigAddress:{type:String||null},nativeTokenBalance:{type:Number,required:!0},selectedAssets:{type:Array,required:!0},lockFund:{type:Number,required:!0},txnFee:{type:Number,required:!0},lockFundTxFee:{type:Number,required:!0},totalFee:{type:Number,required:!0},nativeAmount:{type:String,required:!0},signerNativeTokenBalance:{type:Number,required:!0}},setup(i){const m=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],f=l=>{const r=m.find(n=>n.namespace==l);return r?r.name:l.length==16?l.substring(0,4)+"..."+l.substring(l.length-4,l.length+1):l},c=l=>{let r=l.toString().split(".");return r[1]!=null?'<span class="font-semibold text-sm">'+r[0]+'</span>.<span class="font-semibold text-xs">'+r[1]+"</span>":'<span class="font-semibold text-sm">'+r[0]+"</span>"};return(l,r)=>(d(),p(ee,null,[i.selectedMultisigAddress?(d(),p("div",sl,[e("div",al,u(l.$t("general.multisigAcc")),1),e("div",nl,[e("div",ol,u(l.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:c(i.nativeTokenBalance??0)},null,8,il),e("div",rl,[e("div",cl,u(L(g).nativeToken.label),1),ul])]),e("div",dl,[e("div",ml,u(l.$t("transfer.transferAmount")),1),isNaN(parseFloat(i.nativeAmount))?(d(),p("div",vl,"0")):(d(),p("div",{key:1,class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:c(i.nativeAmount??0)},null,8,pl)),e("div",gl,u(L(g).nativeToken.label),1)]),(d(!0),p(ee,null,de(i.selectedAssets,(n,h)=>(d(),p("div",{class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-white text-xs",key:h},[isNaN(parseFloat(n.amount))&&n.id!=null?(d(),p("div",fl,"0")):(d(),p("div",bl,u(n.amount),1)),n.id!=null?(d(),p("div",{key:2,class:"ml-1 text-blue-400",index:h},u(f(n.namespace==""?n.id:n.namespace)),9,hl)):T("",!0)]))),128)),yl])):T("",!0),e("div",_l,u(l.$t("general.signerAcc")),1),e("div",xl,[e("div",kl,u(l.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:c(i.selectedMultisigAddress?i.signerNativeTokenBalance:i.nativeTokenBalance??0)},null,8,wl),e("div",Al,[e("div",$l,u(L(g).nativeToken.label),1),Tl])]),Ml,i.selectedMultisigAddress?T("",!0):(d(),p("div",Il,[e("div",Fl,u(l.$t("transfer.transferAmount")),1),isNaN(parseFloat(i.nativeAmount))?(d(),p("div",Pl,"0")):(d(),p("div",{key:1,class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:c(i.nativeAmount??0)},null,8,Cl)),e("div",Sl,u(L(g).nativeToken.label),1)])),i.selectedMultisigAddress?T("",!0):(d(!0),p(ee,{key:2},de(i.selectedAssets,(n,h)=>(d(),p("div",{class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-white text-xs",key:h},[isNaN(parseFloat(n.amount))&&n.id!=null?(d(),p("div",Vl,"0")):(d(),p("div",Nl,u(n.amount),1)),n.id!=null?(d(),p("div",{key:2,class:"ml-1 text-blue-400",index:h},u(f(n.namespace==""?n.id:n.namespace)),9,Ll)):T("",!0)]))),128)),e("div",El,[e("div",Bl,u(i.selectedMultisigAddress!=null?l.$t("general.aggregateFee"):l.$t("general.transactionFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:c(i.txnFee)},null,8,Hl),e("div",Kl,u(L(g).nativeToken.label),1)]),i.selectedMultisigAddress!=null?(d(),p("div",ql,[e("div",Rl,u(l.$t("general.lockFund")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:c(i.lockFund??0)},null,8,Ul),e("div",Dl,u(L(g).nativeToken.label),1)])):T("",!0),i.selectedMultisigAddress!=null?(d(),p("div",Ol,[e("div",jl,u(l.$t("general.lockFundTxFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:c(i.lockFundTxFee??0)},null,8,Wl),e("div",zl,u(L(g).nativeToken.label),1)])):T("",!0),Xl,e("div",Zl,[Ql,e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:c(i.totalFee)},null,8,Gl),e("div",Jl,u(L(g).nativeToken.label),1)])],64))}}),es={name:"ConfirmSendModal",props:["toggleModal"],setup(){const m=re().appContext.config.globalProperties.emitter;return{closeConfirmModal:()=>{m.emit("CLOSE_CONFIRM_SEND_MODAL",!1)},proceedSend:()=>{m.emit("CONFIRM_PROCEED_SEND",!0)}}}},ts={key:0,class:"popup-outer fixed flex z-50"},ls={class:"modal-popup-box"},ss={class:"delete-position"},as={class:"w-92"},ns={class:"text-center"},os={class:"mt-3"};function is(i,m,f,c,l,r){const n=W("font-awesome-icon");return d(),p("div",null,[N(De,{"enter-active-class":"animate__animated animate__fadeInDown","leave-active-class":"animate__animated animate__fadeOutUp"},{default:q(()=>[f.toggleModal?(d(),p("div",ts,[e("div",ls,[e("div",ss,[N(n,{icon:"times",class:"delete-icon-style",onClick:m[0]||(m[0]=h=>{c.closeConfirmModal()})})]),e("div",as,[e("div",ns,u(i.$t("transfer.proceedWithZero")),1),e("div",os,[e("div",{onClick:m[1]||(m[1]=h=>c.proceedSend()),class:"blue-btn py-2 font-semibold cursor-pointer text-center ml-auto mr-auto w-7/12"},u(i.$t("general.confirm")),1),e("div",{class:"text-center cursor-pointer text-xs font-semibold text-blue-link mt-2",onClick:m[2]||(m[2]=h=>c.closeConfirmModal())},u(i.$t("general.cancel")),1)])])])])):T("",!0)]),_:1}),f.toggleModal?(d(),p("div",{key:0,onClick:m[3]||(m[3]=h=>{c.closeConfirmModal()}),class:"fixed inset-0 bg-opacity-90 bg-gray-100 z-20"})):T("",!0)])}const rs=Te(es,[["render",is]]),cs={class:"w-10/12 ml-auto mr-auto mt-5"},us={class:"border filter shadow-lg xl:grid xl:grid-cols-3 mt-8"},ds={class:"xl:col-span-2 p-12"},ms={key:0,class:"mb-3 rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},vs={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},ps={class:"inline-block text-xs"},gs={class:"text-sm font-semibold"},fs=e("div",{class:"text-blue-primary font-semibold uppercase mt-3 text-xxs"},"Transfer to",-1),bs={class:"flex mt-1 gap-1 items-center"},hs={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},ys={class:"text-xxs text-blue-primary font-semibold uppercase ml-auto mr-auto"},_s={key:2,class:"h-3"},xs={key:3,class:"mb-5"},ks={for:"encryptedMsg",class:"cursor-pointer font-bold ml-4 mr-5 text-tsm"},ws={class:"bg-navy-primary py-6 px-6 xl:col-span-1"},As={class:"font-semibold text-xs text-white mb-1.5"},$s=["disabled"],Ts={class:"text-center"},Ms="^[0-9A-Za-z]{40}$",Is="^[0-9A-Za-z-]{46}$",Fs="^[^ ]{8,}$",Bs=D({__name:"ViewTransfer",setup(i){const m=re(),{t:f}=Oe(),c=m.appContext.config.globalProperties.emitter,l=$(null),r=$(null),n=$(!1),h=$(!1),M=$(""),k=$(!1),w=$(!1),y=$(""),o=$(!0),_=$(!0),b=$([]),s=$([]),x=$("0"),A=$(0),S=$(""),F=$(""),P=$(0),E=H(()=>!(y.value.match(Fs)&&!o.value&&!R.value&&O.value<ae.value&&I.value)),I=H(()=>!(w.value&&k.value&&O.value>0&&_.value));Z(s,t=>{for(let a=0;a<t.length;a++)isNaN(parseFloat(t[a].amount))&&(t[a].amount="0")},{deep:!0}),Z(x,t=>{isNaN(parseFloat(t))&&(x.value="0")});const R=H(()=>r.value?l.value?parseFloat(x.value)>A.value||!s.value.every(t=>parseFloat(t.amount)<=t.balance)?!0:J.value>P.value:J.value>A.value||!s.value.every(t=>parseFloat(t.amount)<=t.balance):!1),O=H(()=>F.value.length==0?0:k.value?Q.getFakeEncryptedMessageSize(F.value):Q.getPlainMessageSize(F.value)),ae=H(()=>{var t;return((t=te)==null?void 0:t.currentNetworkProfileConfig.maxMessageSize)-1}),G=H(()=>{var t;return j.convertToExact((t=te)==null?void 0:t.currentNetworkProfileConfig.lockedFundsPerAggregate,g.nativeToken.divisibility)}),z=H(()=>te.currentNetworkProfile?j.convertToExact(Q.getLockFundFee(),g.nativeToken.divisibility):0),ne=H(()=>{if(!r.value)return 0;let t=g.nativeToken.divisibility;return l.value?j.convertNumberMinimumFormat(A.value,t):j.convertNumberMinimumFormat(A.value-U.value,t)}),J=H(()=>{let t=g.nativeToken.divisibility;return l.value?t==0?Math.trunc(U.value+z.value+G.value):Math.round((U.value+z.value+G.value)*Math.pow(10,t))/Math.pow(10,t):t==0?Math.trunc(parseFloat(x.value.replace(/,/g,""))+U.value):Math.round((parseFloat(x.value.replace(/,/g,""))+U.value)*Math.pow(10,t))/Math.pow(10,t)}),U=H(()=>{const t=s.value.map(a=>({id:a.id,amount:a.amount}));return t.push({id:g.nativeToken.assetId,amount:x.value}),l.value?le.calculateAggregateFee(F.value,x.value,t,k.value):r.value?le.calculateFee(F.value,x.value,t,k.value):0}),Fe=()=>{x.value=ne.value.toString(),x.value=ne.value.toString()},Pe=()=>{r.value=null,y.value="",M.value="",k.value=!1,F.value="",x.value="0",c.emit("CLEAR_SELECT",0),s.value=[],l.value=null,S.value=""},Ce=je(),Se=We(),ve=async()=>{if(!await le.createTransaction(M.value,x.value,F.value,s.value.map(a=>({id:a.id,amount:parseFloat(a.amount),divisibility:a.divisibility})),y.value,r.value,l.value,k.value,S.value)){Ce.add({severity:"error",summary:"Error",detail:"Password is incorrect",group:"br-custom",life:1e3});return}Se.push({name:"ViewAccountPendingTransactions",params:{address:r.value}}),Pe()},Ve=()=>{x.value=="0"&&s.value.length==0?h.value=!0:ve()},Ne=async()=>{if(g.chainAPI)try{const t=await g.chainAPI.accountAPI.getAccountInfo(v.Address.createFromRawAddress(r.value)),a=t.mosaics.findIndex(C=>C.id.toHex()==g.nativeToken.assetId);a!=-1?(P.value=t.mosaics[a].amount.compact()/Math.pow(10,g.nativeToken.divisibility),t.mosaics.splice(a,1)):P.value=0}catch{P.value=0}},pe=async t=>{if(g.chainAPI&&t){b.value=[];try{const a=await g.chainAPI.accountAPI.getAccountInfo(v.Address.createFromRawAddress(t)),C=a.mosaics.findIndex(B=>B.id.toHex()==g.nativeToken.assetId);C!=-1?(A.value=a.mosaics[C].amount.compact()/Math.pow(10,g.nativeToken.divisibility),a.mosaics.splice(C,1)):A.value=0;for(let B=0;B<a.mosaics.length;B++){const oe=a.mosaics[B];b.value.push({id:oe.id.toHex(),balance:oe.amount.compact(),divisibility:0,namespace:"",hasUpdated:!1})}}catch{b.value=[],A.value=0}}};Z([r,l],async([t,a])=>{b.value=[],s.value=[],t==null&&(A.value=0),t!=null&&a==null?(P.value=0,await pe(t)):t!=null&&a!=null&&(await Ne(),await pe(a))}),c.on("select-account",t=>{r.value=t}),c.on("select-multisig-account",t=>{l.value=t}),c.on("CLOSE_CONFIRM_SEND_MODAL",t=>{h.value=t}),c.on("CONFIRM_PROCEED_SEND",t=>{t&&(h.value=!1,ve())});const Le=t=>{n.value=!1,M.value=t.data},Ee=H(()=>{const t=K.currentLoggedInWallet;if(!t)return[];const a=[...t.accounts,...t.others];return t.contacts.length?[{key:"0",label:f("general.ownerAcc"),selectable:!1,children:a.map((C,B)=>({key:"0-"+B.toString(),label:C.name,data:v.Address.createFromRawAddress(C.address).pretty(),selectable:!0}))},{key:"1",label:f("general.contact"),selectable:!1,children:t.contacts.map((C,B)=>({key:"1-"+B.toString(),label:C.name,data:v.Address.createFromRawAddress(C.address).pretty(),selectable:!0}))}]:[{key:"0",label:f("general.ownerAcc"),selectable:!1,children:a.map((C,B)=>({key:"0-"+B.toString(),label:C.name,data:v.Address.createFromRawAddress(C.address).pretty(),selectable:!0}))}]});Z([M,o],t=>{if(t[0].match(Is)||t[0].match(Ms)){if(!t[1]){Be();return}ge()}else o.value=!0});const Be=()=>{g.chainAPI.accountAPI.getAccountInfo(v.Address.createFromRawAddress(M.value)).then(t=>{w.value=t.publicKey=="0".repeat(64)}).catch(t=>w.value=!0)},He=()=>{try{v.PublicAccount.createFromPublicKey(S.value,g.networkType).address.plain()==v.Address.createFromRawAddress(M.value).plain()&&(_.value=!1)}catch{_.value=!0}},ge=()=>{if(K.currentLoggedInWallet)try{let t=j.createAddress(M.value);j.checkAddressNetwork(t,g.networkType)?o.value=!1:o.value=!0}catch{try{let a=j.createNamespaceId(M.value);g.chainAPI.namespaceAPI.getLinkedAddress(a).then(C=>{M.value=C.plain(),o.value=!1}).catch(C=>{o.value=!0})}catch{o.value=!0}}};return(t,a)=>{const C=W("Sidebar"),B=W("font-awesome-icon"),oe=W("router-link"),fe=Ae("debounce");return d(),p("div",null,[N(C,{visible:n.value,"onUpdate:visible":a[0]||(a[0]=V=>n.value=V),baseZIndex:1e4,position:"full"},{default:q(()=>[N(Xe,{contacts:Ee.value,onNodeSelect:Le},null,8,["contacts"])]),_:1},8,["visible"]),N(rs,{toggleModal:h.value},null,8,["toggleModal"]),e("div",cs,[e("div",us,[e("div",ds,[R.value?(d(),p("div",ms,[e("div",vs,[N(B,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),e("div",ps,u(t.$t("general.insufficientBalance")),1)])):T("",!0),e("div",gs,u(t.$t("transfer.newTransfer")),1),N(ct),N(xt,{class:"md:mt-3","selected-address":r.value},null,8,["selected-address"]),fs,e("div",bs,[Y(N(ye,{placeholder:t.$t("transfer.transferPlaceholder"),modelValue:M.value,"onUpdate:modelValue":a[1]||(a[1]=V=>M.value=V),showError:o.value},null,8,["placeholder","modelValue","showError"]),[[fe,ge,"1000"]]),e("div",{onClick:a[2]||(a[2]=V=>n.value=!n.value),class:"border rounded-md cursor-pointer flex flex-col justify-center p-1.5"},[N(B,{icon:"id-card-alt",class:"text-blue-primary ml-auto mr-auto"}),e("div",hs,u(t.$t("general.select")),1),e("div",ys,u(t.$t("general.contact")),1)])]),(d(!0),p(ee,null,de(s.value,(V,X)=>{var be;return d(),p("div",{key:X},[N(St,{class:"mt-3","asset-options":b.value,index:X,"selected-assets":s.value},null,8,["asset-options","index","selected-assets"]),((be=s.value[X].id)==null?void 0:be.length)==16?(d(),ue(he,{key:0,class:"mt-3",modelValue:s.value[X].amount,"onUpdate:modelValue":Ke=>s.value[X].amount=Ke,placeholder:t.$t("transfer.assetAmount"),type:"text",decimal:s.value[X].divisibility},null,8,["modelValue","onUpdate:modelValue","placeholder","decimal"])):T("",!0)])}),128)),s.value.length!=b.value.length?(d(),p("button",{key:1,class:"my-2 font-semibold text-xs text-blue-primary outline-none focus:outline-none disabled:opacity-50",onClick:a[3]||(a[3]=V=>s.value.push({id:null,balance:0,amount:"0",namespace:"",divisibility:0}))}," + "+u(t.$t("transfer.addAssets")),1)):(d(),p("div",_s)),N(he,{modelValue:x.value,"onUpdate:modelValue":a[4]||(a[4]=V=>x.value=V),balance:A.value,placeholder:t.$t("transfer.transferAmount"),logo:!0,type:"text",onClickedMaxAvailable:a[5]||(a[5]=V=>Fe()),decimal:6},null,8,["modelValue","balance","placeholder"]),N(Wt,{modelValue:F.value,"onUpdate:modelValue":a[6]||(a[6]=V=>F.value=V),limit:ae.value,placeholder:t.$t("general.message"),"current-bytes":O.value},null,8,["modelValue","limit","placeholder","current-bytes"]),o.value?T("",!0):(d(),p("div",xs,[Y(e("input",{id:"encryptedMsg",type:"checkbox","onUpdate:modelValue":a[7]||(a[7]=V=>k.value=V)},null,512),[[ze,k.value]]),e("label",ks,u(t.$t("transfer.enableEncryption")),1)])),!o.value&&w.value&&k.value&&O.value>0?Y((d(),ue(ye,{key:4,placeholder:"Recipient Public Key",modelValue:S.value,"onUpdate:modelValue":a[8]||(a[8]=V=>S.value=V),showError:_.value},null,8,["modelValue","showError"])),[[fe,He,"1000"]]):T("",!0)]),e("div",ws,[N(Yl,{"signer-native-token-balance":P.value,"native-amount":x.value,"native-token-balance":A.value,"lock-fund":G.value,"lock-fund-tx-fee":z.value,"selected-multisig-address":l.value,"txn-fee":U.value,"total-fee":J.value,"selected-assets":s.value},null,8,["signer-native-token-balance","native-amount","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee","selected-assets"]),e("div",As,u(t.$t("general.enterPasswordContinue")),1),N(Ze,{placeholder:t.$t("general.enterPassword"),errorMessage:t.$t("general.passwordRequired"),modelValue:y.value,"onUpdate:modelValue":a[9]||(a[9]=V=>y.value=V),icon:"lock",class:"mt-5 mb-3"},null,8,["placeholder","errorMessage","modelValue"]),e("button",{type:"submit",class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",disabled:E.value,onClick:a[10]||(a[10]=V=>Ve())},u(t.$t("general.transfer")),9,$s),e("div",Ts,[N(oe,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white underline"},{default:q(()=>[Me(u(t.$t("general.cancel")),1)]),_:1})])])])])])}}});export{Bs as default};
