import{y as se,j as ne,g as C,w as h,c as w,A as L,D as oe,k as re,x as p,H as ae,ab as ie,n as M,_ as ce,r as _,o as m,f as v,e as s,l as x,b as W,s as P,t as d,b6 as H,i as f,O as S,av as V}from"./index-49f5eac9.js";import{A as de,_ as ue}from"./AccountTabs.vue_vue_type_script_setup_true_lang-c57c1e13.js";import{c as pe}from"./functions-fa076abc.js";import{_ as me}from"./chevron_left-0423cb29.js";import{_ as ve}from"./proximax-logo-ecfc3767.js";import{_ as fe}from"./icon-multisig-2a7c5e5f.js";import{a as be}from"./icon-key-5b3f7dda.js";import"./jdenticon-module-80457c6f.js";import"./TextInput-2430a15b.js";import"./TextInputClean-ae76feb7.js";const ge={name:"ViewMultisigScheme",components:{AccountComponent:de,AccountTabs:ue},props:{address:String},setup(i){const r=se(),{t:b}=ne(),l=C(!1),u=h.currentLoggedInWallet,g=w(()=>{if(!u)return null;let e=u.accounts.find(t=>t.address==i.address)||u.others.filter(t=>t.type==="MULTISIG").find(t=>t.address==i.address);return e||null}),a=w(()=>g.value?g.value.multisigInfo.filter(e=>e.level>=0):[]),T=L.networkType,y=e=>{let t=p.Address.createFromPublicKey(e,T);try{return t}catch{}},B=e=>e>0?b("general.multisig").toUpperCase()+"-":b("general.cosigner")+"-",k=e=>u.accounts.find(t=>t.address==y(e).plain()),n=(e,t)=>{const o=p.PublicAccount.createFromPublicKey(e,T).address.plain(),c=h.currentLoggedInWallet.contacts.find(le=>le.address==o);return c?c.name:k(e)?k(e).name:B(t)+y(e).plain().substr(-4)},A=e=>a.value.find(t=>t.publicKey==e).cosignaturies.length,R=(e,t)=>{let o=p.Address.createFromRawAddress(e).plain();return t?u.accounts.find(c=>c.address==o)||u.others.find(c=>c.address==o):u.accounts.find(c=>c.address==o)},U=e=>{let t=p.Address.createFromRawAddress(e).plain();return!!h.currentLoggedInWallet.others.find(o=>o.address==t)},E=e=>a.value.find(t=>t.publicKey==e).cosignaturies,N=e=>a.value.find(t=>t.publicKey==e).minApproval,I=e=>a.value.find(t=>t.publicKey==e).minRemoval,K=e=>{let t=u.accounts.find(o=>o.publicKey==e)?u.accounts.find(o=>o.publicKey==e):u.others.find(o=>o.publicKey==e);return t?t.balance:-1},D=e=>{let t=[],o=[];for(let c=0;c<e.length;c++)o=E(e[c]),t.push({label:y(e[c]).pretty(),name:n(e[c],A(e[c])),balance:K(e[c]),numApproveTx:N(e[c]),numRemoval:I(e[c]),children:D(o)});return t};let F={label:"",name:"",balance:0,numApproveTx:0,numRemoval:0,children:[]};a.value[0]&&(F={label:y(a.value[0].publicKey).pretty(),name:n(a.value[0].publicKey,a.value[0].cosignaturies.length),balance:K(a.value[0].publicKey),numApproveTx:N(a.value[0].publicKey),numRemoval:I(a.value[0].publicKey),children:D(a.value[0].cosignaturies)}),oe(()=>g,e=>{a.value[0]&&(F={label:y(a.value[0].publicKey).pretty(),name:n(a.value[0].publicKey,a.value[0].cosignaturies.length),balance:K(a.value[0].publicKey),numApproveTx:N(a.value[0].publicKey),numRemoval:I(a.value[0].publicKey),children:D(a.value[0].cosignaturies)})},{deep:!0});let z=w(()=>g.value?g.value.getDirectParentMultisig().length>0:!1),O=e=>{let t=e.slice(0,13),o=e.slice(35,46);return t+"..."+o};const G=w(()=>L.nativeToken.label),Y=w(()=>L.nativeToken.divisibility),q=e=>{let o=ae.toCurrencyFormat(e,Y.value).split(".");return o[1]!=null?{left:o[0],right:o[1]}:{left:o[0],right:null}},J=e=>{let t=document.getElementById(e).getAttribute("copyValue"),o=document.getElementById(e).getAttribute("copySubject");pe(t),r.add({severity:"info",detail:o+" "+b("general.copied"),group:"br-custom",life:3e3})},Q=e=>{try{return p.Address.createFromRawAddress(e).pretty()}catch{}},X=C(0),Z=C(1),$=C(!1),j=re(),ee=e=>{h.currentLoggedInWallet.accounts.find(t=>t.name==e)&&h.currentLoggedInWallet.setDefaultAccountByName(e)},te=e=>(h.currentLoggedInWallet.accounts.find(o=>o.address==e)||h.currentLoggedInWallet.others.find(o=>o.address==e)).name;return{isHover:l,navigate:e=>{if(R(e,!0)&&!l.value&&!U(e)?(ee(te(p.Address.createFromRawAddress(e).plain())),ie(p.Address.createFromRawAddress(e).plain()),j.push({name:"ViewAccountDetails",params:{address:p.Address.createFromRawAddress(e).plain()}})):R(e,!0)&&j.push({name:"ViewAccountDetails",params:{address:p.Address.createFromRawAddress(e).plain()}}),!M.currentNetworkProfile)return"";R(e,!0)||window.open(M.currentNetworkProfile.chainExplorer.url+"/"+M.currentNetworkProfile.chainExplorer.addressRoute+"/"+e)},viewType:X,viewType2:Z,collapsable:$,findAccountWithAddress:R,splitBalance:q,currentNativeTokenName:G,displayAddress:O,isMultisig:z,currentAccount:g,graph:F,copy:J,prettyAddress:Q}}},ye={class:"flex cursor-pointer"},he={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},xe={class:"p-6 border-2 border-t-0 filter shadow-lg mb-6"},Ae={class:"flex cursor-pointer"},we={class:"border-2 border-blue-primary p-1 mb-3 w-16 text-white bg-blue-primary text-xs text-center font-semibold"},_e=["onClick"],Te={class:"text-xs text-left text-blue-500 font-bold"},ke={class:"flex gap-1"},Re=["id","copyValue","copySubject"],Ce={key:0,class:"flex"},Se={class:"text-xs font-bold"},Ve={key:0,class:"text-xs font-bold"},Be={class:"text-xxs mt-0.5"},Ne={class:"ml-1 text-xs font-bold"},Ie={class:"flex gap-3"},Ke={class:"text-xxs text-gray-500"},De={class:"text-xxs text-gray-500"},Fe={class:"flex gap-1 ml-auto"},Le=["title"],Me=["title"],We={class:"font-semibold"},je={class:"text-left py-3 text-xs pl-4"},Pe={class:"text-left py-3 text-xs pl-4"},He={key:0,class:"text-left py-3 text-xs pl-4"},Ue={key:1,class:"text-left py-3 text-xs pl-4"},Ee={key:0,class:"text-left py-3 text-xs pl-4"},ze={key:1,class:"text-left py-3 text-xs pl-4"},Oe={class:"text-left py-3 text-xs pl-4"};function Ge(i,r,b,l,u,g){const a=_("router-link"),T=_("AccountComponent"),y=_("AccountTabs"),B=_("font-awesome-icon"),k=_("blocks-tree");return m(),v("div",null,[s("div",ye,[r[7]||(r[7]=s("img",{src:me},null,-1)),x(a,{to:{name:"ViewDashboard"},class:"text-blue-primary text-xs mt-0.5"},{default:W(()=>[P(d(i.$t("general.back")),1)]),_:1})]),s("div",he,[x(T,{address:b.address,class:"mb-6"},null,8,["address"]),x(y,{address:b.address,selected:"multisig"},null,8,["address"]),s("div",xe,[s("div",Ae,[x(a,{to:{name:"ViewMultisigHome",params:{address:b.address}},class:"border-2 border-blue-primary p-1 mb-3 w-16 text-blue-primary text-xs text-center font-semibold"},{default:W(()=>[P(d(i.$t("general.multisig")),1)]),_:1},8,["to"]),s("div",we,d(i.$t("general.scheme")),1)]),s("div",{class:"overflow-auto w-full border-2",style:H(`${l.viewType2==1?" transform: rotate(180deg);":""}`)},[x(k,{data:l.graph,horizontal:l.viewType==0,collapsable:l.collapsable,props:{label:"label",name:"name",balance:"balance",numApproveTx:"numApproveTx",numRemoval:"numRemoval",children:"children"}},{node:W(({data:n})=>[s("div",{class:"flex flex-col justify-center p-1.5 h-20 cursor-pointer",onClick:A=>l.navigate(l.prettyAddress(n.label)),style:H(`${l.viewType2==1?" transform: rotate(180deg);":""}width: 16.5rem`)},[s("div",Te,d(n.name),1),s("div",ke,[s("div",{id:n.label,copyValue:l.prettyAddress(n.label),copySubject:i.$t("general.address"),class:"font-bold text-left text-xs mt-0.5"},d(l.displayAddress(n.label)),9,Re),x(B,{icon:"copy",title:i.$t("general.copy"),onMouseover:r[0]||(r[0]=A=>l.isHover=!0),onMouseout:r[1]||(r[1]=A=>l.isHover=!1),onClick:A=>l.copy(n.label),class:"w-5 h-5 text-blue-primary cursor-pointer"},null,8,["title","onClick"])]),n.balance!=-1?(m(),v("div",Ce,[s("div",Se,d(l.splitBalance(n.balance).left),1),l.splitBalance(n.balance).right!=null?(m(),v("div",Ve,".")):f("",!0),s("div",Be,d(l.splitBalance(n.balance).right),1),s("div",Ne,d(l.currentNativeTokenName),1),r[8]||(r[8]=s("img",{src:ve,class:"h-4 w-4"},null,-1))])):f("",!0),s("div",Ie,[s("div",Ke,d(i.$t("multisig.approvalScheme",{approval:n.numApproveTx,maxApproval:n.children.length})),1),s("div",De,d(i.$t("multisig.deletionScheme",{deletion:n.numRemoval,maxDeletion:n.children.length})),1),s("div",Fe,[n.children.length>0?(m(),v("div",{key:0,class:"ml-auto bg-green-500 rounded-2xl",title:i.$t("general.multisigTitle")},r[9]||(r[9]=[s("img",{src:fe,class:"h-4 w-5 mr-1",style:{transform:"rotateY(180deg)"}},null,-1)]),8,Le)):f("",!0),n.children.length>0&&l.findAccountWithAddress(n.label)!=null?(m(),v("div",{key:1,class:"p-0.5 bg-purple-500 rounded-2xl",title:i.$t("general.ownerTitle")},r[10]||(r[10]=[s("img",{src:be,class:"h-3 w-3 mr-1"},null,-1)]),8,Me)):f("",!0)])])],12,_e)]),_:1},8,["data","horizontal","collapsable"])],4)]),s("div",We,d(i.$t("multisig.viewSettings")),1),s("div",null,[S(s("input",{name:"view-type",type:"radio",value:"0","onUpdate:modelValue":r[2]||(r[2]=n=>l.viewType=n),checked:!0},null,512),[[V,l.viewType]]),s("label",je,d(i.$t("multisig.horizontal")),1)]),S(s("input",{name:"view-type",type:"radio",value:"1","onUpdate:modelValue":r[3]||(r[3]=n=>l.viewType=n)},null,512),[[V,l.viewType]]),s("label",Pe,d(i.$t("multisig.vertical")),1),s("div",null,[S(s("input",{name:"view-type-2",type:"radio",value:"0","onUpdate:modelValue":r[4]||(r[4]=n=>l.viewType2=n),checked:!0},null,512),[[V,l.viewType2]]),l.viewType==0?(m(),v("label",He,d(i.$t("multisig.rightToLeft")),1)):f("",!0),l.viewType==1?(m(),v("label",Ue,d(i.$t("multisig.topToBottom")),1)):f("",!0)]),S(s("input",{name:"view-type-2",type:"radio",value:"1","onUpdate:modelValue":r[5]||(r[5]=n=>l.viewType2=n)},null,512),[[V,l.viewType2]]),l.viewType==0?(m(),v("label",Ee,d(i.$t("multisig.leftToRight")),1)):f("",!0),l.viewType==1?(m(),v("label",ze,d(i.$t("multisig.bottomToTop")),1)):f("",!0),s("div",null,[s("input",{type:"checkbox",onClick:r[6]||(r[6]=n=>l.collapsable=!l.collapsable)}),s("label",Oe,d(i.$t("multisig.collapsible")),1)])])])}const nt=ce(ge,[["render",Ge]]);export{nt as default};
