import{_ as F,u as j,D as K,r as C,k as N,o as i,b as c,e as s,B,t as o,s as y,z as M,f as k,F as q,h as G,T as J,i as P,w as m,b2 as Q,p as X,j as Y}from"./index-401acdd9.js";import{A as D}from"./addressBookUtils-0d3294bf.js";import{_ as Z}from"./icon-download-26660e63.js";const ee={name:"DisplayImportContactModal",props:[],components:{},data(){return{toggleModal:!1}},setup(){const{t:e}=j(),a=K(),t=P().appContext.config.globalProperties.emitter,n=C([]),u=C(0),g=C(0),r=C([]),L=A=>{var S=A.target.files||A.dataTransfer.files;S.length&&O(S[0])},R=()=>{u.value=0,g.value=0,r.value=[]},O=A=>{new Promise(I=>{var p=new FileReader;p.onload=()=>{I(p.result)},p.readAsText(A)}).then(I=>{if(!m.currentLoggedInWallet)return;const p=m.currentLoggedInWallet;var V=I.match(/[^\r\n]+/g);let $=[],x=[],E=[];V.shift(),V.forEach(w=>{var d,f,b,h,v=w.split(",");if(v.length>4){let l="";for(var T=0;T<v.length-1;++T)l=l+v[T]+",";d=l.replace(/['"]+/g,"")}else d=v[0].replace(/['"]+/g,"");f=v[1].replace(/['"]+/g,""),v[2]?b=v[2].replace(/['"]+/g,""):b="-none-",v[3]?h=v[3].replace(/['"]+/g,""):h=null;const z=p.accounts.findIndex(l=>l.name.toLowerCase()==d.toLowerCase()),U=p.contacts!=null?p.contacts.findIndex(l=>l.address==f):-1,H=p.contacts!=null?p.contacts.findIndex(l=>l.name.toLowerCase()==d.toLowerCase()):-1,W=m.currentLoggedInWallet.accounts.find(l=>l.default==!0);U>=0?$.push({label:d,address:f,group:b,publicKey:h}):H>=0||z>=0?D.verifyNetworkAddress(W.address,f).isPassed?x.push({label:d+" - 2",address:f,group:b,publicKey:h}):E.push({label:d,address:f,group:b,publicKey:h}):D.verifyNetworkAddress(W.address,f).isPassed?x.push({label:d,address:f,group:b,publicKey:h}):E.push({label:d,address:f,group:b,publicKey:h})}),$.length>0&&(g.value=$.length),x.length>0&&(x.forEach(w=>{let d=new Q(w.label,w.address,w.group,w.publicKey);m.currentLoggedInWallet.addAddressBook(d)}),m.wallets.saveMyWalletOnlytoLocalStorage(m.currentLoggedInWallet),u.value=x.length,t.emit("REFRESH_CONTACT_LIST",!0),a.add({severity:"info",summary:e("general.addressBook"),detail:e("addressBook.newContactImported",u.value),group:"br-custom",life:5e3})),r.value=E},I=>{console.log(I)})};return{csv:n,contactAdded:u,contactExisted:g,contactInvalidAddress:r,onFileChange:L,closeModel:R}}},te=e=>(X("data-v-b03246ac"),e=e(),Y(),e),oe=te(()=>s("img",{src:Z,class:"inline-block mr-4 relative top-1"},null,-1)),se={key:0,class:"popup-outer fixed flex z-50"},ne={class:"modal-popup-box"},ae={class:"delete-position"},re={class:"w-104"},le={class:"default-title font-bold mt-0 mb-5"},de={key:0,class:"bg-blue-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},ie={key:1,class:"bg-yellow-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},ce={key:2,class:"bg-red-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},me={key:3,class:"text-left text-gray-800 mt-5"},ue={class:"font-bold mb-2"},ge={class:"inline-block mr-3 w-40"},pe={class:"inline-block"},fe={class:"py-5 my-5 text-tsm"},ve={enctype:"multipart/form-data"};function _e(e,a,_,t,n,u){const g=N("font-awesome-icon");return i(),c("div",null,[s("div",{onClick:a[0]||(a[0]=r=>n.toggleModal=!n.toggleModal),class:"cursor-pointer mt-5 py-2 px-5 rounded-md bg-blue-primary text-white text-tsm drop-shadow-lg filter hover:bg-blue-600 transition-all duration-500"},[oe,B(o(e.$t("general.import")),1)]),y(J,{"enter-active-class":"animate__animated animate__fadeInDown","leave-active-class":"animate__animated animate__fadeOutUp"},{default:M(()=>[n.toggleModal?(i(),c("div",se,[s("div",ne,[s("div",ae,[y(g,{icon:"times",class:"delete-icon-style",onClick:a[1]||(a[1]=r=>{n.toggleModal=!n.toggleModal,t.closeModel()})})]),s("div",re,[s("h1",le,o(e.$t("addressBook.importAddress")),1),t.contactAdded>0?(i(),c("div",de,o(t.contactAdded)+" "+o(e.$t("general.contact",t.contactAdded))+" "+o(e.$t("addressBook.addressBookMessage1")),1)):k("v-if",!0),t.contactExisted>0?(i(),c("div",ie,o(t.contactExisted)+" "+o(e.$t("general.contact",t.contactExisted))+" "+o(e.$t("addressBook.addressBookMessage2")),1)):k("v-if",!0),t.contactInvalidAddress.length>0?(i(),c("div",ce,o(t.contactInvalidAddress.length)+" "+o(e.$t("general.contact",t.contactInvalidAddress.length))+" "+o(e.$t("addressBook.addressBookMessage3")),1)):k("v-if",!0),t.contactInvalidAddress.length>0?(i(),c("div",me,[s("div",ue,o(e.$t("general.contact",t.contactInvalidAddress.length))+" "+o(e.$t("addressBook.addressBookMessage4"))+":",1),(i(!0),c(q,null,G(t.contactInvalidAddress,(r,L)=>(i(),c("div",{key:L,class:"text-left mb-2"},[s("div",ge,o(r.label),1),s("div",pe,o(r.address),1)]))),128))])):k("v-if",!0),s("div",fe,[s("form",ve,[s("input",{type:"file",onChange:a[2]||(a[2]=(...r)=>t.onFileChange&&t.onFileChange(...r))},null,32)])])])])])):k("v-if",!0)]),_:1}),n.toggleModal?(i(),c("div",{key:0,onClick:a[3]||(a[3]=r=>{n.toggleModal=!n.toggleModal,t.closeModel()}),class:"fixed inset-0 bg-opacity-60 bg-gray-100 z-20"})):k("v-if",!0)])}const be=F(ee,[["render",_e],["__scopeId","data-v-b03246ac"],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/services/submodule/addressbook/components/DisplayImportContactModal.vue"]]),he={name:"ViewServicesAddressBook",components:{DisplayImportContactModal:be},setup(){j();const a=P().appContext.config.globalProperties.emitter,_=C([]),t=()=>{m.currentLoggedInWallet&&(_.value=[],m.currentLoggedInWallet.contacts!=null&&m.currentLoggedInWallet.contacts.length>0&&(m.currentLoggedInWallet.contacts.forEach(n=>{_.value.push(n)}),_.value.sort((n,u)=>n.name>u.name?1:n.name<u.name?-1:0)))};return t(),a.on("REFRESH_CONTACT_LIST",n=>{n&&setTimeout(()=>{t()},1e3)}),{list:_}}},we={class:"w-9/12 ml-auto mr-auto mt-5"},ke={class:"flex text-xs font-semibold border-b-2 menu_title_div"},ye={class:"w-18 text-center border-b-2 pb-3 border-yellow-500"},Ie={class:"mt-10"},xe={class:"text-md my-5 font-semibold"},Ce={class:"flex cursor-pointer"},Ae={class:"border-2 border-blue-primary p-1 mb-3 w-20 text-white bg-blue-primary text-xs text-center font-semibold"},Be={class:"text-tsm"};function Me(e,a,_,t,n,u){const g=N("router-link"),r=N("DisplayImportContactModal");return i(),c("div",null,[s("div",we,[s("div",ke,[y(g,{to:{name:"ViewServicesAddressBook"},class:"w-18 text-center border-b pb-3"},{default:M(()=>[B(o(e.$t("general.list")),1)]),_:1}),s("div",ye,o(e.$t("general.import")),1),y(g,{to:{name:"ViewServicesAddressBookExport"},class:"w-18 text-center border-b pb-3"},{default:M(()=>[B(o(e.$t("general.export")),1)]),_:1})]),s("div",Ie,[s("div",xe,o(e.$t("addressBook.importContacts")),1),s("div",Ce,[s("div",Ae,o(e.$t("wallet.importFile")),1),y(g,{to:{name:"ViewServicesAddressBookImportAccount"},class:"border-2 border-blue-primary p-1 mb-3 w-16 text-blue-primary text-xs text-center font-semibold"},{default:M(()=>[B(o(e.$t("general.account")),1)]),_:1})]),s("div",Be,o(e.$t("addressBook.addBackUpContact")),1),y(r,{class:"inline-block w-36 flex-none"})])])])}const Ee=F(he,[["render",Me],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/services/submodule/addressbook/views/ViewServicesAddressBookImport.vue"]]);export{Ee as default};
