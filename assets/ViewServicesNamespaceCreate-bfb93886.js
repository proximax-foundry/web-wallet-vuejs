import{_ as W,ag as ke,Q as se,o as i,f as u,e as l,s as le,t as o,O as ne,i as w,h as O,d as oe,g as n,j as re,c as N,x as J,F as Te,K as $e,E as ie,k as we,n as y,b9 as Ce,ba as Se,H as p,A as d,B as Ie,D as P,r as te,a as Fe,b as U,l as $,G as Pe}from"./index-2c45a7ef.js";import{_ as Ae}from"./icon-info-8b4f1351.js";import{N as S}from"./namespaceUtils-0d51468a.js";import{_ as Ee}from"./delete-8b454e7f.js";import{D as Re}from"./DurationInputClean-4aed9ed7.js";import{_ as Ve}from"./SelectInputAccount.vue_vue_type_script_setup_true_lang-9ac7dc2f.js";import{_ as De}from"./SelectInputMultisigAccount.vue_vue_type_script_setup_true_lang-eb3b8820.js";import{_ as Me}from"./MultisigInput.vue_vue_type_script_setup_true_lang-95596297.js";import{_ as Be}from"./TxnSummary.vue_vue_type_script_setup_true_lang-31b879a0.js";import{T as Le}from"./TransactionLayout-d00a15b3.js";import{T as z}from"./transactionState-1ddd1cc3.js";import"./jdenticon-module-eb1215b2.js";import"./TransactionFeeLayout.vue_vue_type_script_setup_true_lang-7f116348.js";import"./proximax-logo-ecfc3767.js";const Ue={directives:{tooltip:ke},props:{placeholder:String,errorMessage:String,showError:Boolean,disabled:Boolean,modelValue:String,toolTip:String},emits:["update:modelValue"],name:"TextInputTooltip",data(){return{textErr:!1}}},ze={class:"border border-gray-200 px-2 py-1 h-14 rounded-md"},Oe={class:"uppercase text-gray-500 text-txs text-left mb-2"},He={key:0,src:Ae,class:"inline-block ml-1 relative cursor-pointer",style:{top:"-1px"}},je=["disabled","value"],Qe={class:"h-3 mb-2"},Ge={key:0,class:"error error-text text-left"};function Ke(a,h,c,I,A,g){const r=se("tooltip");return i(),u("div",{class:O(c.disabled?"opacity-50":"")},[l("div",ze,[l("div",Oe,[le(o(c.placeholder)+" ",1),c.toolTip?ne((i(),u("img",He,null,512)),[[r,{value:"<tiptext>"+c.toolTip+"</tiptext>",escape:!1},void 0,{bottom:!0}]]):w("",!0)]),l("input",{disabled:c.disabled,value:c.modelValue,onInput:h[0]||(h[0]=s=>a.$emit("update:modelValue",s.target.value)),type:"text",class:"text_input"},null,40,je)]),l("div",Qe,[A.textErr||c.showError?(i(),u("div",Ge,o(c.errorMessage),1)):w("",!0)])],2)}const Ye=W(Ue,[["render",Ke]]),qe=oe({emits:["select-namespace","update:modelValue","clear-namespace"],name:"SelectInputParentNamespace",props:["modelValue","action","address","disabled"],setup(a,{emit:h}){const c=n(!1);ie().appContext.config.globalProperties.emitter;const{t:A}=re(),g=n(""),r=n(""),s=v=>{g.value=v.value,r.value=v.label,c.value=!c.value},E=()=>{g.value="",r.value=""},_=N(()=>{let v=[];v.push({value:"1",label:A("namespace.newRootNamespace"),level:0,disabled:!1});const x=S.listNamespaces(J.Address.createFromRawAddress(a.address).plain());return x.length>0&&v.push.apply(v,x),v});return{selectNamespace:s,namespaces:_,toggleSelection:c,selectedNamespace:g,selectedNamespaceLabel:r,selectNs:v=>{v.disabled||(s(v),h("update:modelValue",g.value),h("select-namespace",g.value))},clearLabel:E}}}),Je={class:"flex"},We={class:"flex flex-col ml-2 text-left"},Xe={class:"text-blue-primary font-semibold text-xxs mb-1 uppercase",style:{"line-height":"9px"}},Ze={key:0,class:"mt-1 text-tsm font-bold"},ea={key:1,class:"text-tsm font-bold"},aa={key:0,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},ta={key:1,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},sa={class:"relative"},la={key:0,class:"absolute border border-t-0 w-full z-50 bg-white max-h-40 overflow-auto px-3 filter drop-shodow-xl"},na={key:0,class:"uppercase pl-2 pt-4 text-xxs text-gray-400"},oa={key:1,class:"text-xxs pt-2 pl-2 pb-2"},ra=["onClick"],ia={key:0,class:"cursor-pointer text-blue-primary text-xxs mt-0.5 ml-auto font-semibold uppercase"},ca={key:1,class:"text-gray-300 text-xxs mt-0.5 ml-auto uppercase"},ua={key:2,class:"text-gray-500 text-xxs mt-0.5 ml-auto uppercase"};function da(a,h,c,I,A,g){return i(),u("div",{class:O(["relative",a.disabled?"opacity-50":"cursor-pointer"])},[l("div",{onClick:h[1]||(h[1]=r=>a.disabled?"":a.toggleSelection=!a.toggleSelection),class:"border ml-auto mr-auto py-3 px-2 rounded-md w-full h-14"},[l("div",Je,[l("div",We,[l("div",Xe,o(a.$t("general.namespace")),1),a.selectedNamespace!=""?(i(),u("div",Ze,o(a.selectedNamespaceLabel),1)):(i(),u("div",ea,o(a.$t("namespace.selectNamespace")),1))]),!a.toggleSelection&&a.selectedNamespace==""?(i(),u("div",aa,o(a.$t("general.select")),1)):w("",!0),!a.toggleSelection&&a.selectedNamespace!=""?(i(),u("div",ta,o(a.$t("general.change")),1)):w("",!0),a.toggleSelection?(i(),u("img",{key:2,onClick:h[0]||(h[0]=r=>{a.selectedNamespace="",a.$emit("clear-namespace")}),src:Ee,class:"h-5 w-5 ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"})):w("",!0)])]),l("div",sa,[a.toggleSelection?(i(),u("div",la,[a.namespaces.length>0?(i(),u("div",na,o(a.$t("namespace.selectNamespace")),1)):(i(),u("div",oa,o(a.$t("general.listEmpty")),1)),(i(!0),u(Te,null,$e(a.namespaces,(r,s)=>(i(),u("div",{key:s,class:O(["px-2 py-3 flex items-center",[s!=a.namespaces.length-1?"border-b border-gray-200":"",r.disabled?"cursor-text":"cursor-pointer"]]),onClick:E=>a.selectNs(r)},[l("div",{class:O(["text-xs truncate",r.disabled?"text-gray-300":"text-black font-semibold"])},o(r.label),3),r.label!=a.selectedNamespace&&!r.disabled?(i(),u("div",ia,o(a.$t("general.select")),1)):r.disabled?(i(),u("div",ca,o(a.$t("general.disabled")),1)):(i(),u("div",ua,o(a.$t("general.current")),1))],10,ra))),128))])):w("",!0)])],2)}const va=W(qe,[["render",da]]),ma={class:"font-semibold mb-4"},pa={key:0,class:"rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},fa={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},ba={class:"inline-block text-xs"},ga={key:1,class:"error error_box"},ha={class:"mt-4"},_a={class:"flex gap-1 mt-3"},ya={key:0,class:"mt-3"},Na={class:"lg:grid lg:grid-cols-2 mt-5"},xa={class:"mb-5 lg:mb-0 lg:mr-2"},ka={class:"mb-5 lg:mb-0 lg:ml-2"},Ta=["disabled"],$a={class:"text-center"},wa={class:"mb-8 sm:pr-1"},Ca={href:"https://bcdocs.xpxsirius.io/docs/built-in-features/namespace/",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Sa={class:"text-gray-400 text-tsm my-3 sm:pr-2"},Ia={class:"mb-8"},Fa={href:"https://t.me/proximaxhelpdesk",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Pa={class:"text-gray-400 text-tsm my-3"},Aa=oe({__name:"ViewServicesNamespaceCreate",setup(a){const h=we(),{t:c}=re(),I=n(null);ie().appContext.config.globalProperties.emitter;const g=n(!1),r=n(!1),s=n(""),E=n(!1),_=n("1"),H=n(""),v=n(c("namespace.validName"));n("");const x=n(!1),X=n(!1);n(!1);const Z=`^[0-9a-z]{2,${N(()=>y.currentNetworkProfileConfig?y.currentNetworkProfileConfig.maxNameSize:0).value}}$`,f=n(!1),F=N(()=>y.currentNetworkProfileConfig?Math.floor(Ce.configReturn(y.currentNetworkProfileConfig.maxNamespaceDuration,Se.DAY)):0),m=n(""),R=N(()=>m.value?m.value=="1"?Number(_.value)>0?p.convertToExact(y.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock*S.calculateDuration(Number(_.value)),d.nativeToken.divisibility):p.convertToExact(y.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock,d.nativeToken.divisibility):p.convertToExact(y.currentNetworkProfileConfig.childNamespaceRentalFee,d.nativeToken.divisibility):0),ce=N(()=>p.toCurrencyFormat(R.value,d.nativeToken.divisibility)),j=N(()=>y.currentNetworkProfileConfig?p.convertToExact(y.currentNetworkProfileConfig.lockedFundsPerAggregate,d.nativeToken.divisibility):0),Q=N(()=>y.currentNetworkProfile?p.convertToExact(Ie.getLockFundFee(),d.nativeToken.divisibility):0),ue=N(()=>j.value+Q.value),de=N(()=>!(s.value.match(Z)&&!E.value&&!ee.value&&!f.value&&m.value)),b=n(null),D=n(null),C=n(null),k=n(0),M=n(0),G=async e=>{if(d.chainAPI&&e)try{const t=await d.chainAPI.accountAPI.getAccountInfo(J.Address.createFromRawAddress(e)),L=t.mosaics.findIndex(q=>q.id.toHex()==d.nativeToken.assetId);return L!=-1?t.mosaics[L].amount.compact()/Math.pow(10,d.nativeToken.divisibility):0}catch{return 0}},ee=N(()=>{if(C.value)return b.value?M.value<R.value?!0:k.value<T.value+ue.value:k.value<R.value+T.value});k.value<R.value?(X.value=!0,x.value=!0,g.value=!0,r.value=!0):(X.value=!1,x.value=!1,g.value=!1,r.value=!1);const B=n(0),T=n(0),ve=()=>{m.value=""},me=e=>{let t=0;e=="1"?(_.value="1",x.value=!1,s.value.trim().length>0&&!f.value&&(t=S.getRootNamespaceTransactionFee(s.value),B.value=Number(p.convertToCurrency(t,d.nativeToken.divisibility)),T.value=p.convertToExact(t,d.nativeToken.divisibility))):(_.value="0",x.value=!0,s.value.trim().length>0&&!f.value&&(t=S.getSubNamespaceTransactionFee(e,s.value),B.value=Number(p.convertToCurrency(t,d.nativeToken.divisibility)),T.value=p.convertToExact(t,d.nativeToken.divisibility)))};P(m,e=>{e?g.value=!1:(g.value=!0,x.value=!0)},{immediate:!0});const pe=()=>{let e=d.buildTxn;if(m.value==="1"){let t=e.registerRootNamespace(s.value,J.UInt64.fromUint(S.calculateDuration(Number(_.value)))).serialize();z.unsignedTransactionPayload=t}else{let t=e.registersubNamespace(m.value,s.value).serialize();z.unsignedTransactionPayload=t}z.selectedAddress=C.value,z.selectedMultisigAddress=b.value,h.push({name:"ViewConfirmTransaction"})};P(_,e=>{parseInt(e)>F.value&&(_.value=`${F.value}`)});const K=()=>{_.value="1"},ae=N(()=>{if(b.value){let e=[j.value,Q.value,T.value];return p.safeSum(e)}else return R.value+T.value});P(ae,e=>{k.value<e?r.value=!0:r.value=!1});const fe=N(()=>y.currentNetworkProfileConfig?y.currentNetworkProfileConfig.reservedRootNamespaceNames.split(",").map(e=>e.trim()):[]),be=()=>m.value==="1"&&fe.value.includes(s.value.trim())?(f.value=!0,v.value=c("namespace.reservedName"),!0):!1,ge=async()=>{if(m.value==="1"&&s.value.trim())try{let e=await Pe.getNamespaceInfo(p.createNamespaceId(s.value));if(b.value){if(e.owner.address.plain()!==b.value)return f.value=!0,v.value=c("namespace.nameRegistered"),!0}else if(e.owner.address.plain()!==C.value)return f.value=!0,v.value=c("namespace.nameRegistered"),!0}catch{return!1}return!1},he=async()=>{if(s.value.trim()){if(be())return;if(f.value=!s.value.match(Z),f.value)v.value=c("namespace.validName");else{if(await ge())return;let t=0;m.value=="1"?s.value.trim().length>0&&!f.value&&(t=S.getRootNamespaceTransactionFee(s.value),B.value=Number(p.convertToCurrency(t,d.nativeToken.divisibility)),T.value=p.convertToExact(t,d.nativeToken.divisibility)):s.value.trim().length>0&&!f.value&&(t=S.getSubNamespaceTransactionFee(s.value,m.value),B.value=Number(p.convertToCurrency(t,d.nativeToken.divisibility)),T.value=p.convertToExact(t,d.nativeToken.divisibility))}}},Y=()=>{s.value="",m.value="",I.value.clearLabel(),f.value=!1,K(),D.value=null,b.value=null};P(C,async(e,t)=>{e==null?(k.value=0,Y()):e!=t&&(Y(),k.value=await G(e))}),P(b,async(e,t)=>{e==null?(M.value=0,Y(),k.value=await G(C.value)):e!=t&&(m.value="",s.value="",I.value.clearLabel(),f.value=!1,K(),M.value=await G(e))}),P(s,e=>{m.value===""?(f.value=!1,v.value=""):e.length==0&&(f.value=!0,v.value=c("namespace.validName"))});const _e=e=>{C.value=e},ye=e=>{D.value=e.label,b.value=e.value},Ne=()=>{D.value=null,b.value=null};return(e,t)=>{const L=te("font-awesome-icon"),q=te("router-link"),xe=se("debounce");return i(),Fe(Le,{class:"mt-8"},{white:U(()=>[l("div",ma,o(e.$t("general.createNamespace")),1),ee.value?(i(),u("div",pa,[l("div",fa,[$(L,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),l("div",ba,o(e.$t("general.insufficientBalance")),1)])):w("",!0),H.value!=""?(i(),u("div",ga,o(H.value),1)):w("",!0),l("div",ha,[l("div",_a,[$(Ve,{type:"namespace",label:"create namespace",onSelectAccount:_e}),$(De,{"selected-address":C.value,onSelectMultisigAccount:ye},null,8,["selected-address"])]),b.value?(i(),u("div",ya,[$(Me,{"select-default-address":b.value,"select-default-name":D.value,type:"namespace",onCloseMultisig:Ne},null,8,["select-default-address","select-default-name"])])):w("",!0),$(va,{onSelectNamespace:me,onClearNamespace:ve,ref_key:"nsRef",ref:I,modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=V=>m.value=V),address:b.value?b.value:C.value,class:"mt-5",disabled:r.value},null,8,["modelValue","address","disabled"]),l("div",Na,[l("div",xa,[ne($(Ye,{disabled:g.value,placeholder:e.$t("general.name"),errorMessage:v.value,modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=V=>s.value=V),icon:"id-card-alt",showError:f.value,class:"w-full inline-block",toolTip:e.$t("namespace.namespaceNameMsg1")+"<br><br>"+e.$t("namespace.namespaceNameMsg2")+"<br><br>"+e.$t("namespace.namespaceNameMsg3"),tabindex:"0"},null,8,["disabled","placeholder","errorMessage","modelValue","showError","toolTip"]),[[xe,he,"1000"]])]),l("div",ka,[$(Re,{disabled:x.value,modelValue:_.value,"onUpdate:modelValue":t[2]||(t[2]=V=>_.value=V),max:F.value,placeholder:e.$t("namespace.duration"),onSetDefaultDuration:K,showError:E.value,toolTip:e.$t("namespace.durationMsg")+`<br>${F.value===365?"1 "+e.$t("general.year"):""} (${F.value}`+e.$t("general.day",F.value)+")."},null,8,["disabled","modelValue","max","placeholder","showError","toolTip"])])])])]),navy:U(()=>[$(Be,{"signer-native-token-balance":k.value,"namespace-rental-fee-currency":ce.value,"native-token-balance":b.value?M.value:k.value,"lock-fund":j.value,"lock-fund-tx-fee":Q.value,"selected-multisig-address":b.value,"txn-fee":T.value,"total-fee":ae.value},null,8,["signer-native-token-balance","namespace-rental-fee-currency","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee"]),l("button",{type:"submit",class:"mt-3 w-full blue-btn py-4 disabled:opacity-50 disabled:cursor-auto text-white",disabled:de.value,onClick:pe},o(e.$t("namespace.registerNamespace")),9,Ta),l("div",$a,[$(q,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white border-b-2 border-white"},{default:U(()=>[le(o(e.$t("general.cancel")),1)]),_:1})])]),description:U(()=>[l("div",wa,[l("a",Ca,o(e.$t("general.namespaceQues")),1),l("div",Sa,o(e.$t("namespace.namespaceAns")),1)]),l("div",Ia,[l("a",Fa,o(e.$t("general.feedback")),1),l("div",Pa,o(e.$t("general.feedbackDescription")),1)])]),_:1})}}});const Ya=W(Aa,[["__scopeId","data-v-c1ed3522"]]);export{Ya as default};
