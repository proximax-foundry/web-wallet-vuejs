import{_ as D,u as P,D as j,r as C,k as N,o as c,b as i,e as s,B,t as o,s as x,z as M,f as k,F as q,h as G,T as J,i as R,w as m,b2 as Q,p as X,j as Y}from"./index-6032540d.js";import{A as V}from"./addressBookUtils-0d3294bf.js";import{_ as Z}from"./icon-download-26660e63.js";const ee={name:"DisplayImportContactModal",props:[],components:{},data(){return{toggleModal:!1}},setup(){const{t:e}=P(),a=j(),t=R().appContext.config.globalProperties.emitter,n=C([]),g=C(0),u=C(0),r=C([]),L=A=>{var S=A.target.files||A.dataTransfer.files;S.length&&z(S[0])},O=()=>{g.value=0,u.value=0,r.value=[]},z=A=>{new Promise(I=>{var p=new FileReader;p.onload=()=>{I(p.result)},p.readAsText(A)}).then(I=>{if(!m.currentLoggedInWallet)return;const p=m.currentLoggedInWallet;var W=I.match(/[^\r\n]+/g);let $=[],w=[],E=[];W.shift(),W.forEach(y=>{var l,f,b,h,_=y.split(",");if(_.length>4){let d="";for(var T=0;T<_.length-1;++T)d=d+_[T]+",";l=d.replace(/['"]+/g,"")}else l=_[0].replace(/['"]+/g,"");f=_[1].replace(/['"]+/g,""),_[2]?b=_[2].replace(/['"]+/g,""):b="-none-",_[3]?h=_[3].replace(/['"]+/g,""):h=null;const U=p.accounts.findIndex(d=>d.name.toLowerCase()==l.toLowerCase()),H=p.contacts!=null?p.contacts.findIndex(d=>d.address==f):-1,K=p.contacts!=null?p.contacts.findIndex(d=>d.name.toLowerCase()==l.toLowerCase()):-1,F=m.currentLoggedInWallet.accounts.find(d=>d.default==!0);H>=0?$.push({label:l,address:f,group:b,publicKey:h}):K>=0||U>=0?V.verifyNetworkAddress(F.address,f).isPassed?w.push({label:l+" - 2",address:f,group:b,publicKey:h}):E.push({label:l,address:f,group:b,publicKey:h}):V.verifyNetworkAddress(F.address,f).isPassed?w.push({label:l,address:f,group:b,publicKey:h}):E.push({label:l,address:f,group:b,publicKey:h})}),$.length>0&&(u.value=$.length),w.length>0&&(w.forEach(y=>{let l=new Q(y.label,y.address,y.group,y.publicKey);m.currentLoggedInWallet.addAddressBook(l)}),m.wallets.saveMyWalletOnlytoLocalStorage(m.currentLoggedInWallet),g.value=w.length,t.emit("REFRESH_CONTACT_LIST",!0),a.add({severity:"info",summary:e("general.addressBook"),detail:e("addressBook.newContactImported",g.value),group:"br-custom",life:5e3})),r.value=E},I=>{console.log(I)})};return{csv:n,contactAdded:g,contactExisted:u,contactInvalidAddress:r,onFileChange:L,closeModel:O}}},te=e=>(X("data-v-897f86eb"),e=e(),Y(),e),oe=te(()=>s("img",{src:Z,class:"inline-block mr-4 relative top-1"},null,-1)),se={key:0,class:"popup-outer fixed flex z-50"},ne={class:"modal-popup-box"},ae={class:"delete-position"},re={class:"w-104"},de={class:"default-title font-bold mt-0 mb-5"},le={key:0,class:"bg-blue-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},ce={key:1,class:"bg-yellow-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},ie={key:2,class:"bg-red-200 text-left text-sm p-2 rounded-lg text-gray-800 mb-2"},me={key:3,class:"text-left text-gray-800 mt-5"},ge={class:"font-bold mb-2"},ue={class:"inline-block mr-3 w-40"},pe={class:"inline-block"},fe={class:"py-5 my-5 text-tsm"},_e={enctype:"multipart/form-data"};function ve(e,a,v,t,n,g){const u=N("font-awesome-icon");return c(),i("div",null,[s("div",{onClick:a[0]||(a[0]=r=>n.toggleModal=!n.toggleModal),class:"cursor-pointer mt-5 py-2 px-5 rounded-md bg-blue-primary text-white text-tsm drop-shadow-lg filter hover:bg-blue-600 transition-all duration-500"},[oe,B(o(e.$t("general.import")),1)]),x(J,{"enter-active-class":"animate__animated animate__fadeInDown","leave-active-class":"animate__animated animate__fadeOutUp"},{default:M(()=>[n.toggleModal?(c(),i("div",se,[s("div",ne,[s("div",ae,[x(u,{icon:"times",class:"delete-icon-style",onClick:a[1]||(a[1]=r=>{n.toggleModal=!n.toggleModal,t.closeModel()})})]),s("div",re,[s("h1",de,o(e.$t("addressBook.importAddress")),1),t.contactAdded>0?(c(),i("div",le,o(t.contactAdded)+" "+o(e.$t("general.contact",t.contactAdded))+" "+o(e.$t("addressBook.addressBookMessage1")),1)):k("",!0),t.contactExisted>0?(c(),i("div",ce,o(t.contactExisted)+" "+o(e.$t("general.contact",t.contactExisted))+" "+o(e.$t("addressBook.addressBookMessage2")),1)):k("",!0),t.contactInvalidAddress.length>0?(c(),i("div",ie,o(t.contactInvalidAddress.length)+" "+o(e.$t("general.contact",t.contactInvalidAddress.length))+" "+o(e.$t("addressBook.addressBookMessage3")),1)):k("",!0),t.contactInvalidAddress.length>0?(c(),i("div",me,[s("div",ge,o(e.$t("general.contact",t.contactInvalidAddress.length))+" "+o(e.$t("addressBook.addressBookMessage4"))+":",1),(c(!0),i(q,null,G(t.contactInvalidAddress,(r,L)=>(c(),i("div",{key:L,class:"text-left mb-2"},[s("div",ue,o(r.label),1),s("div",pe,o(r.address),1)]))),128))])):k("",!0),s("div",fe,[s("form",_e,[s("input",{type:"file",onChange:a[2]||(a[2]=(...r)=>t.onFileChange&&t.onFileChange(...r))},null,32)])])])])])):k("",!0)]),_:1}),n.toggleModal?(c(),i("div",{key:0,onClick:a[3]||(a[3]=r=>{n.toggleModal=!n.toggleModal,t.closeModel()}),class:"fixed inset-0 bg-opacity-60 bg-gray-100 z-20"})):k("",!0)])}const be=D(ee,[["render",ve],["__scopeId","data-v-897f86eb"]]),he={name:"ViewServicesAddressBook",components:{DisplayImportContactModal:be},setup(){P();const a=R().appContext.config.globalProperties.emitter,v=C([]),t=()=>{m.currentLoggedInWallet&&(v.value=[],m.currentLoggedInWallet.contacts!=null&&m.currentLoggedInWallet.contacts.length>0&&(m.currentLoggedInWallet.contacts.forEach(n=>{v.value.push(n)}),v.value.sort((n,g)=>n.name>g.name?1:n.name<g.name?-1:0)))};return t(),a.on("REFRESH_CONTACT_LIST",n=>{n&&setTimeout(()=>{t()},1e3)}),{list:v}}},ye={class:"w-9/12 ml-auto mr-auto mt-5"},ke={class:"flex text-xs font-semibold border-b-2 menu_title_div"},xe={class:"w-18 text-center border-b-2 pb-3 border-yellow-500"},Ie={class:"mt-10"},we={class:"text-md my-5 font-semibold"},Ce={class:"flex cursor-pointer"},Ae={class:"border-2 border-blue-primary p-1 mb-3 w-20 text-white bg-blue-primary text-xs text-center font-semibold"},Be={class:"text-tsm"};function Me(e,a,v,t,n,g){const u=N("router-link"),r=N("DisplayImportContactModal");return c(),i("div",null,[s("div",ye,[s("div",ke,[x(u,{to:{name:"ViewServicesAddressBook"},class:"w-18 text-center border-b pb-3"},{default:M(()=>[B(o(e.$t("general.list")),1)]),_:1}),s("div",xe,o(e.$t("general.import")),1),x(u,{to:{name:"ViewServicesAddressBookExport"},class:"w-18 text-center border-b pb-3"},{default:M(()=>[B(o(e.$t("general.export")),1)]),_:1})]),s("div",Ie,[s("div",we,o(e.$t("addressBook.importContacts")),1),s("div",Ce,[s("div",Ae,o(e.$t("wallet.importFile")),1),x(u,{to:{name:"ViewServicesAddressBookImportAccount"},class:"border-2 border-blue-primary p-1 mb-3 w-16 text-blue-primary text-xs text-center font-semibold"},{default:M(()=>[B(o(e.$t("general.account")),1)]),_:1})]),s("div",Be,o(e.$t("addressBook.addBackUpContact")),1),x(r,{class:"inline-block w-36 flex-none"})])])])}const Ee=D(he,[["render",Me]]);export{Ee as default};
