import{d as Q,g as k,L as me,I as Y,D as Z,r as ee,o as f,f as A,a as te,b as E,e,t as i,i as I,v as T,E as se,w as m,x as l,A as n,c as w,y as ge,H as q,n as D,B as W,k as ve,l as K,s as pe,W as z,bf as fe}from"./index-2c45a7ef.js";import{_ as J}from"./proximax-logo-ecfc3767.js";import{M as xe}from"./multisigUtils-d0b9e991.js";import{t as O}from"./jdenticon-module-eb1215b2.js";import{T as be}from"./TransactionLayout-d00a15b3.js";import{_ as ye}from"./PasswordInput.vue_vue_type_script_setup_true_lang-9ce324d9.js";const he={key:0,class:"account-item-value account-item"},we={class:"flex"},Te=["innerHTML"],_e={class:"flex flex-col ml-2 text-left"},Ae={class:"mt-1 text-tsm font-bold"},Ie={class:"account-item"},ke={class:"flex items-center"},Le=["innerHTML"],Me={class:"text-xs ml-2 font-semibold"},Fe=Q({__name:"SelectInputCosignerAccount",props:{cosignerList:{type:Array,required:!1}},emits:["select-cosigner-account","update:modelValue"],setup(F){k(!1);const v=F,{cosignerList:N}=me(v),p=k([]),x=se().appContext.config.globalProperties.emitter;let S=new Y("ThemeStyleConfig");S.init();let H=S.jdenticonConfig;const _=k(null);Z(N,b=>{p.value=b.map(d=>{const r=[...m.currentLoggedInWallet.accounts,...m.currentLoggedInWallet.others].find(a=>a.publicKey==d);return{label:r?m.currentLoggedInWallet.convertAddressToName(r.address):l.PublicAccount.createFromPublicKey(d,n.networkType).address.plain(),value:l.PublicAccount.createFromPublicKey(d,n.networkType).address.plain()}})},{deep:!0,immediate:!0});const G=k(null),L=(b,d)=>{if(b==null&&d==null){_.value=null,x.emit("select-cosigner-account",null);return}x.emit("select-cosigner-account",d),_.value.label=b,_.value.value=d,G.value=O(d,25,H)};return(b,d)=>{const g=ee("Dropdown");return f(),A("div",null,[p.value.length?(f(),te(g,{key:0,showClear:!0,modelValue:_.value,"onUpdate:modelValue":d[0]||(d[0]=r=>_.value=r),style:{width:"100%"},options:p.value,filter:!0,filterFields:["label","value"],emptyFilterMessage:" ",onChange:d[1]||(d[1]=r=>{var a,y,P,C;L((a=r.value)==null?void 0:a.label,(y=r.value)==null?void 0:y.value),b.$emit("update:modelValue",(P=r.value)==null?void 0:P.value),b.$emit("select-cosigner-account",(C=r.value)==null?void 0:C.value)})},{value:E(r=>[r.value?(f(),A("div",he,[e("div",we,[e("div",{innerHTML:G.value},null,8,Te),e("div",_e,[d[2]||(d[2]=e("div",{class:"text-blue-primary font-semibold text-xxs uppercase",style:{"line-height":"9px"}}," Selected Multisig Account",-1)),e("div",Ae,i(r.value.label),1)])])])):I("",!0)]),option:E(r=>[e("div",Ie,[e("div",ke,[e("div",{innerHTML:T(O)(r.option.value,20,T(H))},null,8,Le),e("div",Me,i(r.option.label),1)])])]),_:1},8,["modelValue","options"])):I("",!0)])}}}),Se={key:0,class:"text-blue-primary mt-3"},He={key:1,class:"text-red-500"},Pe={class:"border border-blue-300 rounded-md p-3 mt-3 bg-blue-50"},Ce={class:"flex items-center gap-2"},Ee=["innerHTML"],Ge={class:"flex flex-col gap-0.5"},Ve={class:"font-semibold"},$e={key:0},We={class:"font-bold text-xs text-blue-primary uppercase"},Ne={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},Re={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},Be=["innerHTML"],De={class:"flex"},Ke={class:"ml-1 text-blue-400 font-bold"},Oe={class:"font-bold text-xs text-blue-primary uppercase"},je={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 text-gray-200 my-1"},Ue={class:"font-semibold text-xxs mt-2 lg:col-span-2 col-span-3 text-blue-primary uppercase"},Xe=["innerHTML"],qe={class:"flex"},ze={class:"ml-1 text-blue-400 font-bold"},Je={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},Qe={class:"font-semibold lg:col-span-2 col-span-3"},Ye=["innerHTML"],Ze={class:"ml-1 text-blue-400"},et={key:1,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs"},tt={class:"font-semibold lg:col-span-2 col-span-3"},st=["innerHTML"],nt={class:"ml-1 text-blue-400"},at={key:2,class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},ot={class:"font-semibold lg:col-span-2 col-span-3"},lt=["innerHTML"],it={class:"ml-1 text-blue-400"},rt={class:"lg:grid lg:grid-cols-5 grid grid-cols-7 justify-between items-center text-gray-200 text-xs py-2"},ct=["innerHTML"],dt={class:"ml-1 text-blue-400"},ut={class:"font-semibold text-xs text-white mb-1.5"},mt={class:"text-center"},yt=Q({__name:"ViewExchangeRemove",props:{owner:String,pair:String},setup(F){const v=F,N=[{namespace:"prx.xpx",name:"XPX"},{namespace:"prx.metx",name:"METX"},{namespace:"xarcade.xar",name:"XAR"}],p=k(""),R=s=>{if(!s)return"0";const t=l.Address.createFromRawAddress(s).plain(),o=m.currentLoggedInWallet.accounts.find(c=>c.address==t)||m.currentLoggedInWallet.others.find(c=>c.address==t);return o?x(o.balance):0},x=s=>{let t=s.toString().split(".");return t[1]!=null?'<span class="font-semibold text-sm">'+t[0]+'</span>.<span class="font-semibold text-xs">'+t[1]+"</span>":'<span class="font-semibold text-sm">'+t[0]+"</span>"},S=s=>{const t=N.find(o=>o.namespace==s);return t?t.name:s},H=new Y("ThemeStyleConfig");H.init();const _=w(()=>O(v.owner,40,H.jdenticonConfig)),G=w(()=>{const s=l.Address.createFromRawAddress(v.owner).plain();return m.currentLoggedInWallet.convertAddressToName(s,!0)}),L=k(null);se().appContext.config.globalProperties.emitter.on("select-cosigner-account",s=>{L.value=s});const g=w(()=>{const s=l.Address.createFromRawAddress(v.owner).plain();return(m.currentLoggedInWallet.accounts.find(o=>o.address==s)||m.currentLoggedInWallet.others.find(o=>o.address==s)).getDirectParentMultisig().length}),r=w(()=>{if(!g.value)return[];const s=l.Address.createFromRawAddress(v.owner).plain(),t=m.currentLoggedInWallet.accounts.find(o=>o.address==s)||m.currentLoggedInWallet.others.find(o=>o.address==s);return xe.getCosignerInWallet(t.publicKey).cosignerList}),a=k(null),y=ge(),P=v.pair.split("/")[0],C=v.pair.split("/")[1],ne=async()=>{if(!P||!C){y.add({severity:"error",summary:"Error",detail:"Invalid",group:"br-custom",life:1e3});return}const s=new l.ExchangeSdaHttp(n.nodeFullURL),t=await fe(s.getAccountSdaExchangeOffers(l.Address.createFromRawAddress(v.owner)));if(a.value=t.sdaOfferBalances.find(u=>u.mosaicIdGive.toHex()==P&&u.mosaicIdGet.toHex()==C),!a.value){y.add({severity:"error",summary:"Error",detail:"Offer not found",group:"br-custom",life:1e3});return}const o=await n.chainAPI.assetAPI.getMosaicsNames([a.value.mosaicIdGet,a.value.mosaicIdGive]),c=await n.chainAPI.assetAPI.getMosaics([a.value.mosaicIdGet,a.value.mosaicIdGive]);a.value.mosaicGetName=o[0].names.length?o[0].names[0].name:a.value.mosaicIdGet.toHex(),a.value.mosaicGiveName=o[1].names.length?o[1].names[0].name:a.value.mosaicIdGive.toHex(),a.value.mosaicGetDivisibility=c.find(u=>u.mosaicId.toHex()==a.value.mosaicIdGet.toHex()).divisibility,a.value.mosaicGiveDivisibility=c.find(u=>u.mosaicId.toHex()==a.value.mosaicIdGive.toHex()).divisibility},ae=Z(n,async(s,t)=>{s.isReady&&(await ne(),ae())},{immediate:!0}),j=w(()=>q.convertToExact(D.currentNetworkProfileConfig.lockedFundsPerAggregate,n.nativeToken.divisibility)),U=w(()=>q.convertToExact(W.getLockFundFee(),n.nativeToken.divisibility)),B=w(()=>{var c;if(!n.isReady)return 0;const s=l.RemoveSdaExchangeOfferTransaction.create(l.Deadline.create(),[new l.RemoveSdaExchangeOffer(new l.MosaicId(n.nativeToken.assetId),new l.MosaicId(n.nativeToken.assetId))],n.networkType);if(!g.value)return((c=s.maxFee)==null?void 0:c.compact())/Math.pow(10,n.nativeToken.divisibility);const t=[...m.currentLoggedInWallet.accounts,...m.currentLoggedInWallet.others].find(u=>u.address==l.Address.createFromRawAddress(v.owner).plain()),o=[s.toAggregateV1(l.PublicAccount.createFromPublicKey(t.publicKey,n.networkType))];return n.buildTxn.aggregateBonded(o).maxFee.compact()/Math.pow(10,n.nativeToken.divisibility)}),oe=w(()=>g.value?Math.round((j.value+U.value+B.value)*Math.pow(10,n.nativeToken.divisibility))/Math.pow(10,n.nativeToken.divisibility):B.value),le=ve(),ie=async()=>{if(g.value&&!L.value){y.add({severity:"error",summary:"Error",detail:"Initiator not selected",group:"br-custom",life:1e3});return}if(p.value.length<8){y.add({severity:"error",summary:"Error",detail:"password must be at least 8 characters",group:"br-custom",life:1e3});return}if(!z.verifyWalletPassword(m.currentLoggedInWallet.name,D.chainNetworkName,p.value)){y.add({severity:"error",summary:"Error",detail:"Incorrect password",group:"br-custom",life:1e3});return}const s=l.Address.createFromRawAddress(v.owner).plain(),t=m.currentLoggedInWallet.accounts.find(h=>h.address==(g.value?L.value:s)),o=z.decryptPrivateKey(new l.Password(p.value),t.encrypted,t.iv);p.value="";const c=l.RemoveSdaExchangeOfferTransaction.create(l.Deadline.create(),[new l.RemoveSdaExchangeOffer(a.value.mosaicIdGive,a.value.mosaicIdGet)],n.networkType),u=l.Account.createFromPrivateKeyV1(o,n.networkType),M=D.currentNetworkProfile.generationHash;if(g.value){const h=[...m.currentLoggedInWallet.accounts,...m.currentLoggedInWallet.others].find(ue=>ue.address==s),V=[c.toAggregateV1(l.PublicAccount.createFromPublicKey(h.publicKey,n.networkType))],$=await n.chainAPI.nodeAPI.getNodeTime(),re=n.buildTxn.aggregateBonded(V,new l.UInt64($.sendTimeStamp)),X=u.preV2Sign(re,M),ce=W.lockFundTx(X),de=u.preV2Sign(ce,M);W.announceLF_AND_addAutoAnnounceABT(de,X)}else{const h=u.preV2Sign(c,M);await W.announceTransaction(h)}le.push({name:"ViewAccountPendingTransactions",params:{address:u.address.plain()}})};return(s,t)=>{const o=ee("router-link");return f(),te(be,{class:"mt-8"},{white:E(()=>{var c,u,M,h,V,$;return[t[3]||(t[3]=e("div",null,"SDA-SDA Exchange - Remove Offer",-1)),r.value.length?(f(),A("div",Se," Select Initiator ")):I("",!0),K(Fe,{"cosigner-list":r.value},null,8,["cosigner-list"]),g.value&&!r.value.length?(f(),A("div",He," Cosigner not found ")):I("",!0),e("div",Pe,[e("div",Ce,[e("div",{innerHTML:_.value},null,8,Ee),e("div",Ge,[t[2]||(t[2]=e("div",{class:"uppercase text-xxs text-blue-primary"}," Selected Account ",-1)),e("div",Ve,i(G.value),1)])])]),t[4]||(t[4]=e("div",{class:"text-blue-primary mt-3"},"Amount to give",-1)),e("div",null,i(((c=a.value)==null?void 0:c.currentMosaicGiveAmount.compact())/Math.pow(10,(u=a.value)==null?void 0:u.mosaicGiveDivisibility))+" "+i(S((M=a.value)==null?void 0:M.mosaicGiveName)),1),t[5]||(t[5]=e("div",{class:"text-blue-primary mt-3"},"Amount to get",-1)),e("div",null,i(((h=a.value)==null?void 0:h.currentMosaicGetAmount.compact())/Math.pow(10,(V=a.value)==null?void 0:V.mosaicGetDivisibility))+" "+i(S(($=a.value)==null?void 0:$.mosaicGetName)),1)]}),navy:E(()=>[g.value?(f(),A("div",$e,[e("div",We,i(s.$t("general.multisigAcc")),1),e("div",Ne,[e("div",Re,i(s.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:R(F.owner)},null,8,Be),e("div",De,[e("div",Ke,i(T(n).nativeToken.label),1),t[6]||(t[6]=e("img",{src:J,class:"ml-1 h-5 w-5 mt-0.5"},null,-1))])]),t[7]||(t[7]=e("div",{class:"border-b-2 border-gray-600 my-2"},null,-1))])):I("",!0),e("div",Oe,i(s.$t("general.signerAcc")),1),e("div",je,[e("div",Ue,i(s.$t("general.currentBalance")),1),e("span",{class:"ml-auto lg:col-span-2 col-span-3",innerHTML:R(g.value?L.value:F.owner)},null,8,Xe),e("div",qe,[e("div",ze,i(T(n).nativeToken.label),1),t[8]||(t[8]=e("img",{src:J,class:"ml-1 h-5 w-5 mt-0.5"},null,-1))])]),t[10]||(t[10]=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1)),e("div",Je,[e("div",Qe,i(g.value?s.$t("general.aggregateFee"):s.$t("general.transactionFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:x(B.value)},null,8,Ye),e("div",Ze,i(T(n).nativeToken.label),1)]),g.value?(f(),A("div",et,[e("div",tt,i(s.$t("general.lockFund")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:x(j.value??0)},null,8,st),e("div",nt,i(T(n).nativeToken.label),1)])):I("",!0),g.value?(f(),A("div",at,[e("div",ot,i(s.$t("general.lockFundTxFee")),1),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:x(U.value??0)},null,8,lt),e("div",it,i(T(n).nativeToken.label),1)])):I("",!0),t[11]||(t[11]=e("div",{class:"border-b-2 border-gray-600 mt-2"},null,-1)),e("div",rt,[t[9]||(t[9]=e("div",{class:"font-semibold lg:col-span-2 col-span-3 uppercase"}," Total ",-1)),e("div",{class:"lg:col-span-2 col-span-3 ml-auto",innerHTML:x(oe.value)},null,8,ct),e("div",dt,i(T(n).nativeToken.label),1)]),e("div",ut,i(s.$t("general.enterPasswordContinue")),1),K(ye,{placeholder:s.$t("general.enterPassword"),modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=c=>p.value=c),icon:"lock",class:"mt-5 mb-3"},null,8,["placeholder","modelValue"]),e("button",{class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:t[1]||(t[1]=c=>ie())}," Sell "),e("div",mt,[K(o,{to:{name:"ViewExchangeListing"},class:"content-center text-xs text-white underline"},{default:E(()=>[pe(i(s.$t("general.cancel")),1)]),_:1})])]),_:1})}}});export{yt as default};
