import{_ as X,ai as Ne,S as le,o as i,f as u,e as s,s as ne,t as o,Q as oe,i as C,h as j,d as re,g as n,j as ie,c as y,x as W,F as xe,M as ke,E as ce,k as Te,n as _,bb as $e,bc as we,H as m,A as d,B as Ce,D as R,r as se,a as Ie,b as O,l as w,G as Se}from"./index-f4fa05bb.js";import{_ as Ee}from"./icon-info-8b4f1351.js";import{N as S}from"./namespaceUtils-6413f3af.js";import{_ as Fe}from"./delete-8b454e7f.js";import{D as Pe}from"./DurationInputClean-a905886e.js";import{_ as Re,a as Ve,b as De,c as Ae}from"./TxnSummary.vue_vue_type_script_setup_true_lang-ae8f55c6.js";import{T as Me}from"./TransactionLayout-4fe4075f.js";import{T as H}from"./transactionState-bc435c31.js";import"./jdenticon-module-14cc3de9.js";import"./TransactionFeeLayout.vue_vue_type_script_setup_true_lang-32d1fb88.js";import"./proximax-logo-ecfc3767.js";const Be={directives:{tooltip:Ne},props:{placeholder:String,errorMessage:String,showError:Boolean,disabled:Boolean,modelValue:String,toolTip:String},emits:["update:modelValue"],name:"TextInputTooltip",data(){return{textErr:!1}}},Le={class:"border border-gray-200 px-2 py-1 h-14 rounded-md"},Ue={class:"uppercase text-gray-500 text-txs text-left mb-2"},ze={key:0,src:Ee,class:"inline-block ml-1 relative cursor-pointer",style:{top:"-1px"}},Oe=["disabled","value"],He={class:"h-3 mb-2"},je={key:0,class:"error error-text text-left"};function Ge(a,h,c,E,V,N){const r=le("tooltip");return i(),u("div",{class:j(c.disabled?"opacity-50":"")},[s("div",Le,[s("div",Ue,[ne(o(c.placeholder)+" ",1),c.toolTip?oe((i(),u("img",ze,null,512)),[[r,{value:"<tiptext>"+c.toolTip+"</tiptext>",escape:!1},void 0,{bottom:!0}]]):C("",!0)]),s("input",{disabled:c.disabled,value:c.modelValue,onInput:h[0]||(h[0]=b=>a.$emit("update:modelValue",b.target.value)),type:"text",class:"text_input"},null,40,Oe)]),s("div",He,[V.textErr||c.showError?(i(),u("div",je,o(c.errorMessage),1)):C("",!0)])],2)}const Qe=X(Be,[["render",Ge]]),Ye=re({emits:["select-namespace","update:modelValue","clear-namespace"],name:"SelectInputParentNamespace",props:["modelValue","action","address","disabled"],setup(a,{emit:h}){const c=n(!1);ce().appContext.config.globalProperties.emitter;const{t:V}=ie(),N=n(""),r=n(""),b=g=>{N.value=g.value,r.value=g.label,c.value=!c.value},l=()=>{N.value="",r.value=""},M=y(()=>{let g=[];g.push({value:"1",label:V("namespace.newRootNamespace"),level:0,disabled:!1});const k=S.listNamespaces(W.Address.createFromRawAddress(a.address).plain());return k.length>0&&g.push.apply(g,k),g});return{selectNamespace:b,namespaces:M,toggleSelection:c,selectedNamespace:N,selectedNamespaceLabel:r,selectNs:g=>{g.disabled||(b(g),h("update:modelValue",N.value),h("select-namespace",N.value))},clearLabel:l}}}),qe={class:"flex"},Je={class:"flex flex-col ml-2 text-left"},Ke={class:"text-blue-primary font-semibold text-xxs mb-1 uppercase",style:{"line-height":"9px"}},We={key:0,class:"mt-1 text-tsm font-bold"},Xe={key:1,class:"text-tsm font-bold"},Ze={key:0,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},ea={key:1,class:"text-xxs ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"},aa={class:"relative"},ta={key:0,class:"absolute border border-t-0 w-full z-50 bg-white max-h-40 overflow-auto px-3 filter drop-shodow-xl"},sa={key:0,class:"uppercase pl-2 pt-4 text-xxs text-gray-400"},la={key:1,class:"text-xxs pt-2 pl-2 pb-2"},na=["onClick"],oa={key:0,class:"cursor-pointer text-blue-primary text-xxs mt-0.5 ml-auto font-semibold uppercase"},ra={key:1,class:"text-gray-300 text-xxs mt-0.5 ml-auto uppercase"},ia={key:2,class:"text-gray-500 text-xxs mt-0.5 ml-auto uppercase"};function ca(a,h,c,E,V,N){return i(),u("div",{class:j(["relative",a.disabled?"opacity-50":"cursor-pointer"])},[s("div",{onClick:h[1]||(h[1]=r=>a.disabled?"":a.toggleSelection=!a.toggleSelection),class:"border ml-auto mr-auto py-3 px-2 rounded-md w-full h-14"},[s("div",qe,[s("div",Je,[s("div",Ke,o(a.$t("general.namespace")),1),a.selectedNamespace!=""?(i(),u("div",We,o(a.selectedNamespaceLabel),1)):(i(),u("div",Xe,o(a.$t("namespace.selectNamespace")),1))]),!a.toggleSelection&&a.selectedNamespace==""?(i(),u("div",Ze,o(a.$t("general.select")),1)):C("",!0),!a.toggleSelection&&a.selectedNamespace!=""?(i(),u("div",ea,o(a.$t("general.change")),1)):C("",!0),a.toggleSelection?(i(),u("img",{key:2,onClick:h[0]||(h[0]=r=>{a.selectedNamespace="",a.$emit("clear-namespace")}),src:Fe,class:"h-5 w-5 ml-auto cursor-pointer text-blue-primary font-semibold mt-auto mb-auto"})):C("",!0)])]),s("div",aa,[a.toggleSelection?(i(),u("div",ta,[a.namespaces.length>0?(i(),u("div",sa,o(a.$t("namespace.selectNamespace")),1)):(i(),u("div",la,o(a.$t("general.listEmpty")),1)),(i(!0),u(xe,null,ke(a.namespaces,(r,b)=>(i(),u("div",{key:b,class:j(["px-2 py-3 flex items-center",[b!=a.namespaces.length-1?"border-b border-gray-200":"",r.disabled?"cursor-text":"cursor-pointer"]]),onClick:l=>a.selectNs(r)},[s("div",{class:j(["text-xs truncate",r.disabled?"text-gray-300":"text-black font-semibold"])},o(r.label),3),r.label!=a.selectedNamespace&&!r.disabled?(i(),u("div",oa,o(a.$t("general.select")),1)):r.disabled?(i(),u("div",ra,o(a.$t("general.disabled")),1)):(i(),u("div",ia,o(a.$t("general.current")),1))],10,na))),128))])):C("",!0)])],2)}const ua=X(Ye,[["render",ca]]),da={class:"font-semibold mb-4"},va={key:0,class:"rounded-md bg-red-200 w-full p-2 flex items-center justify-center"},ma={class:"rounded-full w-5 h-5 border border-red-500 inline-block relative mr-2"},pa={class:"inline-block text-xs"},fa={key:1,class:"error error_box"},ba={class:"mt-4"},ga={class:"flex gap-1 mt-3"},ha={key:0,class:"mt-3"},_a={class:"lg:grid lg:grid-cols-2 mt-5"},ya={class:"mb-5 lg:mb-0 lg:mr-2"},Na={class:"mb-5 lg:mb-0 lg:ml-2"},xa=["disabled"],ka={class:"text-center"},Ta={class:"mb-8 sm:pr-1"},$a={href:"https://bcdocs.xpxsirius.io/docs/built-in-features/namespace/",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},wa={class:"text-gray-400 text-tsm my-3 sm:pr-2"},Ca={class:"mb-8"},Ia={href:"https://t.me/proximaxhelpdesk",target:"_new",class:"sm:h-9 lg:h-5 text-blue-primary font-bold text-tsm items-start flex"},Sa={class:"text-gray-400 text-tsm my-3"},Ea=re({__name:"ViewServicesNamespaceCreate",setup(a){const h=Te(),{t:c}=ie(),E=n(null),N=ce().appContext.config.globalProperties.emitter,r=n(!1),b=n(!1),l=n(""),M=n(!1),x=n("1"),g=n(""),k=n(c("namespace.validName"));n("");const F=n(!1),Z=n(!1);n(!1);const ee=`^[0-9a-z]{2,${y(()=>_.currentNetworkProfileConfig?_.currentNetworkProfileConfig.maxNameSize:0).value}}$`,p=n(!1),P=y(()=>_.currentNetworkProfileConfig?Math.floor($e.configReturn(_.currentNetworkProfileConfig.maxNamespaceDuration,we.DAY)):0),v=n(""),D=y(()=>v.value?v.value=="1"?Number(x.value)>0?m.convertToExact(_.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock*S.calculateDuration(Number(x.value)),d.nativeToken.divisibility):m.convertToExact(_.currentNetworkProfileConfig.rootNamespaceRentalFeePerBlock,d.nativeToken.divisibility):m.convertToExact(_.currentNetworkProfileConfig.childNamespaceRentalFee,d.nativeToken.divisibility):0),ue=y(()=>m.toCurrencyFormat(D.value,d.nativeToken.divisibility)),G=y(()=>_.currentNetworkProfileConfig?m.convertToExact(_.currentNetworkProfileConfig.lockedFundsPerAggregate,d.nativeToken.divisibility):0),Q=y(()=>_.currentNetworkProfile?m.convertToExact(Ce.getLockFundFee(),d.nativeToken.divisibility):0),de=y(()=>G.value+Q.value),ve=y(()=>!(l.value.match(ee)&&!M.value&&!ae.value&&!p.value&&v.value)),f=n(null),B=n(null),I=n(null),T=n(0),L=n(0),Y=async e=>{if(d.chainAPI&&e)try{const t=await d.chainAPI.accountAPI.getAccountInfo(W.Address.createFromRawAddress(e)),z=t.mosaics.findIndex(K=>K.id.toHex()==d.nativeToken.assetId);return z!=-1?t.mosaics[z].amount.compact()/Math.pow(10,d.nativeToken.divisibility):0}catch{return 0}},ae=y(()=>{if(I.value)return f.value?L.value<D.value?!0:T.value<$.value+de.value:T.value<D.value+$.value});T.value<D.value?(Z.value=!0,F.value=!0,r.value=!0,b.value=!0):(Z.value=!1,F.value=!1,r.value=!1,b.value=!1);const U=n(0),$=n(0),me=()=>{v.value=""},pe=e=>{let t=0;e=="1"?(x.value="1",F.value=!1,l.value.trim().length>0&&!p.value&&(t=S.getRootNamespaceTransactionFee(l.value),U.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),$.value=m.convertToExact(t,d.nativeToken.divisibility))):(x.value="0",F.value=!0,l.value.trim().length>0&&!p.value&&(t=S.getSubNamespaceTransactionFee(e,l.value),U.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),$.value=m.convertToExact(t,d.nativeToken.divisibility)))};R(v,e=>{e?r.value=!1:(r.value=!0,F.value=!0)},{immediate:!0});const fe=()=>{let e=d.buildTxn;if(v.value==="1"){let t=e.registerRootNamespace(l.value,W.UInt64.fromUint(S.calculateDuration(Number(x.value)))).serialize();H.unsignedTransactionPayload=t}else{let t=e.registersubNamespace(v.value,l.value).serialize();H.unsignedTransactionPayload=t}H.selectedAddress=I.value,H.selectedMultisigAddress=f.value,h.push({name:"ViewConfirmTransaction"})};R(x,e=>{parseInt(e)>P.value&&(x.value=`${P.value}`)});const q=()=>{x.value="1"},te=y(()=>{if(f.value){let e=[G.value,Q.value,$.value];return m.safeSum(e)}else return D.value+$.value});R(te,e=>{T.value<e?b.value=!0:b.value=!1});const be=y(()=>_.currentNetworkProfileConfig?_.currentNetworkProfileConfig.reservedRootNamespaceNames.split(",").map(e=>e.trim()):[]),ge=()=>v.value==="1"&&be.value.includes(l.value.trim())?(p.value=!0,k.value=c("namespace.reservedName"),!0):!1,he=async()=>{if(v.value==="1"&&l.value.trim())try{let e=await Se.getNamespaceInfo(m.createNamespaceId(l.value));if(f.value){if(e.owner.address.plain()!==f.value)return p.value=!0,k.value=c("namespace.nameRegistered"),!0}else if(e.owner.address.plain()!==I.value)return p.value=!0,k.value=c("namespace.nameRegistered"),!0}catch{return!1}return!1},_e=async()=>{if(l.value.trim()){if(ge())return;if(p.value=!l.value.match(ee),p.value)k.value=c("namespace.validName");else{if(await he())return;let t=0;v.value=="1"?l.value.trim().length>0&&!p.value&&(t=S.getRootNamespaceTransactionFee(l.value),U.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),$.value=m.convertToExact(t,d.nativeToken.divisibility)):l.value.trim().length>0&&!p.value&&(t=S.getSubNamespaceTransactionFee(l.value,v.value),U.value=Number(m.convertToCurrency(t,d.nativeToken.divisibility)),$.value=m.convertToExact(t,d.nativeToken.divisibility))}}},J=()=>{l.value="",v.value="",E.value.clearLabel(),p.value=!1,q(),B.value=null,f.value=null};return R(I,async(e,t)=>{e==null?(T.value=0,J()):e!=t&&(J(),T.value=await Y(e))}),R(f,async(e,t)=>{e==null?(L.value=0,J(),T.value=await Y(I.value)):e!=t&&(v.value="",l.value="",E.value.clearLabel(),p.value=!1,q(),L.value=await Y(e))}),R(l,e=>{v.value===""?(p.value=!1,k.value=""):e.length==0&&(p.value=!0,k.value=c("namespace.validName"))}),N.on("select-account",e=>{I.value=e}),N.on("select-multisig-account",e=>{B.value=e.label,f.value=e.value}),N.on("CLOSE_MULTISIG",()=>{B.value=null,f.value=null}),(e,t)=>{const z=se("font-awesome-icon"),K=se("router-link"),ye=le("debounce");return i(),Ie(Me,{class:"mt-8"},{white:O(()=>[s("div",da,o(e.$t("general.createNamespace")),1),ae.value?(i(),u("div",va,[s("div",ma,[w(z,{icon:"times",class:"text-red-500 h-3 w-3 absolute",style:{top:"3px",left:"4px"}})]),s("div",pa,o(e.$t("general.insufficientBalance")),1)])):C("",!0),g.value!=""?(i(),u("div",fa,o(g.value),1)):C("",!0),s("div",ba,[s("div",ga,[w(Re,{type:"namespace"}),w(Ve,{"selected-address":I.value},null,8,["selected-address"])]),f.value?(i(),u("div",ha,[w(De,{"select-default-address":f.value,"select-default-name":B.value,type:"namespace"},null,8,["select-default-address","select-default-name"])])):C("",!0),w(ua,{onSelectNamespace:pe,onClearNamespace:me,ref_key:"nsRef",ref:E,modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=A=>v.value=A),address:f.value?f.value:I.value,class:"mt-5",disabled:b.value},null,8,["modelValue","address","disabled"]),s("div",_a,[s("div",ya,[oe(w(Qe,{disabled:r.value,placeholder:e.$t("general.name"),errorMessage:k.value,modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=A=>l.value=A),icon:"id-card-alt",showError:p.value,class:"w-full inline-block",toolTip:e.$t("namespace.namespaceNameMsg1")+"<br><br>"+e.$t("namespace.namespaceNameMsg2")+"<br><br>"+e.$t("namespace.namespaceNameMsg3"),tabindex:"0"},null,8,["disabled","placeholder","errorMessage","modelValue","showError","toolTip"]),[[ye,_e,"1000"]])]),s("div",Na,[w(Pe,{disabled:F.value,modelValue:x.value,"onUpdate:modelValue":t[2]||(t[2]=A=>x.value=A),max:P.value,placeholder:e.$t("namespace.duration"),onSetDefaultDuration:q,showError:M.value,toolTip:e.$t("namespace.durationMsg")+`<br>${P.value===365?"1 "+e.$t("general.year"):""} (${P.value}`+e.$t("general.day",P.value)+")."},null,8,["disabled","modelValue","max","placeholder","showError","toolTip"])])])])]),navy:O(()=>[w(Ae,{"signer-native-token-balance":T.value,"namespace-rental-fee-currency":ue.value,"native-token-balance":f.value?L.value:T.value,"lock-fund":G.value,"lock-fund-tx-fee":Q.value,"selected-multisig-address":f.value,"txn-fee":$.value,"total-fee":te.value},null,8,["signer-native-token-balance","namespace-rental-fee-currency","native-token-balance","lock-fund","lock-fund-tx-fee","selected-multisig-address","txn-fee","total-fee"]),s("button",{type:"submit",class:"mt-3 w-full blue-btn py-4 disabled:opacity-50 disabled:cursor-auto text-white",disabled:ve.value,onClick:fe},o(e.$t("namespace.registerNamespace")),9,xa),s("div",ka,[w(K,{to:{name:"ViewDashboard"},class:"content-center text-xs text-white border-b-2 border-white"},{default:O(()=>[ne(o(e.$t("general.cancel")),1)]),_:1})])]),description:O(()=>[s("div",Ta,[s("a",$a,o(e.$t("general.namespaceQues")),1),s("div",wa,o(e.$t("namespace.namespaceAns")),1)]),s("div",Ca,[s("a",Ia,o(e.$t("general.feedback")),1),s("div",Sa,o(e.$t("general.feedbackDescription")),1)])]),_:1})}}});const Ha=X(Ea,[["__scopeId","data-v-e8d0cdcd"]]);export{Ha as default};
