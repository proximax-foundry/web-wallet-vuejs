import{A as se,u as ne,r as C,w as h,c as A,B as L,a as oe,l as re,z as p,H as ae,a1 as ie,n as M,_ as ce,i as w,o as m,b as v,e as s,m as _,v as W,x as j,t as c,a$ as H,f,P as V,V as S}from"./index-63d33769.js";import{A as de,_ as ue}from"./AccountTabs.vue_vue_type_script_setup_true_lang-f8f660e1.js";import{c as pe}from"./functions-b4d31259.js";import{_ as me}from"./chevron_left-0423cb29.js";import{_ as ve}from"./proximax-logo-ecfc3767.js";import{_ as fe}from"./icon-multisig-2a7c5e5f.js";import{a as ge}from"./icon-key-5b3f7dda.js";import"./jdenticon-module-ba46c3b9.js";import"./TextInput-874a9117.js";import"./TextInputClean-a292a89f.js";const be={name:"ViewMultisigScheme",components:{AccountComponent:de,AccountTabs:ue},props:{address:String},setup(a){const d=se(),{t:g}=ne(),l=C(!1),u=h.currentLoggedInWallet,b=A(()=>{if(!u)return null;let e=u.accounts.find(t=>t.address==a.address)||u.others.filter(t=>t.type==="MULTISIG").find(t=>t.address==a.address);return e||null}),r=A(()=>b.value?b.value.multisigInfo.filter(e=>e.level>=0):[]),T=L.networkType,y=e=>{let t=p.Address.createFromPublicKey(e,T);try{return t}catch{}},B=e=>e>0?g("general.multisig").toUpperCase()+"-":g("general.cosigner")+"-",k=e=>u.accounts.find(t=>t.address==y(e).plain()),n=(e,t)=>{const o=p.PublicAccount.createFromPublicKey(e,T).address.plain(),i=h.currentLoggedInWallet.contacts.find(le=>le.address==o);return i?i.name:k(e)?k(e).name:B(t)+y(e).plain().substr(-4)},x=e=>r.value.find(t=>t.publicKey==e).cosignaturies.length,R=(e,t)=>{let o=p.Address.createFromRawAddress(e).plain();return t?u.accounts.find(i=>i.address==o)||u.others.find(i=>i.address==o):u.accounts.find(i=>i.address==o)},U=e=>{let t=p.Address.createFromRawAddress(e).plain();return!!h.currentLoggedInWallet.others.find(o=>o.address==t)},z=e=>r.value.find(t=>t.publicKey==e).cosignaturies,N=e=>r.value.find(t=>t.publicKey==e).minApproval,I=e=>r.value.find(t=>t.publicKey==e).minRemoval,K=e=>{let t=u.accounts.find(o=>o.publicKey==e)?u.accounts.find(o=>o.publicKey==e):u.others.find(o=>o.publicKey==e);return t?t.balance:-1},D=e=>{let t=[],o=[];for(let i=0;i<e.length;i++)o=z(e[i]),t.push({label:y(e[i]).pretty(),name:n(e[i],x(e[i])),balance:K(e[i]),numApproveTx:N(e[i]),numRemoval:I(e[i]),children:D(o)});return t};let F={label:"",name:"",balance:0,numApproveTx:0,numRemoval:0,children:[]};r.value[0]&&(F={label:y(r.value[0].publicKey).pretty(),name:n(r.value[0].publicKey,r.value[0].cosignaturies.length),balance:K(r.value[0].publicKey),numApproveTx:N(r.value[0].publicKey),numRemoval:I(r.value[0].publicKey),children:D(r.value[0].cosignaturies)}),oe(()=>b,e=>{r.value[0]&&(F={label:y(r.value[0].publicKey).pretty(),name:n(r.value[0].publicKey,r.value[0].cosignaturies.length),balance:K(r.value[0].publicKey),numApproveTx:N(r.value[0].publicKey),numRemoval:I(r.value[0].publicKey),children:D(r.value[0].cosignaturies)})},{deep:!0});let E=A(()=>b.value?b.value.getDirectParentMultisig().length>0:!1),O=e=>{let t=e.slice(0,13),o=e.slice(35,46);return t+"..."+o};const G=A(()=>L.nativeToken.label),Y=A(()=>L.nativeToken.divisibility),q=e=>{let o=ae.toCurrencyFormat(e,Y.value).split(".");return o[1]!=null?{left:o[0],right:o[1]}:{left:o[0],right:null}},J=e=>{let t=document.getElementById(e).getAttribute("copyValue"),o=document.getElementById(e).getAttribute("copySubject");pe(t),d.add({severity:"info",detail:o+" "+g("general.copied"),group:"br-custom",life:3e3})},Q=e=>{try{return p.Address.createFromRawAddress(e).pretty()}catch{}},X=C(0),Z=C(1),$=C(!1),P=re(),ee=e=>{h.currentLoggedInWallet.accounts.find(t=>t.name==e)&&h.currentLoggedInWallet.setDefaultAccountByName(e)},te=e=>(h.currentLoggedInWallet.accounts.find(o=>o.address==e)||h.currentLoggedInWallet.others.find(o=>o.address==e)).name;return{isHover:l,navigate:e=>{if(R(e,!0)&&!l.value&&!U(e)?(ee(te(p.Address.createFromRawAddress(e).plain())),ie(p.Address.createFromRawAddress(e).plain()),P.push({name:"ViewAccountDetails",params:{address:p.Address.createFromRawAddress(e).plain()}})):R(e,!0)&&P.push({name:"ViewAccountDetails",params:{address:p.Address.createFromRawAddress(e).plain()}}),!M.currentNetworkProfile)return"";R(e,!0)||window.open(M.currentNetworkProfile.chainExplorer.url+"/"+M.currentNetworkProfile.chainExplorer.addressRoute+"/"+e)},viewType:X,viewType2:Z,collapsable:$,findAccountWithAddress:R,splitBalance:q,currentNativeTokenName:G,displayAddress:O,isMultisig:E,currentAccount:b,graph:F,copy:J,prettyAddress:Q}}},ye={class:"flex cursor-pointer"},he=s("img",{src:me},null,-1),_e={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},xe={class:"p-6 border-2 border-t-0 filter shadow-lg mb-6"},Ae={class:"flex cursor-pointer"},we={class:"border-2 border-blue-primary p-1 mb-3 w-16 text-white bg-blue-primary text-xs text-center font-semibold"},Te=["onClick"],ke={class:"text-xs text-left text-blue-500 font-bold"},Re={class:"flex gap-1"},Ce=["id","copyValue","copySubject"],Ve={key:0,class:"flex"},Se={class:"text-xs font-bold"},Be={key:0,class:"text-xs font-bold"},Ne={class:"text-xxs mt-0.5"},Ie={class:"ml-1 text-xs font-bold"},Ke=s("img",{src:ve,class:"h-4 w-4"},null,-1),De={class:"flex gap-3"},Fe={class:"text-xxs text-gray-500"},Le={class:"text-xxs text-gray-500"},Me={class:"flex gap-1 ml-auto"},We=["title"],Pe=s("img",{src:fe,class:"h-4 w-5 mr-1",style:{transform:"rotateY(180deg)"}},null,-1),je=[Pe],He=["title"],Ue=s("img",{src:ge,class:"h-3 w-3 mr-1"},null,-1),ze=[Ue],Ee={class:"font-semibold"},Oe={class:"text-left py-3 text-xs pl-4"},Ge={class:"text-left py-3 text-xs pl-4"},Ye={key:0,class:"text-left py-3 text-xs pl-4"},qe={key:1,class:"text-left py-3 text-xs pl-4"},Je={key:0,class:"text-left py-3 text-xs pl-4"},Qe={key:1,class:"text-left py-3 text-xs pl-4"},Xe={class:"text-left py-3 text-xs pl-4"};function Ze(a,d,g,l,u,b){const r=w("router-link"),T=w("AccountComponent"),y=w("AccountTabs"),B=w("font-awesome-icon"),k=w("blocks-tree");return m(),v("div",null,[s("div",ye,[he,_(r,{to:{name:"ViewDashboard"},class:"text-blue-primary text-xs mt-0.5"},{default:W(()=>[j(c(a.$t("general.back")),1)]),_:1})]),s("div",_e,[_(T,{address:g.address,class:"mb-6"},null,8,["address"]),_(y,{address:g.address,selected:"multisig"},null,8,["address"]),s("div",xe,[s("div",Ae,[_(r,{to:{name:"ViewMultisigHome",params:{address:g.address}},class:"border-2 border-blue-primary p-1 mb-3 w-16 text-blue-primary text-xs text-center font-semibold"},{default:W(()=>[j(c(a.$t("general.multisig")),1)]),_:1},8,["to"]),s("div",we,c(a.$t("general.scheme")),1)]),s("div",{class:"overflow-auto w-full border-2",style:H(`${l.viewType2==1?" transform: rotate(180deg);":""}`)},[_(k,{data:l.graph,horizontal:l.viewType==0,collapsable:l.collapsable,props:{label:"label",name:"name",balance:"balance",numApproveTx:"numApproveTx",numRemoval:"numRemoval",children:"children"}},{node:W(({data:n})=>[s("div",{class:"flex flex-col justify-center p-1.5 h-20 cursor-pointer",onClick:x=>l.navigate(l.prettyAddress(n.label)),style:H(`${l.viewType2==1?" transform: rotate(180deg);":""}width: 16.5rem`)},[s("div",ke,c(n.name),1),s("div",Re,[s("div",{id:n.label,copyValue:l.prettyAddress(n.label),copySubject:a.$t("general.address"),class:"font-bold text-left text-xs mt-0.5"},c(l.displayAddress(n.label)),9,Ce),_(B,{icon:"copy",title:a.$t("general.copy"),onMouseover:d[0]||(d[0]=x=>l.isHover=!0),onMouseout:d[1]||(d[1]=x=>l.isHover=!1),onClick:x=>l.copy(n.label),class:"w-5 h-5 text-blue-primary cursor-pointer"},null,8,["title","onClick"])]),n.balance!=-1?(m(),v("div",Ve,[s("div",Se,c(l.splitBalance(n.balance).left),1),l.splitBalance(n.balance).right!=null?(m(),v("div",Be,".")):f("",!0),s("div",Ne,c(l.splitBalance(n.balance).right),1),s("div",Ie,c(l.currentNativeTokenName),1),Ke])):f("",!0),s("div",De,[s("div",Fe,c(a.$t("multisig.approvalScheme",{approval:n.numApproveTx,maxApproval:n.children.length})),1),s("div",Le,c(a.$t("multisig.deletionScheme",{deletion:n.numRemoval,maxDeletion:n.children.length})),1),s("div",Me,[n.children.length>0?(m(),v("div",{key:0,class:"ml-auto bg-green-500 rounded-2xl",title:a.$t("general.multisigTitle")},je,8,We)):f("",!0),n.children.length>0&&l.findAccountWithAddress(n.label)!=null?(m(),v("div",{key:1,class:"p-0.5 bg-purple-500 rounded-2xl",title:a.$t("general.ownerTitle")},ze,8,He)):f("",!0)])])],12,Te)]),_:1},8,["data","horizontal","collapsable"])],4)]),s("div",Ee,c(a.$t("multisig.viewSettings")),1),s("div",null,[V(s("input",{name:"view-type",type:"radio",value:"0","onUpdate:modelValue":d[2]||(d[2]=n=>l.viewType=n),checked:!0},null,512),[[S,l.viewType]]),s("label",Oe,c(a.$t("multisig.horizontal")),1)]),V(s("input",{name:"view-type",type:"radio",value:"1","onUpdate:modelValue":d[3]||(d[3]=n=>l.viewType=n)},null,512),[[S,l.viewType]]),s("label",Ge,c(a.$t("multisig.vertical")),1),s("div",null,[V(s("input",{name:"view-type-2",type:"radio",value:"0","onUpdate:modelValue":d[4]||(d[4]=n=>l.viewType2=n),checked:!0},null,512),[[S,l.viewType2]]),l.viewType==0?(m(),v("label",Ye,c(a.$t("multisig.rightToLeft")),1)):f("",!0),l.viewType==1?(m(),v("label",qe,c(a.$t("multisig.topToBottom")),1)):f("",!0)]),V(s("input",{name:"view-type-2",type:"radio",value:"1","onUpdate:modelValue":d[5]||(d[5]=n=>l.viewType2=n)},null,512),[[S,l.viewType2]]),l.viewType==0?(m(),v("label",Je,c(a.$t("multisig.leftToRight")),1)):f("",!0),l.viewType==1?(m(),v("label",Qe,c(a.$t("multisig.bottomToTop")),1)):f("",!0),s("div",null,[s("input",{type:"checkbox",onClick:d[6]||(d[6]=n=>l.collapsable=!l.collapsable)}),s("label",Xe,c(a.$t("multisig.collapsible")),1)])])])}const dt=ce(be,[["render",Ze]]);export{dt as default};
