import{S as we}from"./SelectInputPluginClean-c70d81c8.js";import{_ as _e}from"./PasswordInput.vue_vue_type_script_setup_true_lang-f0e3a1fe.js";import{_ as Ce,u as Ne,c as l,w as m,r as d,n as N,H as M,E as b,V as xe,D as Le,a as V,q as Te,k as C,o,b as r,e as f,s as y,B as ae,t as u,Q as Ie,ag as Pe,F as se,h as le,f as p,z as Se,A as K,W as Fe}from"./index-75e3a228.js";import{a as h}from"./accountUtils-118baa53.js";import{A as Me,_ as We}from"./AccountTabs.vue_vue_type_script_setup_true_lang-325d76df.js";import{M as X}from"./multisigUtils-50290651.js";import{_ as Ue}from"./AddressInputClean.vue_vue_type_style_index_0_lang-e7e2c8a8.js";import{_ as Ve}from"./TransactionFeeDisplay.vue_vue_type_script_setup_true_lang-723c097e.js";import"./multiselect-73c7b5f2.js";import"./jdenticon-module-0e134424.js";import"./functions-e743544d.js";import"./TextInput-ca57b737.js";import"./TextInputClean-cb535960.js";import"./icon-key-5b3f7dda.js";import"./icon-red-x-a5511f99.js";import"./icon-green-tick-1b766454.js";import"./proximax-logo-ecfc3767.js";const Ke={name:"ViewAccountAliasAddressToNamespace",components:{PasswordInput:_e,SelectInputPluginClean:we,AccountComponent:Me,AddressInputClean:Ue,AccountTabs:We,TransactionFeeDisplay:Ve},props:{address:String},setup(s){const{t:i}=Ne(),x=l(()=>{if(!m.currentLoggedInWallet)return[];let t=m.currentLoggedInWallet.accounts.map(n=>({name:n.name,balance:n.balance,address:n.address,publicKey:n.publicKey,isMultisig:!!n.getDirectParentMultisig().length,multisigInfo:n.multisigInfo})),c=m.currentLoggedInWallet.others.filter(n=>n.type==="MULTISIG").map(n=>({name:n.name,balance:n.balance,address:n.address,publicKey:n.publicKey,isMultisig:!0,multisigInfo:n.multisigInfo}));return t.concat(c)}),e=l(()=>{if(!m.currentLoggedInWallet)return null;let t=m.currentLoggedInWallet.accounts.find(c=>c.address==s.address)||m.currentLoggedInWallet.others.find(c=>c.address==s.address);return t||null}),A=t=>x.value.find(c=>c.publicKey==t),F=d(!1);(()=>{e.value&&X.onPartial(K.PublicAccount.createFromPublicKey(e.value.publicKey,b.networkType)).then(t=>F.value=t).catch(t=>{F.value=!1})})();const B=l(()=>g.value==""),L=d(null),D=d(null),w=d(s.address),T=d(""),E=d(null),R=d(null),a=d(""),v=d(""),g=d(""),_=l(()=>{let t=!1;return m.currentLoggedInWallet&&(t=h.getMultisig(w.value)),t}),k=d(""),I=d(!0),O=d(!1),W=d(""),ne="^[^ ]{8,}$",oe="^[0-9A-Za-z]{40}$",re="^[0-9A-Za-z-]{46}$",j=l(()=>N.currentNetworkProfileConfig?M.convertToExact(N.currentNetworkProfileConfig.lockedFundsPerAggregate,b.nativeToken.divisibility):0),z=l(()=>N.currentNetworkProfile?M.convertToExact(xe.getLockFundFee(),b.nativeToken.divisibility):0);Le();const q=m.currentLoggedInWallet?m.currentLoggedInWallet.name:"";let ie=d("");const P=d(0),H=l(()=>{let t=b.nativeToken.divisibility;return _.value?t==0?Math.trunc(parseFloat(P.value)+j.value+z.value):Math.round((parseFloat(P.value)+j.value+z.value)*Math.pow(10,b.nativeToken.divisibility))/Math.pow(10,b.nativeToken.divisibility):P.value}),$=l(()=>e.value?e.value.balance:0),ce=l(()=>b.nativeToken.label),de=l(()=>b.nativeToken.divisibility),ue=l(()=>m.currentLoggedInWallet?M.toCurrencyFormat($.value,de.value):"0"),ee=l(()=>{var t=!1;return _.value?A(S.value)&&(A(S.value).balance<H.value?t=!0:t=!1):$.value<H.value&&(t=!0),t}),me=l(()=>!(F.value==!1&&ee.value==!1&&v.value.match(ne)&&g.value!=null&&k.value!=""&&a.value!=null&&I.value==!1)),ve=l(()=>{let t=[];return t.push({value:"Link",label:i("general.link")},{value:"Unlink",label:i("general.unlink")}),t}),ge=l(()=>{let t=[];return g.value!=null&&(t=h.namespaceOption(w.value,g.value)),t}),Z=l(()=>m.currentLoggedInWallet?h.getNamespaceListByAddress(w.value).length==0:null),U=l(()=>{if(N.currentNetworkProfileConfig){let t=X.getCosignerInWallet(e.value.publicKey?e.value.publicKey:""),c=[];return t.cosignerList.forEach(n=>{c.push({publicKey:n,name:A(n).name,balance:A(n).balance,address:A(n).address})}),t.cosignerList=c,t}else return{hasCosigner:!1,cosignerList:[]}}),S=d(U.value.cosignerList[0]?U.value.cosignerList[0].publicKey:"");V(U,t=>{t.cosignerList.length&&(S.value=t.cosignerList[0]?t.cosignerList[0].publicKey:"")},{deep:!0});const G=l(()=>e.value?X.getCosignerInWallet(e.value.publicKey).cosignerList.length>0:!1),fe=l(()=>G.value==!1&&_.value==!0||Z.value==!0||g.value=="Unlink"),pe=l(()=>G.value==!1&&_.value==!0||Z.value==!0);V(g,(t,c)=>{t!=c&&(k.value="",L.value.clear(),a.value=null,O.value=!1)}),V(a,t=>{const n=h.getNamespaceListByAddress(w.value).find(J=>J.name===a.value);if(g.value=="Unlink"&&t!=null)k.value=K.Address.createFromRawAddress(n.linkedId).pretty();else if(g.value=="Link"&&k.value!=""&&t!=null){let J=K.Address.createFromRawAddress(k.value).plain();P.value=M.amountFormatterSimple(h.getLinkNamespaceToAddressTransactionFee(_.value,J,a.value,g.value),b.nativeToken.divisibility)}});const be=l(()=>h.getContact());V(k,t=>{if(t.length==46&&t.match(re)||t.length==40&&t.match(oe))if(h.verifyAddress(w.value,k.value).isPassed==!1)W.value="Invalid Address",I.value=!0;else{let n=K.Address.createFromRawAddress(t).plain();P.value=M.amountFormatterSimple(h.getLinkNamespaceToAddressTransactionFee(_.value,n,a.value,g.value),b.nativeToken.divisibility),W.value="",I.value=!1}else I.value=!0});const ke=Te(),ye=()=>{if(!Fe.verifyWalletPassword(q,N.chainNetworkName,v.value))T.value=i("general.walletPasswordInvalid",{name:q}),v.value="";else{let t=m.currentLoggedInWallet.accounts.find(c=>c.address==s.address)?m.currentLoggedInWallet.accounts.find(c=>c.address==s.address):m.currentLoggedInWallet.others.find(c=>c.address==s.address);T.value="",ie.value=g.value,h.linkNamespaceToAddress(S.value,_.value,t,v.value,a.value,g.value,k.value),te(),ke.push({name:"ViewAccountPendingTransactions",params:{address:s.address}})}},te=()=>{O.value=!1,L.value.clear(),I.value=!1,v.value="",W.value="",T.value="",k.value=""},Q=l(()=>b.networkType),he=l(()=>Q.value==168&&N.chainNetworkName=="Sirius Testnet 1"?"https://bctestnetfaucet.xpxsirius.io/#/":Q.value==168&&N.chainNetworkName=="Sirius Testnet 2"?"https://bctestnet2faucet.xpxsirius.io/#/":""),Ae=l(()=>{let t=A(S.value);return t?t.balance:0});return{currentNativeTokenName:ce,acc:e,walletState:m,clearInput:te,actionsOptions:ve,disableNamespace:pe,selectAction:g,walletPassword:v,disableCreate:me,noNamespace:Z,namespaceOptions:ge,selectNamespace:a,showContactSelection:O,isMultiSig:_,selectContactRef:E,selectContact:R,disableContactSelection:fe,namespaceAddress:k,lockFundTxFee:z,showAddressError:I,err:T,addressErrorMsg:W,trxFee:P,contact:be,walletName:q,selectNamespaceRef:L,selectActionRef:D,aliasAddressToNamespace:ye,isCosigner:G,lockFund:j,totalFee:H,onPartial:F,walletCosignerList:U,selectedCosignPublicKey:S,findAcc:A,fundStatus:ee,topUpUrl:he,networkType:Q,disableSelectNamespace:B,checkCosignBalance:Ae,accountDisplayBalance:ue}}},Be={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},De={class:"border-2 border-t-0 filter shadow-lg lg:grid lg:grid-cols-3"},Ee={class:"lg:col-span-2 py-6 px-6"},Re={key:0,class:"text-left mt-2 mb-5"},Oe={key:0},je={class:"text-tsm"},ze={key:0,class:"font-bold"},qe={key:1,class:"font-bold"},He=["value"],Ze={key:1,class:"font-semibold"},Ge={key:2,class:"font-semibold"},Qe={key:3,class:"error error_box mb-5"},Je={class:"flex mt-3 gap-1"},Xe={class:"text-xxs text-blue-primary font-semibold uppercase"},Ye={key:1,class:"border rounded-md cursor-pointer flex flex-col justify-around p-2"},$e={class:"text-xxs text-gray-400 font-semibold uppercase"},et={key:4,class:"border"},tt={class:"text-xxs text-gray-300 font-semibold py-2 px-2 uppercase"},at=["onClick"],st={key:0,class:"text-xs py-2 bg-gray-100 pl-2 w-full"},lt={key:1,class:"text-xs py-2 pl-2 w-full"},nt={key:2,class:"ml-auto pr-2 text-xxs py-2 font-semibold text-blue-primary bg-gray-100 uppercase"},ot={key:3,class:"ml-auto mr-2 text-xxs py-2 font-semibold text-blue-primary uppercase"},rt={class:"bg-navy-primary p-6 lg:col-span-1"},it={class:"font-semibold text-xs text-white mb-1.5"},ct=f("div",{class:"mt-3"},null,-1),dt=["disabled"],ut=["disabled"],mt={class:"text-center"};function vt(s,i,x,e,A,F){const Y=C("AccountComponent"),B=C("AccountTabs"),L=C("SelectInputPluginClean"),D=C("AddressInputClean"),w=C("font-awesome-icon"),T=C("TransactionFeeDisplay"),E=C("PasswordInput"),R=C("router-link");return o(),r("div",null,[f("div",Be,[y(Y,{address:x.address,class:"mb-6"},null,8,["address"]),y(B,{address:x.address,selected:"details"},null,8,["address"]),f("div",De,[f("div",Ee,[e.isMultiSig?(o(),r("div",Re,[e.walletCosignerList.cosignerList.length>0?(o(),r("div",Oe,[f("div",je,[ae(u(s.$t("general.initiateBy"))+": ",1),e.walletCosignerList.length==1?(o(),r("span",ze,u(e.walletCosignerList.cosignerList[0].name),1)):(o(),r("span",qe,[Ie(f("select",{class:"","onUpdate:modelValue":i[0]||(i[0]=a=>e.selectedCosignPublicKey=a)},[(o(!0),r(se,null,le(e.walletCosignerList.cosignerList,(a,v)=>(o(),r("option",{value:e.findAcc(a.publicKey).publicKey,key:v},u(a.name),9,He))),128))],512),[[Pe,e.selectedCosignPublicKey]])]))])])):p("",!0)])):p("",!0),e.selectAction=="Link"?(o(),r("div",Ze,u(s.$t("general.linkToNamespace")),1)):p("",!0),e.selectAction=="Unlink"?(o(),r("div",Ge,u(s.$t("namespace.manageNamespace")),1)):p("",!0),e.err!=""?(o(),r("div",Qe,u(e.err),1)):p("",!0),y(L,{class:"my-3",placeholder:s.$t("namespace.selectAction"),modelValue:e.selectAction,"onUpdate:modelValue":i[1]||(i[1]=a=>e.selectAction=a),options:e.actionsOptions,ref:"selectActionRef",disabled:e.disableNamespace},null,8,["placeholder","modelValue","options","disabled"]),y(L,{placeholder:s.$t("namespace.selectNamespace"),ref:"selectNamespaceRef",modelValue:e.selectNamespace,"onUpdate:modelValue":i[2]||(i[2]=a=>e.selectNamespace=a),options:e.namespaceOptions,disabled:e.disableNamespace||e.disableSelectNamespace},null,8,["placeholder","modelValue","options","disabled"]),f("div",Je,[y(D,{placeholder:s.$t("general.addAccAddress"),modelValue:e.namespaceAddress,"onUpdate:modelValue":i[3]||(i[3]=a=>e.namespaceAddress=a),errorMessage:e.addressErrorMsg,showError:e.showAddressError,disabled:e.disableNamespace||e.selectAction=="Unlink"||e.selectNamespace==null},null,8,["placeholder","modelValue","errorMessage","showError","disabled"]),e.selectNamespace!=null&&e.selectAction=="Link"?(o(),r("div",{key:0,onClick:i[4]||(i[4]=a=>e.showContactSelection=!e.showContactSelection),class:"border rounded-md cursor-pointer flex flex-col justify-around p-2"},[y(w,{icon:"id-card-alt",class:"text-blue-primary ml-auto mr-auto"}),f("div",Xe,u(s.$t("general.select")),1)])):(o(),r("div",Ye,[y(w,{icon:"id-card-alt",class:"text-gray-400 ml-auto mr-auto"}),f("div",$e,u(s.$t("general.select")),1)]))]),e.showContactSelection?(o(),r("div",et,[f("div",tt,u(s.$t("general.importFromAB")),1),(o(!0),r(se,null,le(e.contact,(a,v)=>(o(),r("div",{key:v,class:"cursor-pointer"},[f("div",{onClick:g=>{e.namespaceAddress=a.value,e.showContactSelection=!1},class:"flex justify-center"},[v%2==0?(o(),r("div",st,u(a.label),1)):p("",!0),v%2==1?(o(),r("div",lt,u(a.label),1)):p("",!0),v%2==0?(o(),r("div",nt,u(s.$t("general.select")),1)):p("",!0),v%2==1?(o(),r("div",ot,u(s.$t("general.select")),1)):p("",!0)],8,at)]))),128))])):p("",!0)]),f("div",rt,[y(T,{"transaction-fee":Number(e.trxFee),"total-fee-formatted":String(e.totalFee),"get-multi-sig-cosigner":e.walletCosignerList,"check-cosign-balance":String(e.checkCosignBalance),"lock-fund-currency":e.lockFund,"lock-fund-tx-fee":e.lockFundTxFee,balance:e.accountDisplayBalance,"selected-acc-add":x.address,"no-namespace":e.noNamespace,"on-partial":e.onPartial,"is-cosigner":e.isCosigner,"fund-status":e.fundStatus},null,8,["transaction-fee","total-fee-formatted","get-multi-sig-cosigner","check-cosign-balance","lock-fund-currency","lock-fund-tx-fee","balance","selected-acc-add","no-namespace","on-partial","is-cosigner","fund-status"]),f("div",it,u(s.$t("general.enterPasswordContinue")),1),y(E,{placeholder:s.$t("general.enterPassword"),errorMessage:s.$t("general.passwordRequired"),modelValue:e.walletPassword,"onUpdate:modelValue":i[5]||(i[5]=a=>e.walletPassword=a),icon:"lock",disabled:e.disableNamespace},null,8,["placeholder","errorMessage","modelValue","disabled"]),ct,e.selectAction=="Link"?(o(),r("button",{key:0,class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:i[6]||(i[6]=(...a)=>e.aliasAddressToNamespace&&e.aliasAddressToNamespace(...a)),disabled:e.disableCreate},u(s.$t("general.linkToNamespace")),9,dt)):p("",!0),e.selectAction=="Unlink"?(o(),r("button",{key:1,class:"w-full blue-btn px-3 py-3 disabled:opacity-50 disabled:cursor-auto",onClick:i[7]||(i[7]=(...a)=>e.aliasAddressToNamespace&&e.aliasAddressToNamespace(...a)),disabled:e.disableCreate},u(s.$t("namespace.unlinkNamespace")),9,ut)):p("",!0),f("div",mt,[y(R,{to:{name:"ViewAccountDetails",params:{address:x.address}},class:"content-center text-xs text-white underline"},{default:Se(()=>[ae(u(s.$t("general.cancel")),1)]),_:1},8,["to"])])])])])])}const St=Ce(Ke,[["render",vt]]);export{St as default};
