import{r as n,u as z,D as H,q as J,w as u,c as k,a as V,W as Q,E as P,i as X,A as B,b0 as Y,_ as Z,k as h,o as L,b as D,e as f,s as p,z as S,B as _,t as g,f as $}from"./index-66465054.js";import{T as ee}from"./TextInputClean-a245ca91.js";import{A as oe}from"./addressBookUtils-0d3294bf.js";import{S as ae}from"./SelectInputPluginClean-4f749aa4.js";import{A as se,_ as te}from"./icon-save-f9db940d.js";import"./multiselect-b797c0a5.js";const le={name:"ViewServicesAddressBookAddContact",components:{TextInputClean:ee,SelectInputPluginClean:ae,AddCustomGroupModal:se},setup(){const l=X().appContext.config.globalProperties.emitter,A=n(null),{t:e}=z(),x=H(),c=n(""),s=n(""),a=n(""),i=n(""),m=n(""),r=n(!1),y=n(""),G=J(),I=n(""),M=["-none-","Work","Friend","Family","Employee","Director"];let E=[];const w=n([]);if(w.value.push({value:"-none-",label:" - "},{value:"Work",label:e("addressBook.work")},{value:"Friend",label:e("addressBook.friend")},{value:"Family",label:e("addressBook.family")},{value:"Employee",label:e("addressBook.employee")},{value:"Director",label:e("addressBook.director")}),u.currentLoggedInWallet&&u.currentLoggedInWallet.contacts.length>0){u.currentLoggedInWallet.contacts.forEach(t=>{M.includes(t.group)||E.push(t.group)});let o=[...new Set(E)];o.length>0&&(o.sort(),o.forEach(t=>{w.value.push({value:t,label:t})}))}w.value.push({value:"Custom",label:e("addressBook.custom")});const N=k(()=>w.value),W=k(()=>!(r.value&&c.value!="")),O=k(()=>!r.value&&s.value!=""),T=k(()=>s.value!=""&&c.value==""||a.value!=""&&c.value==""),U=k(()=>{let o=e("general.invalidInput");return y.value?y.value:o});V(a,()=>{if(u.currentLoggedInWallet)if(a.value.length<=63||a.value.length>=65){s.value=a.value;const o=u.currentLoggedInWallet.accounts.find(v=>v.default==!0),t=oe.verifyNetworkAddress(o.address,s.value);r.value=t.isPassed,y.value=t.errMessage}else a.value.length==64&&(r.value=!0,s.value=Q.createAddressFromPublicKey(a.value,P.networkType).plain())});const C=n(!1);V(I,o=>{o=="Custom"&&(C.value=!0)});const F=async o=>{try{let t=await P.chainAPI.accountAPI.getAccountInfo(B.Address.createFromRawAddress(o));t.publicKey=="0000000000000000000000000000000000000000000000000000000000000000"?i.value=null:i.value=t.publicKey}catch{i.value=null}},R=async()=>{if(c.value==" "){m.value=e("general.nameRequired");return}a.value.length==64?i.value=a.value:await F(s.value),console.log(s.value);const o=B.Address.createFromRawAddress(s.value);let t=new Y(c.value.trim(),o.plain(),I.value,i.value);const v=u.currentLoggedInWallet,K=v.accounts.findIndex(b=>b.name.toLowerCase()==c.value.toLowerCase().trim()),q=v.contacts!=null?v.contacts.findIndex(b=>B.Address.createFromRawAddress(b.address).plain()==o.plain()):-1,j=v.contacts!=null?v.contacts.findIndex(b=>b.name.toLowerCase()==c.value.toLowerCase().trim()):-1;q>=0?m.value=e("addressBook.addressExist"):j>=0||K>=0?m.value=e("addressBook.nameExist"):(u.currentLoggedInWallet.addAddressBook(t),u.wallets.saveMyWalletOnlytoLocalStorage(u.currentLoggedInWallet),m.value="",c.value="",a.value="",x.add({severity:"info",summary:e("general.addressBook"),detail:e("addressBook.newContactAdded"),group:"br-custom",life:5e3}),G.push({name:"ViewServicesAddressBook"}))};return l.on("CLOSE_ADDCUSTOMGROUP_PANEL",()=>{C.value=!1}),l.on("ADD_CUSTOM_GROUP",o=>{w.value.push({value:o,label:o}),A.value&&A.value.select(o),C.value=!1}),{err:m,addErr:U,contactName:c,address:s,addressOrPk:a,disableSave:W,showAddErr:O,showNameErr:T,SaveContact:R,selectContactGroups:I,contactGroups:N,isDisplayAddCustomPanel:C,selectGroupDropdown:A}}},re={class:"lg:w-9/12 ml-2 mr-2 lg:ml-auto lg:mr-auto mt-5"},ne={class:"flex text-xs font-semibold border-b-2 menu_title_div"},de={class:"border border-gray-100 p-5 filter drop-shadow-xl mt-10 bg-white"},ce={class:"text-md mb-5 font-semibold"},ue={key:0,class:"error error_box mb-5"},ie={class:"mt-2 py-3 px-0 md:flex"},me=["disabled"],ve=f("img",{src:te,class:"inline-block mr-2"},null,-1);function pe(d,l,A,e,x,c){const s=h("router-link"),a=h("TextInputClean"),i=h("SelectInputPluginClean"),m=h("AddCustomGroupModal");return L(),D("div",null,[f("div",re,[f("div",ne,[p(s,{to:{name:"ViewServicesAddressBook"},class:"w-18 text-center border-b pb-3"},{default:S(()=>[_(g(d.$t("general.list")),1)]),_:1}),p(s,{to:{name:"ViewServicesAddressBookImport"},class:"w-18 text-center border-b pb-3"},{default:S(()=>[_(g(d.$t("general.import")),1)]),_:1}),p(s,{to:{name:"ViewServicesAddressBookExport"},class:"w-18 text-center border-b pb-3"},{default:S(()=>[_(g(d.$t("general.export")),1)]),_:1})]),f("div",de,[f("div",ce,g(d.$t("addressBook.addNewContact")),1),e.err!=""?(L(),D("div",ue,g(e.err),1)):$("v-if",!0),f("div",ie,[p(a,{placeholder:d.$t("general.name"),errorMessage:d.$t("general.nameRequired"),modelValue:e.contactName,"onUpdate:modelValue":l[0]||(l[0]=r=>e.contactName=r),icon:"id-card-alt",showError:e.showNameErr,class:"w-full md:w-52 inline-block mr-2"},null,8,["placeholder","errorMessage","modelValue","showError"]),p(a,{placeholder:d.$t("multisig.addressOrPk"),errorMessage:e.addErr,modelValue:e.addressOrPk,"onUpdate:modelValue":l[1]||(l[1]=r=>e.addressOrPk=r),icon:"wallet",showError:e.showAddErr,class:"w-full md:w-96 inline-block mr-2"},null,8,["placeholder","errorMessage","modelValue","showError"]),p(i,{modelValue:e.selectContactGroups,"onUpdate:modelValue":l[2]||(l[2]=r=>e.selectContactGroups=r),placeholder:d.$t("general.group"),options:e.contactGroups,selectDefault:"-none-",ref:"selectGroupDropdown",class:"w-full md:w-60 inline-block mr-2"},null,8,["modelValue","placeholder","options"]),f("button",{type:"submit",class:"mt-5 md:mt-0 default-btn py-1 disabled:opacity-50 h-12 flex items-center",disabled:e.disableSave,onClick:l[3]||(l[3]=r=>e.SaveContact())},[ve,_(" "+g(d.$t("addressBook.saveAddress")),1)],8,me)])])]),p(m,{toggleModal:e.isDisplayAddCustomPanel,groups:e.contactGroups},null,8,["toggleModal","groups"])])}const Ce=Z(le,[["render",pe],["__file","/home/runner/work/web-wallet-vuejs/web-wallet-vuejs/src/modules/services/submodule/addressbook/views/ViewServicesAddressBookAddContact.vue"]]);export{Ce as default};
